Imports Microsoft.VisualBasic

Public Class ClsMaster

#Region "For All Master"
    Public Function Save_Masters(ByVal Choice_1 As DataObjOpenSaveModeEnum, _
                                ByVal Masters_1 As MasterEntriesEnum, _
                                 ByVal Ds_Mst As DataSet, _
                                 ByVal UserCode_1 As String, _
                                 ByRef eStr_Retu As String) As Boolean

        Dim objDtLogic As New ClsDataLogic_New

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If Masters_1 = MasterEntriesEnum.MasterEntriesEnum_TemplateMst Then
                Save_Masters = Save_tempateMst(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)
                'Added By Naimesh Dave

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_OperationMst Then
                Save_Masters = Save_OperationMst(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_UserTypeMst Then
                Save_Masters = Save_UserTypeMst(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_roleOperationMatrix Then
                Save_Masters = Save_roleOperationMatrix(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_WorkspaceSubjectMst Then
                Save_Masters = Save_WorkSpaceSubjectMst(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_DrugMst Then
                Save_Masters = Save_DrugMst(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_regionmst Then
                Save_Masters = Save_Regionmst(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_UserMst Then
                Save_Masters = Save_UserMst(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_userGroupMst Then
                Save_Masters = Save_UserGroupMst(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_resourcemst Then
                Save_Masters = Save_Resourcemst(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_clientmst Then
                Save_Masters = Save_ClientMst(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_activitymst Then
                Save_Masters = Save_ActivityMst(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_StageMst Then
                Save_Masters = Save_StageMst(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_DoctypeMst Then
                Save_Masters = Save_DoctypeMst(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_LocationMst Then
                Save_Masters = Save_LocationMst(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_TemplateTypeMst Then
                Save_Masters = Save_TemplateTypeMst(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_DeptMst Then
                Save_Masters = Save_DeptMst(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_SubjectFemaleDetails Then
                Save_Masters = save_subjectFemaleDetails(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_ProtocolCriterienMst Then
                Save_Masters = Save_InsertProtocolCriterienMst(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_DocTemplateMst Then
                Save_Masters = Save_InsertDocTemplateMst(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_MedExMst Then
                Save_Masters = Save_MedExMst(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_MedExGroupMst Then
                Save_Masters = Save_MedExGroupMst(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_MedExTemplateDtl Then
                Save_Masters = Save_MedExTemplateDtl(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_MedExWorkspaceDtl Then
                Save_Masters = Save_MedExWorkspaceDtl(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_HolidayMst Then
                Save_Masters = Save_InsertHolidayMst(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_MedExSubGroupMst Then
                Save_Masters = Save_MedExSubGroupMst(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_ActivityGroupMst Then
                Save_Masters = Save_ActivityGroupMst(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_ScopeMst Then
                Save_Masters = Save_ScopeMst(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_UOMMst Then
                Save_Masters = Save_UOMMst(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_ProjectGroupMst Then
                Save_Masters = Save_ProjectgroupMst(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_ProjectGroupWorkspaceMatrix Then
                Save_Masters = Save_ProjectgroupWorkspaceMatrix(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_AgeGroupMst Then
                Save_Masters = Save_AgeGroupMst(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_MedExRangeMst Then
                Save_Masters = Save_MedExRangeMst(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_LabTypeMst Then
                Save_Masters = Save_LabTypeMst(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_MedExCostMst Then
                Save_Masters = Save_MedExCostMst(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_CurrencyMst Then
                Save_Masters = Save_CurrencyMst(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_SampleTypeMst Then
                Save_Masters = Save_SampleTypeMst(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_SampleReportPrintingDetail Then
                Save_Masters = Save_SampleReportPrintingDetail(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_ReferralMaster Then
                Save_Masters = Save_ReferralMaster(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_PatientMaster Then
                Save_Masters = Save_PatientMaster(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_DocumentUpload Then
                Save_Masters = Save_DocumentUpload(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_DiscountMedExTemplateMatrix Then
                Save_Masters = Save_DiscountMedExTemplateMatrix(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_SMSDetail Then
                Save_Masters = Save_SMSDetails(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_SpecialityMst Then
                Save_Masters = Save_SpecialityMst(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_CityMst Then
                Save_Masters = Save_CityMst(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_ReasonMst Then
                Save_Masters = Save_ReasonMst(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_KnockOffDtl Then
                Save_Masters = Save_KnockOffDetail(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_LabPatientMaster Then
                Save_Masters = Save_LabPatientMaster(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_SampleRemarkDtl Then
                Save_Masters = Save_SampleRemarkDtl(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_TemplateRemarkDtl Then
                Save_Masters = Save_TemplateRemarkDtl(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_SampleCollecterMaster Then
                Save_Masters = Save_SampleCollecterMaster(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_CountryMaster Then
                Save_Masters = Save_CountryMaster(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_SpecialityMaster Then
                Save_Masters = Save_SpecialityMaster(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_HistoParameterDtl Then
                Save_Masters = Save_HistoParameterDtl(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_ChildWorkSpaceMstSite Then
                Save_Masters = Save_ChildWorkSpaceMstSite(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_ParameterHdr Then
                Save_Masters = Save_ParameterHdr(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_ParameterDtl Then
                Save_Masters = Save_ParameterDtl(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_SampleParameterDetail Then
                Save_Masters = Save_SampleParameterDetail(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_RemarkGroupDtl Then
                Save_Masters = Save_RemarkGroupDtl(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_MedexRemarkDtl Then
                Save_Masters = Save_MedexRemarkDtl(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_HistoSampleUserApproval Then
                Save_Masters = Save_HistoSampleUserApproval(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_FranchiseCostMst Then
                Save_Masters = Save_FranchiseCostMst(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_MedExWorkspaceTemplateDtl Then
                Save_Masters = Save_MedExWorkspaceTemplateDtl(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_SampleDispatch Then
                Save_Masters = Save_SampleDispatch(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_BoneMarrowParameterDtl Then
                Save_Masters = Save_BoneParameterDtl(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_EmailAlert Then
                Save_Masters = Save_EmailAlert(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MastersEntriesEnum_ExpenseTypeMaster Then
                Save_Masters = Save_ExpenseTypeMst(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)
            ElseIf Masters_1 = MasterEntriesEnum.MastersEntriesEnum_SetProjectMatrix Then
                Save_Masters = Save_SetProjectMatrix(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_ServiceMst Then
                Save_Masters = Save_ServiceMst(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)

            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_PrinterDtl Then
                Save_Masters = Save_PrinterDtl(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)
            ElseIf Masters_1 = MasterEntriesEnum.MasterEntriesEnum_NoticeMst Then
                Save_Masters = Save_NoticeMst(Choice_1, Ds_Mst, objDtLogic, UserCode_1, eStr_Retu)
            End If

            If Save_Masters Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region

#Region "Save_tempateMst"
    Public Function Save_tempateMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                    ByVal Ds_templateMst As Data.DataSet, _
                                    ByVal objDtLogic As ClsDataLogic_New, _
                                    ByVal UserCode_1 As String, _
                                    ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_templateMst As Data.DataTable = Nothing
        Dim Instr_TemplateId As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim TemplateId As String = ""
        Try
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_templateMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_templateMst.Tables("templateMst").Rows

                    Instr_TemplateId += IIf(Instr_TemplateId = "", "", ",").ToString + _
                                    tr("vTemplateId").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of templateMst
            If Not objHelpDbTbl.getTemplateMst("vTemplateId In (" + Instr_TemplateId + ")", dataRet_1, _
                                            objDtLogic, Tbl_templateMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving role Master"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vTemplateId"

            If Not objSave.AssignValues(Tbl_templateMst.TableName, PkColArr, Choice, _
                                        Ds_templateMst.Tables(Tbl_templateMst.TableName), _
                                       Tbl_templateMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in TemplateMst
            If Not objSave.SaveInDb("Insert_TemplateMst", Tbl_templateMst, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of role Master In Database"
                Exit Function
            End If

            Save_tempateMst = True
        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving TemplateMst"
            Save_tempateMst = False
        End Try

    End Function
#End Region

#Region "Save_InsertTemplateLeafNode"
    Public Function Save_InsertTemplateLeafNode(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_templateMst As DataSet, _
                                 ByVal UserCode_1 As String, _
                                 ByRef eStr_Retu As String) As Boolean
        Dim objDtLogic As New ClsDataLogic_New()

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_templateNodeDetail As Data.DataTable = Nothing
        Dim Instr_TemplateId As String = ""

        Dim PkColArr(1) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing


        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            'Logic Of save Start
            eStr_Retu = ""


            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_templateMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_templateMst.Tables("templateNodeDetail").Rows

                    Instr_TemplateId += IIf(Instr_TemplateId = "", "", ",").ToString + _
                                    tr("vTemplateId").ToString + _
                                    tr("iNodeId").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of templateMst
            If Not objHelpDbTbl.getTemplateNodeDetail("vTempateId + cast(iNodeId as varchar(4)) In (" + Instr_TemplateId + ")", dataRet_1, _
                                            objDtLogic, Tbl_templateNodeDetail, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving TemplateNodeDetail"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vTempateId"
            PkColArr(1) = "iNodeId"
            If Not objSave.AssignValues(Tbl_templateNodeDetail.TableName, PkColArr, Choice, _
                                        Ds_templateMst.Tables(Tbl_templateNodeDetail.TableName), _
                                        Tbl_templateNodeDetail, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in Online_roleMst
            If Not objSave.SaveInDb("Insert_addTemplateLeafNode", Tbl_templateNodeDetail, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of TemplateNodeDetail In Database"
                Exit Function
            End If

            'This is to retrive the output parameter

            'Save in TemplateNodeAttribute   
            DataReturnList = DataReturnList.Item(0)
            RetuVal = DataReturnList.Item(0)

            For Each dr As Data.DataRow In Tbl_templateNodeDetail.Rows
                dr("iNodeId") = RetuVal.ParameterValue
            Next dr

            If Not objSave.SaveInDb("Insert_templateNodeAttrDetail", Tbl_templateNodeDetail, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of TemplateNodeDetail In Database"
                Exit Function
            End If

            Save_InsertTemplateLeafNode = True

            'Logic of Save End

            If Save_InsertTemplateLeafNode Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

            objDtLogic.Close_Connection()
        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving TemplateNodeDetail"
            Save_InsertTemplateLeafNode = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region

#Region "Save_InsertTemplateNodeBefore"
    Public Function Save_InsertTemplateNodeBefore(ByVal Choice As DataObjOpenSaveModeEnum, _
                                ByVal Ds_templateMst As DataSet, _
                                ByVal UserCode_1 As String, _
                                ByRef eStr_Retu As String) As Boolean

        Dim objDtLogic As New ClsDataLogic_New

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_templateNodeDetail As Data.DataTable = Nothing
        Dim Instr_TemplateId As String = ""

        Dim PkColArr(1) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing
        Dim NodeId As New Integer

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            'Logic Of save Start
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_templateMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_templateMst.Tables("templateNodeDetail").Rows

                    Instr_TemplateId += IIf(Instr_TemplateId = "", "", ",").ToString + _
                                    tr("vTemplateId").ToString + _
                                    tr("iNodeId").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of templateMst
            If Not objHelpDbTbl.getTemplateNodeDetail("vTempateId + cast(iNodeId as varchar(4)) In (" + Instr_TemplateId + ")", dataRet_1, _
                                            objDtLogic, Tbl_templateNodeDetail, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving TemplateNodeDetail"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vTempateId"
            PkColArr(1) = "iNodeId"
            If Not objSave.AssignValues(Tbl_templateNodeDetail.TableName, PkColArr, Choice, _
                                        Ds_templateMst.Tables(Tbl_templateNodeDetail.TableName), _
                                        Tbl_templateNodeDetail, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in TemplateNodeDetail
            If Not objSave.SaveInDb("Insert_addTemplateNodeBefore", Tbl_templateNodeDetail, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of TemplateNodeDetail In Database"
                Exit Function
            End If

            'This is to retrive the output parameter

            'Save in TemplateNodeAttribute   

            DataReturnList = DataReturnList.Item(0)
            RetuVal = DataReturnList.Item(0)

            For Each dr As Data.DataRow In Tbl_templateNodeDetail.Rows
                dr("iNodeId") = RetuVal.ParameterValue
            Next dr

            If Not objSave.SaveInDb("Insert_templateNodeAttrDetail", Tbl_templateNodeDetail, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of TemplateNodeDetail In Database"
                Exit Function
            End If

            Save_InsertTemplateNodeBefore = True

            'Logic of Save End


            If Save_InsertTemplateNodeBefore Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving TemplateNodeDetail"
            Save_InsertTemplateNodeBefore = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region

#Region "Save_InsertTemplateNodeAfter"
    Public Function Save_InsertTemplateNodeAfter(ByVal Choice As DataObjOpenSaveModeEnum, _
                                ByVal Ds_templateMst As DataSet, _
                                ByVal UserCode_1 As String, _
                                ByRef eStr_Retu As String) As Boolean
        Dim objDtLogic As New ClsDataLogic_New

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_templateNodeDetail As Data.DataTable = Nothing
        Dim Instr_TemplateId As String = ""

        Dim PkColArr(1) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            'Logic Of save Start

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_templateMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_templateMst.Tables("templateNodeDetail").Rows

                    Instr_TemplateId += IIf(Instr_TemplateId = "", "", ",").ToString + _
                                    tr("vTemplateId").ToString + _
                                    tr("iNodeId").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of templateMst
            If Not objHelpDbTbl.getTemplateNodeDetail("vTemplateId + cast(iNodeId as varchar(4)) In (" + Instr_TemplateId + ")", dataRet_1, _
                                            objDtLogic, Tbl_templateNodeDetail, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving TemplateNodeDetail"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vTempateId"
            PkColArr(1) = "iNodeId"

            If Not objSave.AssignValues(Tbl_templateNodeDetail.TableName, PkColArr, Choice, _
                                        Ds_templateMst.Tables(Tbl_templateNodeDetail.TableName), _
                                        Tbl_templateNodeDetail, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in TemplateNodeDetail
            If Not objSave.SaveInDb("Insert_addTemplateNodeAfter", Tbl_templateNodeDetail, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of TemplateNodeDetail In Database"
                Exit Function
            End If

            'This is to retrive the output parameter

            'Save in TemplateNodeAttribute   

            DataReturnList = DataReturnList.Item(0)
            RetuVal = DataReturnList.Item(0)
            For Each dr As Data.DataRow In Tbl_templateNodeDetail.Rows
                dr("iNodeId") = RetuVal.ParameterValue
            Next dr

            If Not objSave.SaveInDb("Insert_templateNodeAttrDetail", Tbl_templateNodeDetail, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of TemplateNodeDetail In Database"
                Exit Function
            End If

            Save_InsertTemplateNodeAfter = True
            'Logic of Save End

            If Save_InsertTemplateNodeAfter Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving TemplateNodeDetail"
            Save_InsertTemplateNodeAfter = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region

#Region "Save_InsertDataForWorkspaceNodeAttrHistory"
    Public Function Save_InsertDataForWorkspaceNodeAttrHistory(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Tbl_WorkspaceNodeAttrHistroy As Data.DataTable, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing
        Dim objDtLogic As New ClsDataLogic_New

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Instr_Workspacenodeattrhistory As String = ""
        Dim Instr_WorkspaceWorkflowUserDtl As String = ""
        Dim Instr_UserMst As String = ""

        Dim vDeptCode As String = ""
        Dim vLocationCode As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Dim ObjHelpDbTable As New clsHelpDbTable
        Dim Ds_Workspacenodeattrhistory As DataSet = Nothing

        Dim Dt_NodeAttributeMaxTranNo As New DataTable
        Dim Dt_ActivityMst As New DataTable
        Dim Dt_WorkspaceWorkflowUserDtl As New DataTable
        Dim Dt_ResourceMst As New DataTable
        Dim Dt_UserMst As New DataTable

        Dim objCommon As New clsCommon

        Try


            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()


            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Tbl_WorkspaceNodeAttrHistroy Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If
            objHelpDbTbl = New clsHelpDbTable()
            serverDateTime_1 = objDtLogic.GetServerDateTime

            'If Not objHelpDbTbl.getWorkspaceNodeAttrHistory(Instr_WorkspaceWorkflowUserDtl, dataRet_1, _
            '                                objDtLogic, Dt_WorkspaceWorkflowUserDtl, eStr_Retu) Then

            '    eStr_Retu += vbCrLf + "Error occured while retrieving workspaceWorkflowUserDtl"
            '    Exit Function
            'End If

            'Assignment of Values in audittrail table

            objSave = New SaveDataInDbObj(objDtLogic)

            ' Save in Workspacenodeattrhistory
            If Not objSave.SaveInDb("Insert_Workspacenodeattrhistory", Tbl_WorkspaceNodeAttrHistroy, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of Workspacenodeattrhistory In Database"
                Exit Function
            End If

            Save_InsertDataForWorkspaceNodeAttrHistory = True

            If Save_InsertDataForWorkspaceNodeAttrHistory Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Workspacenodeattrhistory"
            Save_InsertDataForWorkspaceNodeAttrHistory = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "Save_InsertTemplateWorkflowUserDtl"
    'DefaultUserRights if 'Y' then rights of all the nodes in the template is to be given to the selected user
    'if 'N' then for a particular node
    Public Function Save_InsertTemplateWorkflowUserDtl(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Tbl_TemplateWorkFlowUserDtl As DataTable, _
                                        ByVal DefaultUserRights As String, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing
        Dim objDtLogic As New ClsDataLogic_New
        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim Instr_TemplateId As String = ""

        Dim ObjHelpDbTable As New clsHelpDbTable

        Dim Tbl_Templatenodedetail As New Data.DataTable
        Dim Tbl_TemplateWorkFlowUserDtlAll As New Data.DataTable
        Dim objCommon As New clsCommon
        Dim dr_1 As DataRow

        Dim OuterIndex As Integer
        Dim InnerIndex As Integer
        Try


            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()


            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Tbl_TemplateWorkFlowUserDtl Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Tbl_TemplateWorkFlowUserDtl.Rows

                    Instr_TemplateId += IIf(Instr_TemplateId = "", "", ",").ToString + _
                                    tr("vTemplateId").ToString + _
                                    tr("iNodeId").ToString

                Next tr
            End If


            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If
            objHelpDbTbl = New clsHelpDbTable()
            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)


            If Not objHelpDbTbl.getTemplateWorkflowUserDtl("vTemplateId + cast(iNodeId as varchar(4)) In (" + Instr_TemplateId + ")", dataRet_1, _
                                           objDtLogic, Tbl_TemplateWorkFlowUserDtlAll, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving TemplateWorkflowUserDtl"
                Exit Function
            End If


            If DefaultUserRights.ToString.ToUpper = "YES" Then
                If Not objHelpDbTbl.getTemplateNodeDetail("vTemplateId = " + Tbl_TemplateWorkFlowUserDtl.Rows(0).Item("vTemplateId"), _
                                                         DataRetrievalModeEnum.DataTable_WithWhereCondition, _
                                                           objDtLogic, Tbl_Templatenodedetail, eStr_Retu) Then

                    eStr_Retu += vbCrLf + "Error occured while retrieving TemplateWorkflowUserDtl"
                    Exit Function
                End If

                For OuterIndex = 0 To Tbl_Templatenodedetail.Rows.Count - 1
                    For InnerIndex = 0 To Tbl_TemplateWorkFlowUserDtl.Rows.Count - 1
                        dr_1 = Tbl_TemplateWorkFlowUserDtlAll.NewRow

                        dr_1("vTemplateId") = Tbl_Templatenodedetail.Rows(OuterIndex).Item("vTemplateId")
                        dr_1("iNodeId") = Tbl_Templatenodedetail.Rows(OuterIndex).Item("iNodeId")
                        dr_1("iUserId") = Tbl_TemplateWorkFlowUserDtl.Rows(InnerIndex).Item("iUserId")
                        dr_1("iStageId") = Tbl_TemplateWorkFlowUserDtl.Rows(InnerIndex).Item("iStageId")

                        dr_1("cCanEdit") = "Y"
                        dr_1("cCanRead") = "Y"
                        dr_1("cCanDelete") = "Y"
                        dr_1("iModifyBy") = Tbl_TemplateWorkFlowUserDtl.Rows(InnerIndex).Item("iModifyBy")

                        Tbl_TemplateWorkFlowUserDtlAll.Rows.Add(dr_1)
                    Next InnerIndex
                Next OuterIndex

                If Not objSave.SaveInDb("Insert_TemplateWorkflowUserDtl", Tbl_TemplateWorkFlowUserDtlAll, Choice, Nothing, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of TemplateWorkflowUserDtl In Database"
                    Exit Function
                End If

            Else
                If Not objSave.SaveInDb("Insert_TemplateWorkflowUserDtl", Tbl_TemplateWorkFlowUserDtl, Choice, Nothing, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of TemplateWorkflowUserDtl In Database"
                    Exit Function
                End If
            End If

            Save_InsertTemplateWorkflowUserDtl = True

            If Save_InsertTemplateWorkflowUserDtl Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving TemplateWorkflowUserDtl"
            Save_InsertTemplateWorkflowUserDtl = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "Save_InsertWorkspaceNodeHistory"
    Public Function Save_InsertWorkspaceNodeHistory(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Tbl_WorkspaceNodeHistory As DataTable, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing
        Dim objDtLogic As New ClsDataLogic_New


        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList


        Dim ObjHelpDbTable As New clsHelpDbTable

        Dim Tbl_Templatenodedetail As New Data.DataTable
        Dim Tbl_TemplateWorkFlowUserDtlAll As New Data.DataTable
        Dim objCommon As New clsCommon
        Try


            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()


            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Tbl_WorkspaceNodeHistory Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()
            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            If Not objSave.SaveInDb("Insert_WorkspaceNodeHistory", Tbl_WorkspaceNodeHistory, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of WorkspaceNodeHistory In Database"
                Exit Function
            End If

            Save_InsertWorkspaceNodeHistory = True

            If Save_InsertWorkspaceNodeHistory Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving WorkspaceNodeHistory"
            Save_InsertWorkspaceNodeHistory = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "Save_InsertWorkspaceComments"
    Public Function Save_InsertWorkspaceComments(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_WorkspaceComment As DataSet, _
                                 ByVal UserCode_1 As String, _
                                 ByRef eStr_Retu As String) As Boolean
        Dim objDtLogic As New ClsDataLogic_New()

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_WorkspaceCommentMst As Data.DataTable = Nothing
        Dim Tbl_WorkspaceCommentDtl As Data.DataTable = Nothing
        Dim Instr_TemplateId As String = ""

        Dim PkColArr(0) As String
        Dim PkColArr1(0) As String
        Dim DataReturnList As New ArrayList

        Dim RetuVal As ParameterReturnValue = Nothing


        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            'Logic Of save Start
            eStr_Retu = ""


            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_WorkspaceComment Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            Tbl_WorkspaceCommentMst = Ds_WorkspaceComment.Tables("WorkspaceCommentMst")
            Tbl_WorkspaceCommentDtl = Ds_WorkspaceComment.Tables("WorkspaceCommentDetail")
            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_WorkspaceComment.Tables("View_WorkSpaceSubjectComment").Rows

                    Instr_TemplateId += IIf(Instr_TemplateId = "", "", ",").ToString + _
                                    tr("vCommentId").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of templateMst
            If Not objHelpDbTbl.GetWorkspaceCommentMst("vCommentId in (" & Instr_TemplateId & ")", dataRet_1, _
                                            objDtLogic, Tbl_WorkspaceCommentMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving WorkspaceCommentMst"
                Exit Function
            End If

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vCommentId"

            If Not objSave.AssignValues(Tbl_WorkspaceCommentMst.TableName, PkColArr, Choice, _
                                        Ds_WorkspaceComment.Tables(Tbl_WorkspaceCommentMst.TableName), _
                                        Tbl_WorkspaceCommentMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in Online_roleMst
            If Not objSave.SaveInDb("Insert_WorkspaceCommentMst", Tbl_WorkspaceCommentMst, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of WorkspaceCommentMst In Database"
                Exit Function
            End If

            'This is to retrive the output parameter

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                DataReturnList = DataReturnList.Item(0)
                RetuVal = DataReturnList.Item(0)

                For Each dr As Data.DataRow In Tbl_WorkspaceCommentDtl.Rows
                    dr("vCommentId") = RetuVal.ParameterValue
                Next
            End If

            If Not objSave.SaveInDb("Insert_WorkspaceCommentDetail", Tbl_WorkspaceCommentDtl, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of WorkspaceCommentDtl In Database"
                Exit Function
            End If

            Save_InsertWorkspaceComments = True

            'Logic of Save End

            If Save_InsertWorkspaceComments Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

            'objDtLogic.Commit_Transaction()
            objDtLogic.Close_Connection()
        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving WorkspaceCommentMstDtl"
            Save_InsertWorkspaceComments = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region

#Region "Save_MedExScreeningDtl"
    Public Function Save_MedExScreeningDtl(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_MedExScreeningDtl As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef TranNo_Retu As String, _
                                        ByRef Is_Transaction As Boolean, _
                                        ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing

        Dim serverDateTime_1 As DateTime
        Dim Tbl_MedExScreeningHdr As Data.DataTable = Nothing
        Dim Tbl_MedExScreeningDtl As Data.DataTable = Nothing
        Dim Tbl_Top_MedExScreeningDtl As Data.DataTable = Nothing
        Dim Instr_ScreenId As String = ""

        'Dim Tbl_MedExScreeningHdrHistory As Data.DataTable = Nothing

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Dim DataReturnList_Mst As New ArrayList
        Dim RetuVal_Mst As ParameterReturnValue = Nothing

        Dim i As Integer

        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_MedExScreeningDtl Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_MedExScreeningDtl.Tables("MedExScreeningHdr").Rows

                    Instr_ScreenId += IIf(Instr_ScreenId = "", "", ",").ToString + _
                                      tr("nMedExScreeningHdrNo").ToString()

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of MedExScreeningDtl
            If Not objHelpDbTbl.GetMedExScreeningHdr("nMedExScreeningHdrNo In (" + Instr_ScreenId + ")", dataRet_1, _
                                            objDtLogic, Tbl_MedExScreeningHdr, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving MedExScreeningHDr"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nMedExScreeningHdrNo"

            If Not objSave.AssignValues(Tbl_MedExScreeningHdr.TableName, PkColArr, Choice, _
                                        Ds_MedExScreeningDtl.Tables(Tbl_MedExScreeningHdr.TableName), _
                                        Tbl_MedExScreeningHdr, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in MedExScreeningDtl

            'First we are saving only first Row and after that will save other rows 
            'for getting Return value (iscreenId) for Bulk Save with same iScreenId

            If Not objSave.SaveInDb("Insert_MedExScreeningHdr", Tbl_MedExScreeningHdr, Choice, DataReturnList_Mst, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of MedExScreeningHdr In Database"
                Exit Function
            End If

            'Assiging New iMedExScreenId to MedExScreeningDtl table
            If Not IsNothing(Ds_MedExScreeningDtl.Tables("MedExScreeningDtl")) Then
                DataReturnList_Mst = DataReturnList_Mst.Item(0)
                RetuVal_Mst = DataReturnList_Mst.Item(0)
                If RetuVal_Mst.ParameterValue < 0 Then
                    eStr_Retu = "Screening of selected subject for current date is already saved by other user."
                    objDtLogic.RollBack_Transaction()
                    Exit Function
                End If
                Tbl_MedExScreeningDtl = New DataTable
                Tbl_MedExScreeningDtl = Ds_MedExScreeningDtl.Tables("MedExScreeningDtl")
                For Each dr As Data.DataRow In Tbl_MedExScreeningDtl.Rows
                    dr("nMedExScreeningHdrNo") = RetuVal_Mst.ParameterValue
                    dr.AcceptChanges()
                Next
                Tbl_MedExScreeningDtl.AcceptChanges()
                'To Add Only first row into the table and get itranNo as return value
                Tbl_Top_MedExScreeningDtl = Tbl_MedExScreeningDtl.Copy
                For i = Tbl_Top_MedExScreeningDtl.Rows.Count - 1 To 1 Step -1
                    Tbl_Top_MedExScreeningDtl.Rows(i).Delete()
                    Tbl_Top_MedExScreeningDtl.AcceptChanges()
                Next

                If Not objSave.SaveInDb("Insert_MedExScreeningDtl", Tbl_Top_MedExScreeningDtl, Choice, DataReturnList, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of MedExScreeningDtl In Database"
                    Exit Function
                End If

                Tbl_MedExScreeningDtl.Rows(0).Delete()
                Tbl_MedExScreeningDtl.AcceptChanges()
                '*************************************

                'Assiging New iTranno for Other than first rows
                DataReturnList = DataReturnList.Item(0)
                RetuVal = DataReturnList.Item(0)

                For Each dr As Data.DataRow In Tbl_MedExScreeningDtl.Rows
                    dr("iTranno") = RetuVal.ParameterValue
                    dr.AcceptChanges()
                Next
                Tbl_MedExScreeningDtl.AcceptChanges()
                'Now saveing Remaining Rows with same iTranno
                If Not objSave.SaveInDb("Insert_MedExScreeningDtl", Tbl_MedExScreeningDtl, Choice, Nothing, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of MedExScreeningDtl In Database"
                    Exit Function
                End If
            End If
            '**********************************************            

            'Becasue to Save Document by MedexScreeningHdrno also
            'on 11-Aug-2009
            TranNo_Retu = RetuVal_Mst.ParameterValue + "/" + RetuVal.ParameterValue
            '********************

            'Added by Chandresh Vanker on 16-Sep-2009 For saving Remarks in MedExScreeningHdrHistory table
            'If Not IsNothing(Ds_MedExScreeningDtl.Tables("MedExScreeningHdrHistory")) Then
            '    Tbl_MedExScreeningHdrHistory = New DataTable
            '    Tbl_MedExScreeningHdrHistory = Ds_MedExScreeningDtl.Tables("MedExScreeningHdrHistory")
            '    For Each dr As Data.DataRow In Tbl_MedExScreeningHdrHistory.Rows
            '        dr("nMedExScreeningHdrNo") = RetuVal_Mst.ParameterValue
            '        dr("iTranno") = RetuVal.ParameterValue
            '        dr.AcceptChanges()
            '    Next
            '    Tbl_MedExScreeningHdrHistory.AcceptChanges()

            '    DataReturnList = Nothing
            '    DataReturnList = New ArrayList

            '    If Not objSave.SaveInDb("Insert_MedExScreeningHdrHistory", Tbl_MedExScreeningHdrHistory, Choice, DataReturnList, eStr_Retu) Then
            '        eStr_Retu += vbCrLf + "Error occured while Save Information of MedExScreeningHdrHistory In Database"
            '        Exit Function
            '    End If

            '    DataReturnList = DataReturnList.Item(0)
            '    RetuVal = DataReturnList.Item(0)
            '    If Convert.ToInt32(RetuVal.ParameterValue) = 1 Then
            '        Is_Transaction = True
            '    End If

            'End If
            '**************************

            Save_MedExScreeningDtl = True

            If Save_MedExScreeningDtl Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving MedExScreeningDtl"
            Save_MedExScreeningDtl = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

#Region " ProductAttrDtl "
    Public Function Save_InsertProductAttrDtl(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_DrugRegionPKMatrix As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime
        Dim dr As DataRow

        Dim Tbl_ProductAttrDtl As Data.DataTable = Nothing
        Dim Instr_ProductDrug As String = ""
        Dim Ds_MaxTran As New DataSet

        Dim PkColArr(3) As String
        Dim DataReturnList As New ArrayList

        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_DrugRegionPKMatrix Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_DrugRegionPKMatrix.Tables("ProductAttrDtl").Rows

                    Instr_ProductDrug += IIf(Instr_ProductDrug = "", "", ",").ToString + _
                                    tr("vProductId").ToString + tr("vDrugCode").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of ProductAttrDtl
            If Not objHelpDbTbl.GetProductAttrDtl("vProductId + vDrugCode In (" + Instr_ProductDrug + ")", dataRet_1, _
                                            objDtLogic, Tbl_ProductAttrDtl, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving ProductAttrDtl"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vProductId"
            PkColArr(1) = "vDrugCode"
            PkColArr(2) = "vAttrId"
            PkColArr(3) = "iTranNo"

            If Not objSave.AssignValues(Tbl_ProductAttrDtl.TableName, PkColArr, Choice, _
                                        Ds_DrugRegionPKMatrix.Tables(Tbl_ProductAttrDtl.TableName), _
                                        Tbl_ProductAttrDtl, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            'For Max ITranId
            If Not objHelpDbTbl.GetFieldsOfTable("ProductAttrDtl", "vProductId,vDrugCode,isNull(Max(iTranNo),0) + 1 as MaxTranNo", "vProductId='" & _
                    Tbl_ProductAttrDtl.Rows(0).Item("vProductId") & "' And vDrugCode='" & Tbl_ProductAttrDtl.Rows(0).Item("vDrugCode") & "' Group By vProductId,vDrugCode", Ds_MaxTran, eStr_Retu) Then
            End If

            For Each dr In Tbl_ProductAttrDtl.Rows
                dr.Item("iTranNo") = Ds_MaxTran.Tables(0).Rows(0)("MaxTranNo")
                dr.AcceptChanges()
            Next
            Tbl_ProductAttrDtl.AcceptChanges()
            '********************

            ' Save in ProductAttrDtl
            If Not objSave.SaveInDb("Insert_ProductAttrDtl", Tbl_ProductAttrDtl, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of ProductAttrDtl In Database"
                Exit Function
            End If

            Save_InsertProductAttrDtl = True

            If Save_InsertProductAttrDtl Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

            objDtLogic.Close_Connection()
        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving ProductAttrDtl"
            Save_InsertProductAttrDtl = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

    '*******************************************************
    'Added By Naimesh Dave
    '*******************************************************

#Region "OperationMst"
    Public Function Save_OperationMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_OperationMst As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_OperationMst As Data.DataTable = Nothing
        Dim Instr_OperationCode As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_OperationMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_OperationMst.Tables("OperationMst").Rows

                    Instr_OperationCode += IIf(Instr_OperationCode = "", "", ",").ToString + _
                                    tr("vOperationCode").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of OperationMst
            If Not objHelpDbTbl.getOperationMst("vOperationCode In (" + Instr_OperationCode + ")", dataRet_1, _
                                            objDtLogic, Tbl_OperationMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving Operation Master"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vOperationCode"

            If Not objSave.AssignValues(Tbl_OperationMst.TableName, PkColArr, Choice, _
                                        Ds_OperationMst.Tables(Tbl_OperationMst.TableName), _
                                        Tbl_OperationMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in Operation Master
            If Not objSave.SaveInDb("Insert_OperationMst", Tbl_OperationMst, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of Operation Master In Database"
                Exit Function
            End If

            Save_OperationMst = True

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Operation Master"
            Save_OperationMst = False
        End Try

    End Function
#End Region

#Region "UserTypeMst"
    Public Function Save_UserTypeMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_UserTypeMst As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_UserTypeMst As Data.DataTable = Nothing
        Dim Instr_UserTypeCode As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_UserTypeMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_UserTypeMst.Tables("UserTypeMst").Rows

                    Instr_UserTypeCode += IIf(Instr_UserTypeCode = "", "", ",").ToString + _
                                    tr("vUserTypeCode").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of UserTypeMst
            If Not objHelpDbTbl.getUserTypeMst("vUserTypeCode In (" + Instr_UserTypeCode + ")", dataRet_1, _
                                            objDtLogic, Tbl_UserTypeMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving UserType Master"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vUserTypeCode"

            If Not objSave.AssignValues(Tbl_UserTypeMst.TableName, PkColArr, Choice, _
                                        Ds_UserTypeMst.Tables(Tbl_UserTypeMst.TableName), _
                                        Tbl_UserTypeMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in UserType Master
            If Not objSave.SaveInDb("Insert_UserTypeMst", Tbl_UserTypeMst, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of UserType Master In Database"
                Exit Function
            End If

            Save_UserTypeMst = True

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving UserType Master"
            Save_UserTypeMst = False
        End Try

    End Function
#End Region

#Region "roleOperationMatrix"
    Public Function Save_roleOperationMatrix(ByVal Choice As DataObjOpenSaveModeEnum, _
                                      ByVal Ds_roleOperationMatrix As Data.DataSet, _
                                      ByVal objDtLogic As ClsDataLogic_New, _
                                      ByVal UserCode_1 As String, _
                                      ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_roleOperationMatrix As Data.DataTable = Nothing
        Dim Instr_UserTypeCode As String = ""

        Dim PkColArr(1) As String
        Dim DataReturnList As New ArrayList

        Try
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_roleOperationMatrix Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_roleOperationMatrix.Tables("roleOperationMatrix").Rows

                    Instr_UserTypeCode += IIf(Instr_UserTypeCode = "", "", ",").ToString + _
                                    tr("vUserTypeCode").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of roleOperationMatrix
            If Not objHelpDbTbl.getroleOperationMatrix("vUserTypeCode In (" + Instr_UserTypeCode + ")", dataRet_1, _
                                            objDtLogic, Tbl_roleOperationMatrix, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving roleOperationMatrix"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nRoleOperationNo"

            Ds_roleOperationMatrix.Tables(0).DefaultView.RowFilter = "nRoleOperationNo>0"
            Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit


            If Not objSave.SaveInDb("Insert_roleoperationmatrix", Ds_roleOperationMatrix.Tables(Tbl_roleOperationMatrix.TableName).DefaultView.ToTable(), Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of roleOperationMatrix In Database"
                Exit Function
            End If

            Tbl_roleOperationMatrix.Clear()

            Ds_roleOperationMatrix.Tables(0).DefaultView.RowFilter = "nRoleOperationNo<0"
            Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add


            If Not objSave.SaveInDb("Insert_roleoperationmatrix", Ds_roleOperationMatrix.Tables(Tbl_roleOperationMatrix.TableName).DefaultView.ToTable(), Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of roleOperationMatrix In Database"
                Exit Function
            End If

            ' added by prayag for History table
            If (Not IsNothing(Ds_roleOperationMatrix.Tables(1)) AndAlso Ds_roleOperationMatrix.Tables(1).Rows.Count > 0) Then

                Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add
                If Not objSave.SaveInDb("Insert_roleoperationmatrixHistory", Ds_roleOperationMatrix.Tables(1).DefaultView.ToTable(), Choice, Nothing, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of roleOperationMatrixHistory In Database"
                    Exit Function
                End If

            End If

            Save_roleOperationMatrix = True

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving roleOperationMatrix"
            Save_roleOperationMatrix = False
        End Try

    End Function
#End Region

#Region "WorkSpaceMst"
    Public Function Save_WorkSpaceMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                ByVal Ds_WorkSpaceMst As Data.DataSet, _
                                ByVal UserCode_1 As String, _
                                ByRef RequestId As String, _
                                ByRef eStr_Retu As String) As Boolean


        Dim objDtLogic As New ClsDataLogic_New
        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_WorkSpaceMst As Data.DataTable = Nothing
        Dim Tbl_workspaceProtocolDetailMatrix As Data.DataTable = Nothing
        Dim Tbl_workspaceprotocoldetail As Data.DataTable = Nothing
        Dim Tbl_workspacesubjectmst As Data.DataTable = Nothing
        Dim Tbl_WorkSpaceStatusDtl As Data.DataTable = Nothing
        Dim Instr_WorkSpaceId As String = ""
        Dim vWorkspaceId As String = ""
        Dim WorkspaceId_Edit As String = ""
        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_WorkSpaceMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            If Not IsNothing(Ds_WorkSpaceMst.Tables("workspacemst")) Then
                Tbl_WorkSpaceMst = Ds_WorkSpaceMst.Tables("workspacemst")
            End If

            If Not IsNothing(Ds_WorkSpaceMst.Tables("workspaceprotocoldetail")) Then
                Tbl_workspaceprotocoldetail = Ds_WorkSpaceMst.Tables("workspaceprotocoldetail")
            End If

            If Not IsNothing(Ds_WorkSpaceMst.Tables("workspaceProtocolDetailMatrix")) Then
                Tbl_workspaceProtocolDetailMatrix = Ds_WorkSpaceMst.Tables("workspaceProtocolDetailMatrix")
            End If

            If Not IsNothing(Ds_WorkSpaceMst.Tables("workspacesubjectmst")) Then
                Tbl_workspacesubjectmst = Ds_WorkSpaceMst.Tables("workspacesubjectmst")
            End If

            If Not IsNothing(Ds_WorkSpaceMst.Tables("WorkSpaceStatusDtl")) Then
                Tbl_WorkSpaceStatusDtl = Ds_WorkSpaceMst.Tables("WorkSpaceStatusDtl")
            End If

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_WorkSpaceMst.Tables("workspacemst").Rows

                    Instr_WorkSpaceId += IIf(Instr_WorkSpaceId = "", "", ",").ToString + _
                                    tr("vWorkSpaceId").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of workspacemst
            If Not objHelpDbTbl.getworkspacemst("vWorkSpaceId In (" + Instr_WorkSpaceId + ")", dataRet_1, _
                                            objDtLogic, Tbl_WorkSpaceMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving workspacemst"
                Exit Function
            End If

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vWorkSpaceId"

            If Not objSave.AssignValues(Tbl_WorkSpaceMst.TableName, PkColArr, Choice, _
                                        Ds_WorkSpaceMst.Tables(Tbl_WorkSpaceMst.TableName), _
                                        Tbl_WorkSpaceMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in Workspace Master
            If Not objSave.SaveInDb("Insert_Workspace", Tbl_WorkSpaceMst, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of workspacemst In Database"
                Exit Function
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                DataReturnList = DataReturnList.Item(0)
                RetuVal = DataReturnList.Item(0)
                If Not CType(DataReturnList.Item(1), ParameterReturnValue) Is Nothing Then
                    If CType(DataReturnList.Item(1), ParameterReturnValue).ParameterName.ToUpper = "@VREQUESTID" Then
                        RequestId = CType(DataReturnList.Item(1), ParameterReturnValue).ParameterValue
                    Else
                        Throw New Exception("Parameter: RequestId not Found")
                    End If
                End If

                If RetuVal.ParameterName.ToUpper <> "@NEWWORKSPACEID" Then
                    Throw New Exception("Parameter: NewWorkspaceId not Found")
                End If

                If Not IsNothing(Ds_WorkSpaceMst.Tables("workspaceprotocoldetail")) Then
                    For Each dr As Data.DataRow In Tbl_workspaceprotocoldetail.Rows
                        dr("vWorkspaceId") = RetuVal.ParameterValue
                    Next
                End If

                If Not IsNothing(Ds_WorkSpaceMst.Tables("workspacesubjectmst")) Then
                    For Each dr As Data.DataRow In Tbl_workspacesubjectmst.Rows
                        dr("vWorkspaceId") = RetuVal.ParameterValue
                    Next
                End If

                If Not IsNothing(Ds_WorkSpaceMst.Tables("workspaceProtocolDetailMatrix")) Then
                    For Each dr As Data.DataRow In Tbl_workspaceProtocolDetailMatrix.Rows
                        dr("vWorkspaceId") = RetuVal.ParameterValue
                    Next
                End If

            Else

                WorkspaceId_Edit = Tbl_WorkSpaceMst.Rows(0).Item("vWorkspaceId")

                If Not IsNothing(Ds_WorkSpaceMst.Tables("workspaceprotocoldetail")) Then
                    For Each dr As Data.DataRow In Tbl_workspaceprotocoldetail.Rows
                        dr("vWorkspaceId") = WorkspaceId_Edit.Trim()
                    Next
                End If


                If Not IsNothing(Ds_WorkSpaceMst.Tables("workspacesubjectmst")) Then
                    For Each dr As Data.DataRow In Tbl_workspacesubjectmst.Rows
                        dr("vWorkspaceId") = WorkspaceId_Edit.Trim()
                    Next
                End If

                If Not IsNothing(Ds_WorkSpaceMst.Tables("workspaceProtocolDetailMatrix")) Then
                    For Each dr As Data.DataRow In Tbl_workspaceProtocolDetailMatrix.Rows
                        dr("vWorkspaceId") = WorkspaceId_Edit.Trim()
                    Next
                End If

                If Not IsNothing(Ds_WorkSpaceMst.Tables("WorkSpaceStatusDtl")) Then
                    For Each dr As Data.DataRow In Tbl_WorkSpaceStatusDtl.Rows
                        dr("vWorkspaceId") = WorkspaceId_Edit.Trim()
                    Next
                End If

            End If


            'For workspaceprotocoldetail
            If Not IsNothing(Ds_WorkSpaceMst.Tables("workspaceprotocoldetail")) Then
                If Not objSave.SaveInDb("Insert_ProtocolDetails", Tbl_workspaceprotocoldetail, Choice, Nothing, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of workspaceprotocoldetail In Database"
                    Exit Function
                End If

            End If

            'For workspaceProtocolDetailMatrix
            If Not IsNothing(Ds_WorkSpaceMst.Tables("workspaceProtocolDetailMatrix")) Then
                If Not objSave.SaveInDb("Insert_ProtocolDetailMatrix", Tbl_workspaceProtocolDetailMatrix, Choice, Nothing, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of workspaceProtocolDetailMatrix In Database"
                    Exit Function
                End If

            End If


            'As per talk with Nikur Sir for DMS
            'For WorkspaceSubjectMst 
            If Not IsNothing(Ds_WorkSpaceMst.Tables("workspacesubjectmst")) Then
                If Not objSave.SaveInDb("Insert_WorkspaceSubjectMst", Tbl_workspacesubjectmst, Choice, Nothing, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of workspacesubjectmst In Database"
                    Exit Function
                End If
            End If

            'For WorkspaceStatusDtl
            If Not IsNothing(Ds_WorkSpaceMst.Tables("WorkspaceStatusDtl")) Then
                If Not objSave.SaveInDb("Insert_WorkspaceStatusDtl", Tbl_WorkSpaceStatusDtl, Choice, Nothing, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of WorkspaceStatusDtl In Database"
                    Exit Function
                End If
            End If

            Save_WorkSpaceMst = True

            If Save_WorkSpaceMst Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

            objDtLogic.Close_Connection()

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving workspacemst"
            Save_WorkSpaceMst = False
            objDtLogic.RollBack_Transaction()
            objDtLogic.Close_Connection()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "DrugMst"
    Public Function Save_DrugMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                       ByVal Ds_DrugMst As Data.DataSet, _
                                       ByVal objDtLogic As ClsDataLogic_New, _
                                       ByVal UserCode_1 As String, _
                                       ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_DrugMst As Data.DataTable = Nothing
        Dim Instr_DrugCode As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_DrugMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_DrugMst.Tables("DrugMst").Rows

                    Instr_DrugCode += IIf(Instr_DrugCode = "", "", ",").ToString + _
                                    tr("vDrugCode").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of DrugMst
            If Not objHelpDbTbl.getdrugmst("vDrugCode In (" + Instr_DrugCode + ")", dataRet_1, _
                                            objDtLogic, Tbl_DrugMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving Drug Master"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vDrugCode"

            If Not objSave.AssignValues(Tbl_DrugMst.TableName, PkColArr, Choice, _
                                        Ds_DrugMst.Tables(Tbl_DrugMst.TableName), _
                                        Tbl_DrugMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in Drug Master
            If Not objSave.SaveInDb("Insert_DrugMst", Tbl_DrugMst, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of Drug Master In Database"
                Exit Function
            End If
            Save_DrugMst = True

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Drug Master"
            Save_DrugMst = False
        End Try

    End Function
#End Region

#Region "Regionmst"
    Public Function Save_Regionmst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                      ByVal Ds_Regionmst As Data.DataSet, _
                                      ByVal objDtLogic As ClsDataLogic_New, _
                                      ByVal UserCode_1 As String, _
                                      ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_Regionmst As Data.DataTable = Nothing
        Dim Instr_RegionCode As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_Regionmst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_Regionmst.Tables("RegionMst").Rows

                    Instr_RegionCode += IIf(Instr_RegionCode = "", "", ",").ToString + _
                                    tr("vRegionCode").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of regionmst
            If Not objHelpDbTbl.getregionmst("vRegionCode In (" + Instr_RegionCode + ")", dataRet_1, _
                                            objDtLogic, Tbl_Regionmst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving regionmst"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vRegionCode"

            If Not objSave.AssignValues(Tbl_Regionmst.TableName, PkColArr, Choice, _
                                        Ds_Regionmst.Tables(Tbl_Regionmst.TableName), _
                                        Tbl_Regionmst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in regionmst
            If Not objSave.SaveInDb("Insert_RegionMst", Tbl_Regionmst, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of Region Master In Database"
                Exit Function
            End If
            Save_Regionmst = True

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Region Master"
            Save_Regionmst = False
        End Try

    End Function
#End Region

#Region "UserMst"
    Public Function Save_UserMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                   ByVal Ds_UserMst As Data.DataSet, _
                                   ByVal objDtLogic As ClsDataLogic_New, _
                                   ByVal UserCode_1 As String, _
                                   ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_UserMst As Data.DataTable = Nothing
        Dim Instr_UserCode As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_UserMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_UserMst.Tables("UserMst").Rows

                    Instr_UserCode += IIf(Instr_UserCode = "", "", ",").ToString + _
                                    tr("iUserId").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of UserMst
            If Not objHelpDbTbl.getuserMst("iUserId In (" + Instr_UserCode + ")", dataRet_1, _
                                            objDtLogic, Tbl_UserMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving User Master"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "iUserId"

            If Not objSave.AssignValues(Tbl_UserMst.TableName, PkColArr, Choice, _
                                        Ds_UserMst.Tables(Tbl_UserMst.TableName), _
                                        Tbl_UserMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in User Master
            If Not objSave.SaveInDb("Insert_UserMst", Tbl_UserMst, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of User Master In Database"
                Exit Function
            End If

            Save_UserMst = True

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving User Master"
            Save_UserMst = False
        End Try

    End Function
#End Region

#Region "UserGroupMst"
    Public Function Save_UserGroupMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                         ByVal Ds_UserGroupMst As Data.DataSet, _
                                         ByVal objDtLogic As ClsDataLogic_New, _
                                         ByVal UserCode_1 As String, _
                                         ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_UserGroupMst As Data.DataTable = Nothing
        Dim Instr_UserGroupCode As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_UserGroupMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_UserGroupMst.Tables("UserGroupMst").Rows

                    Instr_UserGroupCode += IIf(Instr_UserGroupCode = "", "", ",").ToString + _
                                    tr("iUserGroupCode").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of UserGroupMst
            If Not objHelpDbTbl.getuserGroupMst("iUserGroupCode In (" + Instr_UserGroupCode + ")", dataRet_1, _
                                            objDtLogic, Tbl_UserGroupMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving UserGroup Master"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "iUserGroupCode"

            If Not objSave.AssignValues(Tbl_UserGroupMst.TableName, PkColArr, Choice, _
                                        Ds_UserGroupMst.Tables(Tbl_UserGroupMst.TableName), _
                                        Tbl_UserGroupMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in User Master
            If Not objSave.SaveInDb("Insert_UserGroupMst", Tbl_UserGroupMst, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of UserGroup Master In Database"
                Exit Function
            End If

            Save_UserGroupMst = True

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving UserGroup Master"
            Save_UserGroupMst = False
        End Try

    End Function
#End Region

#Region "Resourcemst"
    Public Function Save_Resourcemst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_Resourcemst As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_Resourcemst As Data.DataTable = Nothing
        Dim Instr_ResourceCode As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_Resourcemst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_Resourcemst.Tables("Resourcemst").Rows

                    Instr_ResourceCode += IIf(Instr_ResourceCode = "", "", ",").ToString + _
                                    tr("vResourceCode").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of ResourceMst
            If Not objHelpDbTbl.getresourcemst("vResourceCode In (" + Instr_ResourceCode + ")", dataRet_1, _
                                            objDtLogic, Tbl_Resourcemst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving Resource Master"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vResourceCode"

            If Not objSave.AssignValues(Tbl_Resourcemst.TableName, PkColArr, Choice, _
                                        Ds_Resourcemst.Tables(Tbl_Resourcemst.TableName), _
                                        Tbl_Resourcemst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in Resource Master
            If Not objSave.SaveInDb("Insert_resourcemst", Tbl_Resourcemst, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of Resource Master In Database"
                Exit Function
            End If

            Save_Resourcemst = True

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Resource Master"
            Save_Resourcemst = False
        End Try

    End Function
#End Region

#Region "ProjectTypeMst"
    Public Function Save_ProjectTypeMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_ProjectTypeMst As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef ProjectTypeCode As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_ProjectTypeMst As Data.DataTable = Nothing
        Dim Instr_ProjectTypeCode As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try

            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_ProjectTypeMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_ProjectTypeMst.Tables("ProjectTypeMst").Rows

                    Instr_ProjectTypeCode += IIf(Instr_ProjectTypeCode = "", "", ",").ToString + _
                                    tr("vProjectTypeCode").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of ProjectTypeMst
            If Not objHelpDbTbl.getprojectTypeMst("vProjectTypeCode In (" + Instr_ProjectTypeCode + ")", dataRet_1, _
                                            objDtLogic, Tbl_ProjectTypeMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving ProjectType Master"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vProjectTypeCode"

            Tbl_ProjectTypeMst.Columns.Add("vProjectSubTypeName")
            Tbl_ProjectTypeMst.Columns.Add("vProjectSubTypeCode")
            Tbl_ProjectTypeMst.Columns.Add("vProjectTypeSuffix")

            If Not objSave.AssignValues(Tbl_ProjectTypeMst.TableName, PkColArr, Choice, _
                                        Ds_ProjectTypeMst.Tables(Tbl_ProjectTypeMst.TableName), _
                                        Tbl_ProjectTypeMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in ProjectType Master
            If Not objSave.SaveInDb("Insert_projectTypeMst", Tbl_ProjectTypeMst, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of ProjectType Master In Database"
                Exit Function
            End If

            DataReturnList = DataReturnList.Item(0)
            RetuVal = DataReturnList.Item(0)
            ProjectTypeCode = RetuVal.ParameterValue.ToString()


            Save_ProjectTypeMst = True

            If Save_ProjectTypeMst Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

            'objDtLogic.Commit_Transaction()
            objDtLogic.Close_Connection()

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving ProjectType Master"
            Save_ProjectTypeMst = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try

    End Function
#End Region

#Region "ClientMst"
    Public Function Save_ClientMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_ClientMst As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_ClientMst As Data.DataTable = Nothing
        Dim Tbl_ClientContactMatrix As Data.DataTable = Nothing

        Dim Instr_ClientCode As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim ReturnValueList As New ParameterReturnValue

        Try
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_ClientMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_ClientMst.Tables("ClientMst").Rows

                    Instr_ClientCode += IIf(Instr_ClientCode = "", "", ",").ToString + _
                                    tr("vClientCode").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of ClientMst
            If Not objHelpDbTbl.getclientmst("vClientCode In (" + Instr_ClientCode + ")", dataRet_1, _
                                            objDtLogic, Tbl_ClientMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving Client Master"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vClientCode"

            If Not objSave.AssignValues(Tbl_ClientMst.TableName, PkColArr, Choice, _
                                        Ds_ClientMst.Tables(Tbl_ClientMst.TableName), _
                                        Tbl_ClientMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in Client Master
            If Not objSave.SaveInDb("Insert_clientmst", Tbl_ClientMst, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of Client Master In Database"
                Exit Function
            End If

            Save_ClientMst = True

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Client Master"
            Save_ClientMst = False
        End Try

    End Function
#End Region

#Region "ClientContactMatrix"
    Public Function Save_InsertClientContactMatrix(ByVal Choice As DataObjOpenSaveModeEnum, _
                                      ByVal Ds_ClientContactMatrix As Data.DataSet, _
                                      ByVal objDtLogic As ClsDataLogic_New, _
                                      ByVal UserCode_1 As String, _
                                      ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_ClientContactMatrix As Data.DataTable = Nothing
        Dim Instr_ClientContactCode As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_ClientContactMatrix Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_ClientContactMatrix.Tables("ClientContactMatrix").Rows

                    Instr_ClientContactCode += IIf(Instr_ClientContactCode = "", "", ",").ToString + _
                                    tr("vClientContactCode").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of ClientContactMatrix
            If Not objHelpDbTbl.getClientContactMatrix("vClientContactCode In (" + Instr_ClientContactCode + ")", dataRet_1, _
                                            objDtLogic, Tbl_ClientContactMatrix, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving ClientContactMatrix"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vClientContactCode"

            If Not objSave.AssignValues(Tbl_ClientContactMatrix.TableName, PkColArr, Choice, _
                                        Ds_ClientContactMatrix.Tables(Tbl_ClientContactMatrix.TableName), _
                                        Tbl_ClientContactMatrix, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in ClientContactMatrix
            If Not objSave.SaveInDb("Insert_ClientContactMatrix", Tbl_ClientContactMatrix, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of ClientContactMatrix In Database"
                Exit Function
            End If

            Save_InsertClientContactMatrix = True

            If Save_InsertClientContactMatrix Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

            objDtLogic.Close_Connection()
        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving ClientContactMatrix"
            Save_InsertClientContactMatrix = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "workspaceSubjectDocDetail"
    Public Function Save_workspaceSubjectDocDetail(ByVal Choice As DataObjOpenSaveModeEnum, _
                                                          ByVal Ds_workspaceSubjectDocDetail As DataSet, _
                                                          ByVal objDtLogic As ClsDataLogic_New, _
                                                          ByVal UserCode_1 As String, _
                                                          ByRef TranNo_Retu As String, _
                                                          ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_workspaceSubjectDocDetails As Data.DataTable = Nothing
        Dim Instr_WorkSpaceSubjectDocDetailId As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_workspaceSubjectDocDetail Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_workspaceSubjectDocDetail.Tables("workspaceSubjectDocDetails").Rows

                    Instr_WorkSpaceSubjectDocDetailId += IIf(Instr_WorkSpaceSubjectDocDetailId = "", "", ",").ToString + _
                                    tr("vWorkSpaceSubjectDocDetailId").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of workspaceSubjectDocDetails
            If Not objHelpDbTbl.getWorkspaceSubjectDocDetails("vWorkSpaceSubjectDocDetailId In (" + Instr_WorkSpaceSubjectDocDetailId + ")", dataRet_1, _
                                            objDtLogic, Tbl_workspaceSubjectDocDetails, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving workspaceSubjectDocDetails"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vWorkSpaceSubjectDocDetailId"

            If Not objSave.AssignValues(Tbl_workspaceSubjectDocDetails.TableName, PkColArr, Choice, _
                                        Ds_workspaceSubjectDocDetail.Tables(Tbl_workspaceSubjectDocDetails.TableName), _
                                        Tbl_workspaceSubjectDocDetails, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in workspaceSubjectDocDetails
            If Not objSave.SaveInDb("Insert_workspaceSubjectDocDetails", Tbl_workspaceSubjectDocDetails, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of workspaceSubjectDocDetails In Database"
                Exit Function
            End If

            DataReturnList = DataReturnList.Item(0)
            RetuVal = DataReturnList.Item(0)

            TranNo_Retu = RetuVal.ParameterValue

            Save_workspaceSubjectDocDetail = True

            If Save_workspaceSubjectDocDetail Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

            objDtLogic.Close_Connection()
        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving workspaceSubjectDocDetails"
            Save_workspaceSubjectDocDetail = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "StageMst"
    Public Function Save_StageMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_StageMst As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_StageMst As Data.DataTable = Nothing
        Dim Instr_StageId As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_StageMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_StageMst.Tables("StageMst").Rows

                    Instr_StageId += IIf(Instr_StageId = "", "", ",").ToString + _
                                    tr("iStageId").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of StageMst
            If Not objHelpDbTbl.GetStageMst("iStageId In (" + Instr_StageId + ")", dataRet_1, _
                                            objDtLogic, Tbl_StageMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving Stage Master"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "iStageId"

            If Not objSave.AssignValues(Tbl_StageMst.TableName, PkColArr, Choice, _
                                        Ds_StageMst.Tables(Tbl_StageMst.TableName), _
                                        Tbl_StageMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in Stage Master
            If Not objSave.SaveInDb("Insert_StageMst", Tbl_StageMst, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of Stage Master In Database"
                Exit Function
            End If

            Save_StageMst = True

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Stage Master"
            Save_StageMst = False
        End Try

    End Function
#End Region

#Region "DoctypeMst"
    Public Function Save_DoctypeMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_DoctypeMst As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_DoctypeMst As Data.DataTable = Nothing
        Dim Instr_DocTypeCode As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_DoctypeMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_DoctypeMst.Tables("view_doctemplateMatrix").Rows

                    Instr_DocTypeCode += IIf(Instr_DocTypeCode = "", "", ",").ToString + _
                                    tr("vDocTypeCode").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of DoctypeMst
            If Not objHelpDbTbl.GetDoctypeMst("vDocTypeCode In (" + Instr_DocTypeCode + ")", dataRet_1, _
                                            objDtLogic, Tbl_DoctypeMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving DoctypeMst"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vDocTypeCode"

            If Not objSave.AssignValues(Tbl_DoctypeMst.TableName, PkColArr, Choice, _
                                        Ds_DoctypeMst.Tables(Tbl_DoctypeMst.TableName), _
                                        Tbl_DoctypeMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in Doctype Master
            If Not objSave.SaveInDb("Insert_DoctypeMst", Tbl_DoctypeMst, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of Doctype Master In Database"
                Exit Function
            End If

            Save_DoctypeMst = True

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Doctype Master"
            Save_DoctypeMst = False
        End Try

    End Function
#End Region

#Region "LocationMst"
    Public Function Save_LocationMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_LocationMst As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_LocationMst As Data.DataTable = Nothing
        Dim Instr_LocationCode As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_LocationMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_LocationMst.Tables("LocationMst").Rows

                    Instr_LocationCode += IIf(Instr_LocationCode = "", "", ",").ToString + _
                                    tr("vLocationCode").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of LocationMst
            If Not objHelpDbTbl.getLocationMst("vLocationCode In (" + Instr_LocationCode + ")", dataRet_1, _
                                            objDtLogic, Tbl_LocationMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving LocationMst"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vLocationCode"

            If Not objSave.AssignValues(Tbl_LocationMst.TableName, PkColArr, Choice, _
                                        Ds_LocationMst.Tables(Tbl_LocationMst.TableName), _
                                        Tbl_LocationMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in Location Master
            If Not objSave.SaveInDb("Insert_LocationMst", Tbl_LocationMst, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of Location Master In Database"
                Exit Function
            End If

            Save_LocationMst = True

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Location Master"
            Save_LocationMst = False
        End Try

    End Function
#End Region

#Region "Inactive_TemplateNodeDetail"
    Public Function Inactive_TemplateNodeDetail(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_TemplateNodeDetail As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean

        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As New Data.DataTable

        Dim Tbl_TemplateNodeDetail As Data.DataTable = Nothing
        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_TemplateNodeDetail Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If
            Tbl_TemplateNodeDetail = Ds_TemplateNodeDetail.Tables(0)
            objSave = New SaveDataInDbObj(objDtLogic)

            ' Save in Inactive_TemplateNodeDetail
            If Not objSave.SaveInDb("Inactive_TemplateNodeDetail", Tbl_TemplateNodeDetail, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Inactive node in TemplateNodeDetail In Database"
                Exit Function
            End If

            Inactive_TemplateNodeDetail = True

            If Inactive_TemplateNodeDetail Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

            objDtLogic.Close_Connection()
        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving TemplateNodeDetail"
            Inactive_TemplateNodeDetail = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "DeptStageMatrix"
    Public Function Save_DeptStageMatrix(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_DeptStageMatrix As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_DeptStageMatrix As Data.DataTable = Nothing
        Dim Instr_DeptStageCode As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_DeptStageMatrix Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_DeptStageMatrix.Tables("DeptStageMatrix").Rows

                    Instr_DeptStageCode += IIf(Instr_DeptStageCode = "", "", ",").ToString + _
                                    tr("vDeptStageCode").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of DeptStageMatrix
            If Not objHelpDbTbl.GetDeptStageMatrix("vDeptStageCode In (" + Instr_DeptStageCode + ")", dataRet_1, _
                                            objDtLogic, Tbl_DeptStageMatrix, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving DeptStageMatrix"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vDeptStageCode"

            If Not objSave.AssignValues(Tbl_DeptStageMatrix.TableName, PkColArr, Choice, _
                                        Ds_DeptStageMatrix.Tables(Tbl_DeptStageMatrix.TableName), _
                                        Tbl_DeptStageMatrix, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in DeptStageMatrix
            If Not objSave.SaveInDb("Insert_deptStageMatrix", Tbl_DeptStageMatrix, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of DeptStageMatrix In Database"
                Exit Function
            End If

            Save_DeptStageMatrix = True

            If Save_DeptStageMatrix Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

            'objDtLogic.Close_Connection()
        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving DeptStageMatrix"
            Save_DeptStageMatrix = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "Save_InsertWorkSpaceWorkflowUserDtl"
    'DefaultUserRights if 'Y' then rights of all the nodes in the WorkSpace is to be given to the selected user
    'if 'N' then for a particular node
    Public Function Save_InsertWorkSpaceWorkflowUserDtl(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Tbl_WorkSpaceWorkFlowUserDtl As DataTable, _
                                        ByVal DefaultUserRights As String, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing
        Dim objDtLogic As New ClsDataLogic_New

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing
        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim Instr_Nodeid As String = ""
        Dim Instr_Workspace As String = ""

        Dim ObjHelpDbTable As New clsHelpDbTable

        Dim Tbl_WorkSpacenodedetail As New Data.DataTable
        Dim Tbl_WorkSpaceWorkFlowUserDtlAll As New Data.DataTable
        Dim objCommon As New clsCommon
        Dim dr_1 As DataRow

        Dim OuterIndex As Integer
        Dim InnerIndex As Integer
        Try

            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()


            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Tbl_WorkSpaceWorkFlowUserDtl Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then

                Instr_Workspace = Tbl_WorkSpaceWorkFlowUserDtl.Rows(0)("vWorkspaceId")
                For Each tr As Data.DataRow In Tbl_WorkSpaceWorkFlowUserDtl.Rows


                    Instr_Nodeid += IIf(Instr_Nodeid = "", "", ",").ToString + _
                                      tr("iNodeId").ToString()

                Next tr
            End If


            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If
            objHelpDbTbl = New clsHelpDbTable()
            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)


            If Not objHelpDbTbl.getworkspaceWorkflowUserDtl("vWorkSpaceId = '" + Instr_Workspace + "' and iNodeId in (" + Instr_Nodeid + ")", dataRet_1, _
                                           objDtLogic, Tbl_WorkSpaceWorkFlowUserDtlAll, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving WorkSpaceWorkflowUserDtl"
                Exit Function
            End If


            If DefaultUserRights.ToString.ToUpper = "YES" Then
                If Not objHelpDbTbl.getWorkSpaceNodeDetail("vWorkSpaceId = " + Tbl_WorkSpaceWorkFlowUserDtl.Rows(0).Item("vWorkSpaceId"), _
                                                         DataRetrievalModeEnum.DataTable_WithWhereCondition, _
                                                           objDtLogic, Tbl_WorkSpacenodedetail, eStr_Retu) Then

                    eStr_Retu += vbCrLf + "Error occured while retrieving WorkSpaceWorkflowUserDtl"
                    Exit Function
                End If

                For OuterIndex = 0 To Tbl_WorkSpacenodedetail.Rows.Count - 1
                    For InnerIndex = 0 To Tbl_WorkSpaceWorkFlowUserDtl.Rows.Count - 1
                        dr_1 = Tbl_WorkSpaceWorkFlowUserDtlAll.NewRow

                        dr_1("vWorkSpaceId") = Tbl_WorkSpacenodedetail.Rows(OuterIndex).Item("vWorkSpaceId")
                        dr_1("iNodeId") = Tbl_WorkSpacenodedetail.Rows(OuterIndex).Item("iNodeId")
                        dr_1("iUserId") = Tbl_WorkSpaceWorkFlowUserDtl.Rows(InnerIndex).Item("iUserId")
                        dr_1("iStageId") = 0

                        dr_1("cCanEdit") = "Y"
                        dr_1("cCanRead") = "Y"
                        dr_1("cCanDelete") = "Y"
                        dr_1("iModifyBy") = Tbl_WorkSpaceWorkFlowUserDtl.Rows(InnerIndex).Item("iModifyBy")

                        Tbl_WorkSpaceWorkFlowUserDtlAll.Rows.Add(dr_1)
                    Next InnerIndex

                Next OuterIndex

                If Not objSave.SaveInDb("Insert_WorkSpaceWorkflowUserDtl", Tbl_WorkSpaceWorkFlowUserDtlAll, Choice, Nothing, eStr_Retu, True) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of WorkSpaceWorkflowUserDtl In Database"
                    Exit Function
                End If
            Else
                If Not objSave.SaveInDb("Insert_WorkSpaceWorkflowUserDtl", Tbl_WorkSpaceWorkFlowUserDtl, Choice, Nothing, eStr_Retu, True) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of WorkSpaceWorkflowUserDtl In Database"
                    Exit Function
                End If
            End If

            Save_InsertWorkSpaceWorkflowUserDtl = True

            If Save_InsertWorkSpaceWorkflowUserDtl Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving WorkSpaceWorkflowUserDtl"
            Save_InsertWorkSpaceWorkflowUserDtl = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "Save_InsertTemplateNodeDetail"
    Public Function Save_InsertTemplateNodeDetail(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_TemplateNodeDetail As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_TemplateNodeDetail As Data.DataTable = Nothing
        Dim Instr_TempCode As String = ""

        Dim PkColArr(1) As String
        Dim DataReturnList As New ArrayList

        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_TemplateNodeDetail Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_TemplateNodeDetail.Tables("TemplateNodeDetail").Rows

                    Instr_TempCode += IIf(Instr_TempCode = "", "", ",").ToString + _
                                    tr("vTemplateId").ToString + tr("iNodeId").ToString.Trim()

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of TemplateNodeDetail
            If Not objHelpDbTbl.getTemplateNodeDetail("vTemplateId + CAST(iNodeId as VARCHAR(4)) In (" + Instr_TempCode + ")", dataRet_1, _
                                            objDtLogic, Tbl_TemplateNodeDetail, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving TemplateNodeDetail"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of ValuesvWorkSpaceId + cast(iNodeId as varchar(4)) + cast(iTranNo as varchar(4))
            PkColArr(0) = "vTemplateId"
            PkColArr(1) = "iNodeId"

            If Not objSave.AssignValues(Tbl_TemplateNodeDetail.TableName, PkColArr, Choice, _
                                        Ds_TemplateNodeDetail.Tables(Tbl_TemplateNodeDetail.TableName), _
                                        Tbl_TemplateNodeDetail, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in TemplateNodeDetail
            If Not objSave.SaveInDb("Insert_TemplateNodeDetail", Tbl_TemplateNodeDetail, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of TemplateNodeDetail In Database"
                Exit Function
            End If

            Save_InsertTemplateNodeDetail = True

            If Save_InsertTemplateNodeDetail Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

            'objDtLogic.Close_Connection()
        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving TemplateNodeDetail"
            Save_InsertTemplateNodeDetail = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "Save_Insertcheckedoutfiledetail"
    Public Function Save_Insertcheckedoutfiledetail(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_checkedoutfiledetail As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_checkedoutfiledetail As Data.DataTable = Nothing
        Dim Instr_checkedoutfiledetailCode As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_checkedoutfiledetail Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_checkedoutfiledetail.Tables("checkedoutfiledetail").Rows

                    Instr_checkedoutfiledetailCode += IIf(Instr_checkedoutfiledetailCode = "", "", ",").ToString + _
                                    tr("vWorkSpaceId").ToString + tr("iNodeId").ToString.Trim() + tr("iTranNo").ToString.Trim()

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of checkedoutfiledetail
            If Not objHelpDbTbl.GetCheckedoutfiledetail("vWorkSpaceId + cast(iNodeId as varchar(4)) + cast(iTranNo as varchar(4)) In (" + Instr_checkedoutfiledetailCode + ")", dataRet_1, _
                                            objDtLogic, Tbl_checkedoutfiledetail, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving checkedoutfiledetail"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vWorkSpaceId + cast(iNodeId as varchar(4)) + cast(iTranNo as varchar(4))"

            If Not objSave.AssignValues(Tbl_checkedoutfiledetail.TableName, PkColArr, Choice, _
                                        Ds_checkedoutfiledetail.Tables(Tbl_checkedoutfiledetail.TableName), _
                                        Tbl_checkedoutfiledetail, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in checkedoutfiledetail
            If Not objSave.SaveInDb("Insert_checkedoutfiledetail", Tbl_checkedoutfiledetail, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of checkedoutfiledetail In Database"
                Exit Function
            End If

            Save_Insertcheckedoutfiledetail = True

            If Save_Insertcheckedoutfiledetail Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

            'objDtLogic.Close_Connection()
        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving checkedoutfiledetail"
            Save_Insertcheckedoutfiledetail = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "ActivityOperationMatrix"
    Public Function Save_InsertActivityOperationMatrix(ByVal Choice As DataObjOpenSaveModeEnum, _
                                      ByVal Ds_ActivityOperationMatrix As Data.DataSet, _
                                      ByVal objDtLogic As ClsDataLogic_New, _
                                      ByVal UserCode_1 As String, _
                                      ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_ActivityOperationMatrix As Data.DataTable = Nothing
        Dim Instr_ActivityRoleId As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_ActivityOperationMatrix Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_ActivityOperationMatrix.Tables("ActivityOperationMatrix").Rows

                    Instr_ActivityRoleId += IIf(Instr_ActivityRoleId = "", "", ",").ToString + _
                                    tr("vActivityRoleId").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of ActivityOperationMatrix
            If Not objHelpDbTbl.GetActivityOperationMatrix("vActivityRoleId In (" + Instr_ActivityRoleId + ")", dataRet_1, _
                                            objDtLogic, Tbl_ActivityOperationMatrix, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving ActivityOperationMatrix"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vActivityRoleId"

            If Not objSave.AssignValues(Tbl_ActivityOperationMatrix.TableName, PkColArr, Choice, _
                                        Ds_ActivityOperationMatrix.Tables(Tbl_ActivityOperationMatrix.TableName), _
                                        Tbl_ActivityOperationMatrix, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in ActivityOperationMatrix
            If Not objSave.SaveInDb("Insert_ActivityOperationMatrix", Tbl_ActivityOperationMatrix, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of ActivityOperationMatrix In Database"
                Exit Function
            End If

            Save_InsertActivityOperationMatrix = True

            If Save_InsertActivityOperationMatrix Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

            'objDtLogic.Close_Connection()
        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving ActivityOperationMatrix"
            Save_InsertActivityOperationMatrix = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "ProtocolCriterienMst"
    Public Function Save_InsertProtocolCriterienMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                       ByVal Ds_ProtocolCriterienMst As Data.DataSet, _
                                       ByVal objDtLogic As ClsDataLogic_New, _
                                       ByVal UserCode_1 As String, _
                                       ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_ProtocolCriterienMst As Data.DataTable = Nothing
        Dim Instr_ProtocolCriterienId As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_ProtocolCriterienMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_ProtocolCriterienMst.Tables("ProtocolCriterienMst").Rows

                    Instr_ProtocolCriterienId += IIf(Instr_ProtocolCriterienId = "", "", ",").ToString + _
                                    tr("vProtocolCriterienId").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of ProtocolCriterienMst
            If Not objHelpDbTbl.getProtocolCriterienMst("vProtocolCriterienId In (" + Instr_ProtocolCriterienId + ")", dataRet_1, _
                                            objDtLogic, Tbl_ProtocolCriterienMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving ProtocolCriterien Master"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vProtocolCriterienId"

            If Not objSave.AssignValues(Tbl_ProtocolCriterienMst.TableName, PkColArr, Choice, _
                                        Ds_ProtocolCriterienMst.Tables(Tbl_ProtocolCriterienMst.TableName), _
                                        Tbl_ProtocolCriterienMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in ProtocolCriterien Master
            If Not objSave.SaveInDb("Insert_ProtocolCriterienMst", Tbl_ProtocolCriterienMst, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of ProtocolCriterien Master In Database"
                Exit Function
            End If
            Save_InsertProtocolCriterienMst = True

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving ProtocolCriterien Master"
            Save_InsertProtocolCriterienMst = False
        End Try

    End Function
#End Region

#Region "ProtocolWorkspaceCriterienDtls"
    Public Function Save_InsertProtocolWorkspaceCriterienDtls(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_ProtocolWorkspaceCriterienDtls As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_ProtocolWorkspaceCriterienDtls As Data.DataTable = Nothing
        Dim Instr_ProtocolworkspaceCriterienId As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_ProtocolWorkspaceCriterienDtls Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_ProtocolWorkspaceCriterienDtls.Tables("ProtocolWorkspaceCriterienDtls").Rows

                    Instr_ProtocolworkspaceCriterienId += IIf(Instr_ProtocolworkspaceCriterienId = "", "", ",").ToString + _
                                    tr("vProtocolworkspaceCriterienId").ToString + _
                                    tr("vWorkSpaceID").ToString + _
                                    tr("iTranNo").ToString.Trim()

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of ProtocolWorkspaceCriterienDtls
            If Not objHelpDbTbl.getProtocolWorkspaceCriterienDtls("vProtocolworkspaceCriterienId + vWorkSpaceID + cast(iTranNo as varchar(3)) In (" + Instr_ProtocolworkspaceCriterienId + ")", dataRet_1, _
                                            objDtLogic, Tbl_ProtocolWorkspaceCriterienDtls, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving ProtocolWorkspaceCriterienDtls"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vProtocolworkspaceCriterienId + vWorkSpaceID + cast(iTranNo as varchar(3))"

            If Not objSave.AssignValues(Tbl_ProtocolWorkspaceCriterienDtls.TableName, PkColArr, Choice, _
                                        Ds_ProtocolWorkspaceCriterienDtls.Tables(Tbl_ProtocolWorkspaceCriterienDtls.TableName), _
                                        Tbl_ProtocolWorkspaceCriterienDtls, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in ProtocolWorkspaceCriterienDtls
            If Not objSave.SaveInDb("Insert_ProtocolWorkspaceCriterienDtls", Tbl_ProtocolWorkspaceCriterienDtls, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of ProtocolWorkspaceCriterienDtls In Database"
                Exit Function
            End If

            Save_InsertProtocolWorkspaceCriterienDtls = True

            If Save_InsertProtocolWorkspaceCriterienDtls Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

            'objDtLogic.Close_Connection()
        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving ProtocolWorkspaceCriterienDtls"
            Save_InsertProtocolWorkspaceCriterienDtls = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "ProtocolWorkSpaceDetails"
    Public Function Save_InsertProtocolWorkSpaceDetails(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_ProtocolWorkSpaceDetails As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_ProtocolWorkSpaceDetails As Data.DataTable = Nothing
        Dim Instr_ProtocolworkspaceCriterienId As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_ProtocolWorkSpaceDetails Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_ProtocolWorkSpaceDetails.Tables("ProtocolWorkSpaceDetails").Rows

                    Instr_ProtocolworkspaceCriterienId += IIf(Instr_ProtocolworkspaceCriterienId = "", "", ",").ToString + _
                                    tr("vWorkSpaceID").ToString + _
                                    tr("iTranNo").ToString.Trim()

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of ProtocolWorkSpaceDetails
            If Not objHelpDbTbl.getProtocolWorkSpaceDetails("vWorkSpaceID + cast(iTranNo as varchar(3)) In (" + Instr_ProtocolworkspaceCriterienId + ")", dataRet_1, _
                                            objDtLogic, Tbl_ProtocolWorkSpaceDetails, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving ProtocolWorkSpaceDetails"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vWorkSpaceID + cast(iTranNo as varchar(3))"

            If Not objSave.AssignValues(Tbl_ProtocolWorkSpaceDetails.TableName, PkColArr, Choice, _
                                        Ds_ProtocolWorkSpaceDetails.Tables(Tbl_ProtocolWorkSpaceDetails.TableName), _
                                        Tbl_ProtocolWorkSpaceDetails, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in ProtocolWorkSpaceDetails
            If Not objSave.SaveInDb("Insert_ProtocolWorkSpaceDetails", Tbl_ProtocolWorkSpaceDetails, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of ProtocolWorkSpaceDetails In Database"
                Exit Function
            End If

            Save_InsertProtocolWorkSpaceDetails = True

            If Save_InsertProtocolWorkSpaceDetails Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

            'objDtLogic.Close_Connection()
        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving ProtocolWorkSpaceDetails"
            Save_InsertProtocolWorkSpaceDetails = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "DrugRegionMatrix"
    Public Function Save_DrugRegionMatrix(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_DrugRegionMatrix As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_DrugRegionMatrix As Data.DataTable = Nothing
        Dim Instr_DrugRegionCode As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_DrugRegionMatrix Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_DrugRegionMatrix.Tables("DrugRegionMatrix").Rows

                    Instr_DrugRegionCode += IIf(Instr_DrugRegionCode = "", "", ",").ToString + _
                                    tr("vDrugRegionCode").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of DrugRegionMatrix
            If Not objHelpDbTbl.GetDrugRegionMatrix("vDrugRegionCode In (" + Instr_DrugRegionCode + ")", dataRet_1, _
                                            objDtLogic, Tbl_DrugRegionMatrix, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving DrugRegionMatrix"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vDrugRegionCode"

            If Not objSave.AssignValues(Tbl_DrugRegionMatrix.TableName, PkColArr, Choice, _
                                        Ds_DrugRegionMatrix.Tables(Tbl_DrugRegionMatrix.TableName), _
                                        Tbl_DrugRegionMatrix, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in DrugRegionMatrix
            If Not objSave.SaveInDb("Insert_DrugRegionMatrix", Tbl_DrugRegionMatrix, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of DrugRegionMatrix In Database"
                Exit Function
            End If

            Save_DrugRegionMatrix = True

            If Save_DrugRegionMatrix Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving DrugRegionMatrix"
            Save_DrugRegionMatrix = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "DrugRegionPKMatrix"
    Public Function Save_DrugRegionPKMatrix(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_DrugRegionPKMatrix As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_DrugRegionPKMatrix As Data.DataTable = Nothing
        Dim Instr_DrugRegionPKCode As String = ""

        Dim PkColArr(2) As String
        Dim DataReturnList As New ArrayList

        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_DrugRegionPKMatrix Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_DrugRegionPKMatrix.Tables("DrugRegionPKMatrix").Rows

                    Instr_DrugRegionPKCode += IIf(Instr_DrugRegionPKCode = "", "", ",").ToString + _
                                    tr("vDrugAnalytesCode").ToString + tr("vDrugRegionCode").ToString + _
                                     tr("iMetNo").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of DrugRegionPKMatrix
            If Not objHelpDbTbl.GetDrugRegionPKMatrix("vDrugAnalytesCode + vDrugRegionCode + CAST(iMetNo as varchar) In (" + Instr_DrugRegionPKCode + ")", dataRet_1, _
                                            objDtLogic, Tbl_DrugRegionPKMatrix, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving DrugRegionPKMatrix"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vDrugAnalytesCode"
            PkColArr(1) = "vDrugRegionCode"
            PkColArr(2) = "iMetNo"

            If Not objSave.AssignValues(Tbl_DrugRegionPKMatrix.TableName, PkColArr, Choice, _
                                        Ds_DrugRegionPKMatrix.Tables(Tbl_DrugRegionPKMatrix.TableName), _
                                        Tbl_DrugRegionPKMatrix, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in DrugRegionPKMatrix
            If Not objSave.SaveInDb("Insert_DrugRegionPKMatrix", Tbl_DrugRegionPKMatrix, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of DrugRegionPKMatrix In Database"
                Exit Function
            End If

            Save_DrugRegionPKMatrix = True

            If Save_DrugRegionPKMatrix Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving DrugRegionPKMatrix"
            Save_DrugRegionPKMatrix = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "DocTemplateMst"
    Public Function Save_InsertDocTemplateMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_DocTemplateMst As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_DocTemplateMst As Data.DataTable = Nothing
        Dim Instr_DocTemplateId As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_DocTemplateMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_DocTemplateMst.Tables("DocTemplateMst").Rows

                    Instr_DocTemplateId += IIf(Instr_DocTemplateId = "", "", ",").ToString + _
                                    tr("vDocTemplateId").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of DocTemplateMst
            If Not objHelpDbTbl.getDoctemplatemst("vDocTemplateId In (" + Instr_DocTemplateId + ")", dataRet_1, _
                                            objDtLogic, Tbl_DocTemplateMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving DocTemplate Master"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vDocTemplateId"

            If Not objSave.AssignValues(Tbl_DocTemplateMst.TableName, PkColArr, Choice, _
                                        Ds_DocTemplateMst.Tables(Tbl_DocTemplateMst.TableName), _
                                        Tbl_DocTemplateMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in DocTemplate Master
            If Not objSave.SaveInDb("Insert_DocTemplateMst", Tbl_DocTemplateMst, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of DocTemplate Master In Database"
                Exit Function
            End If

            Save_InsertDocTemplateMst = True

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving DocTemplate Master"
            Save_InsertDocTemplateMst = False
        End Try

    End Function
#End Region

#Region "Copy Template"
    Public Function Proc_Copy_Template(ByVal Ds_TemplateMst As DataSet, _
                                  ByVal objDtLogic As ClsDataLogic_New, _
                                  ByRef eStr_Retu As String) As Boolean
        Dim objSave As SaveDataInDbObj = Nothing
        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()
            objSave = New SaveDataInDbObj(objDtLogic)

            If Not objSave.SaveInDb("Proc_Copy_Template", Ds_TemplateMst.Tables(0), DataObjOpenSaveModeEnum.DataObjOpenMode_Add, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Copy Information of Template In Database"
                Exit Function
            End If

            Proc_Copy_Template = True

            If Proc_Copy_Template Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while Copying Template"
            objDtLogic.RollBack_Transaction()
            Proc_Copy_Template = False
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function

#End Region

#Region "Save_MedExInfoHdrDtl"
    Public Function Save_MedExInfoHdrDtl(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_MedExScreeningDtl As Data.DataSet, _
                                        ByVal SaveDefaultValue As Boolean, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef TranNo_Retu As String, _
                                        ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime
        Dim Tbl_MedExInfoDtl As Data.DataTable = Nothing
        Dim Tbl_Top_MedExInfoDtl As Data.DataTable = Nothing
        Dim Tbl_MedExInfoHdr As Data.DataTable = Nothing

        Dim Instr_MedexInfoDtlNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Dim DataReturnList_Mst As New ArrayList
        Dim RetuVal_Mst As ParameterReturnValue = Nothing
        Dim dr As DataRow
        Dim i As Integer

        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_MedExScreeningDtl Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If
            Tbl_MedExInfoDtl = Ds_MedExScreeningDtl.Tables("MedExInfoDtl")
            Tbl_MedExInfoHdr = Ds_MedExScreeningDtl.Tables("MedExInfoHdr")


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)


            If SaveDefaultValue = True Then

                ' Save in MedExInfoHdr
                If Not objSave.SaveInDb("Insert_MedExInfoHdr", Tbl_MedExInfoHdr, Choice, DataReturnList, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of MedExInfoHdr In Database"
                    Exit Function
                End If
                'Assiging New HdrNo 
                DataReturnList = DataReturnList.Item(0)
                RetuVal = DataReturnList.Item(0)

                For Each dr In Tbl_MedExInfoDtl.Rows
                    dr("nMedexInfoHdrNo") = RetuVal.ParameterValue
                    dr.AcceptChanges()
                Next
                Tbl_MedExInfoDtl.AcceptChanges()
                '********************************************

                ' Save in MedExInfoDtl

                If Not objSave.SaveInDb("Insert_MedExInfoDtl", Tbl_MedExInfoDtl, Choice, DataReturnList, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of MedExInfoDtl In Database"
                    Exit Function
                End If
                '*************************************

            Else

                'Function called only if edit is called
                If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                    For Each tr As Data.DataRow In Ds_MedExScreeningDtl.Tables("MedExInfoHdr").Rows

                        Instr_MedexInfoDtlNo += IIf(Instr_MedexInfoDtlNo = "", "", ",").ToString + _
                                          tr("nMedExInfoHdrNo").ToString.Trim()

                    Next tr
                End If

                If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                    dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
                Else
                    dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
                End If

                'Retrieval of MedexInfoDtl
                If Not objHelpDbTbl.GetMedExInfoHdr("nMedExInfoHdrNo In (" + Instr_MedexInfoDtlNo + ")", dataRet_1, _
                                                objDtLogic, Tbl_MedExInfoHdr, eStr_Retu) Then

                    eStr_Retu += vbCrLf + "Error occured while retrieving MedExInfoDtl"
                    Exit Function
                End If


                'Retrieval of Online_AuditInfo
                If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                                  Tbl_Audit, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                    Exit Function
                End If

                'Assignment of Values
                PkColArr(0) = "nMedExInfoHdrNo"
                Tbl_Audit = New DataTable()

                If Not objSave.AssignValues(Tbl_MedExInfoHdr.TableName, PkColArr, Choice, _
                                            Ds_MedExScreeningDtl.Tables(Tbl_MedExInfoHdr.TableName), _
                                            Tbl_MedExInfoHdr, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while assigning values"
                    Exit Function
                End If

                ' Save in MedExInfoHdr

                If Not objSave.SaveInDb("Insert_MedExInfoHdr", Tbl_MedExInfoHdr, Choice, DataReturnList, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of MedExInfoHdr In Database"
                    Exit Function
                End If
                'Assiging New HdrNo 
                DataReturnList = DataReturnList.Item(0)
                RetuVal = DataReturnList.Item(0)

                For Each dr In Tbl_MedExInfoDtl.Rows
                    dr("nMedexInfoHdrNo") = RetuVal.ParameterValue
                    dr.AcceptChanges()
                Next
                Tbl_MedExInfoDtl.AcceptChanges()
                '********************************************


                ' Save in MedExInfoDtl
                If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                    'First we are saving only first Row and after that will save other rows 
                    'for getting Return value (iscreenId) for Bulk Save with same iScreenId

                    'To Add Only first row into the table and get itranNo as return value
                    Tbl_Top_MedExInfoDtl = Tbl_MedExInfoDtl.Copy
                    For i = Tbl_Top_MedExInfoDtl.Rows.Count - 1 To 1 Step -1
                        Tbl_Top_MedExInfoDtl.Rows(i).Delete()
                        Tbl_Top_MedExInfoDtl.AcceptChanges()
                    Next
                    'Here first record go as tran No 0 because as per the condition in Procedure for getting new tran No.
                    For Each dr In Tbl_Top_MedExInfoDtl.Rows
                        dr("iTranno") = 0
                        dr.AcceptChanges()
                    Next
                    Tbl_Top_MedExInfoDtl.AcceptChanges()


                    If Not objSave.SaveInDb("Insert_MedExInfoDtl", Tbl_Top_MedExInfoDtl, Choice, DataReturnList, eStr_Retu) Then
                        eStr_Retu += vbCrLf + "Error occured while Save Information of MedExInfoDtl In Database"
                        Exit Function
                    End If
                    '*************************************

                    Tbl_MedExInfoDtl.Rows(0).Delete()
                    Tbl_MedExInfoDtl.AcceptChanges()

                    'Assiging New iTranno for Other than first rows
                    DataReturnList = DataReturnList.Item(0)
                    RetuVal = DataReturnList.Item(0)
                    For Each dr In Tbl_MedExInfoDtl.Rows
                        dr("iTranno") = RetuVal.ParameterValue
                        dr.AcceptChanges()
                    Next

                    Tbl_MedExInfoDtl.AcceptChanges()

                End If

                'Now saving Remaining Rows with same iTranno
                If Not objSave.SaveInDb("Insert_MedExInfoDtl", Tbl_MedExInfoDtl, Choice, Nothing, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of MedExInfoDtl In Database"
                    Exit Function
                End If
                '********************************************
                TranNo_Retu = RetuVal.ParameterValue
            End If

            Save_MedExInfoHdrDtl = True

            If Save_MedExInfoHdrDtl Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving MedExScreeningDtl"
            Save_MedExInfoHdrDtl = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "Save_MedExInfoHdr"
    Public Function Save_MedExInfoHdr(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_SubjectMedExHdr As Data.DataSet, _
                                        ByVal objHdrogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime
        Dim Tbl_MedExInfoHdr As Data.DataTable = Nothing
        Dim Tbl_Top_MedExInfoHdr As Data.DataTable = Nothing

        Dim Instr_CaseRecordHdrId As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Dim DataReturnList_Mst As New ArrayList
        Dim RetuVal_Mst As ParameterReturnValue = Nothing


        Try
            eStr_Retu = ""
            objHdrogic.Open_Connection()
            objHdrogic.Begin_Transaction()

            If objHdrogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objHdrogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_SubjectMedExHdr Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If
            Tbl_MedExInfoHdr = Ds_SubjectMedExHdr.Tables("MedExInfoHdr")

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_SubjectMedExHdr.Tables("MedExInfoHdr").Rows

                    Instr_CaseRecordHdrId += IIf(Instr_CaseRecordHdrId = "", "", ",").ToString + _
                                      tr("nCaseRecordHdrId").ToString.Trim()

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objHdrogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objHdrogic)

            'Retrieval of MedExInfoHdr
            If Not objHelpDbTbl.GetMedExInfoHdr("nCaseRecordHdrId In (" + Instr_CaseRecordHdrId + ")", dataRet_1, _
                                            objHdrogic, Tbl_MedExInfoHdr, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving MedExInfoHdr"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objHdrogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nCaseRecordHdrId"

            If Not objSave.AssignValues(Tbl_MedExInfoHdr.TableName, PkColArr, Choice, _
                                        Ds_SubjectMedExHdr.Tables(Tbl_MedExInfoHdr.TableName), _
                                        Tbl_MedExInfoHdr, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in MedExInfoHdr

            If Not objSave.SaveInDb("Insert_MedExInfoHdr", Tbl_MedExInfoHdr, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of MedExInfoHdr In Database"
                Exit Function
            End If
            'Assiging New iTranno for Other than first rows
            DataReturnList = DataReturnList.Item(0)
            RetuVal = DataReturnList.Item(0)
            '********************************************

            Save_MedExInfoHdr = True

            If Save_MedExInfoHdr Then
                objHdrogic.Commit_Transaction()
            Else
                objHdrogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving MedExInfoHdr"
            Save_MedExInfoHdr = False
            objHdrogic.RollBack_Transaction()
        Finally
            objHdrogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "Save_MedExSubGroupMst"
    Public Function Save_MedExSubGroupMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_MedExSubGroupMst As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean
        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim Dt_View As Data.DataView = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_MedExSubGroupMst As Data.DataTable = Nothing

        Dim Instr_vMedExSubGroupCode As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_MedExSubGroupMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            Ds_MedExSubGroupMst.Tables(0).TableName = "MedExSubGroupMst"
            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_MedExSubGroupMst.Tables("MedExSubGroupMst").Rows

                    Instr_vMedExSubGroupCode += IIf(Instr_vMedExSubGroupCode = "", "'", ",'").ToString + _
                                    tr("vMedExSubGroupCode").ToString + "'"

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of MedEx Sub Group Master
            If Not objHelpDbTbl.GetMedExSubGroupMst("vMedExSubGroupCode in (" + Instr_vMedExSubGroupCode + ")", dataRet_1, _
                                            objDtLogic, Tbl_MedExSubGroupMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving MedEx Sub Group Master Details"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            Tbl_MedExSubGroupMst.TableName = "MedExSubGroupMst"

            'Assignment of Values

            PkColArr(0) = "vMedExSubGroupCode"

            If Not objSave.AssignValues(Tbl_MedExSubGroupMst.TableName, PkColArr, Choice, _
                                        Ds_MedExSubGroupMst.Tables(Tbl_MedExSubGroupMst.TableName), _
                                        Tbl_MedExSubGroupMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "error occured while assigning values"
                Exit Function
            End If

            ' Save in MedExMst
            Tbl_MedExSubGroupMst.TableName = "MedExSubGroupMst"
            If Not objSave.SaveInDb("Insert_MedExSubGroupMst", Tbl_MedExSubGroupMst, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of MedEx Sub Group Master In Database"
                Exit Function
            End If

            Save_MedExSubGroupMst = True

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving MedExSubGroupMst Details"
            Save_MedExSubGroupMst = False
        End Try
    End Function
#End Region

#Region "Save_SubjectLanguageMst"
    Public Function Save_SubjectLanguageMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_SubjectLanguageMst As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_SubjectLanguageMst As Data.DataTable = Nothing
        Dim Instr_LanguageId As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_SubjectLanguageMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_SubjectLanguageMst.Tables("SubjectLanguageMst").Rows

                    Instr_LanguageId += IIf(Instr_LanguageId = "", "", ",").ToString + _
                                    tr("vLanguageId").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of SubjectLanguageMst
            If Not objHelpDbTbl.getSubjectLanguageMst("vLanguageId In (" + Instr_LanguageId + ")", dataRet_1, _
                                            objDtLogic, Tbl_SubjectLanguageMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving SubjectLanguage Master"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vLanguageId"

            If Not objSave.AssignValues(Tbl_SubjectLanguageMst.TableName, PkColArr, Choice, _
                                        Ds_SubjectLanguageMst.Tables(Tbl_SubjectLanguageMst.TableName), _
                                        Tbl_SubjectLanguageMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in SubjectLanguage Master
            If Not objSave.SaveInDb("Insert_SubjectLanguageMst", Tbl_SubjectLanguageMst, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of SubjectLanguage Master In Database"
                Exit Function
            End If

            Save_SubjectLanguageMst = True
            objDtLogic.Commit_Transaction()

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving SubjectLanguage Master"
            Save_SubjectLanguageMst = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "ActivityGroupMst"
    Public Function Save_ActivityGroupMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_ActivityGroupMst As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_ActivityGroupMst As Data.DataTable = Nothing
        Dim Instr_ActivityGroupId As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_ActivityGroupMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_ActivityGroupMst.Tables("ActivityGroupMst").Rows

                    Instr_ActivityGroupId += IIf(Instr_ActivityGroupId = "", "", ",").ToString + _
                                    tr("vActivityGroupId").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of ActivityGroupMst
            If Not objHelpDbTbl.getActivityGroupMst("vActivityGroupId In (" + Instr_ActivityGroupId + ")", dataRet_1, _
                                            objDtLogic, Tbl_ActivityGroupMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving ActivityGroup Master"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vActivityGroupId"

            If Not objSave.AssignValues(Tbl_ActivityGroupMst.TableName, PkColArr, Choice, _
                                        Ds_ActivityGroupMst.Tables(Tbl_ActivityGroupMst.TableName), _
                                        Tbl_ActivityGroupMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in ActivityGroup Master
            If Not objSave.SaveInDb("Insert_ActivityGroupMst", Tbl_ActivityGroupMst, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of ActivityGroup Master In Database"
                Exit Function
            End If

            Save_ActivityGroupMst = True

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving ActivityGroup Master"
            Save_ActivityGroupMst = False
        End Try

    End Function
#End Region

#Region "WorkSpaceNodeDetail"
    Public Function Save_WorkSpaceNodeDetail(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_WorkSpaceNodeDetail As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_WorkSpaceNodeDetail As Data.DataTable = Nothing
        Dim Instr_WorkSpaceNodeId As String = ""

        Dim PkColArr(1) As String
        Dim DataReturnList As New ArrayList

        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_WorkSpaceNodeDetail Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_WorkSpaceNodeDetail.Tables("WorkSpaceNodeDetail").Rows

                    Instr_WorkSpaceNodeId += IIf(Instr_WorkSpaceNodeId = "", "'", ",'").ToString + _
                                    tr("vWorkSpaceId").ToString + tr("iNodeId").ToString + "'"

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of WorkSpaceNodeDetail
            If Not objHelpDbTbl.getWorkSpaceNodeDetail("vWorkSpaceId + cast(iNodeId as varchar(4)) In (" + Instr_WorkSpaceNodeId + ")", dataRet_1, _
                                            objDtLogic, Tbl_WorkSpaceNodeDetail, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving WorkSpaceNodeDetail"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vWorkSpaceId"
            PkColArr(1) = "iNodeId"

            If Not objSave.AssignValues(Tbl_WorkSpaceNodeDetail.TableName, PkColArr, Choice, _
                                        Ds_WorkSpaceNodeDetail.Tables(Tbl_WorkSpaceNodeDetail.TableName), _
                                        Tbl_WorkSpaceNodeDetail, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in WorkSpaceNodeDetail
            If Not objSave.SaveInDb("Insert_WorkSpaceNodeDetail", Tbl_WorkSpaceNodeDetail, Choice, Nothing, eStr_Retu, True) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of WorkSpaceNodeDetail In Database"
                Exit Function
            End If

            Save_WorkSpaceNodeDetail = True

            If Save_WorkSpaceNodeDetail Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

            'objDtLogic.Close_Connection()
        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving WorkSpaceNodeDetail"
            Save_WorkSpaceNodeDetail = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "Save_InsertWorkSpaceLeafNode"
    Public Function Save_InsertWorkspaceLeafNode(ByVal Choice As DataObjOpenSaveModeEnum, _
                                     ByVal Ds_WorkspaceMst As DataSet, _
                                     ByVal UserCode_1 As String, _
                                     ByRef eStr_Retu As String) As Boolean
        Dim objDtLogic As New ClsDataLogic_New()

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_WorkspaceNodeDetail As Data.DataTable = Nothing
        Dim Instr_WorkspaceId As String = ""

        Dim PkColArr(1) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing


        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            'Logic Of save Start
            eStr_Retu = ""


            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_WorkspaceMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_WorkspaceMst.Tables("WorkspaceNodeDetail").Rows

                    Instr_WorkspaceId += IIf(Instr_WorkspaceId = "", "", ",").ToString + _
                                    tr("vWorkspaceId").ToString + _
                                    tr("iNodeId").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of WorkspaceNodeDetail
            If Not objHelpDbTbl.getWorkSpaceNodeDetail("vTempateId + cast(iNodeId as varchar(4)) In (" + Instr_WorkspaceId + ")", dataRet_1, _
                                            objDtLogic, Tbl_WorkspaceNodeDetail, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving WorkspaceNodeDetail"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vWorkspaceId"
            PkColArr(1) = "iNodeId"
            If Not objSave.AssignValues(Tbl_WorkspaceNodeDetail.TableName, PkColArr, Choice, _
                                        Ds_WorkspaceMst.Tables(Tbl_WorkspaceNodeDetail.TableName), _
                                        Tbl_WorkspaceNodeDetail, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in WorkspaceNodeDetail
            If Not objSave.SaveInDb("Insert_addWorkspaceLeafNode", Tbl_WorkspaceNodeDetail, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of WorkspaceNodeDetail In Database"
                Exit Function
            End If

            'This is to retrive the output parameter

            'Save in WorkspaceNodeAttribute   

            DataReturnList = DataReturnList.Item(0)
            RetuVal = DataReturnList.Item(0)

            For Each dr As Data.DataRow In Tbl_WorkspaceNodeDetail.Rows
                dr("iNodeId") = RetuVal.ParameterValue
            Next
            If Not objSave.SaveInDb("Insert_WorkspaceNodeAttrDetail", Tbl_WorkspaceNodeDetail, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of WorkspaceNodeDetail In Database"
                Exit Function
            End If

            Save_InsertWorkspaceLeafNode = True

            'Logic of Save End

            If Save_InsertWorkspaceLeafNode Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

            objDtLogic.Close_Connection()
        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving WorkspaceNodeDetail"
            Save_InsertWorkspaceLeafNode = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region

#Region "Save_InsertWorkSpaceNodeBefore"
    Public Function Save_InsertWorkspaceNodeBefore(ByVal Choice As DataObjOpenSaveModeEnum, _
                                ByVal Ds_WorkspaceMst As DataSet, _
                                ByVal UserCode_1 As String, _
                                ByRef eStr_Retu As String) As Boolean

        Dim objDtLogic As New ClsDataLogic_New

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_WorkspaceNodeDetail As Data.DataTable = Nothing
        Dim Instr_WorkspaceId As String = ""

        Dim PkColArr(1) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing
        Dim NodeId As New Integer

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            'Logic Of save Start
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_WorkspaceMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_WorkspaceMst.Tables("WorkspaceNodeDetail").Rows

                    Instr_WorkspaceId += IIf(Instr_WorkspaceId = "", "", ",").ToString + _
                                    tr("vWorkspaceId").ToString + _
                                    tr("iNodeId").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of WorkspaceNodeDetail
            If Not objHelpDbTbl.getWorkSpaceNodeDetail("vTempateId + cast(iNodeId as varchar(4)) In (" + Instr_WorkspaceId + ")", dataRet_1, _
                                            objDtLogic, Tbl_WorkspaceNodeDetail, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving WorkspaceNodeDetail"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vWorkspaceId"
            PkColArr(1) = "iNodeId"
            If Not objSave.AssignValues(Tbl_WorkspaceNodeDetail.TableName, PkColArr, Choice, _
                                        Ds_WorkspaceMst.Tables(Tbl_WorkspaceNodeDetail.TableName), _
                                        Tbl_WorkspaceNodeDetail, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in WorkspaceNodeDetail
            If Not objSave.SaveInDb("Insert_addWorkspaceNodeBefore", Tbl_WorkspaceNodeDetail, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of WorkspaceNodeDetail In Database"
                Exit Function
            End If

            'This is to retrive the output parameter

            'Save in WorkspaceNodeAttribute   

            DataReturnList = DataReturnList.Item(0)
            RetuVal = DataReturnList.Item(0)

            For Each dr As Data.DataRow In Tbl_WorkspaceNodeDetail.Rows
                dr("iNodeId") = RetuVal.ParameterValue
            Next



            If Not objSave.SaveInDb("Insert_WorkspaceNodeAttrDetail", Tbl_WorkspaceNodeDetail, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of WorkspaceNodeDetail In Database"
                Exit Function
            End If

            Save_InsertWorkspaceNodeBefore = True

            'Logic of Save End


            If Save_InsertWorkspaceNodeBefore Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving WorkspaceNodeDetail"
            Save_InsertWorkspaceNodeBefore = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region

#Region "Save_InsertWorkSpaceNodeAfter"
    Public Function Save_InsertWorkspaceNodeAfter(ByVal Choice As DataObjOpenSaveModeEnum, _
                                ByVal Ds_WorkspaceMst As DataSet, _
                                ByVal UserCode_1 As String, _
                                ByRef eStr_Retu As String) As Boolean
        Dim objDtLogic As New ClsDataLogic_New

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_WorkspaceNodeDetail As Data.DataTable = Nothing
        Dim Instr_WorkspaceId As String = ""

        Dim PkColArr(1) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()


            'Logic Of save Start

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_WorkspaceMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_WorkspaceMst.Tables("WorkspaceNodeDetail").Rows

                    Instr_WorkspaceId += IIf(Instr_WorkspaceId = "", "", ",").ToString + _
                                    tr("vWorkspaceId").ToString + _
                                    tr("iNodeId").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of WorkspaceNodeDetail
            If Not objHelpDbTbl.getWorkSpaceNodeDetail("vWorkspaceId + cast(iNodeId as varchar(4)) In (" + Instr_WorkspaceId + ")", dataRet_1, _
                                            objDtLogic, Tbl_WorkspaceNodeDetail, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving WorkspaceNodeDetail"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vWorkspaceId"
            PkColArr(1) = "iNodeId"

            If Not objSave.AssignValues(Tbl_WorkspaceNodeDetail.TableName, PkColArr, Choice, _
                                        Ds_WorkspaceMst.Tables(Tbl_WorkspaceNodeDetail.TableName), _
                                        Tbl_WorkspaceNodeDetail, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in WorkspaceNodeDetail
            If Not objSave.SaveInDb("Insert_addWorkspaceNodeAfter", Tbl_WorkspaceNodeDetail, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of WorkspaceNodeDetail In Database"
                Exit Function
            End If

            'This is to retrive the output parameter

            'Save in WorkspaceNodeAttribute   

            DataReturnList = DataReturnList.Item(0)
            RetuVal = DataReturnList.Item(0)
            For Each dr As Data.DataRow In Tbl_WorkspaceNodeDetail.Rows
                dr("iNodeId") = RetuVal.ParameterValue
            Next



            If Not objSave.SaveInDb("Insert_WorkspaceNodeAttrDetail", Tbl_WorkspaceNodeDetail, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of WorkspaceNodeDetail In Database"
                Exit Function
            End If

            Save_InsertWorkspaceNodeAfter = True
            'Logic of Save End

            If Save_InsertWorkspaceNodeAfter Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving WorkspaceNodeDetail"
            Save_InsertWorkspaceNodeAfter = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region

#Region "Save_MedExInfoHdrQC"

    Public Function Save_MedExInfoHdrQC(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_MedExInfoHdrQC As Data.DataSet, _
                                        ByVal objHdrogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime
        Dim Tbl_MedExInfoHdrQC As Data.DataTable = Nothing
        Dim Tbl_Top_MedExInfoHdrQC As Data.DataTable = Nothing

        Dim Instr_MedExInfoHdrQCNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Dim DataReturnList_Mst As New ArrayList
        Dim RetuVal_Mst As ParameterReturnValue = Nothing

        Try
            eStr_Retu = ""
            objHdrogic.Open_Connection()
            objHdrogic.Begin_Transaction()

            If objHdrogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objHdrogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_MedExInfoHdrQC Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If
            Tbl_MedExInfoHdrQC = Ds_MedExInfoHdrQC.Tables("MedExInfoHdrQC")

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_MedExInfoHdrQC.Tables("MedExInfoHdrQC").Rows

                    Instr_MedExInfoHdrQCNo += IIf(Instr_MedExInfoHdrQCNo = "", "", ",").ToString + _
                                      tr("nMedExInfoHdrQCNo").ToString.Trim()

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objHdrogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objHdrogic)

            'Retrieval of MedExInfoHdrQC
            If Not objHelpDbTbl.GetMedexInfoHdrQC("nMedExInfoHdrQCNo In (" + Instr_MedExInfoHdrQCNo + ")", dataRet_1, _
                                            objHdrogic, Tbl_MedExInfoHdrQC, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving MedExInfoHdrQC"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objHdrogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nMedExInfoHdrQCNo"

            If Not objSave.AssignValues(Tbl_MedExInfoHdrQC.TableName, PkColArr, Choice, _
                                        Ds_MedExInfoHdrQC.Tables(Tbl_MedExInfoHdrQC.TableName), _
                                        Tbl_MedExInfoHdrQC, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in MedExInfoHdrQC

            If Not objSave.SaveInDb("Insert_MedExInfoHdrQC", Tbl_MedExInfoHdrQC, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of MedExInfoHdrQC In Database"
                Exit Function
            End If

            Save_MedExInfoHdrQC = True

            If Save_MedExInfoHdrQC Then
                objHdrogic.Commit_Transaction()
            Else
                objHdrogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving MedExInfoHdrQC"
            Save_MedExInfoHdrQC = False
            objHdrogic.RollBack_Transaction()
        Finally
            objHdrogic.Close_Connection()
        End Try

    End Function

#End Region

#Region "Save_InsertSTP"
    Public Function Save_InsertSTP(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_STP As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime
        Dim Tbl_STP As Data.DataTable = Nothing

        Dim Instr_STPNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Dim DataReturnList_Mst As New ArrayList
        Dim RetuVal_Mst As ParameterReturnValue = Nothing

        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_STP Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_STP.Tables(0).Rows

                    Instr_STPNo += IIf(Instr_STPNo = "", "", ",").ToString + _
                                      tr("nSTPNo").ToString.Trim()

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of STP
            If Not objHelpDbTbl.GetViewSTPWithScope("nSTPNo In (" + Instr_STPNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_STP, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving STP"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nSTPNo"

            If Not objSave.AssignValues(Tbl_STP.TableName, PkColArr, Choice, _
                                        Ds_STP.Tables(Tbl_STP.TableName), _
                                        Tbl_STP, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            If Not objSave.SaveInDb("Insert_STP", Tbl_STP, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of STP In Database"
                Exit Function
            End If


            Save_InsertSTP = True

            If Save_InsertSTP Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving STP "
            Save_InsertSTP = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "Save_MTPMstDtl"
    Public Function Save_MTPMstDtl(ByVal Choice As DataObjOpenSaveModeEnum, _
                                       ByVal Ds_MTP As Data.DataSet, _
                                       ByVal objDtLogic As ClsDataLogic_New, _
                                       ByVal UserCode_1 As String, _
                                       ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing
        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime
        Dim Tbl_MTP As Data.DataTable = Nothing

        Dim Instr_MTPNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Dim DataReturnList_Mst As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing
        Dim dr As DataRow

        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_MTP Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_MTP.Tables(0).Rows

                    Instr_MTPNo += IIf(Instr_MTPNo = "", "", ",").ToString + _
                                      tr("nMTPNo").ToString.Trim()

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of MTP
            If Not objHelpDbTbl.GetMTPHdr("nMTPNo In (" + Instr_MTPNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_MTP, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving MTP"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nMTPNo"

            If Not objSave.AssignValues(Tbl_MTP.TableName, PkColArr, Choice, _
                                        Ds_MTP.Tables(Tbl_MTP.TableName), _
                                        Tbl_MTP, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            If Not objSave.SaveInDb("Insert_MTPHdr", Ds_MTP.Tables("MTPHdr"), Choice, DataReturnList_Mst, eStr_Retu) Then
                eStr_Retu += " " + "Error occured while Save Information of MTPHdr In Database"
                Exit Function
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                DataReturnList_Mst = DataReturnList_Mst.Item(0)
                RetuVal = DataReturnList_Mst.Item(0)

                For Each dr In Ds_MTP.Tables("MTPDtl").Rows
                    dr("nMTPHdrNo") = RetuVal.ParameterValue
                Next dr
            End If

            If Not objSave.SaveInDb("Insert_MTPDtl", Ds_MTP.Tables("MTPDtl"), Choice, Nothing, eStr_Retu) Then
                eStr_Retu += " " + "Error occured while Save Information of MTPDtl In Database"
                Exit Function
            End If

            Save_MTPMstDtl = True

            If Save_MTPMstDtl Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving MTP "
            Save_MTPMstDtl = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "Save MTP"
    Public Function Save_SubmitMTP(ByVal Choice As DataObjOpenSaveModeEnum, _
                                     ByVal Ds_MTP As Data.DataSet, _
                                     ByVal objDtLogic As ClsDataLogic_New, _
                                     ByVal UserCode_1 As String, _
                                     ByRef eStr_Retu As String) As Boolean
        Try

            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            Dim objSave As SaveDataInDbObj = Nothing
            objSave = New SaveDataInDbObj(objDtLogic)

            If Not objSave.SaveInDb("InsertUpdateMtpApproval", Ds_MTP.Tables(0), Choice, Nothing, eStr_Retu) Then
                eStr_Retu += " " + "Error occured while saving MTP In Database"
                Exit Function
            End If

            Save_SubmitMTP = True

            If Save_SubmitMTP Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while Saving MTP"
            Save_SubmitMTP = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "Save_DWRHdrDtl"
    Public Function Save_DWRHdrDtl(ByVal Choice As DataObjOpenSaveModeEnum, _
                                       ByVal Ds_DWR As Data.DataSet, _
                                       ByVal objDtLogic As ClsDataLogic_New, _
                                       ByVal UserCode_1 As String, _
                                       ByRef DocumentNo As String, _
                                       ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing
        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime
        Dim Tbl_DWR As Data.DataTable = Nothing

        Dim Instr_DWRNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Dim DataReturnList_Mst As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing
        Dim dr As DataRow

        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_DWR Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Function called only if edit is called
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                For Each tr As Data.DataRow In Ds_DWR.Tables(0).Rows

                    Instr_DWRNo += IIf(Instr_DWRNo = "", "", ",").ToString + _
                                      tr("nDWRHdrNo").ToString.Trim()

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of DWRHdr
            If Not objHelpDbTbl.GetDWRHdr("nDWRHdrNo In (" + Instr_DWRNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_DWR, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving DWR"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nDWRHdrNo"

            If Not objSave.AssignValues(Tbl_DWR.TableName, PkColArr, Choice, _
                                        Ds_DWR.Tables(Tbl_DWR.TableName), _
                                        Tbl_DWR, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add AndAlso Ds_DWR.Tables("DWRHdr").Rows(0).Item("nDWRHdrNo") = 0 Then
                If Not objSave.SaveInDb("Insert_DWRHdr", Ds_DWR.Tables("DWRHdr"), Choice, DataReturnList_Mst, eStr_Retu) Then
                    eStr_Retu += " " + "Error occured while Save Information of DWRHdr In Database"
                    Exit Function
                End If
            Else
                If Not objSave.SaveInDb("Insert_DWRHdr", Ds_DWR.Tables("DWRHdr"), DataObjOpenSaveModeEnum.DataObjOpenMode_Edit, DataReturnList_Mst, eStr_Retu) Then
                    eStr_Retu += " " + "Error occured while Save Information of DWRHdr In Database"
                    Exit Function
                End If
            End If


            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                DataReturnList_Mst = DataReturnList_Mst.Item(0)
                RetuVal = DataReturnList_Mst.Item(0)

                For Each dr In Ds_DWR.Tables("DWRDetail").Rows
                    dr("nDWRHdrNo") = RetuVal.ParameterValue
                Next dr

                DocumentNo = "DWR Submited with DWRNo: " & RetuVal.ParameterValue
            End If

            If Not objSave.SaveInDb("Insert_DWRDetail", Ds_DWR.Tables("DWRDetail"), Choice, Nothing, eStr_Retu) Then
                eStr_Retu += " " + "Error occured while Save Information of DWRDetail In Database"
                Exit Function
            End If

            Save_DWRHdrDtl = True

            If Save_DWRHdrDtl Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving DWR "
            Save_DWRHdrDtl = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "ParameterList Saving"
    Public Function Save_ParameterList(ByVal Choice As DataObjOpenSaveModeEnum, _
                                       ByVal Ds_ParameterList As Data.DataSet, _
                                       ByVal objDtLogic As ClsDataLogic_New, _
                                       ByVal UserCode_1 As String, _
                                       ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_ParameterList As Data.DataTable = Nothing
        Dim Instr_ParameterList As String = ""
        Dim PkColArr(0) As String

        Dim DataReturnList As New ArrayList

        Dim RetuVal As ParameterReturnValue = Nothing

        Dim Tbl_ParameterDeptMatrix As Data.DataTable = Nothing
        Dim PkColArr_ParameterDeptMatrix(0) As String
        Dim wStr_ParaDiv As String

        Try
            eStr_Retu = ""

            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_ParameterList Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            For Each tr As Data.DataRow In Ds_ParameterList.Tables("PARAMETERLIST").Rows

                Instr_ParameterList += IIf(Instr_ParameterList = "", "", ",").ToString + _
                                        tr("nParameterNo").ToString

            Next tr


            dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of ParameterList
            If Not objHelpDbTbl.GetParameterList("nParameterNo In (" + Instr_ParameterList + ")", dataRet_1, _
                                            objDtLogic, Tbl_ParameterList, eStr_Retu) Then

                eStr_Retu += " " + "Error occured while retrieving Parameter List"
                Exit Function
            End If

            wStr_ParaDiv = "nParameterNo In (" + Instr_ParameterList + ")  AND ParameterDeptMatrix.cActiveFlag='Y'"
            If Not objHelpDbTbl.GetParameterDeptMatrix(wStr_ParaDiv, dataRet_1, _
                                                           objDtLogic, Tbl_ParameterDeptMatrix, eStr_Retu) Then

                eStr_Retu += " " + "Error occured while retrieving Parameter Dept Matrix"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += " " + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "NPARAMETERNO"

            Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add
            If Tbl_ParameterList.Rows.Count > 0 Then
                Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit
            End If

            If Not objSave.AssignValues(Tbl_ParameterList.TableName, PkColArr, Choice, _
                                        Ds_ParameterList.Tables(Tbl_ParameterList.TableName), _
                                        Tbl_ParameterList, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += " " + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in ParameterList
            If Not objSave.SaveInDb("Insert_ParameterList", Tbl_ParameterList, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += " " + "Error occured while Save Information of ParameterList Master In Database"
                Exit Function
            End If

            ' Save in ParameterDeptMatrix

            Tbl_ParameterDeptMatrix = Ds_ParameterList.Tables("ParameterDeptMatrix")

            If Not objSave.SaveInDb("Insert_ParameterDeptMatrix", Tbl_ParameterDeptMatrix, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += " " + "Error occured while Save Information of Parameter Dept Matrix In Database"
                Exit Function
            End If

            Save_ParameterList = True

            If Save_ParameterList Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Parameter List"
            Save_ParameterList = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function

#End Region

#Region "Edit_HousingDetail"
    Public Function Edit_HousingDetail(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_WorkSpaceNodeDetail As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_WorkSpaceNodeDetail As Data.DataTable = Nothing

        Dim Ds_Common As Data.DataSet = Nothing
        Dim Dt_Delete As Data.DataTable = Nothing

        Dim WrokspaceId As String = ""
        Dim ParenActivityId As String = ""
        Dim RefActivityId As String = ""
        Dim RefNodeId As String = ""
        Dim wStr As String = ""
        Dim MaxNodeId As Integer
        Dim cnt As Integer = 0

        Dim dt_Period As New DataTable

        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_WorkSpaceNodeDetail Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            Tbl_WorkSpaceNodeDetail = Ds_WorkSpaceNodeDetail.Tables("WorkSpaceNodeDetail")

            dt_Period = Tbl_WorkSpaceNodeDetail.DefaultView.ToTable(True, "iPeriod")

            'As per The Discussion First Delete All Housing Activity of perticular Parent
            WrokspaceId = Tbl_WorkSpaceNodeDetail.Rows(0).Item("vWorkSpaceId")
            ParenActivityId = Tbl_WorkSpaceNodeDetail.Rows(0).Item("vParentActivityId")
            RefActivityId = Tbl_WorkSpaceNodeDetail.Rows(0).Item("vRefActivityId")
            RefNodeId = Tbl_WorkSpaceNodeDetail.Rows(0).Item("iRefNodeId")

            Ds_Common = New Data.DataSet

            wStr = "vWorkSpaceId = '" & WrokspaceId.Trim() & "'"


            If Not objHelpDbTbl.GetViewWorkSpaceNodeDetail(wStr, Ds_Common, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving WorkSpaceNodeDetail"
                Exit Function
            End If

            MaxNodeId = Ds_Common.Tables(0).Compute("max(iNodeId)", "1=1")


            If dt_Period.Rows.Count > 1 Then

                'Ds_Common.Tables(0).DefaultView.RowFilter = "vParentActivityId = '" & ParenActivityId.Trim() & _
                '                                            "' And vRefActivityId='" & RefActivityId.Trim() & _
                '                                            "' AND iRefNodeid = " & RefNodeId & _
                '                                            " And cCloneFlag = 'H' and cStatusIndi<>'D'"

                Ds_Common.Tables(0).DefaultView.RowFilter = "vParentActivityId = '" & ParenActivityId.Trim() & _
                                                           "' And vRefActivityId='" & RefActivityId.Trim() & _
                                                           "' And cCloneFlag = 'H' and cStatusIndi<>'D'"

            Else

                'Ds_Common.Tables(0).DefaultView.RowFilter = "vParentActivityId = '" & ParenActivityId.Trim() & _
                '                                            "' And vRefActivityId='" & RefActivityId.Trim() & _
                '                                            "' And cCloneFlag = 'H' and cStatusIndi<>'D' And " & _
                '                                            "iPeriod=" & dt_Period.Rows(0).Item("iPeriod").ToString.Trim()
                Ds_Common.Tables(0).DefaultView.RowFilter = "vParentActivityId = '" & ParenActivityId.Trim() & _
                                                            "' And vRefActivityId='" & RefActivityId.Trim() & _
                                                            "' And iNodeId ='" & Tbl_WorkSpaceNodeDetail.Rows(0).Item("iNodeId") & _
                                                            "' And cCloneFlag = 'H' and cStatusIndi<>'D' And " & _
                                                            "iPeriod=" & dt_Period.Rows(0).Item("iPeriod").ToString.Trim()

            End If


            Dt_Delete = Ds_Common.Tables(0).DefaultView.ToTable()

            For Each dr As DataRow In Dt_Delete.Rows
                dr("cStatusIndi") = "D"
            Next dr
            Dt_Delete.AcceptChanges()

            If Not objSave.SaveInDb("Insert_WorkSpaceNodeDetail", Dt_Delete, _
                                    DataObjOpenSaveModeEnum.DataObjOpenMode_Edit, Nothing, eStr_Retu, True) Then

                eStr_Retu += vbCrLf + "Error occured while Save Information of WorkSpaceNodeDetail In Database"
                Exit Function

            End If

            'Now Add Passed Housing Activity Again

            For Each dr As DataRow In Tbl_WorkSpaceNodeDetail.Rows
                MaxNodeId += 1
                dr("iNodeId") = MaxNodeId
            Next dr

            Tbl_WorkSpaceNodeDetail.AcceptChanges()


            If Not objSave.SaveInDb("Insert_WorkSpaceNodeDetail", Tbl_WorkSpaceNodeDetail, _
                        DataObjOpenSaveModeEnum.DataObjOpenMode_Add, Nothing, eStr_Retu, True) Then

                eStr_Retu += vbCrLf + "Error occured while Save Information of WorkSpaceNodeDetail In Database"
                Exit Function

            End If


            Edit_HousingDetail = True

            If Edit_HousingDetail Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving WorkSpaceNodeDetail"
            Edit_HousingDetail = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.RollBack_Transaction()
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "Save_DeptMst"
    Public Function Save_DeptMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_DeptMst As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_DeptMst As Data.DataTable = Nothing
        Dim Instr_DeptCode As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_DeptMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_DeptMst.Tables("DeptMst").Rows

                    Instr_DeptCode += IIf(Instr_DeptCode = "", "", ",").ToString + _
                                    tr("vDeptCode").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of DoctypeMst
            If Not objHelpDbTbl.GetDeptMst("vDeptCode In (" + Instr_DeptCode + ")", dataRet_1, _
                                            objDtLogic, Tbl_DeptMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving Department Master"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vDeptCode"

            If Not objSave.AssignValues(Tbl_DeptMst.TableName, PkColArr, Choice, _
                                        Ds_DeptMst.Tables(Tbl_DeptMst.TableName), _
                                        Tbl_DeptMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in Doctype Master
            If Not objSave.SaveInDb("Insert_DeptMst", Tbl_DeptMst, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of Department Master In Database"
                Exit Function
            End If

            Save_DeptMst = True

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Department Master"
            Save_DeptMst = False
        End Try

    End Function
#End Region

#Region "Save_SubjectMasterQC"
    Public Function Save_SubjectMasterQC(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_SubjectMasterQC As Data.DataSet, _
                                        ByVal objHdrogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime
        Dim Tbl_SubjectMasterQC As Data.DataTable = Nothing

        Dim Instr_SubjectMasterQCNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Dim DataReturnList_Mst As New ArrayList
        Dim RetuVal_Mst As ParameterReturnValue = Nothing

        Try
            eStr_Retu = ""
            objHdrogic.Open_Connection()
            objHdrogic.Begin_Transaction()

            If objHdrogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objHdrogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_SubjectMasterQC Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If
            Tbl_SubjectMasterQC = Ds_SubjectMasterQC.Tables("SubjectMasterQC")

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_SubjectMasterQC.Tables("SubjectMasterQC").Rows

                    Instr_SubjectMasterQCNo += IIf(Instr_SubjectMasterQCNo = "", "", ",").ToString + _
                                      tr("nSubjectMasterQCNo").ToString.Trim()

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objHdrogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objHdrogic)

            'Retrieval of MedExInfoHdrQC
            If Not objHelpDbTbl.GetSubjectMasterQC("nSubjectMasterQCNo In (" + Instr_SubjectMasterQCNo + ")", dataRet_1, _
                                            objHdrogic, Tbl_SubjectMasterQC, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving SubjectMasterQC"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objHdrogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nSubjectMasterQCNo"

            If Not objSave.AssignValues(Tbl_SubjectMasterQC.TableName, PkColArr, Choice, _
                                        Ds_SubjectMasterQC.Tables(Tbl_SubjectMasterQC.TableName), _
                                        Tbl_SubjectMasterQC, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in MedExInfoHdrQC

            If Not objSave.SaveInDb("Insert_SubjectMasterQC", Tbl_SubjectMasterQC, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of SubjectMasterQC In Database"
                Exit Function
            End If

            Save_SubjectMasterQC = True

            If Save_SubjectMasterQC Then
                objHdrogic.Commit_Transaction()
            Else
                objHdrogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving SubjectMasterQC"
            Save_SubjectMasterQC = False
            objHdrogic.RollBack_Transaction()
        Finally
            objHdrogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "Save_MedexScreeningHdrQC"
    Public Function Save_MedexScreeningHdrQC(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_MedexScreeningHdrQC As Data.DataSet, _
                                        ByVal objHdrogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime
        Dim Tbl_MedexScreeningHdrQC As Data.DataTable = Nothing
        Dim Tbl_Top_MedexScreeningHdrQC As Data.DataTable = Nothing

        Dim Instr_MedexScreeningHdrQCNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Dim DataReturnList_Mst As New ArrayList
        Dim RetuVal_Mst As ParameterReturnValue = Nothing

        Try
            eStr_Retu = ""
            objHdrogic.Open_Connection()
            objHdrogic.Begin_Transaction()

            If objHdrogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objHdrogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_MedexScreeningHdrQC Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If
            Tbl_MedexScreeningHdrQC = Ds_MedexScreeningHdrQC.Tables("MedexScreeningHdrQC")

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_MedexScreeningHdrQC.Tables("MedexScreeningHdrQC").Rows

                    Instr_MedexScreeningHdrQCNo += IIf(Instr_MedexScreeningHdrQCNo = "", "", ",").ToString + _
                                      tr("nMedexScreeningHdrQCNo").ToString.Trim()

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objHdrogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objHdrogic)

            'Retrieval of MedexScreeningHdrQC
            If Not objHelpDbTbl.GetMedexScreeningHdrQC("nMedexScreeningHdrQCNo In (" + Instr_MedexScreeningHdrQCNo + ")", dataRet_1, _
                                            objHdrogic, Tbl_MedexScreeningHdrQC, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving MedexScreeningHdrQC"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objHdrogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nMedexScreeningHdrQCNo"

            If Not objSave.AssignValues(Tbl_MedexScreeningHdrQC.TableName, PkColArr, Choice, _
                                        Ds_MedexScreeningHdrQC.Tables(Tbl_MedexScreeningHdrQC.TableName), _
                                        Tbl_MedexScreeningHdrQC, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in MedexScreeningHdrQC

            If Not objSave.SaveInDb("Insert_MedexScreeningHdrQC", Tbl_MedexScreeningHdrQC, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of MedexScreeningHdrQC In Database"
                Exit Function
            End If

            Save_MedexScreeningHdrQC = True

            If Save_MedexScreeningHdrQC Then
                objHdrogic.Commit_Transaction()
            Else
                objHdrogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving MedexScreeningHdrQC"
            Save_MedexScreeningHdrQC = False
            objHdrogic.RollBack_Transaction()
        Finally
            objHdrogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "Save_TemplateDefaultWorkflowUserDtl"
    Public Function Save_TemplateDefaultWorkflowUserDtl(ByVal Choice As DataObjOpenSaveModeEnum, _
                                                        ByVal Ds_TemplateDefaultWorkflowUserDtl As Data.DataSet, _
                                                        ByVal objHdrogic As ClsDataLogic_New, _
                                                        ByVal UserCode_1 As String, _
                                                        ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing
        Dim objDtLogic As New ClsDataLogic_New
        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim Instr_TemplateDefaultWorkflowUserDtlId As String = ""

        Dim ObjHelpDbTable As New clsHelpDbTable

        Dim Tbl_Templatenodedetail As New Data.DataTable
        Dim Tbl_TemplateDefaultWorkflowUserDtl As New Data.DataTable
        Dim objCommon As New clsCommon

        Try


            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()


            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_TemplateDefaultWorkflowUserDtl Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_TemplateDefaultWorkflowUserDtl.Tables("View_TemplateDefaultWorkflowUserDtl").Rows

                    Instr_TemplateDefaultWorkflowUserDtlId += IIf(Instr_TemplateDefaultWorkflowUserDtlId = "", "", ",").ToString + _
                                      tr("nTemplateDefaultWorkflowUserId").ToString.Trim()

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of TemplateDefaultWorkflowUserDtl
            If Not objHelpDbTbl.View_TemplateDefaultWorkflowUserDtl("nTemplateDefaultWorkflowUserId In (" + Instr_TemplateDefaultWorkflowUserDtlId + ")", dataRet_1, _
                                            objHdrogic, Tbl_TemplateDefaultWorkflowUserDtl, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving TemplateDefaultWorkflowUserDtl"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objHdrogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nTemplateDefaultWorkflowUserId"

            If Not objSave.AssignValues(Tbl_TemplateDefaultWorkflowUserDtl.TableName, PkColArr, Choice, _
                                        Ds_TemplateDefaultWorkflowUserDtl.Tables(Tbl_TemplateDefaultWorkflowUserDtl.TableName), _
                                        Tbl_TemplateDefaultWorkflowUserDtl, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If




            If Not objSave.SaveInDb("Insert_TemplateDefaultWorkflowUserDtl", Tbl_TemplateDefaultWorkflowUserDtl, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of TemplateDefaultWorkflowUserDtl In Database"
                Exit Function
            End If


            Save_TemplateDefaultWorkflowUserDtl = True

            If Save_TemplateDefaultWorkflowUserDtl Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving TemplateDefaultWorkflowUserDtl"
            Save_TemplateDefaultWorkflowUserDtl = False
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "Save_WorkspaceDefaultWorkflowUserDtl"
    Public Function Save_WorkspaceDefaultWorkflowUserDtl(ByVal Choice As DataObjOpenSaveModeEnum, _
                                                        ByVal Ds_WorkspaceDefaultWorkflowUserDtl As Data.DataSet, _
                                                        ByVal objHdrogic As ClsDataLogic_New, _
                                                        ByVal UserCode_1 As String, _
                                                        ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing
        Dim objDtLogic As New ClsDataLogic_New
        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim Instr_WorkspaceDefaultWorkflowUserDtlId As String = ""

        Dim ObjHelpDbTable As New clsHelpDbTable

        Dim Tbl_Workspacenodedetail As New Data.DataTable
        Dim Tbl_WorkspaceDefaultWorkflowUserDtl As New Data.DataTable
        Dim objCommon As New clsCommon

        Try


            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()


            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_WorkspaceDefaultWorkflowUserDtl Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_WorkspaceDefaultWorkflowUserDtl.Tables("View_WorkspaceDefaultWorkflowUserDtl").Rows

                    Instr_WorkspaceDefaultWorkflowUserDtlId += IIf(Instr_WorkspaceDefaultWorkflowUserDtlId = "", "", ",").ToString + _
                                      tr("nWorkspaceDefaultWorkflowUserId").ToString.Trim()

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of WorkspaceDefaultWorkflowUserDtl
            If Not objHelpDbTbl.View_WorkspaceDefaultWorkflowUserDtl("nWorkspaceDefaultWorkflowUserId In (" + Instr_WorkspaceDefaultWorkflowUserDtlId + ")", dataRet_1, _
                                            objHdrogic, Tbl_WorkspaceDefaultWorkflowUserDtl, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving WorkspaceDefaultWorkflowUserDtl"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objHdrogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nWorkspaceDefaultWorkflowUserId"

            If Not objSave.AssignValues(Tbl_WorkspaceDefaultWorkflowUserDtl.TableName, PkColArr, Choice, _
                                        Ds_WorkspaceDefaultWorkflowUserDtl.Tables(Tbl_WorkspaceDefaultWorkflowUserDtl.TableName), _
                                        Tbl_WorkspaceDefaultWorkflowUserDtl, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If




            If Not objSave.SaveInDb("Insert_WorkspaceDefaultWorkflowUserDtl", Tbl_WorkspaceDefaultWorkflowUserDtl, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of WorkspaceDefaultWorkflowUserDtl In Database"
                Exit Function
            End If


            Save_WorkspaceDefaultWorkflowUserDtl = True

            If Save_WorkspaceDefaultWorkflowUserDtl Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            objDtLogic.RollBack_Transaction()
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving WorkspaceDefaultWorkflowUserDtl"
            Save_WorkspaceDefaultWorkflowUserDtl = False
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "Proc_CopyProjects"
    Public Function Proc_CopyProjects(ByVal Choice As DataObjOpenSaveModeEnum, _
                                     ByVal Ds_WorkspaceMst As DataSet, _
                                     ByVal UserCode_1 As String, _
                                     ByRef RequestId As String, _
                                     ByRef Retu_WorkspaceId As String, _
                                     ByRef eStr_Retu As String) As Boolean

        Dim objDtLogic As New ClsDataLogic_New()

        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_WorkspaceMst As Data.DataTable = Nothing
        Dim Tbl_WorkspaceMst_Old As Data.DataTable = Nothing

        Dim Instr_WorkspaceId As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            'Logic Of save Start
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_WorkspaceMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            Tbl_WorkspaceMst = New DataTable()

            Tbl_WorkspaceMst = Ds_WorkspaceMst.Tables("WorkspaceMst")

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)


            'Select * from WorkSpaceMst--Insert_Workspace
            'Select * from WorkSpaceProtocolDetail--Insert_WorkSpaceProtocolDetail
            'Select * from WorkSpaceNodeDetail--Insert_Workspace
            'Select * from WorkSpaceNodeAttrDetail--Insert_Workspace
            'Select * from WorkspaceNodeAttrHistory--Insert_Workspace--For StartDate and End Date of First Activity like create first time create project

            'Select * from WorkSpaceWorkflowUserDtl--If User='Y'--Insert_WorkSpaceWorkflowUserDtl
            'Select * from WorkspaceDefaultWorkflowUserDtl--If User='Y'--Insert_WorkspaceDefaultWorkflowUserDtl

            'Select * from WorkSpaceNodeHistory--If Doc='Y'--Insert_WorkSpaceNodeHistory

            'Select * from MedExWorkSpaceDtl--If Attribute='Y'--Insert_MedExWorkSpaceDtl
            'Select * from MedExWorkSpaceHdr--If Attribute='Y'--Insert_MedExWorkSpaceHdr

            ' Save As WorkSpaceMst
            If Not objSave.SaveInDb("Proc_CopyProjects", Tbl_WorkspaceMst, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Saving Project Status In Database"
                Exit Function
            End If

            DataReturnList = DataReturnList.Item(0)
            RetuVal = DataReturnList.Item(0)
            If Not CType(DataReturnList.Item(0), ParameterReturnValue) Is Nothing Then
                If CType(DataReturnList.Item(0), ParameterReturnValue).ParameterName.ToUpper = "@VREQUESTID" Then
                    RequestId = CType(DataReturnList.Item(0), ParameterReturnValue).ParameterValue
                Else
                    Throw New Exception("Parameter: RequestId not Found")
                End If
            End If

            RetuVal = DataReturnList.Item(1)
            If Not CType(DataReturnList.Item(1), ParameterReturnValue) Is Nothing Then
                If CType(DataReturnList.Item(1), ParameterReturnValue).ParameterName.ToUpper = "@RETU_WORKSPACEID" Then
                    Retu_WorkspaceId = CType(DataReturnList.Item(1), ParameterReturnValue).ParameterValue
                Else
                    Throw New Exception("Parameter: Retu_WorkspaceId not Found")
                End If
            End If


            Proc_CopyProjects = True

            If Proc_CopyProjects Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

            objDtLogic.Close_Connection()
        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while Copying Project Chranges"
            Proc_CopyProjects = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region

#Region "ProjectgroupMst"
    Public Function Save_ProjectgroupMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_ProjectgroupMst As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_ProjectgroupMst As Data.DataTable = Nothing
        Dim Tbl_ProjectgroupContactMatrix As Data.DataTable = Nothing

        Dim Instr_ProjectgroupNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim ReturnValueList As New ParameterReturnValue

        Try
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_ProjectgroupMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Or _
               Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Delete Then

                For Each tr As Data.DataRow In Ds_ProjectgroupMst.Tables("ProjectgroupMst").Rows

                    Instr_ProjectgroupNo += IIf(Instr_ProjectgroupNo = "", "", ",").ToString + _
                                    tr("nProjectgroupNo").ToString

                Next tr

            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of ProjectgroupMst
            If Not objHelpDbTbl.GetProjectgroupMst("nProjectgroupNo In (" + Instr_ProjectgroupNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_ProjectgroupMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving Projectgroup Master"
                Exit Function
            End If

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nProjectgroupNo"

            If Not objSave.AssignValues(Tbl_ProjectgroupMst.TableName, PkColArr, Choice, _
                                        Ds_ProjectgroupMst.Tables(Tbl_ProjectgroupMst.TableName), _
                                        Tbl_ProjectgroupMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in Projectgroup Master
            If Not objSave.SaveInDb("Insert_Projectgroupmst", Tbl_ProjectgroupMst, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of Projectgroup Master In Database"
                Exit Function
            End If

            Save_ProjectgroupMst = True

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Projectgroup Master"
            Save_ProjectgroupMst = False
        End Try

    End Function
#End Region

#Region "ProjectgroupWorkspaceMatrix"
    Public Function Save_ProjectgroupWorkspaceMatrix(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_ProjectgroupWorkspaceMatrix As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_ProjectgroupWorkspaceMatrix As Data.DataTable = Nothing
        Dim Tbl_ProjectgroupContactMatrix As Data.DataTable = Nothing

        Dim Instr_ProjectGroupWorkspaceMatrixNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim ReturnValueList As New ParameterReturnValue

        Try
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_ProjectgroupWorkspaceMatrix Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_ProjectgroupWorkspaceMatrix.Tables("ProjectgroupWorkspaceMatrix").Rows

                    Instr_ProjectGroupWorkspaceMatrixNo += IIf(Instr_ProjectGroupWorkspaceMatrixNo = "", "", ",").ToString + _
                                    tr("nProjectgroupNo").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of ProjectgroupWorkspaceMatrix
            If Not objHelpDbTbl.GetProjectgroupWorkspaceMatrix("nProjectGroupWorkspaceMatrixNo In (" + Instr_ProjectGroupWorkspaceMatrixNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_ProjectgroupWorkspaceMatrix, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving ProjectGroupWorkspaceMatrix"
                Exit Function
            End If

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            'Changed according to RoleOperationMatrix logic

            PkColArr(0) = "nProjectGroupWorkspaceMatrixNo"

            Ds_ProjectgroupWorkspaceMatrix.Tables(0).DefaultView.RowFilter = "nProjectGroupWorkspaceMatrixNo>0"
            Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit

            ' Save in Projectgroup Master
            If Not objSave.SaveInDb("Insert_ProjectgroupWorkspaceMatrix", Ds_ProjectgroupWorkspaceMatrix.Tables(Tbl_ProjectgroupWorkspaceMatrix.TableName).DefaultView.ToTable(), Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of ProjectGroupWorkspaceMatrix In Database"
                Exit Function
            End If

            Tbl_ProjectgroupWorkspaceMatrix.Clear()

            Ds_ProjectgroupWorkspaceMatrix.Tables(0).DefaultView.RowFilter = "nProjectGroupWorkspaceMatrixNo<0"
            Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add

            If Not objSave.SaveInDb("Insert_ProjectgroupWorkspaceMatrix", Ds_ProjectgroupWorkspaceMatrix.Tables(Tbl_ProjectgroupWorkspaceMatrix.TableName).DefaultView.ToTable(), Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of ProjectGroupWorkspaceMatrix In Database"
                Exit Function
            End If

            Save_ProjectgroupWorkspaceMatrix = True

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving ProjectGroupWorkspaceMatrix"
            Save_ProjectgroupWorkspaceMatrix = False
        End Try

    End Function
#End Region

#Region "AgeGroupMst"
    Public Function Save_AgeGroupMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_AgeGroupMst As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_AgeGroupMst As Data.DataTable = Nothing
        Dim Instr_AgeGroupNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_AgeGroupMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_AgeGroupMst.Tables("AgeGroupMst").Rows

                    Instr_AgeGroupNo += IIf(Instr_AgeGroupNo = "", "", ",").ToString + _
                                    tr("nAgeGroupNo").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of AgeGroupMst
            If Not objHelpDbTbl.GetAgeGroupMst("nAgeGroupNo In (" + Instr_AgeGroupNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_AgeGroupMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving AgeGroup Master"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nAgeGroupNo"

            If Not objSave.AssignValues(Tbl_AgeGroupMst.TableName, PkColArr, Choice, _
                                        Ds_AgeGroupMst.Tables(Tbl_AgeGroupMst.TableName), _
                                        Tbl_AgeGroupMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in AgeGroup Master
            If Not objSave.SaveInDb("Insert_AgeGroupMst", Tbl_AgeGroupMst, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of AgeGroup Master In Database"
                Exit Function
            End If

            Save_AgeGroupMst = True

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving AgeGroup Master"
            Save_AgeGroupMst = False
        End Try

    End Function
#End Region

#Region "Save_SampleTypeDetail"
    Public Function Save_SampleTypeDetail(ByVal Choice As DataObjOpenSaveModeEnum, _
                                                        ByVal Ds_SampleTypeDetail As Data.DataSet, _
                                                        ByVal objHdrogic As ClsDataLogic_New, _
                                                        ByVal UserCode_1 As String, _
                                                        ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing
        Dim objDtLogic As New ClsDataLogic_New
        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim Instr_SampleTypeDetailId As String = ""

        Dim ObjHelpDbTable As New clsHelpDbTable

        Dim Tbl_Workspacenodedetail As New Data.DataTable
        Dim Tbl_SampleTypeDetail As New Data.DataTable
        Dim objCommon As New clsCommon

        Try


            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()


            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_SampleTypeDetail Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_SampleTypeDetail.Tables("SampleTypeDetail").Rows

                    Instr_SampleTypeDetailId += IIf(Instr_SampleTypeDetailId = "", "", ",").ToString + _
                                      tr("nSampleTypeDetailNo").ToString.Trim()

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of SampleTypeDetail
            If Not objHelpDbTbl.getSampleTypeDetail("nSampleTypeDetailNo In (" + Instr_SampleTypeDetailId + ")", dataRet_1, _
                                            objHdrogic, Tbl_SampleTypeDetail, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving SampleTypeDetail"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objHdrogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nSampleTypeDetailNo"

            If Not objSave.AssignValues(Tbl_SampleTypeDetail.TableName, PkColArr, Choice, _
                                        Ds_SampleTypeDetail.Tables(Tbl_SampleTypeDetail.TableName), _
                                        Tbl_SampleTypeDetail, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If




            If Not objSave.SaveInDb("Insert_SampleTypeDetail", Tbl_SampleTypeDetail, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of SampleTypeDetail In Database"
                Exit Function
            End If


            Save_SampleTypeDetail = True

            If Save_SampleTypeDetail Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            objDtLogic.RollBack_Transaction()
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving SampleTypeDetail"
            Save_SampleTypeDetail = False
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region
    '-----------------------------------------------
#Region "MedExRangeMst"
    Public Function Save_MedExRangeMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_MedExRangeMst As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_MedExRangeMst As Data.DataTable = Nothing
        Dim Instr_MedExRangeNo As String = ""


        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_MedExRangeMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_MedExRangeMst.Tables("MedExRangeMst").Rows

                    Instr_MedExRangeNo += IIf(Instr_MedExRangeNo = "", "", ",").ToString + _
                                    tr("nMedExRangeNo").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of MedExRangeMst
            If Not objHelpDbTbl.getMedExRangeMst("nMedExRangeNo In (" + Instr_MedExRangeNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_MedExRangeMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving MedExRange Master"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nMedExRangeNo"

            If Not objSave.AssignValues(Tbl_MedExRangeMst.TableName, PkColArr, Choice, _
                                        Ds_MedExRangeMst.Tables(Tbl_MedExRangeMst.TableName), _
                                        Tbl_MedExRangeMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in MedExRange Master
            If Not objSave.SaveInDb("Insert_MedExRangeMst", Tbl_MedExRangeMst, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of MedExRange Master In Database"
                Exit Function
            End If

            Save_MedExRangeMst = True

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving MedExRange Master"
            Save_MedExRangeMst = False
        End Try

    End Function
#End Region

#Region "LabTypeMst"
    Public Function Save_LabTypeMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_LabTypeMst As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_LabTypeMst As Data.DataTable = Nothing
        Dim Instr_LabTypeNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_LabTypeMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_LabTypeMst.Tables("LabTypeMst").Rows

                    Instr_LabTypeNo += IIf(Instr_LabTypeNo = "", "", ",").ToString + _
                                    tr("nLabTypeNo").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of LabTypeMst
            If Not objHelpDbTbl.getLabTypeMst("nLabTypeNo In (" + Instr_LabTypeNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_LabTypeMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving LabType Master"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nLabTypeNo"

            If Not objSave.AssignValues(Tbl_LabTypeMst.TableName, PkColArr, Choice, _
                                        Ds_LabTypeMst.Tables(Tbl_LabTypeMst.TableName), _
                                        Tbl_LabTypeMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in LabType Master
            If Not objSave.SaveInDb("Insert_LabTypeMst", Tbl_LabTypeMst, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of LabType Master In Database"
                Exit Function
            End If

            Save_LabTypeMst = True

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving LabType Master"
            Save_LabTypeMst = False
        End Try

    End Function
#End Region

#Region "MedExCostMst"
    Public Function Save_MedExCostMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_MedExCostMst As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_MedExCostMst As Data.DataTable = Nothing
        Dim Instr_MedExCostCode As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_MedExCostMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_MedExCostMst.Tables("MedExCostMst").Rows

                    Instr_MedExCostCode += IIf(Instr_MedExCostCode = "", "", ",").ToString + _
                                    tr("nMedExCostCode").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of MedExCostMst
            If Not objHelpDbTbl.getMedExCostMst("nMedExCostCode In (" + Instr_MedExCostCode + ")", dataRet_1, _
                                            objDtLogic, Tbl_MedExCostMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving MedExCost Master"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nMedExCostCode"

            If Not objSave.AssignValues(Tbl_MedExCostMst.TableName, PkColArr, Choice, _
                                        Ds_MedExCostMst.Tables(Tbl_MedExCostMst.TableName), _
                                        Tbl_MedExCostMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in MedExCost Master
            If Not objSave.SaveInDb("Insert_MedExCostMst", Tbl_MedExCostMst, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of MedExCost Master In Database"
                Exit Function
            End If

            Save_MedExCostMst = True

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving MedExCost Master"
            Save_MedExCostMst = False
        End Try

    End Function
#End Region

#Region "CurrencyMst"
    Public Function Save_CurrencyMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_CurrencyMst As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_CurrencyMst As Data.DataTable = Nothing
        Dim Instr_CurrencyNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_CurrencyMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_CurrencyMst.Tables("CurrencyMst").Rows

                    Instr_CurrencyNo += IIf(Instr_CurrencyNo = "", "", ",").ToString + _
                                    tr("nCurrencyNo").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of CurrencyMst
            If Not objHelpDbTbl.getCurrencyMst("nCurrencyNo In (" + Instr_CurrencyNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_CurrencyMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving Currency Master"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nCurrencyNo"

            If Not objSave.AssignValues(Tbl_CurrencyMst.TableName, PkColArr, Choice, _
                                        Ds_CurrencyMst.Tables(Tbl_CurrencyMst.TableName), _
                                        Tbl_CurrencyMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in Currency Master
            If Not objSave.SaveInDb("Insert_CurrencyMst", Tbl_CurrencyMst, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of Currency Master In Database"
                Exit Function
            End If

            Save_CurrencyMst = True

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Currency Master"
            Save_CurrencyMst = False
        End Try

    End Function
#End Region

#Region "SampleTypeMst"
    Public Function Save_SampleTypeMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_SampleTypeMst As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_SampleTypeMst As Data.DataTable = Nothing
        Dim Instr_SampleTypeMstNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_SampleTypeMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_SampleTypeMst.Tables("SampleTypeMst").Rows

                    Instr_SampleTypeMstNo += IIf(Instr_SampleTypeMstNo = "", "", ",").ToString + _
                                    tr("nSampleTypeMstNo").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of SampleTypeMst
            If Not objHelpDbTbl.getSampleTypeMst("nSampleTypeMstNo In (" + Instr_SampleTypeMstNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_SampleTypeMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving SampleType Master"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nSampleTypeMstNo"

            If Not objSave.AssignValues(Tbl_SampleTypeMst.TableName, PkColArr, Choice, _
                                        Ds_SampleTypeMst.Tables(Tbl_SampleTypeMst.TableName), _
                                        Tbl_SampleTypeMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in SampleType Master
            If Not objSave.SaveInDb("Insert_SampleTypeMst", Tbl_SampleTypeMst, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of SampleType Master In Database"
                Exit Function
            End If

            Save_SampleTypeMst = True

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving SampleType Master"
            Save_SampleTypeMst = False
        End Try

    End Function
#End Region

#Region "LabMachineMedexMatrix"

    Public Function Save_LabMachineMedexMatrix(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_LabMachineMedexMatrix As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_LabMachineMedexMatrix As Data.DataTable = Nothing
        Dim Tbl_ProjectgroupContactMatrix As Data.DataTable = Nothing

        Dim Instr_LabMachineMedexMatrixNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim ReturnValueList As New ParameterReturnValue

        Try
            eStr_Retu = ""

            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_LabMachineMedexMatrix Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_LabMachineMedexMatrix.Tables("LabMachineMedexMatrix").Rows

                    Instr_LabMachineMedexMatrixNo += IIf(Instr_LabMachineMedexMatrixNo = "", "", ",").ToString + _
                                    tr("nLabMachineMedExMatrixNo").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of LabMachineMedexMatrix
            If Not objHelpDbTbl.getLabMachineMedexMatrix("nLabMachineMedexMatrixNo In (" + Instr_LabMachineMedexMatrixNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_LabMachineMedexMatrix, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving LabMachineMedexMatrix"
                Exit Function
            End If

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            'Changed according to LabMachineMedexMatrix logic
            '' Commented by Rahul Rupareliya     Reason LabMachine not insertd new Entry

            'PkColArr(0) = "nLabMachineMedexMatrixNo"

            'Ds_LabMachineMedexMatrix.Tables(0).DefaultView.RowFilter = "nLabMachineMedexMatrixNo>0"
            'Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit

            '' Save in LabMachineMedexMatrix
            'If Not objSave.SaveInDb("Insert_LabMachineMedexMatrix", Ds_LabMachineMedexMatrix.Tables(Tbl_LabMachineMedexMatrix.TableName).DefaultView.ToTable(), Choice, DataReturnList, eStr_Retu) Then
            '    eStr_Retu += vbCrLf + "Error occured while Save Information of LabMachineMedexMatrix In Database"
            '    Exit Function
            'End If

            'Tbl_LabMachineMedexMatrix.Clear()

            'Ds_LabMachineMedexMatrix.Tables(0).DefaultView.RowFilter = "nLabMachineMedexMatrixNo<0"
            'Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add

            '' Comment Ended 

            If Not objSave.SaveInDb("Insert_LabMachineMedexMatrix", Ds_LabMachineMedexMatrix.Tables(Tbl_LabMachineMedexMatrix.TableName).DefaultView.ToTable(), Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of LabMachineMedexMatrix In Database"
                Exit Function
            End If

            Save_LabMachineMedexMatrix = True

            If Save_LabMachineMedexMatrix Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            objDtLogic.RollBack_Transaction()
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving LabMachineMedexMatrix"
            Save_LabMachineMedexMatrix = False
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function

#End Region

#Region "SubjectRejectionDetail"

    Public Function Save_SubjectRejectionDetail(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_SubjectRejectionDetail As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_SubjectRejectionDetail As Data.DataTable = Nothing

        Dim Instr_SubjectRejectionNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim ReturnValueList As New ParameterReturnValue

        Try
            eStr_Retu = ""

            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_SubjectRejectionDetail Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_SubjectRejectionDetail.Tables("SubjectRejectionDetail").Rows

                    Instr_SubjectRejectionNo += IIf(Instr_SubjectRejectionNo = "", "", ",").ToString + _
                                    tr("nSubjectRejectionNo").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of SubjectRejectionDetail
            If Not objHelpDbTbl.GetSubjectRejectionDetail("nSubjectRejectionNo In (" + Instr_SubjectRejectionNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_SubjectRejectionDetail, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving SubjectRejectionDetail"
                Exit Function
            End If

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nSubjectRejectionNo"

            ' Save in SubjectRejectionDetail
            If Not objSave.SaveInDb("Insert_SubjectRejectionDetail", Ds_SubjectRejectionDetail.Tables(Tbl_SubjectRejectionDetail.TableName).DefaultView.ToTable(), Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of LabMachineMedexMatrix In Database"
                Exit Function
            End If

            If Not IsNothing(Ds_SubjectRejectionDetail.Tables("View_SubjectMaster")) Then

                ' Save in SubjectMaster and always Update RejectionFlag
                If Not objSave.SaveInDb("Insert_SubjectMaster", Ds_SubjectRejectionDetail.Tables("View_SubjectMaster").DefaultView.ToTable(), DataObjOpenSaveModeEnum.DataObjOpenMode_Edit, Nothing, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of LabMachineMedexMatrix In Database"
                    Exit Function
                End If

            End If

            Save_SubjectRejectionDetail = True

            If Save_SubjectRejectionDetail Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            objDtLogic.RollBack_Transaction()
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving SubjectRejectionDetail"
            Save_SubjectRejectionDetail = False
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function

#End Region

#Region "SubjectScreeningRecordDetail"

    Public Function Save_SubjectScreeningRecordDetail(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_SubjectScreeningRecordDetail As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_SubjectScreeningRecordDetail As Data.DataTable = Nothing

        Dim Instr_SubjectScreeningRecordNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim ReturnValueList As New ParameterReturnValue

        Try
            eStr_Retu = ""

            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_SubjectScreeningRecordDetail Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_SubjectScreeningRecordDetail.Tables("SubjectScreeningRecordDetail").Rows

                    Instr_SubjectScreeningRecordNo += IIf(Instr_SubjectScreeningRecordNo = "", "", ",").ToString + _
                                    tr("nSubjectScreeningRecordNo").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of SubjectScreeningRecordDetail
            If Not objHelpDbTbl.GetSubjectScreeningRecordDetail("nSubjectScreeningRecordNo In (" + Instr_SubjectScreeningRecordNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_SubjectScreeningRecordDetail, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving SubjectScreeningRecordDetail"
                Exit Function
            End If

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nSubjectScreeningRecordNo"

            ' Save in SubjectScreeningRecordDetail
            If Not objSave.SaveInDb("Insert_SubjectScreeningRecordDetail", Ds_SubjectScreeningRecordDetail.Tables(Tbl_SubjectScreeningRecordDetail.TableName).DefaultView.ToTable(), Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of SubjectScreeningRecordDetail In Database"
                Exit Function
            End If

            Save_SubjectScreeningRecordDetail = True

            If Save_SubjectScreeningRecordDetail Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            objDtLogic.RollBack_Transaction()
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving SubjectScreeningRecordDetail"
            Save_SubjectScreeningRecordDetail = False
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function

#End Region

#Region "Insert_ChangePassword"

    Public Function Insert_ChangePassword(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_ChangePassword As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_CheckInOutMst As Data.DataTable = Nothing
        Dim Instr_nSrNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            eStr_Retu = ""

            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_ChangePassword Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                'For Each tr As Data.DataRow In Ds_ChangePassword.Tables("CheckInOutMst").Rows

                '    Instr_nSrNo += IIf(Instr_nSrNo = "", "", ",").ToString + _
                '                    tr("nSrNo").ToString

                'Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of UserGroupMst
            'If Not objHelpDbTbl.GetCheckInOutMst("nSrNo In (" + Instr_nSrNo + ")", dataRet_1, _
            '                                objDtLogic, Tbl_CheckInOutMst, eStr_Retu) Then

            '    eStr_Retu += vbCrLf + "Error occured while retrieving from CheckInOutMst"
            '    Exit Function
            'End If

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            'PkColArr(0) = "nSrNo"


            'Tbl_CheckInOutMst.TableName = "UserMst"

            'If Not objSave.AssignValues(Tbl_CheckInOutMst.TableName, PkColArr, Choice, _
            '                           Ds_CheckInOutMst.Tables(Tbl_CheckInOutMst.TableName).DefaultView.ToTable(), _
            '                           Tbl_CheckInOutMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
            '    eStr_Retu += vbCrLf + "Error occured while assigning values"
            '    Exit Function
            'End If

            ' Save in User Master
            If Not objSave.SaveInDb("Insert_ChangePassword", Ds_ChangePassword.Tables(0), Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Changing Password and Saving in Database"
                Exit Function
            End If

            Insert_ChangePassword = True

            If Insert_ChangePassword Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            objDtLogic.RollBack_Transaction()
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving ChangePassword"
            Insert_ChangePassword = False
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function

#End Region

#Region "ReasonMst"
    Public Function Save_ReasonMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                       ByVal Ds_ReasonMst As Data.DataSet, _
                                       ByVal objDtLogic As ClsDataLogic_New, _
                                       ByVal UserCode_1 As String, _
                                       ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_ReasonMst As Data.DataTable = Nothing
        Dim Instr_ReasonNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_ReasonMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_ReasonMst.Tables("ReasonMst").Rows

                    Instr_ReasonNo += IIf(Instr_ReasonNo = "", "", ",").ToString + _
                                    tr("nReasonNo").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of ReasonMst
            If Not objHelpDbTbl.GetReasonMst("nReasonNo In (" + Instr_ReasonNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_ReasonMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving Reason Master"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nReasonNo"

            If Not objSave.AssignValues(Tbl_ReasonMst.TableName, PkColArr, Choice, _
                                        Ds_ReasonMst.Tables(Tbl_ReasonMst.TableName), _
                                        Tbl_ReasonMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in Reason Master
            If Not objSave.SaveInDb("Insert_ReasonMst", Tbl_ReasonMst, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of Reason Master In Database"
                Exit Function
            End If
            Save_ReasonMst = True

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Reason Master"
            Save_ReasonMst = False
        End Try

    End Function
#End Region

#Region "DosingDetail"

    Public Function Save_DosingDetail(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_DosingDetail As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef BarCodes_Retu As String, _
                                        ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_DosingDetail As Data.DataTable = Nothing

        Dim Instr_DosingDetailNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim DataReturnList1 As New ArrayList
        Dim ReturnValueList As New ParameterReturnValue

        Try
            eStr_Retu = ""

            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_DosingDetail Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called

            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                For Each tr As Data.DataRow In Ds_DosingDetail.Tables("DosingDetail").Rows

                    Instr_DosingDetailNo += IIf(Instr_DosingDetailNo = "", "", ",").ToString + _
                                    tr("nDosingDetailNo").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of DosingDetail
            If Not objHelpDbTbl.GetDosingDetail("nDosingDetailNo In (" + Instr_DosingDetailNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_DosingDetail, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving DosingDetail"
                Exit Function
            End If

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nDosingDetailNo"

            ' Save in DosingDetail
            If Not objSave.SaveInDb("Insert_DosingDetail", Ds_DosingDetail.Tables(Tbl_DosingDetail.TableName), Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of DosingDetail In Database"
                Exit Function
            End If

            For itm As Integer = 0 To DataReturnList.Count - 1

                DataReturnList1 = DataReturnList.Item(itm)
                ReturnValueList = DataReturnList1.Item(0)
                BarCodes_Retu += ReturnValueList.ParameterValue + IIf(itm < DataReturnList.Count - 1, ",", "")

                If ReturnValueList.ParameterValue = "0" Then
                    eStr_Retu = "Dosing already done for this Subject, Kindly wait till the process ends."
                    Save_DosingDetail = False
                    objDtLogic.RollBack_Transaction()
                    Exit Function
                End If

            Next

            '******************************************

            If Ds_DosingDetail.Tables.Contains("CRFHdr") AndAlso _
                Ds_DosingDetail.Tables.Contains("CRFDtl") AndAlso _
                Ds_DosingDetail.Tables.Contains("CRFSubDtl") Then

                Dim Tbl_CRFDtl As Data.DataTable = Nothing
                Dim Tbl_CRFSubDtl As Data.DataTable = Nothing
                Dim Tbl_CRFHdr As Data.DataTable = Nothing
                Dim RetuVal As ParameterReturnValue = Nothing
                Dim DataReturnList_CRF As New ArrayList

                Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add

                Tbl_CRFHdr = Ds_DosingDetail.Tables("CRFHdr")
                Tbl_CRFDtl = Ds_DosingDetail.Tables("CRFDtl")
                Tbl_CRFSubDtl = Ds_DosingDetail.Tables("CRFSubDtl")

                ' Save in CRFHdr
                If Not objSave.SaveInDb("Insert_CRFHdr", Tbl_CRFHdr, Choice, DataReturnList_CRF, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of CRFHdr In Database"
                    Exit Function
                End If
                'Assiging New HdrNo 
                DataReturnList_CRF = DataReturnList_CRF.Item(0)
                RetuVal = DataReturnList_CRF.Item(0)
                For Each dr In Tbl_CRFDtl.Rows
                    dr("nCRFHdrNo") = RetuVal.ParameterValue
                    dr("iRepeatNo") = 1
                    dr.AcceptChanges()
                Next
                Tbl_CRFDtl.AcceptChanges()
                '********************************************

                ' Save in CRFDtl
                DataReturnList_CRF = Nothing
                DataReturnList_CRF = New ArrayList
                If Not objSave.SaveInDb("Insert_CRFDtl", Tbl_CRFDtl, Choice, DataReturnList_CRF, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of CRFDtl In Database"
                    Exit Function
                End If
                '*************************************

                'Assiging New DtlNo 
                DataReturnList_CRF = DataReturnList_CRF.Item(0)
                RetuVal = DataReturnList_CRF.Item(0)

                '*************************************

                For Each dr In Tbl_CRFSubDtl.Rows
                    dr("nCRFDtlNo") = RetuVal.ParameterValue
                    dr.AcceptChanges()
                Next
                Tbl_CRFSubDtl.AcceptChanges()

                ' Save in CRFSubDtl
                DataReturnList_CRF = Nothing
                DataReturnList_CRF = New ArrayList

                If Not objSave.SaveInDb("Insert_CRFSubDtl", Tbl_CRFSubDtl, Choice, DataReturnList_CRF, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of CRFDtl In Database"
                    Exit Function
                End If
                '*************************************

            End If

            '******************************************

            Save_DosingDetail = True

            If Save_DosingDetail Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            objDtLogic.RollBack_Transaction()
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving DosingDetail"
            Save_DosingDetail = False
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function

#End Region

#Region "RandomizationDetail"

    Public Function Save_RandomizationDetail(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_RandomizationDetail As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_RandomizationDetail As Data.DataTable = Nothing

        Dim Instr_RandomizationDetailNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim ReturnValueList As New ParameterReturnValue

        Try
            eStr_Retu = ""

            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_RandomizationDetail Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_RandomizationDetail.Tables("RandomizationDetail").Rows

                    Instr_RandomizationDetailNo += IIf(Instr_RandomizationDetailNo = "", "", ",").ToString + _
                                    tr("nRendomizationNo").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of RandomizationDetail
            If Not objHelpDbTbl.GetRandomizationDetail("nRendomizationNo In (" + Instr_RandomizationDetailNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_RandomizationDetail, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving RandomizationDetail"
                Exit Function
            End If

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nRendomizationNo"

            ' Save in RandomizationDetail
            If Not objSave.SaveInDb("Insert_RandomizationDetail", Ds_RandomizationDetail.Tables(Tbl_RandomizationDetail.TableName).DefaultView.ToTable(), Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of RandomizationDetail In Database"
                Exit Function
            End If

            Save_RandomizationDetail = True

            If Save_RandomizationDetail Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            objDtLogic.RollBack_Transaction()
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving RandomizationDetail"
            Save_RandomizationDetail = False
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function

#End Region

    '*******************************************************
    ' Added By Vishal Astik
    '*******************************************************

#Region "ActivityMst"
    Public Function Save_ActivityMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                   ByVal Ds_ActivityMst As Data.DataSet, _
                                   ByVal objDtLogic As ClsDataLogic_New, _
                                   ByVal UserCode_1 As String, _
                                   ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_ActivityMst As Data.DataTable = Nothing
        Dim Tbl_ActivityDocLinkMatrix As Data.DataTable = Nothing
        Dim Tbl_ActivityMedExTemplateDtl As Data.DataTable = Nothing

        Dim Instr_ActivityId As String = ""

        Dim PkColArr(0) As String

        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing
        Dim dr As DataRow

        Try
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_ActivityMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_ActivityMst.Tables("ActivityMst").Rows

                    Instr_ActivityId += IIf(Instr_ActivityId = "", "", ",").ToString + _
                                    tr("vActivityId").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of Activity Master
            If Not objHelpDbTbl.getActivityMst("vActivityId In (" + Instr_ActivityId + ")", dataRet_1, _
                                            objDtLogic, Tbl_ActivityMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving Activity Master"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vActivityId"

            If Not objSave.AssignValues(Tbl_ActivityMst.TableName, PkColArr, Choice, _
                                        Ds_ActivityMst.Tables(Tbl_ActivityMst.TableName), _
                                        Tbl_ActivityMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in Activity Master
            If Not objSave.SaveInDb("Insert_ActivityMst", Tbl_ActivityMst, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of Activity Master In Database"
                Exit Function
            End If

            DataReturnList = DataReturnList.Item(0)
            RetuVal = DataReturnList.Item(0)

            '-------------Added on 30-May-2009 by Chandresh Vanker for ActivityMedExTemplateDtl
            If Ds_ActivityMst.Tables.Count > 1 Then
                Tbl_ActivityMedExTemplateDtl = Ds_ActivityMst.Tables("ActivityMedExTemplateDtl")

                For Each dr In Tbl_ActivityMedExTemplateDtl.Rows
                    dr("vActivityId") = RetuVal.ParameterValue
                Next dr
                Tbl_ActivityMedExTemplateDtl.AcceptChanges()

                ' Save in Insert_ActivityMedExTemplateDtl
                If Not objSave.SaveInDb("Insert_ActivityMedExTemplateDtl", Tbl_ActivityMedExTemplateDtl, Choice, Nothing, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of ActivityMedExTemplateDtl In Database"
                    Exit Function
                End If

            End If
            '-------------------------------

            If Ds_ActivityMst.Tables.Count > 2 Then
                Tbl_ActivityDocLinkMatrix = Ds_ActivityMst.Tables("ActivityDocLinkMatrix")

                For Each dr In Tbl_ActivityDocLinkMatrix.Rows
                    dr("vActivityId") = RetuVal.ParameterValue
                Next dr
                Tbl_ActivityDocLinkMatrix.AcceptChanges()

                ' Save in Insert_ActivityDocLinkMatrix
                If Not objSave.SaveInDb("Insert_ActivityDocLinkMatrix", Tbl_ActivityDocLinkMatrix, Choice, Nothing, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of ActivityDocLinkMatrix In Database"
                    Exit Function
                End If

            End If

            Save_ActivityMst = True

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Activity Master"
            Save_ActivityMst = False
        End Try

    End Function
#End Region

#Region "TemplateTypeMst"
    Public Function Save_TemplateTypeMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_TemplateTypeMst As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_TemplateTypeMst As Data.DataTable = Nothing
        Dim Instr_TemplateTypeCode As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_TemplateTypeMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_TemplateTypeMst.Tables("TemplateTypeMst").Rows

                    Instr_TemplateTypeCode += IIf(Instr_TemplateTypeCode = "", "", ",").ToString + _
                                    tr("vTemplateTypeCode").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)


            'Retrieval of TemplateTypeMst
            If Not objHelpDbTbl.GetTemplateTypeMst("vTemplateTypeCode In (" + Instr_TemplateTypeCode + ")", dataRet_1, _
                                            objDtLogic, Tbl_TemplateTypeMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving Stage Master"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vTemplateTypeCode"

            If Not objSave.AssignValues(Tbl_TemplateTypeMst.TableName, PkColArr, Choice, _
                                        Ds_TemplateTypeMst.Tables(Tbl_TemplateTypeMst.TableName), _
                                        Tbl_TemplateTypeMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in TemplateTypeMst
            If Not objSave.SaveInDb("Insert_TemplateTypeMst", Tbl_TemplateTypeMst, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of Template Type Master In Database"
                Exit Function
            End If

            Save_TemplateTypeMst = True

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving TemplateType Master"
            Save_TemplateTypeMst = False
        End Try

    End Function
#End Region

#Region "Save_InsertworkspaceSubjectComment"

    Public Function Save_InsertworkspaceSubjectComment(ByVal Choice As DataObjOpenSaveModeEnum, _
                                                          ByVal Ds_workspaceSubjectComment As DataSet, _
                                                          ByVal UserCode_1 As String, _
                                                          ByRef eStr_Retu As String) As Boolean

        Dim objDtLogic As New ClsDataLogic_New
        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_workspaceSubjectComment As Data.DataTable = Nothing
        Dim Instr_nWorkSpaceSubjectCommentNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_workspaceSubjectComment Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_workspaceSubjectComment.Tables("workspaceSubjectComment").Rows

                    Instr_nWorkSpaceSubjectCommentNo += IIf(Instr_nWorkSpaceSubjectCommentNo = "", "", ",").ToString + _
                                    tr("nWorkSpaceSubjectCommentNo").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of workspaceSubjectDocDetails
            If Not objHelpDbTbl.getWorkspaceSubjectComment("nWorkSpaceSubjectCommentNo In (" + Instr_nWorkSpaceSubjectCommentNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_workspaceSubjectComment, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving workspaceSubjectDocDetails"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nWorkSpaceSubjectCommentNo"

            If Not objSave.AssignValues(Tbl_workspaceSubjectComment.TableName, PkColArr, Choice, _
                                        Ds_workspaceSubjectComment.Tables(Tbl_workspaceSubjectComment.TableName), _
                                        Tbl_workspaceSubjectComment, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in workspaceSubjectDocDetails
            If Not objSave.SaveInDb("Insert_workspaceSubjectComment", Tbl_workspaceSubjectComment, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of workspaceSubjectDocDetails In Database"
                Exit Function
            End If

            Save_InsertworkspaceSubjectComment = True

            If Save_InsertworkspaceSubjectComment Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

            'objDtLogic.Close_Connection()
        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving workspaceSubjectDocDetails"
            Save_InsertworkspaceSubjectComment = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function

#End Region

#Region "Save_ProcChangeProjectStatus"
    Public Function Save_ProcChangeProjectStatus(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_WorkspaceMst As DataSet, _
                                 ByVal UserCode_1 As String, _
                                 ByRef eStr_Retu As String) As Boolean
        Dim objDtLogic As New ClsDataLogic_New()

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_WorkspaceMst As Data.DataTable = Nothing
        Dim Tbl_WorkspaceMst_Old As Data.DataTable = Nothing

        Dim Instr_WorkspaceId As String = ""

        Dim PkColArr(0) As String

        Dim DataReturnList As New ArrayList

        Dim RetuVal As ParameterReturnValue = Nothing


        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            'Logic Of save Start
            eStr_Retu = ""


            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_WorkspaceMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            Tbl_WorkspaceMst = New DataTable()

            Tbl_WorkspaceMst = Ds_WorkspaceMst.Tables("WorkspaceMst")

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_WorkspaceMst.Tables("WorkspaceMst").Rows

                    Instr_WorkspaceId += IIf(Instr_WorkspaceId = "", "", ",").ToString + _
                                    tr("vWorkspaceId").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            ' Save in WorkSpaceMst
            If Not objSave.SaveInDb("Proc_ChangeProjectStatus", Tbl_WorkspaceMst, Choice, Nothing, eStr_Retu, True) Then
                eStr_Retu += vbCrLf + "Error occured while Saving Project Status In Database"
                Exit Function
            End If

            Save_ProcChangeProjectStatus = True

            If Save_ProcChangeProjectStatus Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

            'objDtLogic.Close_Connection()
        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while changing Project Chranges"
            Save_ProcChangeProjectStatus = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region

#Region " Save_InsertHolidayMst "
    Public Function Save_InsertHolidayMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                       ByVal Ds_HolidayMst As Data.DataSet, _
                                       ByVal objDtLogic As ClsDataLogic_New, _
                                       ByVal UserCode_1 As String, _
                                       ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_HolidayMst As Data.DataTable = Nothing
        Dim Instr_HolidayNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_HolidayMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            Ds_HolidayMst.Tables(0).TableName = "View_HolidayMst"
            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_HolidayMst.Tables("View_HolidayMst").Rows

                    Instr_HolidayNo += IIf(Instr_HolidayNo = "", "", ",").ToString + _
                                    tr("iHolidayNo").ToString

                Next tr

            ElseIf Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Delete Then
                For Each tr As Data.DataRow In Ds_HolidayMst.Tables("View_HolidayMst").Rows

                    Instr_HolidayNo += IIf(Instr_HolidayNo = "", "", ",").ToString + _
                                    tr("iHolidayNo").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            Dim dsHoliday As New DataSet
            'Retrieval of HolidayMst

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then

                If Not objHelpDbTbl.GetViewHolidayMst("1=2", DataRetrievalModeEnum.DataTable_WithWhereCondition, dsHoliday, _
                                            eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while retrieving Holiday Master"
                    Exit Function
                Else
                    Tbl_HolidayMst = dsHoliday.Tables(0).Copy()
                    Tbl_HolidayMst.TableName = "View_HolidayMst"
                End If

            ElseIf Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then

                If Not objHelpDbTbl.GetViewHolidayMst("iHolidayNo In (" + Instr_HolidayNo + ")", DataRetrievalModeEnum.DataTable_WithWhereCondition, _
                                            dsHoliday, eStr_Retu) Then

                    eStr_Retu += vbCrLf + "Error occured while retrieving Holiday Master"
                    Exit Function
                Else
                    Tbl_HolidayMst = dsHoliday.Tables(0).Copy()
                    Tbl_HolidayMst.TableName = "View_HolidayMst"
                End If

            ElseIf Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Delete Then

                If Not objHelpDbTbl.GetViewHolidayMst("iHolidayNo In (" + Instr_HolidayNo + ")", DataRetrievalModeEnum.DataTable_WithWhereCondition, _
                                        dsHoliday, eStr_Retu) Then

                    eStr_Retu += vbCrLf + "Error occured while retrieving Holiday Master"
                    Exit Function
                Else
                    Tbl_HolidayMst = dsHoliday.Tables(0).Copy()
                    Tbl_HolidayMst.TableName = "View_HolidayMst"
                End If

            End If

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "iHolidayNo"

            If Not objSave.AssignValues(Tbl_HolidayMst.TableName, PkColArr, Choice, _
                                        Ds_HolidayMst.Tables(Tbl_HolidayMst.TableName), _
                                        Tbl_HolidayMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in Drug Master
            If Not objSave.SaveInDb("Insert_HolidayMst", Tbl_HolidayMst, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of Holiday Master In Database"
                Exit Function
            End If
            Save_InsertHolidayMst = True

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving HolidayMst"
            Save_InsertHolidayMst = False
        End Try

    End Function
#End Region

#Region "BulkCopy"
    Public Function BulkCopy(ByVal TableName As String, _
                                                          ByVal dsDataToSave As DataSet, _
                                                        ByRef eStr_Retu As String) As Boolean
        Dim objDtLogic As New ClsDataLogic_New
        Dim conn As SqlClient.SqlConnection
        Dim conStr As String = ""

        Try
            conStr = System.Web.Configuration.WebConfigurationManager.AppSettings("connstring").ToString
            conn = New SqlClient.SqlConnection(conStr)
            conn.Open()


            Dim myBulkCopy As SqlClient.SqlBulkCopy = New SqlClient.SqlBulkCopy(conn)

            myBulkCopy.DestinationTableName = TableName
            myBulkCopy.WriteToServer(dsDataToSave.Tables(0))

            BulkCopy = True

            If BulkCopy Then
                conn.Close()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message
            If conn.State <> ConnectionState.Closed Then
                conn.Close()
            End If
            BulkCopy = False
        End Try
    End Function
#End Region

    '====Created For:Archive Module======
    'Created By:Vikas Shah===============

#Region "insert_workspace"
    Public Function insert_workspace(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_WorkspaceStatusDetail As Data.DataSet, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime
        Dim Tbl_WorkspaceStatusDetail As Data.DataTable = Nothing
        Dim Instr_vWorkSpaceIDNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing
        Dim objHdrogic As New clsCommon

        Try
            eStr_Retu = ""
            objHdrogic.Open_Connection()
            objHdrogic.Begin_Transaction()

            If objHdrogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objHdrogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_WorkspaceStatusDetail Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            Tbl_WorkspaceStatusDetail = Ds_WorkspaceStatusDetail.Tables("WorkSpaceMst")


            'Function called only if edit is called
            'If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                For Each tr As Data.DataRow In Ds_WorkspaceStatusDetail.Tables("WorkSpaceMst").Rows

                    Instr_vWorkSpaceIDNo += IIf(Instr_vWorkSpaceIDNo = "", "", ",").ToString + _
                                      tr("vWorkSpaceId").ToString.Trim()

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objHdrogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objHdrogic)

            'Retrieval of CCSampleRetrievalMst
            'If Not objHelpDbTbl.GetCCSampleRetrievalMst("nCCSampleRetrievalMstNo In (" + Instr_vWorkSpaceIDNo + ")", dataRet_1, _
            '                                objHdrogic, Tbl_WorkspaceStatusDetail, eStr_Retu) Then

            '    eStr_Retu += vbCrLf + "Error occured while retrieving CCSampleRetrievalMst"
            '    Exit Function
            'End If


            'Assignment of Values
            PkColArr(0) = "vWorkSpaceId"

            If Not objSave.AssignValues(Tbl_WorkspaceStatusDetail.TableName, PkColArr, Choice, _
                                        Ds_WorkspaceStatusDetail.Tables(Tbl_WorkspaceStatusDetail.TableName), _
                                        Tbl_WorkspaceStatusDetail, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            If Not objSave.SaveInDb("insert_workspace", Tbl_WorkspaceStatusDetail, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of projectStatus In Database"
                Exit Function
            End If

            insert_workspace = True

            If insert_workspace Then
                objHdrogic.Commit_Transaction()
            Else
                objHdrogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving BagBatchMst"
            insert_workspace = False
            objHdrogic.RollBack_Transaction()
        Finally
            objHdrogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "Save_TransferDetail"
    Public Function Save_TransferDetail(ByVal Choice As DataObjOpenSaveModeEnum, _
                               ByVal Dt_TransferDtl As DataTable, _
                               ByVal SaveDefaultValue As Boolean, _
                               ByVal objDtLogic As ClsDataLogic_New, _
                               ByVal UserCode_1 As String, _
                               ByRef IsSuccess As String, _
                               ByRef eStr_Retu As String) As Boolean


        'Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing


        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime


        Dim Instr_WorkspaceId As String = ""
        Dim wsId As String = String.Empty
        Dim PkColArr(1) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            'wsId = Ds_TransferDtl.Tables(0).Rows(0)("vWorkspaceId").ToString.Trim
            ''Logic Of save Start

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Dt_TransferDtl Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)


            If Not objSave.SaveInDb("PROC_TranferDataForArchive", Dt_TransferDtl, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of WorkspaceNodeDetail In Database"
                Exit Function
            End If

            DataReturnList = DataReturnList.Item(0)
            If DataReturnList.Count > 0 Then
                RetuVal = DataReturnList.Item(0)
                IsSuccess = RetuVal.ParameterValue
            End If

            RetuVal = DataReturnList.Item(0)

            'End If

            Save_TransferDetail = True
            'Logic of Save End

            If Save_TransferDetail Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving WorkspaceNodeDetail"
            Save_TransferDetail = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region


#Region "Save_ArchiveDetail"

    Public Function Save_ArchiveDetail(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_ArchiveDetail As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_ArchiveDetail As Data.DataTable = Nothing
        Dim Instr_ArchieveDetail As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_ArchiveDetail Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)


            If Not objSave.SaveInDb("insert_ArchiveProjectMst", Ds_ArchiveDetail.Tables(0), Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of ArchiveProjectMst In Database"
                Exit Function
            End If

            Save_ArchiveDetail = True

            If Save_ArchiveDetail Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If


        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving ArchiveProjectMst"
            Save_ArchiveDetail = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function

#End Region


#Region "proc_TransferLabRptForArchive"
    Public Function proc_TransferLabRptForArchive(ByVal Choice As DataObjOpenSaveModeEnum, _
                               ByVal Dt_TransferLabRptDtl As DataTable, _
                               ByVal SaveDefaultValue As Boolean, _
                               ByVal objDtLogic As ClsDataLogic_New, _
                               ByVal UserCode_1 As String, _
                               ByRef SuccessLabRpt As String, _
                               ByRef eStr_Retu As String) As Boolean


        'Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing


        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime


        Dim Instr_WorkspaceId As String = ""
        Dim wsId As String = String.Empty
        Dim PkColArr(1) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            'wsId = Ds_TransferDtl.Tables(0).Rows(0)("vWorkspaceId").ToString.Trim
            ''Logic Of save Start

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Dt_TransferLabRptDtl Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)


            If Not objSave.SaveInDb("proc_TransferLabRptForArchive", Dt_TransferLabRptDtl, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of LabReportArchival In Database"
                Exit Function
            End If

            DataReturnList = DataReturnList.Item(0)
            If DataReturnList.Count > 0 Then
                RetuVal = DataReturnList.Item(0)
                SuccessLabRpt = RetuVal.ParameterValue
            End If

            RetuVal = DataReturnList.Item(0)

            'End If

            proc_TransferLabRptForArchive = True
            'Logic of Save End

            If proc_TransferLabRptForArchive Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving LabArchivalData"
            proc_TransferLabRptForArchive = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region

    '=====================================


    '*******************************************************
    'Added By Mihir Oza
    '*******************************************************

#Region "save_subjectMst"
    Public Function Save_SubjectMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                      ByVal Ds_SubjectMst As Data.DataSet, _
                                      ByVal objDtLogic As ClsDataLogic_New, _
                                      ByVal UserCode_1 As String, _
                                      ByRef SubjectId As String, _
                                      ByRef eStr_Retu As String,
                                      Optional ByRef RandomizationNo As String = "") As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim Tbl_HaditMst As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_SubjectMst As Data.DataTable = Nothing
        Dim Instr_SubjectID As String = ""

        Dim Tbl_WorkSpaceSubjectMst As DataTable = Nothing

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_SubjectMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            Tbl_HaditMst = New DataTable
            Tbl_HaditMst = Ds_SubjectMst.Tables("SubjectHabitDetails")
            Tbl_WorkSpaceSubjectMst = Ds_SubjectMst.Tables("View_WorkspaceSubjectMst")

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_SubjectMst.Tables("View_SubjectMaster").Rows

                    Instr_SubjectID += IIf(Instr_SubjectID = "", "", ",").ToString + _
                                    tr("vSubjectID").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Delete Then
                For Each tr As Data.DataRow In Ds_SubjectMst.Tables("View_SubjectMaster").Rows

                    Instr_SubjectID += IIf(Instr_SubjectID = "", "", ",").ToString + _
                                    tr("vSubjectID").ToString

                Next tr
            End If
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of Subject Master
            If Not objHelpDbTbl.GetView_SubjectMaster("vSubjectID In ('" + Instr_SubjectID + "')", dataRet_1, _
                                            objDtLogic, Tbl_SubjectMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving Subject Master"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vSubjectID"

            Tbl_SubjectMst = Ds_SubjectMst.Tables(Tbl_SubjectMst.TableName)

            ' Save in Subject Master

            If Not objSave.SaveInDb("Insert_SubjectMaster", Tbl_SubjectMst, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of Subject Master In Database"
                Exit Function
                'End If
            End If

            DataReturnList = DataReturnList.Item(0)
            RetuVal = DataReturnList.Item(0)
            SubjectId = RetuVal.ParameterValue

            If Not Tbl_HaditMst Is Nothing Then

                For Each dr As Data.DataRow In Tbl_HaditMst.Rows
                    dr("vSubjectID") = RetuVal.ParameterValue
                Next
                SubjectId = RetuVal.ParameterValue
                'Save in SubjectHabitdetail Master
                If Not objSave.SaveInDb("Insert_SubjectHabitDetails", Tbl_HaditMst, Choice, Nothing, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of SubjectHabit Detail In Database"
                    Exit Function
                End If

            End If

            'Added on 31-Mar-2010 for assigning iMySubjectNo and vMySubjectNo at the time of subject registration
            If Not Tbl_WorkSpaceSubjectMst Is Nothing Then

                For Each dr As Data.DataRow In Tbl_WorkSpaceSubjectMst.Rows
                    dr("vSubjectID") = RetuVal.ParameterValue
                Next
                Tbl_WorkSpaceSubjectMst.AcceptChanges()

                If Not objSave.SaveInDb("Insert_WorkspaceSubjectMaster", Tbl_WorkSpaceSubjectMst, Choice, DataReturnList, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of WorkspaceSubjectMst In Database"
                    Exit Function
                End If

                DataReturnList = DataReturnList.Item(0)
                RetuVal = DataReturnList.Item(0)
                RandomizationNo = RetuVal.ParameterValue

            End If
            '************************************

            Save_SubjectMst = True

            If Save_SubjectMst Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Subject Master"
            Save_SubjectMst = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "Save_ImportSubjectMst"
    Public Function Save_ImportSubjectMst(ByVal Ds_SubjectMst As Data.DataSet,
                                      ByVal objDtLogic As ClsDataLogic_New,
                                      ByVal UserCode_1 As String,
                                      ByRef eStr_Retu As String) As Boolean


        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing
        Const CONST_SubjectMstTAB As String = "View_SubjectMaster"
        Const CONST_WorkspaceSubjectMstTAB As String = "View_WorkspaceSubjectMst"
        Const CONST_ImgTransmittalHdr As String = "ImgTransmittalHdr"
        Const Pro_Screening As String = "0000000000" 'Screening Project
        Dim Choice As DataObjOpenSaveModeEnum
        Dim Tbl_SubjectMst, Tbl_SaveSubjectMst As Data.DataTable
        Dim Tbl_WorkSpaceSubjectMst, Tbl_SaveWorkSpaceSubjectMst As DataTable
        Dim Tbl_ImageTransmittalHdr, Tbl_SaveImageTransmittalHdr As DataTable
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                Throw New Exception("Data Object Is Invalid or Nothing")
            End If

            If objDtLogic.Transaction Is Nothing Then
                Throw New Exception("Transaction object is not started")
            End If

            If Ds_SubjectMst Is Nothing AndAlso Ds_SubjectMst.Tables(CONST_SubjectMstTAB) Is Nothing Then
                Throw New Exception("Dataset Is Invalid or Nothing")
            End If

            objSave = New SaveDataInDbObj(objDtLogic)
            Tbl_SubjectMst = Ds_SubjectMst.Tables(CONST_SubjectMstTAB)
            Tbl_WorkSpaceSubjectMst = Ds_SubjectMst.Tables(CONST_WorkspaceSubjectMstTAB)
            Tbl_ImageTransmittalHdr = Ds_SubjectMst.Tables(CONST_ImgTransmittalHdr)

            For Each drSubject As DataRow In Tbl_SubjectMst.Rows

                If drSubject("vSubjectID") = Pro_Screening Then
                    Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add
                Else
                    Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit
                End If

                Tbl_SaveSubjectMst = New DataTable
                Tbl_SaveSubjectMst = Tbl_SubjectMst.Clone()
                Tbl_SaveSubjectMst.ImportRow(drSubject)

                ' Save in Subject Master
                If Not objSave.SaveInDb("InsertUpdate_SubjectMaster", Tbl_SaveSubjectMst, Choice, DataReturnList, eStr_Retu) Then
                    Throw New Exception(eStr_Retu + vbCrLf + "Error occured while Save Information of Subject Master In Database")
                End If

                DataReturnList = DataReturnList.Item(0)
                RetuVal = DataReturnList.Item(0)

                Tbl_SaveWorkSpaceSubjectMst = Nothing
                Tbl_SaveWorkSpaceSubjectMst = Tbl_WorkSpaceSubjectMst.Clone()
                Tbl_SaveImageTransmittalHdr = Nothing
                Tbl_SaveImageTransmittalHdr = Tbl_ImageTransmittalHdr.Clone()

                For Each dr As Data.DataRow In Tbl_WorkSpaceSubjectMst.Select("vExternalSubjectId= '" + drSubject("vExternalSubjectId") + "'")
                    dr("vSubjectID") = RetuVal.ParameterValue
                    Tbl_SaveWorkSpaceSubjectMst.ImportRow(dr)
                Next dr

                For Each dr As Data.DataRow In Tbl_ImageTransmittalHdr.Select("vExternalSubjectId= '" + drSubject("vExternalSubjectId") + "'")
                    dr("vSubjectID") = RetuVal.ParameterValue
                    Tbl_SaveImageTransmittalHdr.ImportRow(dr)
                Next dr

                If Not objSave.SaveInDb("Insert_WorkspaceSubjectMaster", Tbl_SaveWorkSpaceSubjectMst, Choice, DataReturnList, eStr_Retu) Then
                    Throw New Exception(eStr_Retu + vbCrLf + "Error occured while Save Information of WorkspaceSubjectMst In Database")
                End If

                If Not objSave.SaveInDb("InsertUpdate_ImageTransmittalHdr", Tbl_SaveImageTransmittalHdr, Choice, DataReturnList, eStr_Retu) Then
                    Throw New Exception(eStr_Retu = vbCrLf + "Error occured while Save Information of WorkspaceSubjectMst In Database")
                End If
            Next drSubject

            objDtLogic.Commit_Transaction()
            Save_ImportSubjectMst = True

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Subject Master"
            objDtLogic.RollBack_Transaction()
            Save_ImportSubjectMst = False
        Finally
            objDtLogic.Close_Connection()
        End Try
        Return Save_ImportSubjectMst

    End Function
#End Region

    '*******************************************************
    'Added By Bhargav
    '*******************************************************

#Region "Save_CRFBunchData"
    Public Function Save_CRFBunchData(ByVal Ds_SubjectMst As Data.DataSet,
                                      ByVal objDtLogic As ClsDataLogic_New,
                                      ByVal UserCode_1 As String,
                                      ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime
        Dim Choice As DataObjOpenSaveModeEnum
        Dim Tbl_WorkSpaceMst As Data.DataTable = Nothing
        Dim Tbl_workspaceProtocolDetailMatrix As Data.DataTable = Nothing
        Dim Tbl_workspaceprotocoldetail As Data.DataTable = Nothing
        Dim Instr_WorkSpaceId As String = ""
        Dim vWorkspaceId As String = ""
        Dim WorkspaceId_Edit As String = ""
        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_SubjectMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'If Not IsNothing(Ds_ChildWorkSpaceMstSite.Tables("Proc_ParentToChild")) Then
            '    Tbl_WorkSpaceMst = Ds_ChildWorkSpaceMstSite.Tables("Proc_ParentToChild")
            'End If

            'If Not IsNothing(Ds_ChildWorkSpaceMstSite.Tables("workspaceprotocoldetail")) Then
            '    Tbl_workspaceprotocoldetail = Ds_ChildWorkSpaceMstSite.Tables("workspaceprotocoldetail")
            'End If

            If Not IsNothing(Ds_SubjectMst.Tables("CRFBunchHdrTable")) Then
                Tbl_workspaceProtocolDetailMatrix = Ds_SubjectMst.Tables("CRFBunchHdrTable")
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic,
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            'PkColArr(0) = "vWorkSpaceId"

            'If Not objSave.AssignValues(Tbl_WorkSpaceMst.TableName, PkColArr, Choice, _
            '                            Ds_ChildWorkSpaceMstSite.Tables(Tbl_WorkSpaceMst.TableName), _
            '                            Tbl_WorkSpaceMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
            '    eStr_Retu += vbCrLf + "Error occured while assigning values"
            '    Exit Function
            'End If

            'Comment by pratiksha As while editing it will insert new child site
            'Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add
            '''''''

            ' Save in Workspace Master
            'If Not objSave.SaveInDb("Proc_ParentToChild", Tbl_WorkSpaceMst, Choice, DataReturnList, eStr_Retu, True) Then
            '    eStr_Retu += vbCrLf + "Error occured while Save Information of workspacemst In Database"
            '    Exit Function
            'End If
            'DataReturnList = DataReturnList.Item(0)
            'RetuVal = DataReturnList.Item(0)

            'If Not IsNothing(Ds_SubjectMst.Tables("CRFBunchHdrTable")) Then
            '    For Each dr As Data.DataRow In Tbl_workspaceProtocolDetailMatrix.Rows
            '        dr("vWorkspaceId") = RetuVal.ParameterValue
            '    Next
            'End If

            'For CRFBunchHdrTable
            If Not IsNothing(Ds_SubjectMst.Tables("CRFBunchHdrTable")) Then
                If Not objSave.SaveInDb("Insert_CRFBunchDetail", Tbl_workspaceProtocolDetailMatrix, Choice, Nothing, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of CRFBunchHdrTable In Database"
                    Exit Function
                End If

            End If

            Save_CRFBunchData = True

            If Save_CRFBunchData Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

            'objDtLogic.Close_Connection()

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving workspacemst"
            Save_CRFBunchData = False
            objDtLogic.RollBack_Transaction()
            'objDtLogic.Close_Connection()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "Save_CRFSubBunchData"
    Public Function Save_CRFSubBunchData(ByVal Ds_SubjectMst As Data.DataSet,
                                      ByVal objDtLogic As ClsDataLogic_New,
                                      ByVal UserCode_1 As String,
                                      ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime
        Dim Choice As DataObjOpenSaveModeEnum
        Dim Tbl_WorkSpaceMst As Data.DataTable = Nothing
        Dim Tbl_workspaceProtocolDetailMatrix As Data.DataTable = Nothing
        Dim Tbl_workspaceprotocoldetail As Data.DataTable = Nothing
        Dim Instr_WorkSpaceId As String = ""
        Dim vWorkspaceId As String = ""
        Dim WorkspaceId_Edit As String = ""
        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_SubjectMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            If Not IsNothing(Ds_SubjectMst.Tables("CRFBunchSubDtlTable")) Then
                Tbl_workspaceProtocolDetailMatrix = Ds_SubjectMst.Tables("CRFBunchSubDtlTable")
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic,
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'For CRFBunchSubDtlTable
            If Not IsNothing(Ds_SubjectMst.Tables("CRFBunchSubDtlTable")) Then
                If Not objSave.SaveInDb("Insert_CRFBunchSubDetail", Tbl_workspaceProtocolDetailMatrix, Choice, Nothing, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of CRFBunchSubDtlTable In Database"
                    Exit Function
                End If
            End If

            Save_CRFSubBunchData = True

            If Save_CRFSubBunchData Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

            'objDtLogic.Close_Connection()

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving workspacemst"
            Save_CRFSubBunchData = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region



#Region "save_subjectFemaleDetails"
    Public Function save_subjectFemaleDetails(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_SubjectFemaleMst As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_SubjectFemaleDetails As Data.DataTable = Nothing
        Dim Instr_ScreenId As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_SubjectFemaleMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_SubjectFemaleMst.Tables("SubjectFemaleDetails").Rows

                    Instr_ScreenId += IIf(Instr_ScreenId = "", "", ",").ToString + _
                                    tr("pScreenId").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of Subject female details
            If Not objHelpDbTbl.GetSubjectFemaleDetails("pScreenId In (" + Instr_ScreenId + ")", dataRet_1, _
                                            objDtLogic, Tbl_SubjectFemaleDetails, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving Subject female details"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "pScreenId"

            If Not objSave.AssignValues(Tbl_SubjectFemaleDetails.TableName, PkColArr, Choice, _
                                        Ds_SubjectFemaleMst.Tables(Tbl_SubjectFemaleDetails.TableName), _
                                        Tbl_SubjectFemaleDetails, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in Subjectfemaledetail Master
            If Not objSave.SaveInDb("insert_SubjectFemaleDetails", Tbl_SubjectFemaleDetails, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of Subject Female Details In Database"
                Exit Function
            End If

            save_subjectFemaleDetails = True

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Subject Female Details"
            save_subjectFemaleDetails = False
        End Try

    End Function
#End Region

#Region "DrugAnalytesMatrix"
    Public Function Save_DrugAnalytesMatrix(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_DrugAnalytesMatrix As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_DrugAnalytesMatrix As Data.DataTable = Nothing
        Dim Instr_DrugAnalytesCode As String = ""

        Dim PkColArr(1) As String
        Dim DataReturnList As New ArrayList

        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_DrugAnalytesMatrix Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_DrugAnalytesMatrix.Tables("DrugAnalytesMatrix").Rows

                    Instr_DrugAnalytesCode += IIf(Instr_DrugAnalytesCode = "", "", ",").ToString + _
                                    tr("vDrugAnalytesCode").ToString + tr("vDrugCode").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of Drug Analytes Matrix
            If Not objHelpDbTbl.GetDrugAnalytesMatrix("vDrugAnalytesCode + vDrugCode In (" + Instr_DrugAnalytesCode + ")", dataRet_1, _
                                            objDtLogic, Tbl_DrugAnalytesMatrix, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving Drug Analytes Matrix"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vDrugAnalytesCode"
            PkColArr(1) = "vDrugCode"

            If Not objSave.AssignValues(Tbl_DrugAnalytesMatrix.TableName, PkColArr, Choice, _
                                        Ds_DrugAnalytesMatrix.Tables(Tbl_DrugAnalytesMatrix.TableName), _
                                        Tbl_DrugAnalytesMatrix, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in Drug Analytes Matrix
            If Not objSave.SaveInDb("Insert_DrugAnalytesMatrix", Tbl_DrugAnalytesMatrix, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of DrugAnalytesMatrix In Database"
                Exit Function
            End If

            Save_DrugAnalytesMatrix = True

            If Save_DrugAnalytesMatrix Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

            'objDtLogic.Close_Connection()
        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Drug Analytes Matrix"
            Save_DrugAnalytesMatrix = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "Save_MedExMst"
    Public Function Save_MedExMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_MedExMst As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean
        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim Dt_View As Data.DataView = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_MedExMst As Data.DataTable = Nothing
        Dim Tbl_MedExRangeMst As Data.DataTable = Nothing

        Dim Tbl_MedExCostMst As Data.DataTable = Nothing
        Dim Tbl_LabMachineMedexMatrix As Data.DataTable = Nothing
        Dim Tbl_MedExFormulaMst As Data.DataTable = Nothing
        Dim Tbl_MedExCrossChecks As Data.DataTable = Nothing

        Dim Instr_vMedExCode As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_MedExMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Ds_MedExMst.Tables(0).TableName = "VIEW_MedExMst" 'Commented 

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_MedExMst.Tables("VIEW_MedExMst").Rows

                    Instr_vMedExCode += IIf(Instr_vMedExCode = "", "'", ",'").ToString + _
                                    tr("vMedExCode").ToString + "'"

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of MedExMst
            If Not objHelpDbTbl.GetMedExMst("vMedExCode in (" + Instr_vMedExCode + ")", dataRet_1, _
                                            objDtLogic, Tbl_MedExMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving MedExMst Details"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            Tbl_MedExMst.TableName = "VIEW_MedExMst"

            'Assignment of Values

            PkColArr(0) = "vMedExCode"

            If Not objSave.AssignValues(Tbl_MedExMst.TableName, PkColArr, Choice, _
                                        Ds_MedExMst.Tables(Tbl_MedExMst.TableName), _
                                        Tbl_MedExMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "error occured while assigning values"
                Exit Function
            End If

            ' Save in MedExMst
            Tbl_MedExMst.TableName = "VIEW_MedExMst"
            If Not objSave.SaveInDb("Insert_MedExMst", Tbl_MedExMst, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of MedEx Master In Database"
                Exit Function
            End If

            'Assiging New MedexCode 
            DataReturnList = DataReturnList.Item(0)
            RetuVal = DataReturnList.Item(0)

            'Added for Saving in MedExRangeMst by LIMS on 19-Jul-2009
            If Not IsNothing(Ds_MedExMst.Tables("MedExRangeMst")) Then

                Tbl_MedExRangeMst = Ds_MedExMst.Tables("MedExRangeMst").Copy()

                ''Assiging New MedexCode 
                'DataReturnList = DataReturnList.Item(0)
                'RetuVal = DataReturnList.Item(0)

                For Each dr As DataRow In Tbl_MedExRangeMst.Rows
                    dr("vMedExCode") = RetuVal.ParameterValue
                    dr.AcceptChanges()
                Next
                Tbl_MedExRangeMst.AcceptChanges()

                If Not objSave.SaveInDb("Insert_MedExRangeMst", Tbl_MedExRangeMst, Choice, Nothing, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of MedExRange Master In Database"
                    Exit Function
                End If

            End If


            'Added for Saving in MedExCostMst by LIMS on 19-Jul-2009
            If Not IsNothing(Ds_MedExMst.Tables("MedExCostMst")) Then

                Tbl_MedExCostMst = Ds_MedExMst.Tables("MedExCostMst").Copy()

                'Assiging New MedexCode 
                'DataReturnList = DataReturnList.Item(0)
                'RetuVal = DataReturnList.Item(0)

                For Each dr As DataRow In Tbl_MedExCostMst.Rows
                    dr("vMedExCode") = RetuVal.ParameterValue
                    dr.AcceptChanges()
                Next
                Tbl_MedExCostMst.AcceptChanges()

                If Not objSave.SaveInDb("Insert_MedExCostMst", Tbl_MedExCostMst, Choice, Nothing, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of MedExCost Master In Database"
                    Exit Function
                End If

            End If

            'Added for Saving in LabMachineMedexMatrix by LIMS on 19-Jul-2009
            If Not IsNothing(Ds_MedExMst.Tables("LabMachineMedexMatrix")) Then

                Tbl_LabMachineMedexMatrix = Ds_MedExMst.Tables("LabMachineMedexMatrix").Copy()

                'Assiging New MedexCode 
                'DataReturnList = DataReturnList.Item(0)
                'RetuVal = DataReturnList.Item(0)

                For Each dr As DataRow In Tbl_LabMachineMedexMatrix.Rows
                    dr("vMedExCode") = RetuVal.ParameterValue
                    dr.AcceptChanges()
                Next
                Tbl_LabMachineMedexMatrix.AcceptChanges()

                If Not objSave.SaveInDb("Insert_LabMachineMedexMatrix", Tbl_LabMachineMedexMatrix, Choice, Nothing, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of LabMachineMedexMatrix Master In Database"
                    Exit Function
                End If

            End If


            'Added for Saving in MedExFormulaMst by BizNET -Chandresh Vanker on 02-Jan-2010
            If Not IsNothing(Ds_MedExMst.Tables("MedExFormulaMst")) Then

                Tbl_MedExFormulaMst = Ds_MedExMst.Tables("MedExFormulaMst").Copy()

                'Assiging New MedexCode 
                'DataReturnList = DataReturnList.Item(0)
                'RetuVal = DataReturnList.Item(0)

                For Each dr As DataRow In Tbl_MedExFormulaMst.Rows
                    dr("vMedExCode") = RetuVal.ParameterValue
                    dr.AcceptChanges()
                Next
                Tbl_MedExFormulaMst.AcceptChanges()

                If Not objSave.SaveInDb("Insert_MedExFormulaMst", Tbl_MedExFormulaMst, Choice, Nothing, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of MedExFormulaM Master In Database"
                    Exit Function
                End If

            End If


            'Added for Saving in MedExCrossChecks by BizNET -Chandresh Vanker on 17-Feb-2010
            If Not IsNothing(Ds_MedExMst.Tables("MedExCrossChecks")) Then

                Tbl_MedExCrossChecks = Ds_MedExMst.Tables("MedExCrossChecks").Copy()

                For Each dr As DataRow In Tbl_MedExCrossChecks.Rows
                    dr("vMedExCode") = RetuVal.ParameterValue
                    dr.AcceptChanges()
                Next
                Tbl_MedExCrossChecks.AcceptChanges()

                If Not objSave.SaveInDb("Insert_MedExCrossChecks", Tbl_MedExCrossChecks, Choice, Nothing, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of MedExCrossChecks Master In Database"
                    Exit Function
                End If

            End If


            Save_MedExMst = True

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving MedExMaster Details"
            Save_MedExMst = False
        End Try
    End Function
#End Region

#Region "Save_MedExGroupMst"
    Public Function Save_MedExGroupMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_MedExGroupMst As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean
        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim Dt_View As Data.DataView = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_MedExGroupMst As Data.DataTable = Nothing

        Dim Instr_vMedExGroupCode As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_MedExGroupMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            Ds_MedExGroupMst.Tables(0).TableName = "MedExGroupMst"
            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_MedExGroupMst.Tables("MedExGroupMst").Rows

                    Instr_vMedExGroupCode += IIf(Instr_vMedExGroupCode = "", "'", ",'").ToString + _
                                    tr("vMedExGroupCode").ToString + "'"

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of MedExGroupMst
            If Not objHelpDbTbl.GetMedExGroupMst("vMedExGroupCode in (" + Instr_vMedExGroupCode + ")", dataRet_1, _
                                            objDtLogic, Tbl_MedExGroupMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving MedExGroup Mst Details"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            Tbl_MedExGroupMst.TableName = "MedExGroupMst"

            'Assignment of Values

            PkColArr(0) = "vMedExGroupCode"

            If Not objSave.AssignValues(Tbl_MedExGroupMst.TableName, PkColArr, Choice, _
                                        Ds_MedExGroupMst.Tables(Tbl_MedExGroupMst.TableName), _
                                        Tbl_MedExGroupMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "error occured while assigning values"
                Exit Function
            End If

            ' Save in MedExGroupMst
            Tbl_MedExGroupMst.TableName = "MedExGroupMst"
            If Not objSave.SaveInDb("Insert_MedExGroupMst", Tbl_MedExGroupMst, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of MedEx Group Master In Database"
                Exit Function
            End If

            Save_MedExGroupMst = True

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving MedEx Group Master Details"
            Save_MedExGroupMst = False
        End Try
    End Function
#End Region

#Region "Save_MedExTemplateDtl"
    Public Function Save_MedExTemplateDtl(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_MedExTemplateDtl As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean
        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim Dt_View As Data.DataView = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_MedExTemplateDtl As Data.DataTable = Nothing
        Dim Tbl_TemplateCostMst As Data.DataTable = Nothing
        Dim Tbl_TemplateRemarkDtl As Data.DataTable = Nothing


        Dim Instr_vMedExTemplateId As String = ""

        Dim PkColArr(1) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_MedExTemplateDtl Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_MedExTemplateDtl.Tables("View_MedExTemplateDtl").Rows

                    Instr_vMedExTemplateId += IIf(Instr_vMedExTemplateId = "", "'", ",'").ToString + _
                                    tr("vMedExTemplateId").ToString + tr("vMedExCode").ToString + "'"

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of MedExTemplateMst
            If Not objHelpDbTbl.GetMedExTemplateDtl("vMedExTemplateId in (" + Instr_vMedExTemplateId + ")", dataRet_1, _
                                            objDtLogic, Tbl_MedExTemplateDtl, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving MedExTemplateMst Details"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vMedExTemplateId"
            PkColArr(1) = "vMedExCode"

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then

                If Not objSave.AssignValues(Tbl_MedExTemplateDtl.TableName, PkColArr, Choice, _
                                            Ds_MedExTemplateDtl.Tables(Tbl_MedExTemplateDtl.TableName), _
                                            Tbl_MedExTemplateDtl, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "error occured while assigning values"
                    Exit Function
                End If
                ' Save in MedExTemplateMst
                If Not objSave.SaveInDb("Insert_MedExTemplateDtl", Tbl_MedExTemplateDtl, Choice, DataReturnList, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of MedEx Template Detail In Database"
                    Exit Function
                End If



                'Added for Saving in MedExCostMst by LIMS on 22-Jul-2009
                If Not IsNothing(Ds_MedExTemplateDtl.Tables("TemplateCostMSt")) Then

                    Tbl_TemplateCostMst = Ds_MedExTemplateDtl.Tables("TemplateCostMSt").Copy()

                    'Assiging New MedexCode 
                    DataReturnList = DataReturnList.Item(0)
                    RetuVal = DataReturnList.Item(0)

                    For Each dr As DataRow In Tbl_TemplateCostMst.Rows
                        dr("vTemplateCode") = RetuVal.ParameterValue
                        dr.AcceptChanges()
                    Next
                    Tbl_TemplateCostMst.AcceptChanges()

                    If Not objSave.SaveInDb("insert_TemplateCostMst", Tbl_TemplateCostMst, Choice, Nothing, eStr_Retu) Then
                        eStr_Retu += vbCrLf + "Error occured while Save Information of Template Cost In Database"
                        Exit Function
                    End If

                End If

                'Added for Saving in TemplateRemarkDtl by LIMS 
                If Not IsNothing(Ds_MedExTemplateDtl.Tables("TemplateRemarkDtl")) Then

                    Tbl_TemplateRemarkDtl = Ds_MedExTemplateDtl.Tables("TemplateRemarkDtl").Copy()

                    'Assiging New MedexCode 
                    RetuVal = DataReturnList.Item(0)

                    For Each dr As DataRow In Tbl_TemplateRemarkDtl.Rows
                        dr("vTemplateCode") = RetuVal.ParameterValue
                        dr.AcceptChanges()
                    Next
                    Tbl_TemplateRemarkDtl.AcceptChanges()

                    If Not objSave.SaveInDb("Insert_TemplateRemarkDtl", Tbl_TemplateRemarkDtl, Choice, Nothing, eStr_Retu) Then
                        eStr_Retu += vbCrLf + "Error occured while Save Information of Template Remark Dtl In Database"
                        Exit Function
                    End If

                End If

                Save_MedExTemplateDtl = True


            ElseIf Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then

                If Not objSave.SaveInDb("Insert_MedExTemplateDtl", Ds_MedExTemplateDtl.Tables(0), Choice, DataReturnList, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of MedEx Template Detail In Database"
                    Exit Function
                End If

                If Not IsNothing(Ds_MedExTemplateDtl.Tables("TemplateCostMSt")) Then

                    Tbl_TemplateCostMst = Ds_MedExTemplateDtl.Tables("TemplateCostMSt").Copy()

                    If Not objSave.SaveInDb("insert_TemplateCostMst", Tbl_TemplateCostMst, Choice, Nothing, eStr_Retu) Then
                        eStr_Retu += vbCrLf + "Error occured while Save Information of Template Cost In Database"
                        Exit Function
                    End If

                End If

                If Not IsNothing(Ds_MedExTemplateDtl.Tables("TemplateRemarkDtl")) Then

                    Tbl_TemplateRemarkDtl = Ds_MedExTemplateDtl.Tables("TemplateRemarkDtl").Copy()

                    If Not objSave.SaveInDb("Insert_TemplateRemarkDtl", Tbl_TemplateRemarkDtl, Choice, Nothing, eStr_Retu) Then
                        eStr_Retu += vbCrLf + "Error occured while Save Information of Template Remark Dtl In Database"
                        Exit Function
                    End If

                End If

                Save_MedExTemplateDtl = True
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving MedEx Template Master Details"
            Save_MedExTemplateDtl = False
        End Try
    End Function
#End Region

#Region "Save_MedExWorkspaceDtl"
    Public Function Save_MedExWorkspaceDtl(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_MedExWorkspaceDtl As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing
        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_MedExWorkspaceHdr As Data.DataTable = Nothing
        Dim Tbl_MedExWorkspaceDtl As Data.DataTable = Nothing
        Dim Instr_vMedExWorkSpaceId As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim ReturnValueList As New ParameterReturnValue
        Dim prv As New ParameterReturnValue()
        Dim MedExWorkSpaceHdrNo As String = ""

        Try
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_MedExWorkspaceDtl Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            If Ds_MedExWorkspaceDtl.Tables.Count > 1 Then
                Ds_MedExWorkspaceDtl.Tables(0).TableName = "MedExWorkspaceHdr"

                'Function called only if edit is called
                If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                    For Each tr As Data.DataRow In Ds_MedExWorkspaceDtl.Tables("MedExWorkspaceHdr").Rows

                        Instr_vMedExWorkSpaceId += IIf(Instr_vMedExWorkSpaceId = "", "", ",").ToString + _
                                        tr("nMedExWorkSpaceHdrNo").ToString

                    Next tr
                End If

                If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                    dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
                Else
                    dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
                End If


                'Retrieval of MedExWorkSpaceDtl
                If Not objHelpDbTbl.GetMedExWorkSpaceHdr("nMedExWorkSpaceHdrNo In (" + Instr_vMedExWorkSpaceId + ")", dataRet_1, _
                                                objDtLogic, Tbl_MedExWorkspaceHdr, eStr_Retu) Then

                    eStr_Retu += vbCrLf + "Error occured while retrieving MedExWorkSpaceDtl"
                    Exit Function
                End If

                'Retrieval of Online_AuditInfo
                If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                                  Tbl_Audit, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                    Exit Function
                End If

                'Assignment of Values
                PkColArr(0) = "nMedExWorkSpaceHdrNo"
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then

                If Not IsNothing(Ds_MedExWorkspaceDtl.Tables("MedExWorkspaceHdr")) Then

                    If Not objSave.AssignValues(Tbl_MedExWorkspaceHdr.TableName, PkColArr, Choice, _
                                                               Ds_MedExWorkspaceDtl.Tables(Tbl_MedExWorkspaceHdr.TableName), _
                                                               Tbl_MedExWorkspaceHdr, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                        eStr_Retu += vbCrLf + "Error occured while assigning values"
                        Exit Function
                    End If
                    'Save in MedExWorkspaceHdr Source Master
                    'Tbl_MedExWorkspaceDtl.TableName = Ds_MedExWorkspaceDtl.Tables(1).TableName

                    If Not objSave.SaveInDb("Insert_MedExWorkSpaceHdr", Tbl_MedExWorkspaceHdr, Choice, DataReturnList, eStr_Retu) Then
                        eStr_Retu += vbCrLf + "Error occured while Save Information of MedExWorkspaceHdr In Database"
                    End If
                    DataReturnList = DataReturnList.Item(0)
                    prv = DataReturnList.Item(0)
                    MedExWorkSpaceHdrNo = prv.ParameterValue.ToString

                    For Each dr As DataRow In Ds_MedExWorkspaceDtl.Tables("MedExWorkspaceDtl").Rows
                        dr("nMedExWorkSpaceHdrNo") = MedExWorkSpaceHdrNo
                    Next dr

                End If

                'Save in MedExWorkspaceDtl Source Master
                If Not objSave.SaveInDb("Insert_MedExWorkspaceDtl", Ds_MedExWorkspaceDtl.Tables("MedExWorkspaceDtl"), Choice, Nothing, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of MedExWorkspaceDtl In Database"
                    Exit Function
                End If

                Save_MedExWorkspaceDtl = True

            ElseIf Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then

                If Not IsNothing(Ds_MedExWorkspaceDtl.Tables("MedExWorkspaceHdr")) Then

                    If Not objSave.SaveInDb("Insert_MedExWorkspaceHdr", Ds_MedExWorkspaceDtl.Tables("MedExWorkspaceHdr"), Choice, DataReturnList, eStr_Retu) Then
                        eStr_Retu += vbCrLf + "Error occured while Save Information of MedExWorkspaceHdr In Database"
                        Exit Function
                    End If

                End If

                If Not IsNothing(Ds_MedExWorkspaceDtl.Tables("MedExWorkspaceDtl")) Then

                    If Not objSave.SaveInDb("Insert_MedExWorkspaceDtl", Ds_MedExWorkspaceDtl.Tables("MedExWorkspaceDtl"), Choice, DataReturnList, eStr_Retu) Then
                        eStr_Retu += vbCrLf + "Error occured while Save Information of MedExWorkspace  Detail In Database"
                        Exit Function
                    End If
                End If

                Save_MedExWorkspaceDtl = True

            ElseIf Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Delete Then

                If Not objSave.SaveInDb("Insert_MedExWorkspaceHdr", Ds_MedExWorkspaceDtl.Tables("MedExWorkspaceHdr"), Choice, DataReturnList, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Delete Information of MedExWorkspaceHdr In Database"
                    Exit Function
                End If
                If Not objSave.SaveInDb("Insert_MedExWorkspaceDtl", Ds_MedExWorkspaceDtl.Tables("MedExWorkspaceDtl"), Choice, DataReturnList, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Delete Information of MedExWorkspaceDtl In Database"
                    Exit Function
                End If
                Save_MedExWorkspaceDtl = True
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving MedExWorkspaceHdr And MedExWorkspaceDtl"
            Save_MedExWorkspaceDtl = False
        End Try

    End Function
#End Region

#Region "Save_DocTypeTemplateMst"
    Public Function Save_DocTypeTemplateMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_DocTypeTemplateMst As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String, _
                                        ByRef DocId_Retu As String) As Boolean
        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim Dt_View As Data.DataView = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_DocTypeTemplateMst As Data.DataTable = Nothing

        Dim Instr_vDocTemplateId As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing
        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_DocTypeTemplateMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            Ds_DocTypeTemplateMst.Tables(0).TableName = "VIEW_DocTypeTemplateMst"
            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_DocTypeTemplateMst.Tables("VIEW_DocTypeTemplateMst").Rows

                    Instr_vDocTemplateId += IIf(Instr_vDocTemplateId = "", "'", ",'").ToString + _
                                    tr("vDocTemplateId").ToString + "'"

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of DocTypeTemplateMst
            If Not objHelpDbTbl.GetDocTypeTemplateMst("vDocTemplateId in (" + Instr_vDocTemplateId + ")", dataRet_1, _
                                            objDtLogic, Tbl_DocTypeTemplateMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving Doc Type Template Mst Details"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            Tbl_DocTypeTemplateMst.TableName = "VIEW_DocTypeTemplateMst"

            'Assignment of Values

            PkColArr(0) = "vDocTemplateId"

            If Not objSave.AssignValues(Tbl_DocTypeTemplateMst.TableName, PkColArr, Choice, _
                                        Ds_DocTypeTemplateMst.Tables(Tbl_DocTypeTemplateMst.TableName), _
                                        Tbl_DocTypeTemplateMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "error occured while assigning values"
                Exit Function
            End If



            ' Save in MedExMst
            Tbl_DocTypeTemplateMst.TableName = "VIEW_DocTypeTemplateMst"
            If Not objSave.SaveInDb("Insert_DocTypeTemplateMst", Tbl_DocTypeTemplateMst, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of Doc Type Template In Database"
                Exit Function
            End If


            DataReturnList = DataReturnList.Item(0)
            RetuVal = DataReturnList.Item(0)

            DocId_Retu = RetuVal.ParameterValue

            Save_DocTypeTemplateMst = True

            If Save_DocTypeTemplateMst Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Doc Type Template Details"
            Save_DocTypeTemplateMst = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try
    End Function
#End Region

#Region "Save_CountryMaster"
    Public Function Save_CountryMaster(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_CountryMaster As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_CountryMst As Data.DataTable = Nothing
        Dim Instr_CountryMst As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_CountryMaster Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_CountryMaster.Tables("View_CountryMst").Rows

                    Instr_CountryMst += IIf(Instr_CountryMst = "", "", ",").ToString + _
                                    tr("vCountryId").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of Drug Analytes Matrix
            If Not objHelpDbTbl.GetCountryMaster("vCountryId In(" + Instr_CountryMst + ")", dataRet_1, _
                                            objDtLogic, Tbl_CountryMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving Country Master"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vCountryId"

            If Not objSave.AssignValues(Tbl_CountryMst.TableName, PkColArr, Choice, _
                                        Ds_CountryMaster.Tables(Tbl_CountryMst.TableName), _
                                        Tbl_CountryMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in Drug Analytes Matrix
            If Not objSave.SaveInDb("Insert_CountryMst", Tbl_CountryMst, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of Country Master In Database"
                Exit Function
            End If

            Save_CountryMaster = True

            If Save_CountryMaster Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

            'objDtLogic.Close_Connection()
        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Country Master"
            Save_CountryMaster = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "Save_SpecialityMaster"
    Public Function Save_SpecialityMaster(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_SpecialityMaster As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_SpecialityMst As Data.DataTable = Nothing
        Dim Instr_SpecialityNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_SpecialityMaster Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_SpecialityMaster.Tables("SpecialityMst").Rows

                    Instr_SpecialityNo += IIf(Instr_SpecialityNo = "", "", ",").ToString + _
                                    tr("vCountryId").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of Drug Analytes Matrix
            If Not objHelpDbTbl.GetSpecialityMaster("nSpecialityNo In(" + Instr_SpecialityNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_SpecialityMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving Speciality Master"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nSpecialityNo"

            If Not objSave.AssignValues(Tbl_SpecialityMst.TableName, PkColArr, Choice, _
                                        Ds_SpecialityMaster.Tables(Tbl_SpecialityMst.TableName), _
                                        Tbl_SpecialityMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in Drug Analytes Matrix
            If Not objSave.SaveInDb("Insert_SpecialityMst", Tbl_SpecialityMst, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of Country Master In Database"
                Exit Function
            End If

            Save_SpecialityMaster = True

            If Save_SpecialityMaster Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

            'objDtLogic.Close_Connection()
        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Speciality Master"
            Save_SpecialityMaster = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

#Region " Save_ChildWorkSpaceMstSite "
    Public Function Save_ChildWorkSpaceMstSite(ByVal Choice As DataObjOpenSaveModeEnum, _
                                ByVal Ds_ChildWorkSpaceMstSite As Data.DataSet, _
                                ByVal objDtLogic As ClsDataLogic_New, _
                                ByVal UserCode_1 As String, _
                                ByRef eStr_Retu As String) As Boolean


        'Dim objDtLogic As New ClsDataLogic_New
        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_WorkSpaceMst As Data.DataTable = Nothing
        Dim Tbl_workspaceProtocolDetailMatrix As Data.DataTable = Nothing
        Dim Tbl_workspaceprotocoldetail As Data.DataTable = Nothing
        Dim Instr_WorkSpaceId As String = ""
        Dim vWorkspaceId As String = ""
        Dim WorkspaceId_Edit As String = ""
        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_ChildWorkSpaceMstSite Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            If Not IsNothing(Ds_ChildWorkSpaceMstSite.Tables("Proc_ParentToChild")) Then
                Tbl_WorkSpaceMst = Ds_ChildWorkSpaceMstSite.Tables("Proc_ParentToChild")
            End If

            'If Not IsNothing(Ds_ChildWorkSpaceMstSite.Tables("workspaceprotocoldetail")) Then
            '    Tbl_workspaceprotocoldetail = Ds_ChildWorkSpaceMstSite.Tables("workspaceprotocoldetail")
            'End If

            If Not IsNothing(Ds_ChildWorkSpaceMstSite.Tables("workspaceProtocolDetailMatrix")) Then
                Tbl_workspaceProtocolDetailMatrix = Ds_ChildWorkSpaceMstSite.Tables("workspaceProtocolDetailMatrix")
            End If


            'Function called only if edit is called
            'If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
            '    For Each tr As Data.DataRow In Ds_ChildWorkSpaceMstSite.Tables("workspacemst").Rows

            '        Instr_WorkSpaceId += IIf(Instr_WorkSpaceId = "", "", ",").ToString + _
            '                        tr("vWorkSpaceId").ToString

            '    Next tr
            'End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of workspacemst
            'If Not objHelpDbTbl.getworkspacemst("vWorkSpaceId In (" + Instr_WorkSpaceId + ")", dataRet_1, _
            '                                objDtLogic, Tbl_WorkSpaceMst, eStr_Retu) Then

            '    eStr_Retu += vbCrLf + "Error occured while retrieving workspacemst"
            '    Exit Function
            'End If

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vWorkSpaceId"

            'If Not objSave.AssignValues(Tbl_WorkSpaceMst.TableName, PkColArr, Choice, _
            '                            Ds_ChildWorkSpaceMstSite.Tables(Tbl_WorkSpaceMst.TableName), _
            '                            Tbl_WorkSpaceMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
            '    eStr_Retu += vbCrLf + "Error occured while assigning values"
            '    Exit Function
            'End If

            'Comment by pratiksha As while editing it will insert new child site
            'Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add
            '''''''



            ' Save in Workspace Master
            If Not objSave.SaveInDb("Proc_ParentToChild", Tbl_WorkSpaceMst, Choice, DataReturnList, eStr_Retu, True) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of workspacemst In Database"
                Exit Function
            End If
            DataReturnList = DataReturnList.Item(0)
            RetuVal = DataReturnList.Item(0)

            'Do comment after testing
            'If Not IsNothing(Ds_ChildWorkSpaceMstSite.Tables("workspaceprotocoldetail")) Then
            '    For Each dr As Data.DataRow In Tbl_workspaceprotocoldetail.Rows
            '        dr("vWorkspaceId") = RetuVal.ParameterValue
            '    Next
            'End If

            If Not IsNothing(Ds_ChildWorkSpaceMstSite.Tables("workspaceProtocolDetailMatrix")) Then
                For Each dr As Data.DataRow In Tbl_workspaceProtocolDetailMatrix.Rows
                    dr("vWorkspaceId") = RetuVal.ParameterValue
                Next
            End If

            ''For workspaceprotocoldetail
            'Do comment after testing
            'If Not IsNothing(Ds_ChildWorkSpaceMstSite.Tables("workspaceprotocoldetail")) Then

            '    If Not objSave.SaveInDb("Insert_ProtocolDetails", Tbl_workspaceprotocoldetail, Choice, Nothing, eStr_Retu) Then
            '        eStr_Retu += vbCrLf + "Error occured while Save Information of workspaceprotocoldetail In Database"
            '        Exit Function
            '    End If

            'End If

            'For workspaceProtocolDetailMatrix
            If Not IsNothing(Ds_ChildWorkSpaceMstSite.Tables("workspaceProtocolDetailMatrix")) Then

                If Not objSave.SaveInDb("Insert_ProtocolDetailMatrix", Tbl_workspaceProtocolDetailMatrix, Choice, Nothing, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of workspaceProtocolDetailMatrix In Database"
                    Exit Function
                End If

            End If

            Save_ChildWorkSpaceMstSite = True

            If Save_ChildWorkSpaceMstSite Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

            'objDtLogic.Close_Connection()

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving workspacemst"
            Save_ChildWorkSpaceMstSite = False
            objDtLogic.RollBack_Transaction()
            'objDtLogic.Close_Connection()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

    '************************
    'satyam
    '*************************

#Region "Save_WorkSpaceSubjectMst"
    Public Function Save_WorkSpaceSubjectMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_WorkSpaceSubjectMst As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_WorkSpaceSubjectMst As Data.DataTable = Nothing
        Dim Instr_WorkSpaceSubjectMstCode As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_WorkSpaceSubjectMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                For Each tr As Data.DataRow In Ds_WorkSpaceSubjectMst.Tables("view_WorkspaceSubjectMst").Rows

                    Instr_WorkSpaceSubjectMstCode += IIf(Instr_WorkSpaceSubjectMstCode = "", "", ",").ToString + _
                                    tr("vWorkspaceSubjectId").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of WorkspaceSubjectMst
            If Not objHelpDbTbl.GetViewWorkspaceSubjectMst("vWorkSpaceSubjectId In (" + Instr_WorkSpaceSubjectMstCode + ")", dataRet_1, _
                                            objDtLogic, Tbl_WorkSpaceSubjectMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving WorkspaceSubjectMst"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vWorkSpaceSubjectId"

            If Not objSave.AssignValues(Tbl_WorkSpaceSubjectMst.TableName, PkColArr, Choice, _
                                        Ds_WorkSpaceSubjectMst.Tables(Tbl_WorkSpaceSubjectMst.TableName), _
                                        Tbl_WorkSpaceSubjectMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in WorkspaceSubjectMst
            If Not objSave.SaveInDb("Insert_WorkspaceSubjectMaster", Tbl_WorkSpaceSubjectMst, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of WorkspaceSubjectMst In Database"
                Exit Function
            End If

            Save_WorkSpaceSubjectMst = True

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving WorkspaceSubjectMst"
            Save_WorkSpaceSubjectMst = False
        End Try

    End Function
#End Region

#Region "Save_SubjectBlobDetails"
    Public Function Save_SubjectBlobDetails(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_SubjectBlobDetails As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim objHelpDbTbl As clsHelpDbTable = Nothing
        Dim dataRet_1 As DataRetrievalModeEnum
        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_SubjectBlobDetails As Data.DataTable = Nothing
        Dim Instr_WorkSpaceNodeId As String = ""
        Dim Instr_SubjectID As String = ""

        Dim PkColArr(2) As String
        Dim DataReturnList As New ArrayList

        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_SubjectBlobDetails Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If
            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)
            Tbl_SubjectBlobDetails = New DataTable


            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Delete Then
                For Each tr As Data.DataRow In Ds_SubjectBlobDetails.Tables("SubjectBlobDetails").Rows

                    Instr_SubjectID += IIf(Instr_SubjectID = "", "", ",").ToString + _
                                    tr("vSubjectID").ToString + tr("cRecordType").ToString + tr("itranNo").ToString

                Next tr
            End If

            dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Delete Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)


            If Not objHelpDbTbl.getSubjectBlobDetails("vSubjectId + cRecordType + cast(itranNo as varchar(4)) In ('" + Instr_SubjectID + "')", dataRet_1, _
                                            objDtLogic, Tbl_SubjectBlobDetails, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving Subject Master"
                Exit Function
            End If

            Tbl_SubjectBlobDetails = Ds_SubjectBlobDetails.Tables("SubjectBlobDetails")

            ' Save in SubjectBlobDetails
            If Not objSave.SaveInDb("Insert_SubjectBlobDetails", Tbl_SubjectBlobDetails, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of SubjectBlobDetails In Database"
                Exit Function
            End If

            Save_SubjectBlobDetails = True

            If Save_SubjectBlobDetails Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving SubjectBlobDetails"
            Save_SubjectBlobDetails = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "Save_DocTemplateWorkspaceDtl"
    Public Function Save_DocTemplateWorkspaceDtl(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_DocTemplateWorkspaceDtl As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean
        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim Dt_View As Data.DataView = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_DocTemplateWorkspaceDtl As Data.DataTable = Nothing

        Dim Instr_vDocTemplateId As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing
        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_DocTemplateWorkspaceDtl Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            Ds_DocTemplateWorkspaceDtl.Tables(0).TableName = "VIEW_DocTemplateWorkspaceDtl"
            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_DocTemplateWorkspaceDtl.Tables("VIEW_DocTemplateWorkspaceDtl").Rows

                    Instr_vDocTemplateId += IIf(Instr_vDocTemplateId = "", "'", ",'").ToString + _
                                    tr("vDocTemplateId").ToString + "'"

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of DoctypeMst
            If Not objHelpDbTbl.GetDocTemplateWorkspaceDtl("vDocTemplateId in (" + Instr_vDocTemplateId + ")", dataRet_1, _
                                            objDtLogic, Tbl_DocTemplateWorkspaceDtl, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving Doc Type Template Mst Details"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            Tbl_DocTemplateWorkspaceDtl.TableName = "VIEW_DocTemplateWorkspaceDtl"

            'Assignment of Values

            PkColArr(0) = "vDocTemplateId"

            If Not objSave.AssignValues(Tbl_DocTemplateWorkspaceDtl.TableName, PkColArr, Choice, _
                                        Ds_DocTemplateWorkspaceDtl.Tables(Tbl_DocTemplateWorkspaceDtl.TableName), _
                                        Tbl_DocTemplateWorkspaceDtl, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "error occured while assigning values"
                Exit Function
            End If



            ' Save in MedExMst
            Tbl_DocTemplateWorkspaceDtl.TableName = "VIEW_DocTemplateWorkspaceDtl"
            If Not objSave.SaveInDb("Insert_DocTemplateWorkspaceDtl", Tbl_DocTemplateWorkspaceDtl, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of DocTemplateWorkspaceDtl In Database"
                Exit Function
            End If

            Save_DocTemplateWorkspaceDtl = True

            If Save_DocTemplateWorkspaceDtl Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

            'objDtLogic.Close_Connection()
        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving DocTemplateWorkspaceDtl Details"
            Save_DocTemplateWorkspaceDtl = False
            objDtLogic.RollBack_Transaction()
            'objDtLogic.Close_Connection()
        Finally
            objDtLogic.Close_Connection()
        End Try
    End Function
#End Region

    '************************
    'Added by Chandresh Vanker on 02-02-2009
    '*************************

#Region "Save_SampleDetail"
    Public Function Save_SampleDetail(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_SampleDetail As DataSet, _
                                 ByVal objDtLogic As ClsDataLogic_New, _
                                 ByVal UserCode_1 As String, _
                                 ByRef nSampleId_Retu As String, _
                                 ByRef vSampleId_Retu As String, _
                                 ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing
        Dim objLambda As ClsMaster = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_SampleDetail As Data.DataTable = Nothing
        Dim Tbl_SampleMedExDetail As Data.DataTable = Nothing
        Dim Tbl_SampleTemplateDetail As Data.DataTable = Nothing

        Dim Instr_SampleId As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal1 As ParameterReturnValue = Nothing
        Dim RetuVal2 As ParameterReturnValue = Nothing


        Try

            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            'Logic Of save Start
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_SampleDetail Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_SampleDetail.Tables("SampleDetail").Rows

                    Instr_SampleId += IIf(Instr_SampleId = "", "", ",").ToString + _
                                    tr("nSampleId").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of SampleDetail
            If Not objHelpDbTbl.GetSampleDetail("nSampleId In (" + Instr_SampleId + ")", dataRet_1, _
                                            objDtLogic, Tbl_SampleDetail, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving SampleDetail"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nSampleId"
            If Not objSave.AssignValues(Tbl_SampleDetail.TableName, PkColArr, Choice, _
                                        Ds_SampleDetail.Tables(Tbl_SampleDetail.TableName), _
                                        Tbl_SampleDetail, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in SampleDetail
            If Not objSave.SaveInDb("Insert_SampleDetail", Tbl_SampleDetail, Choice, DataReturnList, eStr_Retu, True) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of SampleDetail In Database"
                Exit Function
            End If

            DataReturnList = DataReturnList.Item(0)
            RetuVal1 = DataReturnList.Item(0)
            RetuVal2 = DataReturnList.Item(1)

            nSampleId_Retu = RetuVal1.ParameterValue 'Returns Generated SampleId
            vSampleId_Retu = RetuVal2.ParameterValue


            If Not Ds_SampleDetail.Tables("SampleMedExDetail") Is Nothing Then
                Tbl_SampleMedExDetail = Ds_SampleDetail.Tables("SampleMedExDetail")

                For Each dr As DataRow In Tbl_SampleMedExDetail.Rows
                    dr("nSampleId") = RetuVal1.ParameterValue
                Next dr
                Tbl_SampleMedExDetail.AcceptChanges()

                ' Save in SampleMedExDetail
                If Not objSave.SaveInDb("Insert_SampleMedExDetail", Tbl_SampleMedExDetail, Choice, DataReturnList, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of SampleMedExDetail In Database"
                    Exit Function
                End If
            End If


            If Not (Ds_SampleDetail.Tables("SampleTemplateDetail")) Is Nothing Then

                Tbl_SampleTemplateDetail = Ds_SampleDetail.Tables("SampleTemplateDetail")

                nSampleId_Retu = RetuVal1.ParameterValue 'Returns Generated SampleId
                vSampleId_Retu = RetuVal2.ParameterValue

                For Each dr As DataRow In Tbl_SampleTemplateDetail.Rows
                    dr("nSampleId") = RetuVal1.ParameterValue
                    dr("vSampleId") = RetuVal2.ParameterValue
                Next dr
                Tbl_SampleTemplateDetail.AcceptChanges()

                ' Save in SampleTeamplateDetail
                If Not objSave.SaveInDb("insert_SampleTemplateDetail", Tbl_SampleTemplateDetail, Choice, DataReturnList, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of SampleTemplateDetail In Database"
                    Exit Function
                End If

            End If

            Save_SampleDetail = True

            'Logic of Save End

            If Save_SampleDetail Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving SampleDetail"
            Save_SampleDetail = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region

#Region "Save_SampleMedExDetail"
    Public Function Save_SampleMedExDetail(ByVal Choice As DataObjOpenSaveModeEnum, _
                             ByVal Ds_SampleMedExDetail As DataSet, _
                             ByVal objDtLogic As ClsDataLogic_New, _
                             ByVal UserCode_1 As String, _
                             ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_SampleMedExDetail As Data.DataTable = Nothing
        Dim Instr_SampleId As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing


        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            'Logic Of save Start
            'Commented By Ankit
            eStr_Retu = ""


            If objDtLogic Is Nothing Then
                eStr_Retu += Environment.NewLine + "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu += Environment.NewLine + "Transaction object is not started"
                Exit Function
            End If

            If Ds_SampleMedExDetail Is Nothing Then
                eStr_Retu += Environment.NewLine + "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Or DataObjOpenSaveModeEnum.DataObjOpenMode_Delete Then
                For Each tr As Data.DataRow In Ds_SampleMedExDetail.Tables("SampleMedExDetail").Rows
                    '======added on 20-nov-2009=by Deepak Singh===
                    If tr("nSampleMedexNo").ToString = "" Then
                        Exit For
                    ElseIf tr("nSampleMedexNo").ToString <> "" Then
                        Instr_SampleId += IIf(Instr_SampleId = "", "", ",").ToString + _
                                        tr("nSampleMedexNo").ToString

                    End If
                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of SampleMedExDetail



            If Not objHelpDbTbl.Get_ViewSampleMedExDetail("nSampleMedexNo In (" + Instr_SampleId + ")", dataRet_1, _
                                            objDtLogic, Tbl_SampleMedExDetail, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving SampleMedExDetail"
                Exit Function
            End If
            Tbl_SampleMedExDetail.TableName = "SampleMedExDetail"




            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nSampleMedexNo"

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then

                If Not objSave.AssignValues(Tbl_SampleMedExDetail.TableName, PkColArr, Choice, _
                                                        Ds_SampleMedExDetail.Tables(Tbl_SampleMedExDetail.TableName), _
                                                        Tbl_SampleMedExDetail, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while assigning values"
                    Exit Function
                End If

            Else 'For Edit / Delete Mode On

                Dim Dv_SampleMedExDetail As New DataView
                Dv_SampleMedExDetail = Ds_SampleMedExDetail.Tables(Tbl_SampleMedExDetail.TableName).Copy.DefaultView()
                Dv_SampleMedExDetail.RowFilter = "cStatusIndi = 'D'"

                If Dv_SampleMedExDetail.ToTable.Rows.Count > 0 Then
                    If Not objSave.AssignValues(Tbl_SampleMedExDetail.TableName, PkColArr, Choice, _
                                                                            Dv_SampleMedExDetail.ToTable(), _
                                                                            Tbl_SampleMedExDetail, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                        eStr_Retu += vbCrLf + "Error occured while assigning values"
                        Exit Function
                    End If
                End If

                Tbl_SampleMedExDetail = Ds_SampleMedExDetail.Tables(Tbl_SampleMedExDetail.TableName).Copy()
                'Tbl_SampleMedExDetail = Dv_SampleMedExDetail.ToTable()
                ''Ds_SampleMedExDetail.Tables(Dv_SampleMedExDetail.ToTable.TableName).Copy()
                ''Tbl_SampleMedExDetail = Ds_SampleMedExDetail.Tables(Tbl_SampleMedExDetail.TableName).Copy()

            End If

            ' Save in SampleMedExDetail
            If Not objSave.SaveInDb("Insert_SampleMedExDetail", Tbl_SampleMedExDetail, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of SampleMedExDetail In Database"
                Exit Function
            End If

            If Tbl_SampleMedExDetail.Columns.Contains("cReleaseStatus") Then
                If Convert.ToString(Tbl_SampleMedExDetail.Rows(0)("cReleaseStatus")) = "S" Then
                    If Not objSave.SaveInDb("Insert_SampleMedExDetailReleaseStatus", Tbl_SampleMedExDetail, Choice, DataReturnList, eStr_Retu) Then
                        eStr_Retu += vbCrLf + "Error occured while Save Information of SampleMedExDetail In Database"
                        Exit Function
                    End If
                End If
            End If

            Save_SampleMedExDetail = True

            'Logic of Save End

            If Save_SampleMedExDetail Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving SampleMedExDetail"
            Save_SampleMedExDetail = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region

#Region "Save_SampleTypeSendReceiveDetail"
    Public Function Save_SampleTypeSendReceiveDetail(ByVal Choice As DataObjOpenSaveModeEnum, _
                             ByVal Ds_SampleTypeSendReceiveDetail As DataSet, _
                             ByVal objDtLogic As ClsDataLogic_New, _
                             ByVal UserCode_1 As String, _
                             ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_SampleTypeSendReceiveDetail As Data.DataTable = Nothing
        Dim Instr_nSampleTypeSendReceiveDetailNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing


        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            'Logic Of save Start
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_SampleTypeSendReceiveDetail Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_SampleTypeSendReceiveDetail.Tables("SampleTypeSendReceiveDetail").Rows

                    Instr_nSampleTypeSendReceiveDetailNo += IIf(Instr_nSampleTypeSendReceiveDetailNo = "", "", ",").ToString + _
                                    tr("nSampleTypeSendReceiveDetailNo").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of SampleTypeSendReceiveDetail
            If Not objHelpDbTbl.GetSampleTypeSendReceiveDetail("nSampleTypeSendReceiveDetailNo In (" + Instr_nSampleTypeSendReceiveDetailNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_SampleTypeSendReceiveDetail, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving SampleTypeSendReceiveDetail"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nSampleTypeSendReceiveDetailNo"
            If Not objSave.AssignValues(Tbl_SampleTypeSendReceiveDetail.TableName, PkColArr, Choice, _
                                        Ds_SampleTypeSendReceiveDetail.Tables(Tbl_SampleTypeSendReceiveDetail.TableName), _
                                        Tbl_SampleTypeSendReceiveDetail, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in SampleTypeSendReceiveDetail
            If Not objSave.SaveInDb("Insert_SampleTypeSendReceiveDetail", Tbl_SampleTypeSendReceiveDetail, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of SampleTypeSendReceiveDetail In Database"
                Exit Function
            End If

            Save_SampleTypeSendReceiveDetail = True

            'Logic of Save End

            If Save_SampleTypeSendReceiveDetail Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving SampleTypeSendReceiveDetail"
            Save_SampleTypeSendReceiveDetail = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region '========Added on 05-02-2009'========Added on 05-02-2009

#Region "Save_OtherExpHdr"
    Public Function Save_OtherExpHdr(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_OtherExpHdr As DataSet, _
                                 ByVal objDtLogic As ClsDataLogic_New, _
                                 ByVal UserCode_1 As String, _
                                 ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_OtherExpHdr As Data.DataTable = Nothing
        Dim Tbl_OtherExpDtl As Data.DataTable = Nothing

        Dim Instr_OtherExpHdrNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            'Logic Of save Start
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_OtherExpHdr Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                For Each tr As Data.DataRow In Ds_OtherExpHdr.Tables("OtherExpHdr").Rows

                    Instr_OtherExpHdrNo += IIf(Instr_OtherExpHdrNo = "", "", ",").ToString + _
                                    tr("nOtherExpHdrNo").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of OtherExpHdr
            If Not objHelpDbTbl.GetOtherExpHdr("nOtherExpHdrNo In (" + Instr_OtherExpHdrNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_OtherExpHdr, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving OtherExpHdr"
                Exit Function
            End If

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nOtherExpHdrNo"
            If Not objSave.AssignValues(Tbl_OtherExpHdr.TableName, PkColArr, Choice, _
                                        Ds_OtherExpHdr.Tables(Tbl_OtherExpHdr.TableName), _
                                        Tbl_OtherExpHdr, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in OtherExpHdr
            If Not objSave.SaveInDb("Insert_OtherExpHdr", Tbl_OtherExpHdr, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of OtherExpHdr In Database"
                Exit Function
            End If

            If Not Ds_OtherExpHdr.Tables("OtherExpDtl") Is Nothing Then
                Tbl_OtherExpDtl = Ds_OtherExpHdr.Tables("OtherExpDtl")

                DataReturnList = DataReturnList.Item(0)
                RetuVal = DataReturnList.Item(0)

                For Each dr As DataRow In Tbl_OtherExpDtl.Rows
                    dr("nOtherExpHdrNo") = RetuVal.ParameterValue
                Next dr
                Tbl_OtherExpDtl.AcceptChanges()

                ' Save in OtherExpDtl
                If Not objSave.SaveInDb("Insert_OtherExpDtl", Tbl_OtherExpDtl, Choice, DataReturnList, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of OtherExpDtl In Database"
                    Exit Function
                End If

            End If
            Save_OtherExpHdr = True

            'Logic of Save End

            If Save_OtherExpHdr Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If
        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving OtherExpHdr"
            Save_OtherExpHdr = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region '=====================Added on 11-02-2009

#Region "Save_OtherExpDtl"
    Public Function Save_OtherExpDtl(ByVal Choice As DataObjOpenSaveModeEnum, _
                             ByVal Ds_OtherExpDtl As DataSet, _
                             ByVal objDtLogic As ClsDataLogic_New, _
                             ByVal UserCode_1 As String, _
                             ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_OtherExpDtl As Data.DataTable = Nothing
        Dim Instr_OtherExpDtlNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            'Logic Of save Start
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_OtherExpDtl Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                For Each tr As Data.DataRow In Ds_OtherExpDtl.Tables("OtherExpDtl").Rows

                    Instr_OtherExpDtlNo += IIf(Instr_OtherExpDtlNo = "", "", ",").ToString + _
                                    tr("nOtherExpDtlNo").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of OtherExpDtl
            If Not objHelpDbTbl.GetOtherExpDtl("nOtherExpDtlNo In (" + Instr_OtherExpDtlNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_OtherExpDtl, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving OtherExpDtl"
                Exit Function
            End If

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nOtherExpDtlNo"
            If Not objSave.AssignValues(Tbl_OtherExpDtl.TableName, PkColArr, Choice, _
                                        Ds_OtherExpDtl.Tables(Tbl_OtherExpDtl.TableName), _
                                        Tbl_OtherExpDtl, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in OtherExpDtl
            If Not objSave.SaveInDb("Insert_OtherExpDtl", Tbl_OtherExpDtl, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of OtherExpDtl In Database"
                Exit Function
            End If

            Save_OtherExpDtl = True

            'Logic of Save End

            If Save_OtherExpDtl Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving OtherExpDtl"
            Save_OtherExpDtl = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region

#Region "Save_ScopeMst"
    Public Function Save_ScopeMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_ScopeMst As DataSet, _
                                 ByVal objDtLogic As ClsDataLogic_New, _
                                 ByVal UserCode_1 As String, _
                                 ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_ScopeMst As Data.DataTable = Nothing

        Dim Instr_ScopeNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_ScopeMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                For Each tr As Data.DataRow In Ds_ScopeMst.Tables("ScopeMst").Rows

                    Instr_ScopeNo += IIf(Instr_ScopeNo = "", "", ",").ToString + _
                                    tr("nScopeNo").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of ScopeMst
            If Not objHelpDbTbl.GetScopeMst("nScopeNo In (" + Instr_ScopeNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_ScopeMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving ScopeMst"
                Exit Function
            End If

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nScopeNo"
            If Not objSave.AssignValues(Tbl_ScopeMst.TableName, PkColArr, Choice, _
                                        Ds_ScopeMst.Tables(Tbl_ScopeMst.TableName), _
                                        Tbl_ScopeMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in ScopeMst
            If Not objSave.SaveInDb("Insert_ScopeMst", Tbl_ScopeMst, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of ScopeMst In Database"
                Exit Function
            End If

            Save_ScopeMst = True

            If Save_ScopeMst Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving ScopeMst"
            Save_ScopeMst = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region '========================Added on 25-02-2009

#Region "Save_UserLoginDetails"

    Public Function Save_UserLoginDetails(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_UserLoginDetails As DataSet, _
                                 ByVal UserCode_1 As String, _
                                 ByRef eStr_Retu As String) As Boolean
        Dim objDtLogic As New ClsDataLogic_New()

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_UserLoginDetails As Data.DataTable = Nothing

        Dim Instr_UserID As String = ""

        Dim PkColArr(0) As String

        Dim DataReturnList As New ArrayList

        Dim RetuVal As ParameterReturnValue = Nothing


        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            'Logic Of save Start
            eStr_Retu = ""


            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_UserLoginDetails Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Or Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Delete Then
                For Each tr As Data.DataRow In Ds_UserLoginDetails.Tables("UserLoginDetails").Rows

                    Instr_UserID += IIf(Instr_UserID = "", "", ",").ToString + _
                                    tr("iUserID").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of User Login Details
            If Not objHelpDbTbl.GetUserLoginDetails("iUserId In (" + Instr_UserID + ")", dataRet_1, _
                                            objDtLogic, Tbl_UserLoginDetails, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving User Login Details"
                Exit Function
            End If



            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "iUserID"

            If Not objSave.AssignValues(Ds_UserLoginDetails.Tables(0).TableName, PkColArr, Choice, _
                                        Ds_UserLoginDetails.Tables(0), _
                                        Tbl_UserLoginDetails, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in UserLoginDetails
            If Not objSave.SaveInDb("Insert_UserLoginDetails", Tbl_UserLoginDetails, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Saving User Login Details In Database"
                Exit Function
            End If


            Save_UserLoginDetails = True

            If Save_UserLoginDetails Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while Saving User Login Details"
            Save_UserLoginDetails = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function

#End Region '================Added on 06-05-2009===================For PassWord Policy

#Region "Save_UOMMst"
    Public Function Save_UOMMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_UOMMst As DataSet, _
                                 ByVal objDtLogic As ClsDataLogic_New, _
                                 ByVal UserCode_1 As String, _
                                 ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_UOMMst As Data.DataTable = Nothing

        Dim Instr_UOMCode As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_UOMMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                For Each tr As Data.DataRow In Ds_UOMMst.Tables("UOMMst").Rows

                    Instr_UOMCode += IIf(Instr_UOMCode = "", "", ",").ToString + _
                                    tr("vUOMCode").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of ScopeMst
            If Not objHelpDbTbl.GetUOMMst("vUOMCode In (" + Instr_UOMCode + ")", dataRet_1, _
                                            objDtLogic, Tbl_UOMMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving UOMMst"
                Exit Function
            End If

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vUOMCode"
            If Not objSave.AssignValues(Tbl_UOMMst.TableName, PkColArr, Choice, _
                                        Ds_UOMMst.Tables(Tbl_UOMMst.TableName), _
                                        Tbl_UOMMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in ScopeMst
            If Not objSave.SaveInDb("Insert_UOMMst", Tbl_UOMMst, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of UOMMst In Database"
                Exit Function
            End If

            Save_UOMMst = True

            If Save_UOMMst Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving UOMMst"
            Save_UOMMst = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region '========================Added on 03-06-2009

#Region "Save_SubjectProofDetails"

    Public Function Save_SubjectProofDetails(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_SubjectProofDetails As DataSet, _
                                 ByVal UserCode_1 As String, _
                                 ByRef Retu_TranNo As String, _
                                 ByRef eStr_Retu As String) As Boolean
        Dim objDtLogic As New ClsDataLogic_New()

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_SubjectProofDetails As Data.DataTable = Nothing

        Dim Instr_SubjectProofNo As String = ""

        Dim PkColArr(0) As String

        Dim DataReturnList As New ArrayList

        Dim RetuVal As ParameterReturnValue = Nothing


        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            'Logic Of save Start
            eStr_Retu = ""


            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_SubjectProofDetails Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If



            Tbl_SubjectProofDetails = Ds_SubjectProofDetails.Tables(0)


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Or Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Delete Then
                For Each tr As Data.DataRow In Ds_SubjectProofDetails.Tables("SubjectProofDetails").Rows

                    Instr_SubjectProofNo += IIf(Instr_SubjectProofNo = "", "", ",").ToString + _
                                    tr("nSubjectProofNo").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of User Login Details
            If Not objHelpDbTbl.GetSubjectProofDetails("nSubjectProofNo In (" + Instr_SubjectProofNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_SubjectProofDetails, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving SubjectProofDetails"
                Exit Function
            End If



            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            ''Assignment of Values
            PkColArr(0) = "nSubjectProofNo"

            If Not objSave.AssignValues(Ds_SubjectProofDetails.Tables(0).TableName, PkColArr, Choice, _
                                        Ds_SubjectProofDetails.Tables(0), _
                                        Tbl_SubjectProofDetails, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in UserLoginDetails
            If Not objSave.SaveInDb("Insert_SubjectProofDetails", Ds_SubjectProofDetails.Tables(0), Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Saving SubjectProofDetails In Database"
                Exit Function
            End If

            DataReturnList = DataReturnList.Item(0)
            RetuVal = DataReturnList.Item(0)
            Retu_TranNo = RetuVal.ParameterValue

            Save_SubjectProofDetails = True

            If Save_SubjectProofDetails Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while Saving SubjectProofDetails"
            Save_SubjectProofDetails = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function

#End Region '================Added on 27-07-2009===================

#Region "Save_CollectionDetail"

    Public Function Save_CollectionDetail(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_CollectionDetail As DataSet, _
                                 ByVal UserCode_1 As String, _
                                 ByRef eStr_Retu As String) As Boolean
        Dim objDtLogic As New ClsDataLogic_New()

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_CollectionDetail As Data.DataTable = Nothing

        Dim Instr_CollectionNo As String = ""

        Dim PkColArr(0) As String

        Dim DataReturnList As New ArrayList

        Dim RetuVal As ParameterReturnValue = Nothing


        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            'Logic Of save Start
            eStr_Retu = ""


            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_CollectionDetail Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Or Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Delete Then
                For Each tr As Data.DataRow In Ds_CollectionDetail.Tables("CollectionDetail").Rows

                    Instr_CollectionNo += IIf(Instr_CollectionNo = "", "", ",").ToString + _
                                    tr("nCollectionNo").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of User Login Details
            If Not objHelpDbTbl.GetCollectionDetail("nCollectionNo In (" + Instr_CollectionNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_CollectionDetail, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving CollectionDetail"
                Exit Function
            End If



            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nCollectionNo"

            If Not objSave.AssignValues(Ds_CollectionDetail.Tables(0).TableName, PkColArr, Choice, _
                                        Ds_CollectionDetail.Tables(0), _
                                        Tbl_CollectionDetail, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in UserLoginDetails
            If Not objSave.SaveInDb("Insert_CollectionDetail", Tbl_CollectionDetail, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Saving CollectionDetail In Database"
                Exit Function
            End If

            'DataReturnList = DataReturnList.Item(0)
            'RetuVal = DataReturnList.Item(0)
            'Retu_TranNo = RetuVal.ParameterValue

            Save_CollectionDetail = True

            If Save_CollectionDetail Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while Saving CollectionDetail"
            Save_CollectionDetail = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function

#End Region '================Added on 31-07-2009===================

#Region "Save_SubjectWorkspaceAssignment"

    Public Function Save_SubjectWorkspaceAssignment(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_SubjectWorkspaceAssignment As DataSet, _
                                 ByVal UserCode_1 As String, _
                                 ByRef eStr_Retu As String) As Boolean
        Dim objDtLogic As New ClsDataLogic_New()

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_SubjectWorkspaceAssignment As Data.DataTable = Nothing

        Dim Instr_nSubjectWorkspaceId As String = ""

        Dim PkColArr(0) As String

        Dim DataReturnList As New ArrayList

        Dim RetuVal As ParameterReturnValue = Nothing


        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            'Logic Of save Start
            eStr_Retu = ""


            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_SubjectWorkspaceAssignment Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Or Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Delete Then
                For Each tr As Data.DataRow In Ds_SubjectWorkspaceAssignment.Tables("SubjectWorkspaceAssignment").Rows

                    Instr_nSubjectWorkspaceId += IIf(Instr_nSubjectWorkspaceId = "", "", ",").ToString + _
                                    tr("nSubjectWorkspaceId").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of User Login Details
            If Not objHelpDbTbl.GetSubjectWorkspaceAssignment("nSubjectWorkspaceId In (" + Instr_nSubjectWorkspaceId + ")", dataRet_1, _
                                            objDtLogic, Tbl_SubjectWorkspaceAssignment, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving SubjectWorkspaceAssignment"
                Exit Function
            End If



            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nSubjectWorkspaceId"

            If Not objSave.AssignValues(Ds_SubjectWorkspaceAssignment.Tables(0).TableName, PkColArr, Choice, _
                                        Ds_SubjectWorkspaceAssignment.Tables(0), _
                                        Tbl_SubjectWorkspaceAssignment, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in UserLoginDetails
            If Not objSave.SaveInDb("Insert_SubjectWorkspaceAssignment", Tbl_SubjectWorkspaceAssignment, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Saving SubjectWorkspaceAssignment In Database"
                Exit Function
            End If

            'DataReturnList = DataReturnList.Item(0)
            'RetuVal = DataReturnList.Item(0)
            'Retu_TranNo = RetuVal.ParameterValue

            Save_SubjectWorkspaceAssignment = True

            If Save_SubjectWorkspaceAssignment Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while Saving SubjectWorkspaceAssignment"
            Save_SubjectWorkspaceAssignment = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function

#End Region '================Added on 11-08-2009===================

#Region "Save_SubjectLabReportDetail"

    Public Function Save_SubjectLabReportDetail(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_SubjectLabReportDetail As DataSet, _
                                 ByVal UserCode_1 As String, _
                                 ByRef eStr_Retu As String) As Boolean
        Dim objDtLogic As New ClsDataLogic_New()

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_SubjectLabReportDetail As Data.DataTable = Nothing

        Dim Instr_nSubjectLabReportNo As String = ""

        Dim PkColArr(0) As String

        Dim DataReturnList As New ArrayList

        Dim RetuVal As ParameterReturnValue = Nothing


        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            'Logic Of save Start
            eStr_Retu = ""


            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_SubjectLabReportDetail Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Or Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Delete Then
                For Each tr As Data.DataRow In Ds_SubjectLabReportDetail.Tables("SubjectLabReportDetail").Rows

                    Instr_nSubjectLabReportNo += IIf(Instr_nSubjectLabReportNo = "", "", ",").ToString + _
                                    tr("nSubjectLabReportNo").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of User Login Details
            If Not objHelpDbTbl.GetSubjectLabReportDetail("nSubjectLabReportNo In (" + Instr_nSubjectLabReportNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_SubjectLabReportDetail, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving SubjectLabReportDetail"
                Exit Function
            End If



            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nSubjectLabReportNo"

            If Not objSave.AssignValues(Ds_SubjectLabReportDetail.Tables(0).TableName, PkColArr, Choice, _
                                        Ds_SubjectLabReportDetail.Tables(0), _
                                        Tbl_SubjectLabReportDetail, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in UserLoginDetails
            If Not objSave.SaveInDb("Insert_SubjectLabReportDtl", Tbl_SubjectLabReportDetail, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Saving SubjectLabReportDetail In Database"
                Exit Function
            End If

            'DataReturnList = DataReturnList.Item(0)
            'RetuVal = DataReturnList.Item(0)
            'Retu_TranNo = RetuVal.ParameterValue

            Save_SubjectLabReportDetail = True

            If Save_SubjectLabReportDetail Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while Saving SubjectLabReportDetail"
            Save_SubjectLabReportDetail = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function

#End Region '================Added on 27-08-2009===================

#Region "Save_UserLoginFailureDetails"
    Public Function Save_UserLoginFailureDetails(ByVal Choice As DataObjOpenSaveModeEnum, _
                                                 ByVal Ds_UserLoginFailureDetails As DataSet, _
                                                 ByRef eStr_Retu As String) As Boolean
        Dim objDtLogic As New ClsDataLogic_New()

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_UserLoginFailureDetails As Data.DataTable = Nothing

        Dim Instr_SrNo As String = ""

        Dim PkColArr(0) As String

        Dim DataReturnList As New ArrayList

        Dim RetuVal As ParameterReturnValue = Nothing


        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            'Logic Of save Start
            eStr_Retu = ""


            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_UserLoginFailureDetails Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_UserLoginFailureDetails.Tables("UserLoginFailureDetails").Rows

                    Instr_SrNo += IIf(Instr_SrNo = "", "", ",").ToString + _
                                    tr("nSrNo").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of templateMst
            If Not objHelpDbTbl.GetUserLoginFailureDetails("nSrNo In (" + Instr_SrNo + ")", dataRet_1, _
                                                           objDtLogic, Tbl_UserLoginFailureDetails, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving User Login Failure Details"
                Exit Function
            End If

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nSrNo"

            If Not objSave.AssignValues(Ds_UserLoginFailureDetails.Tables(0).TableName, PkColArr, Choice, _
                                        Ds_UserLoginFailureDetails.Tables(0), _
                                        Tbl_UserLoginFailureDetails, Tbl_Audit, False, "", serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in UserLoginFailureDetails
            If Not objSave.SaveInDb("Insert_UserLoginFailureDetails", Tbl_UserLoginFailureDetails, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Saving User Login Failure Details In Database"
                Exit Function
            End If

            Save_UserLoginFailureDetails = True

            If Save_UserLoginFailureDetails Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

            'objDtLogic.Close_Connection()
        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while Saving User Login Failure Details"
            Save_UserLoginFailureDetails = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region '================Added on 16-09-2009===================

#Region "Save_CRFHdrForCTM"
    Public Function Save_CRFHdrForCTM(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_CRFHdr As Data.DataSet, _
                                        ByVal objHdrogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime
        Dim Tbl_CRFHdr As Data.DataTable = Nothing
        Dim Instr_nCRFHdrNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            eStr_Retu = ""
            objHdrogic.Open_Connection()
            objHdrogic.Begin_Transaction()

            If objHdrogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objHdrogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_CRFHdr Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If
            Tbl_CRFHdr = Ds_CRFHdr.Tables("CRFHdr")

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_CRFHdr.Tables("CRFHdr").Rows

                    Instr_nCRFHdrNo += IIf(Instr_nCRFHdrNo = "", "", ",").ToString + _
                                      tr("nCRFHdrNo").ToString.Trim()

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objHdrogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objHdrogic)

            'Retrieval of CRFHdrNo
            If Not objHelpDbTbl.GetCRFHdrForCTM("nCRFHdrNo In (" + Instr_nCRFHdrNo + ")", dataRet_1, _
                                            objHdrogic, Tbl_CRFHdr, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving CRFHdr"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objHdrogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nCRFHdrNo"

            If Not objSave.AssignValues(Tbl_CRFHdr.TableName, PkColArr, Choice, _
                                        Ds_CRFHdr.Tables(Tbl_CRFHdr.TableName), _
                                        Tbl_CRFHdr, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in CRFHdr

            If Not objSave.SaveInDb("Insert_CRFHdr", Tbl_CRFHdr, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of CRFHdr In Database"
                Exit Function
            End If
            DataReturnList = DataReturnList.Item(0)
            RetuVal = DataReturnList.Item(0)
            '********************************************

            Save_CRFHdrForCTM = True

            If Save_CRFHdrForCTM Then
                objHdrogic.Commit_Transaction()
            Else
                objHdrogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving CRFHdr"
            Save_CRFHdrForCTM = False
            objHdrogic.RollBack_Transaction()
        Finally
            objHdrogic.Close_Connection()
        End Try

    End Function
#End Region '================Added on 19-12-2009===================

#Region "Save_CRFDtl"
    Public Function Save_CRFDtl(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_CRFDtl As Data.DataSet, _
                                        ByVal objHdrogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime
        Dim Tbl_CRFDtl As Data.DataTable = Nothing
        Dim Instr_nCRFDtlNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            eStr_Retu = ""
            objHdrogic.Open_Connection()
            objHdrogic.Begin_Transaction()

            If objHdrogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objHdrogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_CRFDtl Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If
            Tbl_CRFDtl = Ds_CRFDtl.Tables("CRFDtl")

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_CRFDtl.Tables("CRFDtl").Rows

                    Instr_nCRFDtlNo += IIf(Instr_nCRFDtlNo = "", "", ",").ToString + _
                                      tr("nCRFDtlNo").ToString.Trim()

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objHdrogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objHdrogic)

            'Retrieval of CRFHdrNo
            If Not objHelpDbTbl.GetCRFDtl("nCRFDtlNo In (" + Instr_nCRFDtlNo + ")", dataRet_1, _
                                            objHdrogic, Tbl_CRFDtl, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving CRFDtl"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objHdrogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nCRFDtlNo"

            If Not objSave.AssignValues(Tbl_CRFDtl.TableName, PkColArr, Choice, _
                                        Ds_CRFDtl.Tables(Tbl_CRFDtl.TableName), _
                                        Tbl_CRFDtl, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in CRFDtl

            If Not objSave.SaveInDb("Insert_CRFDtl", Tbl_CRFDtl, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of CRFDtl In Database"
                Exit Function
            End If
            DataReturnList = DataReturnList.Item(0)
            RetuVal = DataReturnList.Item(0)
            '********************************************

            Save_CRFDtl = True

            If Save_CRFDtl Then
                objHdrogic.Commit_Transaction()
            Else
                objHdrogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving CRFDtl"
            Save_CRFDtl = False
            objHdrogic.RollBack_Transaction()
        Finally
            objHdrogic.Close_Connection()
        End Try

    End Function
#End Region '================Added on 19-12-2009===================

#Region "Save_CRFSubDtl"
    Public Function Save_CRFSubDtl(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_CRFSubDtl As Data.DataSet, _
                                        ByVal objHdrogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime
        Dim Tbl_CRFSubDtl As Data.DataTable = Nothing
        Dim Tbl_DCFMst As Data.DataTable = Nothing
        Dim Instr_nCRFSubDtlNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            eStr_Retu = ""
            objHdrogic.Open_Connection()
            objHdrogic.Begin_Transaction()

            If objHdrogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objHdrogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_CRFSubDtl Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If
            Tbl_CRFSubDtl = Ds_CRFSubDtl.Tables("CRFSubDtl")

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_CRFSubDtl.Tables("CRFSubDtl").Rows

                    Instr_nCRFSubDtlNo += IIf(Instr_nCRFSubDtlNo = "", "", ",").ToString + _
                                      tr("nCRFSubDtlNo").ToString.Trim()

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objHdrogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objHdrogic)

            'Retrieval of CRFHdrNo
            If Not objHelpDbTbl.GetCRFSubDtl("nCRFSubDtlNo In (" + Instr_nCRFSubDtlNo + ")", dataRet_1, _
                                            objHdrogic, Tbl_CRFSubDtl, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving CRFSubDtl"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objHdrogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nCRFSubDtlNo"

            If Not objSave.AssignValues(Tbl_CRFSubDtl.TableName, PkColArr, Choice, _
                                        Ds_CRFSubDtl.Tables(Tbl_CRFSubDtl.TableName), _
                                        Tbl_CRFSubDtl, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in CRFHdr

            If Not objSave.SaveInDb("Insert_CRFSubDtl", Tbl_CRFSubDtl, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of CRFSubDtl In Database"
                Exit Function
            End If
            DataReturnList = DataReturnList.Item(0)
            RetuVal = DataReturnList.Item(0)
            '********************************************

            If Ds_CRFSubDtl.Tables.Contains("DCFMst") Then
                Tbl_DCFMst = Ds_CRFSubDtl.Tables("DCFMst").Copy()
                If Not objSave.SaveInDb("Insert_DCFMst", Tbl_DCFMst, Choice, Nothing, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of DCFMst In Database"
                    Exit Function
                End If
            End If

            If Ds_CRFSubDtl.Tables.Contains("DCFMst_Update") Then
                If Not objSave.SaveInDb("Insert_DCFMst", Ds_CRFSubDtl.Tables("DCFMst_Update").Copy(), DataObjOpenSaveModeEnum.DataObjOpenMode_Edit, Nothing, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of DCFMst In Database"
                    Exit Function
                End If
            End If


            Save_CRFSubDtl = True

            If Save_CRFSubDtl Then
                objHdrogic.Commit_Transaction()
            Else
                objHdrogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving CRFSubDtl"
            Save_CRFSubDtl = False
            objHdrogic.RollBack_Transaction()
        Finally
            objHdrogic.Close_Connection()
        End Try

    End Function
#End Region '================Added on 19-12-2009===================

#Region "Save_CRFWorkFlowDtl"
    Public Function Save_CRFWorkFlowDtl(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_CRFWorkFlowDtl As Data.DataSet, _
                                        ByVal objHdrogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime
        Dim Tbl_CRFWorkFlowDtl As Data.DataTable = Nothing
        Dim Instr_nCRFWorkFlowDtlNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            eStr_Retu = ""
            objHdrogic.Open_Connection()
            objHdrogic.Begin_Transaction()

            If objHdrogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objHdrogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_CRFWorkFlowDtl Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If
            Tbl_CRFWorkFlowDtl = Ds_CRFWorkFlowDtl.Tables("CRFWorkFlowDtl")

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_CRFWorkFlowDtl.Tables("CRFWorkFlowDtl").Rows

                    Instr_nCRFWorkFlowDtlNo += IIf(Instr_nCRFWorkFlowDtlNo = "", "", ",").ToString + _
                                      tr("nCRFWorkFlowDtlNo").ToString.Trim()

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objHdrogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objHdrogic)

            'Retrieval of CRFWorkFlowDtlNo
            If Not objHelpDbTbl.GetCRFWorkFlowDtl("nCRFWorkFlowDtlNo In (" + Instr_nCRFWorkFlowDtlNo + ")", dataRet_1, _
                                            objHdrogic, Tbl_CRFWorkFlowDtl, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving CRFWorkFlowDtl"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objHdrogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nCRFWorkFlowDtlNo"

            If Not objSave.AssignValues(Tbl_CRFWorkFlowDtl.TableName, PkColArr, Choice, _
                                        Ds_CRFWorkFlowDtl.Tables(Tbl_CRFWorkFlowDtl.TableName), _
                                        Tbl_CRFWorkFlowDtl, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in CRFWorkFlowDtl

            If Not objSave.SaveInDb("Insert_CRFWorkFlowDtl", Tbl_CRFWorkFlowDtl, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of CRFWorkFlowDtl In Database"
                Exit Function
            End If
            DataReturnList = DataReturnList.Item(0)
            RetuVal = DataReturnList.Item(0)
            '********************************************

            Save_CRFWorkFlowDtl = True

            If Save_CRFWorkFlowDtl Then
                objHdrogic.Commit_Transaction()
            Else
                objHdrogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving CRFWorkFlowDtl"
            Save_CRFWorkFlowDtl = False
            objHdrogic.RollBack_Transaction()
        Finally
            objHdrogic.Close_Connection()
        End Try

    End Function
#End Region '================Added on 19-12-2009===================

#Region "Save_CRFHdrDtlSubDtl"
    Public Function Save_CRFHdrDtlSubDtl(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_CRFHdrDtlSubDtl As Data.DataSet, _
                                        ByVal SaveDefaultValue As Boolean, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime
        Dim Tbl_CRFDtl As Data.DataTable = Nothing
        Dim Tbl_Top_CRFDtl As Data.DataTable = Nothing
        Dim Tbl_CRFSubDtl As Data.DataTable = Nothing
        Dim Tbl_Top_CRFSubDtl As Data.DataTable = Nothing
        Dim Tbl_CRFHdr As Data.DataTable = Nothing

        Dim Tbl_DCFMst As Data.DataTable = Nothing

        Dim Instr_CRFHdrNo As String = ""
        Dim Instr_CRFDtlNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing
        Dim RetuVal_RepeatNo As ParameterReturnValue = Nothing

        Dim DataReturnList_Mst As New ArrayList
        Dim RetuVal_Mst As ParameterReturnValue = Nothing
        Dim dr As DataRow
        Dim i As Integer

        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_CRFHdrDtlSubDtl Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If
            Tbl_CRFSubDtl = Ds_CRFHdrDtlSubDtl.Tables("CRFSubDtl")
            Tbl_CRFDtl = Ds_CRFHdrDtlSubDtl.Tables("CRFDtl")
            Tbl_CRFHdr = Ds_CRFHdrDtlSubDtl.Tables("CRFHdr")
            Tbl_DCFMst = Ds_CRFHdrDtlSubDtl.Tables("DCFMst")

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)


            If SaveDefaultValue = True Then

                ' Save in CRFHdr
                If Not objSave.SaveInDb("Insert_CRFHdr", Tbl_CRFHdr, Choice, DataReturnList, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of CRFHdr In Database"
                    Exit Function
                End If
                'Assiging New HdrNo 
                DataReturnList = DataReturnList.Item(0)
                RetuVal = DataReturnList.Item(0)

                For Each dr In Tbl_CRFDtl.Rows
                    dr("nCRFHdrNo") = RetuVal.ParameterValue
                    dr.AcceptChanges()
                Next
                Tbl_CRFDtl.AcceptChanges()
                '********************************************

                ' Save in CRFDtl
                DataReturnList = Nothing
                DataReturnList = New ArrayList

                If Not objSave.SaveInDb("Insert_CRFDtl", Tbl_CRFDtl, Choice, DataReturnList, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of CRFDtl In Database"
                    Exit Function
                End If
                '*************************************

                'Assiging New DtlNo 
                DataReturnList = DataReturnList.Item(0)
                RetuVal = DataReturnList.Item(0)
                RetuVal_RepeatNo = DataReturnList.Item(1)

                'For updating DAta status of CRF entry at the end of this method
                For Each dr In Tbl_CRFDtl.Rows
                    dr("nCRFDtlNo") = RetuVal.ParameterValue
                    dr("iRepeatNo") = RetuVal_RepeatNo.ParameterValue
                    dr.AcceptChanges()
                Next
                Tbl_CRFDtl.AcceptChanges()
                '*************************************

                For Each dr In Tbl_CRFSubDtl.Rows
                    dr("nCRFDtlNo") = RetuVal.ParameterValue
                    dr.AcceptChanges()
                Next
                Tbl_CRFSubDtl.AcceptChanges()

                If Not Tbl_DCFMst Is Nothing Then
                    'Assiging New DtlNo in DCF
                    DataReturnList = DataReturnList.Item(0)
                    RetuVal = DataReturnList.Item(0)

                    For Each dr In Tbl_DCFMst.Rows
                        dr("nCRFDtlNo") = RetuVal.ParameterValue
                        dr.AcceptChanges()
                    Next
                    Tbl_DCFMst.AcceptChanges()
                    '**********************************
                End If


                ' Save in CRFSubDtl
                DataReturnList = Nothing
                DataReturnList = New ArrayList

                If Not objSave.SaveInDb("Insert_CRFSubDtl", Tbl_CRFSubDtl, DataObjOpenSaveModeEnum.DataObjOpenMode_Add, DataReturnList, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of CRFDtl In Database"
                    Exit Function
                End If
                '*************************************
                'Save in DCFMSt
                If Not Tbl_DCFMst Is Nothing Then
                    If Not objSave.SaveInDb("Insert_DCFMst", Tbl_DCFMst, Choice, Nothing, eStr_Retu) Then
                        eStr_Retu += vbCrLf + "Error occured while Save Information of DCFMst In Database"
                        Exit Function
                    End If
                End If
                '*************************

            Else

                'Function called only if edit is called
                If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                    For Each tr As Data.DataRow In Ds_CRFHdrDtlSubDtl.Tables("CRFHdr").Rows

                        Instr_CRFHdrNo += IIf(Instr_CRFHdrNo = "", "", ",").ToString + _
                                          tr("nCRFHdrNo").ToString.Trim()

                    Next tr
                End If

                If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                    dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
                Else
                    dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
                End If

                'Retrieval of CRFHdr
                If Not objHelpDbTbl.GetCRFHdr("nCRFHdrNo In (" + Instr_CRFHdrNo + ")", dataRet_1, _
                                                objDtLogic, Tbl_CRFHdr, eStr_Retu) Then

                    eStr_Retu += vbCrLf + "Error occured while retrieving CRFHdr"
                    Exit Function
                End If


                'Retrieval of Online_AuditInfo
                If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                                  Tbl_Audit, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                    Exit Function
                End If

                'Assignment of Values
                PkColArr(0) = "nCRFHdrNo"
                Tbl_Audit = New DataTable()

                If Not objSave.AssignValuesForCRFHDRDTLSUBDTL(Tbl_CRFHdr.TableName, PkColArr, Choice, _
                                            Ds_CRFHdrDtlSubDtl.Tables(Tbl_CRFHdr.TableName), _
                                            Tbl_CRFHdr, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while assigning values"
                    Exit Function
                End If

                ' Save in CRFHdr

                If Not objSave.SaveInDb("Insert_CRFHdr", Tbl_CRFHdr, Choice, DataReturnList, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of CRFHdr In Database"
                    Exit Function
                End If
                'Assiging New HdrNo 
                DataReturnList = DataReturnList.Item(0)
                RetuVal = DataReturnList.Item(0)

                For Each dr In Tbl_CRFDtl.Rows
                    dr("nCRFHdrNo") = RetuVal.ParameterValue
                    dr.AcceptChanges()
                Next
                Tbl_CRFDtl.AcceptChanges()
                '********************************************

                ' Save in CRFDtl
                If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                    'First we are saving only first Row and after that will save other rows 
                    'for getting Return value (iscreenId) for Bulk Save with same iScreenId

                    'To Add Only first row into the table and get itranNo as return value
                    Tbl_Top_CRFDtl = Tbl_CRFDtl.Copy
                    For i = Tbl_Top_CRFDtl.Rows.Count - 1 To 1 Step -1
                        Tbl_Top_CRFDtl.Rows(i).Delete()
                        Tbl_Top_CRFDtl.AcceptChanges()
                    Next
                    'Here first record go as tran No 0 because as per the condition in Procedure for getting new tran No.
                    For Each dr In Tbl_Top_CRFDtl.Rows
                        dr("iRepeatNo") = 0
                        dr.AcceptChanges()
                    Next
                    Tbl_Top_CRFDtl.AcceptChanges()

                    DataReturnList = Nothing
                    DataReturnList = New ArrayList

                    If Not objSave.SaveInDb("Insert_CRFDtl", Tbl_Top_CRFDtl, Choice, DataReturnList, eStr_Retu) Then
                        eStr_Retu += vbCrLf + "Error occured while Save Information of CRFDtl In Database"
                        Exit Function
                    End If
                    '*************************************

                    Tbl_CRFDtl.Rows(0).Delete()
                    Tbl_CRFDtl.AcceptChanges()

                    'Assiging New iTranno for Other than first rows
                    DataReturnList = DataReturnList.Item(0)
                    RetuVal = DataReturnList.Item(0)
                    RetuVal_RepeatNo = DataReturnList.Item(1)

                    If RetuVal.ParameterValue = 0 AndAlso RetuVal_RepeatNo.ParameterValue = 0 Then
                        eStr_Retu = "Entry already done in this page, Kindly open the page again to change the data."
                        Save_CRFHdrDtlSubDtl = False
                        objDtLogic.RollBack_Transaction()
                        Exit Function
                    End If

                    'For updating DAta status of CRF entry at the end of this method
                    For Each dr In Tbl_CRFDtl.Rows
                        dr("nCRFDtlNo") = RetuVal.ParameterValue
                        dr("iRepeatNo") = RetuVal_RepeatNo.ParameterValue
                        dr.AcceptChanges()
                    Next
                    Tbl_CRFDtl.AcceptChanges()

                    'Assigning Repeat no for updating flag of CRF entry at the end of this method
                    For Each dr In Tbl_Top_CRFDtl.Rows
                        dr("nCRFDtlNo") = RetuVal.ParameterValue
                        dr("iRepeatNo") = RetuVal_RepeatNo.ParameterValue
                        dr.AcceptChanges()
                    Next
                    Tbl_Top_CRFDtl.AcceptChanges()
                    '*********************

                End If

                'Now saving Remaining Rows with same iRepeatNo
                If Tbl_CRFDtl.Rows.Count > 0 Then
                    DataReturnList = Nothing
                    DataReturnList = New ArrayList
                    If Not objSave.SaveInDb("Insert_CRFDtl", Tbl_CRFDtl, Choice, DataReturnList, eStr_Retu) Then
                        eStr_Retu += vbCrLf + "Error occured while Save Information of CRFDtl In Database"
                        Exit Function
                    End If
                    DataReturnList = DataReturnList.Item(0)
                End If
                '********************************************

                'Assiging New DtlNo 
                If DataReturnList.Count > 0 Then
                    RetuVal = DataReturnList.Item(0)
                    RetuVal_RepeatNo = DataReturnList.Item(1)

                    'For updating DAta status of CRF entry at the end of this method
                    For Each dr In Tbl_CRFDtl.Rows
                        dr("nCRFDtlNo") = RetuVal.ParameterValue
                        dr("iRepeatNo") = RetuVal_RepeatNo.ParameterValue
                        dr.AcceptChanges()
                    Next
                    Tbl_CRFDtl.AcceptChanges()
                    '*************************************

                    For Each dr In Tbl_CRFSubDtl.Rows
                        dr("nCRFDtlNo") = RetuVal.ParameterValue
                        dr.AcceptChanges()
                    Next
                    Tbl_CRFSubDtl.AcceptChanges()

                    '********************************************
                    'Assiging New DtlNo in DCF
                    If Not Tbl_DCFMst Is Nothing Then
                        For Each dr In Tbl_DCFMst.Rows
                            dr("nCRFDtlNo") = RetuVal.ParameterValue
                            dr.AcceptChanges()
                        Next
                        Tbl_DCFMst.AcceptChanges()
                        '**********************************
                    End If
                End If

                ' Save in CRFDtl
                If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                    'First we are saving only first Row and after that will save other rows 
                    'for getting Return value (iscreenId) for Bulk Save with same iScreenId

                    'To Add Only first row into the table and get itranNo as return value

                    Tbl_Top_CRFSubDtl = Tbl_CRFSubDtl.Copy
                    For i = Tbl_Top_CRFSubDtl.Rows.Count - 1 To 1 Step -1
                        Tbl_Top_CRFSubDtl.Rows(i).Delete()
                        Tbl_Top_CRFSubDtl.AcceptChanges()
                    Next
                    'Here first record go as tran No 0 because as per the condition in Procedure for getting new tran No.
                    For Each dr In Tbl_Top_CRFSubDtl.Rows
                        dr("iTranNo") = 0
                        dr.AcceptChanges()
                    Next
                    Tbl_Top_CRFSubDtl.AcceptChanges()

                    DataReturnList = Nothing
                    DataReturnList = New ArrayList

                    If Not objSave.SaveInDb("Insert_CRFSubDtl", Tbl_Top_CRFSubDtl, DataObjOpenSaveModeEnum.DataObjOpenMode_Add, DataReturnList, eStr_Retu) Then
                        eStr_Retu += vbCrLf + "Error occured while Save Information of CRFSubDtl In Database"
                        Exit Function
                    End If
                    '*************************************

                    Tbl_CRFSubDtl.Rows(0).Delete()
                    Tbl_CRFSubDtl.AcceptChanges()

                    'Assiging New iTranno for Other than first rows
                    DataReturnList = DataReturnList.Item(0)
                    RetuVal = DataReturnList.Item(0)
                    For Each dr In Tbl_CRFSubDtl.Rows
                        dr("iTranNo") = RetuVal.ParameterValue
                        dr.AcceptChanges()
                    Next

                    Tbl_CRFSubDtl.AcceptChanges()

                End If

                'Now saving Remaining Rows with same iTranNo
                If Not objSave.SaveInDb("Insert_CRFSubDtl", Tbl_CRFSubDtl, DataObjOpenSaveModeEnum.DataObjOpenMode_Add, Nothing, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of CRFSubDtl In Database"
                    Exit Function
                End If
                '********************************************

                'Save in DCFMSt
                If Not Tbl_DCFMst Is Nothing Then
                    If Not objSave.SaveInDb("Insert_DCFMst", Tbl_DCFMst, Choice, Nothing, eStr_Retu) Then
                        eStr_Retu += vbCrLf + "Error occured while Save Information of DCFMst In Database"
                        Exit Function
                    End If
                End If
                '*************************

                'Updating DataStatus flag of CRFDtl on 01-Feb-2010
                If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                    If Not Tbl_Top_CRFDtl Is Nothing Then
                        If Tbl_Top_CRFDtl.Rows.Count > 0 Then
                            DataReturnList = Nothing
                            DataReturnList = New ArrayList

                            For Each dr In Tbl_Top_CRFDtl.Rows
                                If dr("cDataStatus") = "C" Then
                                    dr("cDataStatus") = "D"
                                End If
                            Next
                            Tbl_Top_CRFDtl.AcceptChanges()

                            If Not objSave.SaveInDb("Insert_CRFDtl", Tbl_Top_CRFDtl, Choice, DataReturnList, eStr_Retu) Then
                                eStr_Retu += vbCrLf + "Error occured while Save Information of CRFDtl In Database"
                                Exit Function
                            End If
                        End If
                    End If
                End If
                If Tbl_CRFDtl.Rows.Count > 0 Then
                    DataReturnList = Nothing
                    DataReturnList = New ArrayList
                    For Each dr In Tbl_CRFDtl.Rows
                        If dr("cDataStatus") = "C" Then
                            dr("cDataStatus") = "D"
                        End If
                    Next
                    Tbl_CRFDtl.AcceptChanges()

                    If Not objSave.SaveInDb("Insert_CRFDtl", Tbl_CRFDtl, Choice, DataReturnList, eStr_Retu) Then
                        eStr_Retu += vbCrLf + "Error occured while Save Information of CRFDtl In Database"
                        Exit Function
                    End If
                End If
                '****************************

            End If

            'Adde By Maitri on 29-May-2015 to solve edit check issue (Edit checks were not fired when activity has only one attribute)
            If Not Tbl_Top_CRFDtl Is Nothing And Not Tbl_Top_CRFSubDtl Is Nothing Then
                Ds_CRFHdrDtlSubDtl.Tables.Remove("CRFSubDtl")
                Ds_CRFHdrDtlSubDtl.Tables.Remove("CRFDtl")
                Tbl_Top_CRFSubDtl.TableName = "CRFSubDtl"
                Tbl_Top_CRFDtl.TableName = "CRFDtl"
                Ds_CRFHdrDtlSubDtl.Tables.Add(Tbl_Top_CRFSubDtl)
                Ds_CRFHdrDtlSubDtl.Tables.Add(Tbl_Top_CRFDtl)
            End If

            Save_CRFHdrDtlSubDtl = True

            If Save_CRFHdrDtlSubDtl Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving CRFHdrDtlSubDtl"
            Save_CRFHdrDtlSubDtl = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region '================Added on 21-12-2009===================

#Region "Save_DCFMst"
    Public Function Save_DCFMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_DCFMst As Data.DataSet, _
                                        ByVal objHdrogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime
        Dim Tbl_DCFMst As Data.DataTable = Nothing
        Dim Instr_nDCFNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            eStr_Retu = ""
            objHdrogic.Open_Connection()
            objHdrogic.Begin_Transaction()

            If objHdrogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objHdrogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_DCFMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If
            Tbl_DCFMst = Ds_DCFMst.Tables("DCFMst")

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_DCFMst.Tables("DCFMst").Rows

                    Instr_nDCFNo += IIf(Instr_nDCFNo = "", "", ",").ToString + _
                                      tr("nDCFNo").ToString.Trim()

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objHdrogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objHdrogic)

            'Retrieval of DCFMstNo
            If Not objHelpDbTbl.GetDCFMst("nDCFNo In (" + Instr_nDCFNo + ")", dataRet_1, _
                                            objHdrogic, Tbl_DCFMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving DCFMst"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objHdrogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nDCFNo"

            If Not objSave.AssignValues(Tbl_DCFMst.TableName, PkColArr, Choice, _
                                        Ds_DCFMst.Tables(Tbl_DCFMst.TableName), _
                                        Tbl_DCFMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in DCFMst

            If Not objSave.SaveInDb("Insert_DCFMst", Tbl_DCFMst, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of DCFMst In Database"
                Exit Function
            End If

            '********************************************

            Save_DCFMst = True

            If Save_DCFMst Then
                objHdrogic.Commit_Transaction()
            Else
                objHdrogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving DCFMst"
            Save_DCFMst = False
            objHdrogic.RollBack_Transaction()
        Finally
            objHdrogic.Close_Connection()
        End Try

    End Function
#End Region '================Added on 25-12-2009===================

#Region "Save_MedExFormulaMst"
    Public Function Save_MedExFormulaMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_MedExFormulaMst As Data.DataSet, _
                                        ByVal objHdrogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime
        Dim Tbl_MedExFormulaMst As Data.DataTable = Nothing
        Dim Instr_vMedExCode As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            eStr_Retu = ""
            objHdrogic.Open_Connection()
            objHdrogic.Begin_Transaction()

            If objHdrogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objHdrogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_MedExFormulaMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If
            Tbl_MedExFormulaMst = Ds_MedExFormulaMst.Tables("MedExFormulaMst")

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_MedExFormulaMst.Tables("MedExFormulaMst").Rows

                    Instr_vMedExCode += IIf(Instr_vMedExCode = "", "", ",").ToString + _
                                      tr("vMedExCode").ToString.Trim()

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objHdrogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objHdrogic)

            'Retrieval of MedExFormulaMstNo
            If Not objHelpDbTbl.Get_MedexFormulaMst("vMedExCode In (" + Instr_vMedExCode + ")", dataRet_1, _
                                            objHdrogic, Tbl_MedExFormulaMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving MedExFormulaMst"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objHdrogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vMedExCode"

            If Not objSave.AssignValues(Tbl_MedExFormulaMst.TableName, PkColArr, Choice, _
                                        Ds_MedExFormulaMst.Tables(Tbl_MedExFormulaMst.TableName), _
                                        Tbl_MedExFormulaMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in MedExFormulaMst

            If Not objSave.SaveInDb("Insert_MedExFormulaMst", Tbl_MedExFormulaMst, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of MedExFormulaMst In Database"
                Exit Function
            End If

            '********************************************

            Save_MedExFormulaMst = True

            If Save_MedExFormulaMst Then
                objHdrogic.Commit_Transaction()
            Else
                objHdrogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving MedExFormulaMst"
            Save_MedExFormulaMst = False
            objHdrogic.RollBack_Transaction()
        Finally
            objHdrogic.Close_Connection()
        End Try

    End Function
#End Region '================Added on 02-01-2009===================

#Region "Save_MedExEditChecks"
    Public Function Save_MedExEditChecks(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_MedExEditChecks As Data.DataSet, _
                                        ByVal objHdrogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime
        Dim Tbl_MedExEditChecks As Data.DataTable = Nothing
        Dim Instr_nMedExEditCheckNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            eStr_Retu = ""
            objHdrogic.Open_Connection()
            objHdrogic.Begin_Transaction()

            If objHdrogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objHdrogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_MedExEditChecks Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If
            Tbl_MedExEditChecks = Ds_MedExEditChecks.Tables("MedExEditChecks")

            'Function called only if edit is called
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                For Each tr As Data.DataRow In Ds_MedExEditChecks.Tables("MedExEditChecks").Rows

                    Instr_nMedExEditCheckNo += IIf(Instr_nMedExEditCheckNo = "", "", ",").ToString + _
                                      tr("nMedExEditCheckNo").ToString.Trim()

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objHdrogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objHdrogic)

            'Retrieval of DCFMstNo
            If Not objHelpDbTbl.GetMedExEditChecks("nMedExEditCheckNo In (" + Instr_nMedExEditCheckNo + ")", dataRet_1, _
                                            objHdrogic, Tbl_MedExEditChecks, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving MedExEditChecks"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objHdrogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nMedExEditCheckNo"

            If Not objSave.AssignValues(Tbl_MedExEditChecks.TableName, PkColArr, Choice, _
                                        Ds_MedExEditChecks.Tables(Tbl_MedExEditChecks.TableName), _
                                        Tbl_MedExEditChecks, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in DCFMst

            If Not objSave.SaveInDb("Insert_MedExEditChecks", Tbl_MedExEditChecks, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of MedExEditChecks In Database"
                Exit Function
            End If

            '********************************************

            Save_MedExEditChecks = True

            If Save_MedExEditChecks Then
                objHdrogic.Commit_Transaction()
            Else
                objHdrogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving EditChecks"
            Save_MedExEditChecks = False
            objHdrogic.RollBack_Transaction()
        Finally
            objHdrogic.Close_Connection()
        End Try

    End Function
#End Region '================Added on 05-04-2010===================

#Region "Save_EditChecksHdrDtl"
    Public Function Save_EditChecksHdrDtl(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_EditChecksHdrDtl As Data.DataSet, _
                                        ByVal objHdrogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime
        Dim Tbl_EditChecksHdr As Data.DataTable = Nothing
        Dim Instr_nEditChecksHdrNo As String = ""

        Dim Tbl_EditChecksDtl As Data.DataTable = Nothing
        Dim Instr_nEditChecksDtlNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            eStr_Retu = ""
            objHdrogic.Open_Connection()
            objHdrogic.Begin_Transaction()

            If objHdrogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objHdrogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_EditChecksHdrDtl Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            Tbl_EditChecksHdr = Ds_EditChecksHdrDtl.Tables("EditChecksHdr")
            Tbl_EditChecksDtl = Ds_EditChecksHdrDtl.Tables("EditChecksDtl")

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_EditChecksHdrDtl.Tables("EditChecksHdr").Rows

                    Instr_nEditChecksHdrNo += IIf(Instr_nEditChecksHdrNo = "", "", ",").ToString + _
                                      tr("Instr_nEditChecksHdrNo").ToString.Trim()

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objHdrogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objHdrogic)

            'Retrieval of EditChecksHdr
            If Not objHelpDbTbl.GetEditChecksHdr("nEditChecksHdrNo In (" + Instr_nEditChecksHdrNo + ")", dataRet_1, _
                                            objHdrogic, Tbl_EditChecksHdr, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving EditChecksHdr"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objHdrogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nEditChecksHdrNo"

            If Not objSave.AssignValues(Tbl_EditChecksHdr.TableName, PkColArr, Choice, _
                                        Ds_EditChecksHdrDtl.Tables(Tbl_EditChecksHdr.TableName), _
                                        Tbl_EditChecksHdr, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            If Not objSave.SaveInDb("Insert_EditChecksHdr", Tbl_EditChecksHdr, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of EditChecksHdr In Database"
                Exit Function
            End If

            DataReturnList = DataReturnList.Item(0)
            RetuVal = DataReturnList.Item(0)

            For Each dr As DataRow In Tbl_EditChecksDtl.Rows
                dr("nEditChecksHdrNo") = RetuVal.ParameterValue
                dr.AcceptChanges()
            Next
            Tbl_EditChecksDtl.AcceptChanges()

            Dim ds_Dtl As DataSet = New DataSet
            ds_Dtl.Tables.Add(Tbl_EditChecksDtl.Copy())

            If Not BulkCopy("EditChecksDtl", ds_Dtl, eStr_Retu) Then
                Throw New Exception(eStr_Retu)
                Exit Function
            End If

            'If Not objSave.SaveInDb("Insert_EditChecksDtl", Tbl_EditChecksDtl, Choice, Nothing, eStr_Retu) Then
            '    eStr_Retu += vbCrLf + "Error occured while Save Information of EditChecksDtl In Database"
            '    Exit Function
            'End If
            '********************************************

            Save_EditChecksHdrDtl = True

            If Save_EditChecksHdrDtl Then
                objHdrogic.Commit_Transaction()
            Else
                objHdrogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving EditChecksHdr"
            Save_EditChecksHdrDtl = False
            objHdrogic.RollBack_Transaction()
        Finally
            objHdrogic.Close_Connection()
        End Try

    End Function
#End Region '================Added on 22-04-2010===================

#Region "Save_CRFLockDtl"
    Public Function Save_CRFLockDtl(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_CRFLockDtl As Data.DataSet, _
                                        ByVal objHdrogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime
        Dim Tbl_CRFLockDtl As Data.DataTable = Nothing
        Dim Tbl_CRFHdr As Data.DataTable = Nothing
        Dim Instr_nCRFLockDtlNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            eStr_Retu = ""
            objHdrogic.Open_Connection()
            objHdrogic.Begin_Transaction()

            If objHdrogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objHdrogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_CRFLockDtl Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            Tbl_CRFLockDtl = Ds_CRFLockDtl.Tables("CRFLockDtl")
            Tbl_CRFHdr = Ds_CRFLockDtl.Tables("CRFHdr")

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_CRFLockDtl.Tables("CRFLockDtl").Rows

                    Instr_nCRFLockDtlNo += IIf(Instr_nCRFLockDtlNo = "", "", ",").ToString + _
                                      tr("nCRFLockDtlNo").ToString.Trim()

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objHdrogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objHdrogic)

            'Retrieval of CRFLockDtlNo
            If Not objHelpDbTbl.GetCRFLockDtl("nCRFLockDtlNo In (" + Instr_nCRFLockDtlNo + ")", dataRet_1, _
                                            objHdrogic, Tbl_CRFLockDtl, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving CRFLockDtl"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objHdrogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nCRFLockDtlNo"

            If Not objSave.AssignValues(Tbl_CRFLockDtl.TableName, PkColArr, Choice, _
                                        Ds_CRFLockDtl.Tables(Tbl_CRFLockDtl.TableName), _
                                        Tbl_CRFLockDtl, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in CRFLockDtl
            If Not objSave.SaveInDb("Insert_CRFLockDtl", Tbl_CRFLockDtl, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of CRFLockDtl In Database"
                Exit Function
            End If
            '********************************************

            ' Save in CRFHdr

            If Not objSave.SaveInDb("Insert_CRFHdr", Tbl_CRFHdr, DataObjOpenSaveModeEnum.DataObjOpenMode_Edit, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of CRFHdr In Database"
                Exit Function
            End If

            Save_CRFLockDtl = True

            If Save_CRFLockDtl Then
                objHdrogic.Commit_Transaction()
            Else
                objHdrogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving CRFLockDtl"
            Save_CRFLockDtl = False
            objHdrogic.RollBack_Transaction()
        Finally
            objHdrogic.Close_Connection()
        End Try

    End Function
#End Region '================Added on 25-04-2010===================

#Region "Save_EditChecksDtl"
    Public Function Save_EditChecksDtl(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_EditChecksDtl As Data.DataSet, _
                                        ByVal objHdrogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_EditChecksDtl As Data.DataTable = Nothing
        Dim Instr_nEditChecksDtlNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            eStr_Retu = ""
            objHdrogic.Open_Connection()
            objHdrogic.Begin_Transaction()

            If objHdrogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objHdrogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_EditChecksDtl Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            Tbl_EditChecksDtl = Ds_EditChecksDtl.Tables("EditChecksDtl")

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_EditChecksDtl.Tables("EditChecksDtl").Rows

                    Instr_nEditChecksDtlNo += IIf(Instr_nEditChecksDtlNo = "", "", ",").ToString + _
                                      tr("nEditChecksDtlNo").ToString.Trim()

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objHdrogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objHdrogic)

            'Retrieval of EditChecksDtl
            If Not objHelpDbTbl.GetEditChecksDtl("nEditChecksDtlNo In (" + Instr_nEditChecksDtlNo + ")", dataRet_1, _
                                            objHdrogic, Tbl_EditChecksDtl, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving EditChecksDtl"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objHdrogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nEditChecksDtlNo"

            If Not objSave.AssignValues(Tbl_EditChecksDtl.TableName, PkColArr, Choice, _
                                        Ds_EditChecksDtl.Tables(Tbl_EditChecksDtl.TableName), _
                                        Tbl_EditChecksDtl, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            If Not objSave.SaveInDb("Insert_EditChecksDtl", Tbl_EditChecksDtl, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of EditChecksDtl In Database"
                Exit Function
            End If

            Save_EditChecksDtl = True

            If Save_EditChecksDtl Then
                objHdrogic.Commit_Transaction()
            Else
                objHdrogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving EditChecksDtl"
            Save_EditChecksDtl = False
            objHdrogic.RollBack_Transaction()
        Finally
            objHdrogic.Close_Connection()
        End Try

    End Function
#End Region '================Added on 29-04-2010===================

#Region "Save_OldProjects"
    Public Function Save_OldProjects(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_OldProjects As Data.DataSet, _
                                        ByVal objHdrogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime
        Dim Tbl_OldProjects As Data.DataTable = Nothing
        Dim Instr_nSerialNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            eStr_Retu = ""
            objHdrogic.Open_Connection()
            objHdrogic.Begin_Transaction()

            If objHdrogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objHdrogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_OldProjects Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If
            Tbl_OldProjects = Ds_OldProjects.Tables("OldProjects")

            'Function called only if edit is called
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                For Each tr As Data.DataRow In Ds_OldProjects.Tables("OldProjects").Rows

                    Instr_nSerialNo += IIf(Instr_nSerialNo = "", "", ",").ToString + _
                                      tr("nSerialNo").ToString.Trim()

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objHdrogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objHdrogic)

            'Retrieval of SerialNo
            If Not objHelpDbTbl.GetOldProjects("nSerialNo In (" + Instr_nSerialNo + ")", dataRet_1, _
                                            objHdrogic, Tbl_OldProjects, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving Old Projects"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objHdrogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nSerialNo"

            If Not objSave.AssignValues(Tbl_OldProjects.TableName, PkColArr, Choice, _
                                        Ds_OldProjects.Tables(Tbl_OldProjects.TableName), _
                                        Tbl_OldProjects, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in DCFMst

            If Not objSave.SaveInDb("Insert_OldProjects", Tbl_OldProjects, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of Old Projects In Database"
                Exit Function
            End If

            '********************************************

            Save_OldProjects = True

            If Save_OldProjects Then
                objHdrogic.Commit_Transaction()
            Else
                objHdrogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Old Projects"
            Save_OldProjects = False
            objHdrogic.RollBack_Transaction()
        Finally
            objHdrogic.Close_Connection()
        End Try

    End Function
#End Region '================Added on 25-08-2010===================

#Region "Save_SetProjectMatrix"
    Public Function Save_SetProjectMatrix(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal DS_SetProjectMatrix As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim Dt_View As Data.DataView = Nothing
        Dim serverDateTime_1 As DateTime
        Dim Tbl_SetProjectMatrix As Data.DataTable = Nothing

        Dim Instr_nSetProjectMatrix As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If DS_SetProjectMatrix Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            DS_SetProjectMatrix.Tables(0).TableName = "SetProjectMatrix"
            'Function called only if edit is called
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                For Each tr As Data.DataRow In DS_SetProjectMatrix.Tables("SetProjectMatrix").Rows

                    Instr_nSetProjectMatrix += IIf(Instr_nSetProjectMatrix = "", "'", ",'").ToString + _
                                    tr("nSetProjectMatrix").ToString + "'"

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of Discount MedExTemplate Matrix
            If Not objHelpDbTbl.GetSetProjectMatrix("SetProjectMatrix in (" + Instr_nSetProjectMatrix + ")", dataRet_1, _
                                            objDtLogic, Tbl_SetProjectMatrix, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving SetProjectMatrix"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            Tbl_SetProjectMatrix.TableName = "SetProjectMatrix"

            'Assignment of Values

            PkColArr(0) = "nSetProjectMatrix"

            If Not objSave.AssignValues(Tbl_SetProjectMatrix.TableName, PkColArr, Choice, _
                                        DS_SetProjectMatrix.Tables(Tbl_SetProjectMatrix.TableName), _
                                        Tbl_SetProjectMatrix, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "error occured while assigning values"
                Exit Function
            End If

            ' Save in DiscountMedExTemplateMatrix

            If Not objSave.SaveInDb("Insert_SetProjectMatrix", Tbl_SetProjectMatrix, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of SetProjectMatrix In Database"
                Exit Function
            End If

            Save_SetProjectMatrix = True

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving SetProjectMatrix Details"
            Save_SetProjectMatrix = False
        End Try



    End Function
#End Region

#Region "Save_ExpenseTypeMst"

    Public Function Save_ExpenseTypeMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_ExpenseTypeMst As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean
        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim Dt_View As Data.DataView = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_ExpenseTypeMst As Data.DataTable = Nothing

        Dim Instr_nExpenseTypeId As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_ExpenseTypeMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            Ds_ExpenseTypeMst.Tables(0).TableName = "ExpenseTypeMst"
            'Function called only if edit is called
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                For Each tr As Data.DataRow In Ds_ExpenseTypeMst.Tables("ExpenseTypeMst").Rows

                    Instr_nExpenseTypeId += IIf(Instr_nExpenseTypeId = "", "'", ",'").ToString + _
                                    tr("nExpTypeId").ToString + "'"

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of Discount MedExTemplate Matrix
            If Not objHelpDbTbl.getExpenseTypeMst("nExpTypeId in (" + Instr_nExpenseTypeId + ")", dataRet_1, _
                                            objDtLogic, Tbl_ExpenseTypeMst, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving ExpensE TypeMst"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            Tbl_ExpenseTypeMst.TableName = "ExpenseTypeMst"

            'Assignment of Values

            PkColArr(0) = "nExpTypeId"

            If Not objSave.AssignValues(Tbl_ExpenseTypeMst.TableName, PkColArr, Choice, _
                                        Ds_ExpenseTypeMst.Tables(Tbl_ExpenseTypeMst.TableName), _
                                        Tbl_ExpenseTypeMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "error occured while assigning values"
                Exit Function
            End If

            ' Save in DiscountMedExTemplateMatrix

            If Not objSave.SaveInDb("Insert_ExpenseTypeMst", Tbl_ExpenseTypeMst, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of Expense Type Mst In Database"
                Exit Function
            End If

            Save_ExpenseTypeMst = True

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Expense Type Mst Details"
            Save_ExpenseTypeMst = False
        End Try
    End Function

#End Region

#Region "Save_ExpenseMst"
    Public Function Save_ExpenseMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_ExpenseMst As Data.DataSet, _
                                        ByVal objHdrogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime
        Dim Tbl_ExpenseMst As Data.DataTable = Nothing
        Dim Instr_nExpenseMstNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            eStr_Retu = ""
            objHdrogic.Open_Connection()
            objHdrogic.Begin_Transaction()

            If objHdrogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objHdrogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_ExpenseMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            Tbl_ExpenseMst = Ds_ExpenseMst.Tables("ExpenseMst")

            'Function called only if edit is called
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                For Each tr As Data.DataRow In Ds_ExpenseMst.Tables("ExpenseMst").Rows

                    Instr_nExpenseMstNo += IIf(Instr_nExpenseMstNo = "", "", ",").ToString + _
                                      tr("nExpenseMstNo").ToString.Trim()

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objHdrogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objHdrogic)

            'Retrieval of ExpenseMstNo
            If Not objHelpDbTbl.getExpenseMst("nExpenseMstNo In (" + Instr_nExpenseMstNo + ")", dataRet_1, _
                                            objHdrogic, Tbl_ExpenseMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving ExpenseMst"
                Exit Function
            End If

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objHdrogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nExpenseMstNo"

            If Not objSave.AssignValues(Tbl_ExpenseMst.TableName, PkColArr, Choice, _
                                        Ds_ExpenseMst.Tables(Tbl_ExpenseMst.TableName), _
                                        Tbl_ExpenseMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in ExpenseMst
            If Not objSave.SaveInDb("Insert_ExpenseMst", Tbl_ExpenseMst, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of ExpenseMst In Database"
                Exit Function
            End If
            '********************************************

            Save_ExpenseMst = True

            If Save_ExpenseMst Then
                objHdrogic.Commit_Transaction()
            Else
                objHdrogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving ExpenseMst"
            Save_ExpenseMst = False
            objHdrogic.RollBack_Transaction()
        Finally
            objHdrogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "Save_DocumentReleaseDetail"

    Public Function Save_DocumentReleaseDetail(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_DocumentReleaseDetail As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean
        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim Dt_View As Data.DataView = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_DocumentReleaseDetail As Data.DataTable = Nothing

        Dim Instr_nDocumentReleaseDetailNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            eStr_Retu = ""

            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_DocumentReleaseDetail Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            Ds_DocumentReleaseDetail.Tables(0).TableName = "DocumentReleaseDetails"
            'Function called only if edit is called
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                For Each tr As Data.DataRow In Ds_DocumentReleaseDetail.Tables("DocumentReleaseDetails").Rows

                    Instr_nDocumentReleaseDetailNo += IIf(Instr_nDocumentReleaseDetailNo = "", "'", ",'").ToString + _
                                    tr("nDocReleaseNo").ToString + "'"
                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            If Not objHelpDbTbl.getDocumentReleaseDetails("nDocReleaseNo in (" + Instr_nDocumentReleaseDetailNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_DocumentReleaseDetail, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving DocumentReleaseDetails"
                Exit Function
            End If

            Tbl_DocumentReleaseDetail.TableName = "DocumentReleaseDetails"

            PkColArr(0) = "nDocReleaseNo"

            If Not objSave.AssignValues(Tbl_DocumentReleaseDetail.TableName, PkColArr, Choice, _
                                        Ds_DocumentReleaseDetail.Tables(Tbl_DocumentReleaseDetail.TableName), _
                                        Tbl_DocumentReleaseDetail, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "error occured while assigning values"
                Exit Function
            End If

            If Not objSave.SaveInDb("Insert_DocumentReleaseDetails", Tbl_DocumentReleaseDetail, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of DocumentReleaseDetails In Database"
                Exit Function
            End If

            Save_DocumentReleaseDetail = True

            If Save_DocumentReleaseDetail Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving DocumentReleaseDetails"
            Save_DocumentReleaseDetail = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function

#End Region '================Added on 24-03-2011 on request of Vishal===================

#Region "Save_ReferenceTableDefinitions"
    Public Function Save_ReferenceTableDefinitions(ByVal Choice As DataObjOpenSaveModeEnum, _
                                ByVal Ds_ReferenceTableDefinitions As Data.DataSet, _
                                ByVal objDtLogic As ClsDataLogic_New, _
                                ByVal UserCode_1 As String, _
                                ByRef eStr_Retu As String) As Boolean


        'Dim objDtLogic As New ClsDataLogic_New
        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_ReferenceTableDefinitions As Data.DataTable = Nothing



        Dim vWorkspaceId As String = ""
        Dim WorkspaceId_Edit As String = ""

        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_ReferenceTableDefinitions Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            If Not IsNothing(Ds_ReferenceTableDefinitions.Tables("ReferenceTableDefinitions")) Then
                Tbl_ReferenceTableDefinitions = Ds_ReferenceTableDefinitions.Tables("ReferenceTableDefinitions")
            End If


            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)
            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            'PkColArr(0) = "vWorkSpaceId"
            'Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add
            ' Save in Dictionary Tables 
            If Not objSave.SaveInDb("Insert_ReferenceTableDefinitions", Tbl_ReferenceTableDefinitions, Choice, DataReturnList, eStr_Retu, True) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of MeDdra Low Level Term in Database."
                Exit Function
            End If


            Save_ReferenceTableDefinitions = True

            If Save_ReferenceTableDefinitions Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If



        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving workspacemst"
            Save_ReferenceTableDefinitions = False
            objDtLogic.RollBack_Transaction()

        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function

#End Region

    '*************************************************************************************************
    '*************************************************************************************************

    '************************
    'Added by Deepak Shekhawat
    '*************************

#Region "Save_UserLoginHistory" '===Added on 14-09-09 ====
    Public Function Save_UserLoginHistory(ByVal Choice As DataObjOpenSaveModeEnum, _
                                ByVal Ds_UserLoginHistory As DataSet, _
                                ByVal UserCode_1 As String, _
                                ByRef eStr_Retu As String) As Boolean
        Dim objDtLogic As New ClsDataLogic_New()

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_UserLoginHistory As Data.DataTable = Nothing

        Dim Instr_UserLoginHistoryNo As String = ""

        Dim PkColArr(0) As String

        Dim DataReturnList As New ArrayList

        Dim RetuVal As ParameterReturnValue = Nothing


        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            'Logic Of save Start
            eStr_Retu = ""


            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_UserLoginHistory Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Or Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Delete Then
                For Each tr As Data.DataRow In Ds_UserLoginHistory.Tables("UserLoginHiistory").Rows

                    Instr_UserLoginHistoryNo += IIf(Instr_UserLoginHistoryNo = "", "", ",").ToString + _
                                    tr("nUserLoginHistoryNo").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of User Login Details
            If Not objHelpDbTbl.getUserLoginHistory("nUserLoginHistoryNo In (" + Instr_UserLoginHistoryNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_UserLoginHistory, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving User Login History"
                Exit Function
            End If



            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nUserloginHistoryNo"

            If Not objSave.AssignValues(Ds_UserLoginHistory.Tables(0).TableName, PkColArr, Choice, _
                                        Ds_UserLoginHistory.Tables(0), _
                                        Tbl_UserLoginHistory, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in UserLoginHistory
            If Not objSave.SaveInDb("Insert_UserLoginHistory", Tbl_UserLoginHistory, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Saving User Login History In Database"
                Exit Function
            End If


            Save_UserLoginHistory = True

            If Save_UserLoginHistory Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while Saving User Login History"
            Save_UserLoginHistory = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region '===Added On 14-09-09 ===

#Region "Save_MedExWorkspaceTemplateDtl"
    Public Function Save_MedExWorkspaceTemplateDtl(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_MedExWorkspaceTemplateDtl As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean
        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim Dt_View As Data.DataView = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_MedExWorkspaceTemplateDtl As Data.DataTable = Nothing
        Dim Tbl_TemplateCostMst As Data.DataTable = Nothing
        Dim Tbl_TemplateRemarkDtl As Data.DataTable = Nothing


        Dim Instr_vMedExTemplateId As String = ""

        Dim PkColArr(1) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_MedExWorkspaceTemplateDtl Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_MedExWorkspaceTemplateDtl.Tables("MedExWorkspaceTemplateDtl").Rows

                    Instr_vMedExTemplateId += IIf(Instr_vMedExTemplateId = "", "'", ",'").ToString + _
                                    tr("vMedexWorkspaceProfileId").ToString + tr("vMedExCode").ToString + "'"

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of MedExTemplateMst
            If Not objHelpDbTbl.GetMedExWorkspaceTemplateDtl("vMedexWorkspaceProfileId in (" + Instr_vMedExTemplateId + ")", dataRet_1, _
                                            objDtLogic, Tbl_MedExWorkspaceTemplateDtl, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving MedExTemplateMst Details"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vMedexWorkspaceProfileId"
            PkColArr(1) = "vMedExCode"

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then

                If Not objSave.AssignValues(Tbl_MedExWorkspaceTemplateDtl.TableName, PkColArr, Choice, _
                                            Ds_MedExWorkspaceTemplateDtl.Tables(Tbl_MedExWorkspaceTemplateDtl.TableName), _
                                            Tbl_MedExWorkspaceTemplateDtl, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "error occured while assigning values"
                    Exit Function
                End If
                ' Save in MedExTemplateMst
                If Not objSave.SaveInDb("Insert_MedExWorkspaceTemplateDtl", Tbl_MedExWorkspaceTemplateDtl, Choice, DataReturnList, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of MedEx Template Detail In Database"
                    Exit Function
                End If



                ''Added for Saving in MedExCostMst by LIMS on 22-Jul-2009
                'If Not IsNothing(Ds_MedExTemplateDtl.Tables("TemplateCostMSt")) Then

                '    Tbl_TemplateCostMst = Ds_MedExTemplateDtl.Tables("TemplateCostMSt").Copy()

                '    'Assiging New MedexCode 
                '    DataReturnList = DataReturnList.Item(0)
                '    RetuVal = DataReturnList.Item(0)

                '    For Each dr As DataRow In Tbl_TemplateCostMst.Rows
                '        dr("vTemplateCode") = RetuVal.ParameterValue
                '        dr.AcceptChanges()
                '    Next
                '    Tbl_TemplateCostMst.AcceptChanges()

                '    If Not objSave.SaveInDb("insert_TemplateCostMst", Tbl_TemplateCostMst, Choice, Nothing, eStr_Retu) Then
                '        eStr_Retu += vbCrLf + "Error occured while Save Information of Template Cost In Database"
                '        Exit Function
                '    End If

                'End If

                ''Added for Saving in TemplateRemarkDtl by LIMS 
                'If Not IsNothing(Ds_MedExTemplateDtl.Tables("TemplateRemarkDtl")) Then

                '    Tbl_TemplateRemarkDtl = Ds_MedExTemplateDtl.Tables("TemplateRemarkDtl").Copy()

                '    'Assiging New MedexCode 
                '    RetuVal = DataReturnList.Item(0)

                '    For Each dr As DataRow In Tbl_TemplateRemarkDtl.Rows
                '        dr("vTemplateCode") = RetuVal.ParameterValue
                '        dr.AcceptChanges()
                '    Next
                '    Tbl_TemplateRemarkDtl.AcceptChanges()

                '    If Not objSave.SaveInDb("Insert_TemplateRemarkDtl", Tbl_TemplateRemarkDtl, Choice, Nothing, eStr_Retu) Then
                '        eStr_Retu += vbCrLf + "Error occured while Save Information of Template Remark Dtl In Database"
                '        Exit Function
                '    End If

                'End If

                Save_MedExWorkspaceTemplateDtl = True


            ElseIf Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then

                If Not objSave.SaveInDb("Insert_MedExWorkspaceTemplateDtl", Ds_MedExWorkspaceTemplateDtl.Tables(0), Choice, DataReturnList, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of MedEx Template Detail In Database"
                    Exit Function
                End If

                If Not IsNothing(Ds_MedExWorkspaceTemplateDtl.Tables("TemplateCostMSt")) Then

                    Tbl_TemplateCostMst = Ds_MedExWorkspaceTemplateDtl.Tables("TemplateCostMSt").Copy()

                    If Not objSave.SaveInDb("insert_TemplateCostMst", Tbl_TemplateCostMst, Choice, Nothing, eStr_Retu) Then
                        eStr_Retu += vbCrLf + "Error occured while Save Information of Template Cost In Database"
                        Exit Function
                    End If

                End If

                'If Not IsNothing(Ds_MedExWorkspaceTemplateDtl.Tables("TemplateRemarkDtl")) Then

                '    Tbl_TemplateRemarkDtl = Ds_MedExWorkspaceTemplateDtl.Tables("TemplateRemarkDtl").Copy()

                '    If Not objSave.SaveInDb("Insert_TemplateRemarkDtl", Tbl_TemplateRemarkDtl, Choice, Nothing, eStr_Retu) Then
                '        eStr_Retu += vbCrLf + "Error occured while Save Information of Template Remark Dtl In Database"
                '        Exit Function
                '    End If

                'End If

                Save_MedExWorkspaceTemplateDtl = True
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving MedEx Template Master Details"
            Save_MedExWorkspaceTemplateDtl = False
        End Try
    End Function
#End Region '===Added on 12-Mar-10 ==

#Region "Save_PKSampleDetail"

    Public Function Save_PKSampleDetail(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_PKSampleDetail As DataSet, _
                                 ByVal objDtLogic As ClsDataLogic_New, _
                                 ByVal UserCode_1 As String, _
                                 ByRef nPKSampleId_Retu As String, _
                                 ByRef vPKSampleId_Retu As String, _
                                 ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_PKSampleDetail As Data.DataTable = Nothing
        Dim Tbl_SampleMedExDetail As Data.DataTable = Nothing
        Dim Tbl_SampleTemplateDetail As Data.DataTable = Nothing

        Dim Instr_SampleId As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal1 As ParameterReturnValue = Nothing
        Dim RetuVal2 As ParameterReturnValue = Nothing


        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            'Logic Of save Start
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_PKSampleDetail Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_PKSampleDetail.Tables("PKSampleDetail").Rows

                    Instr_SampleId += IIf(Instr_SampleId = "", "", ",").ToString + _
                                    tr("nPKSampleId").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of PKSampleDetail
            If Not objHelpDbTbl.PKSampleDetail("nPKSampleId In (" + Instr_SampleId + ")", dataRet_1, _
                                            objDtLogic, Tbl_PKSampleDetail, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving PKSampleDetail"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nPKSampleId"
            If Not objSave.AssignValues(Tbl_PKSampleDetail.TableName, PkColArr, Choice, _
                                        Ds_PKSampleDetail.Tables(Tbl_PKSampleDetail.TableName), _
                                        Tbl_PKSampleDetail, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in SampleDetail
            If Not objSave.SaveInDb("Insert_PKSampleDetail", Tbl_PKSampleDetail, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of PKSampleDetail In Database"
                Exit Function
            End If

            DataReturnList = DataReturnList.Item(0)
            RetuVal1 = DataReturnList.Item(0)
            RetuVal2 = DataReturnList.Item(1)

            nPKSampleId_Retu = RetuVal1.ParameterValue 'Returns Generated SampleId
            vPKSampleId_Retu = RetuVal2.ParameterValue

            If nPKSampleId_Retu = 0 AndAlso vPKSampleId_Retu = "0" Then
                eStr_Retu = "PK Sample already collected for this Subject, Kindly wait till the process ends."
                Save_PKSampleDetail = False
                objDtLogic.RollBack_Transaction()
                Exit Function
            End If

            '******************************************

            If Ds_PKSampleDetail.Tables.Contains("CRFHdr") AndAlso _
                Ds_PKSampleDetail.Tables.Contains("CRFDtl") AndAlso _
                Ds_PKSampleDetail.Tables.Contains("CRFSubDtl") Then

                Dim Tbl_CRFDtl As Data.DataTable = Nothing
                Dim Tbl_CRFSubDtl As Data.DataTable = Nothing
                Dim Tbl_CRFHdr As Data.DataTable = Nothing
                Dim RetuVal As ParameterReturnValue = Nothing
                Dim DataReturnList_CRF As New ArrayList

                Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add

                Tbl_CRFHdr = Ds_PKSampleDetail.Tables("CRFHdr")
                Tbl_CRFDtl = Ds_PKSampleDetail.Tables("CRFDtl")
                Tbl_CRFSubDtl = Ds_PKSampleDetail.Tables("CRFSubDtl")

                ' Save in CRFHdr
                If Not objSave.SaveInDb("Insert_CRFHdr", Tbl_CRFHdr, Choice, DataReturnList_CRF, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of CRFHdr In Database"
                    Exit Function
                End If
                'Assiging New HdrNo 
                DataReturnList_CRF = DataReturnList_CRF.Item(0)
                RetuVal = DataReturnList_CRF.Item(0)
                For Each dr In Tbl_CRFDtl.Rows
                    dr("nCRFHdrNo") = RetuVal.ParameterValue
                    dr("iRepeatNo") = 1
                    dr.AcceptChanges()
                Next
                Tbl_CRFDtl.AcceptChanges()
                '********************************************

                ' Save in CRFDtl
                DataReturnList_CRF = Nothing
                DataReturnList_CRF = New ArrayList
                If Not objSave.SaveInDb("Insert_CRFDtl", Tbl_CRFDtl, Choice, DataReturnList_CRF, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of CRFDtl In Database"
                    Exit Function
                End If
                '*************************************

                'Assiging New DtlNo 
                DataReturnList_CRF = DataReturnList_CRF.Item(0)
                RetuVal = DataReturnList_CRF.Item(0)

                '*************************************

                For Each dr In Tbl_CRFSubDtl.Rows
                    dr("nCRFDtlNo") = RetuVal.ParameterValue
                    dr.AcceptChanges()
                Next
                Tbl_CRFSubDtl.AcceptChanges()

                ' Save in CRFSubDtl
                DataReturnList_CRF = Nothing
                DataReturnList_CRF = New ArrayList

                If Not objSave.SaveInDb("Insert_CRFSubDtl", Tbl_CRFSubDtl, Choice, DataReturnList_CRF, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of CRFDtl In Database"
                    Exit Function
                End If
                '*************************************

            End If

            '******************************************

            Save_PKSampleDetail = True

            'Logic of Save End

            If Save_PKSampleDetail Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving PKSampleDetail"
            Save_PKSampleDetail = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function

#End Region '==Added on 06-Mar-2010===

#Region "Save_PDSampleDetail"

    Public Function Save_PDSampleDetail(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_PDSampleDetail As DataSet, _
                                 ByVal objDtLogic As ClsDataLogic_New, _
                                 ByVal UserCode_1 As String, _
                                 ByRef eStr_Retu As String) As Boolean


        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing

        Dim serverDateTime_1 As DateTime

        Dim Tbl_PDSampleDetail As Data.DataTable = Nothing




        Dim PDColArr(0) As String
        Dim DataReturnList As New ArrayList


        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            'Logic Of save Start
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_PDSampleDetail Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If
            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)
            ' Save in SampleDetail
            Tbl_PDSampleDetail = Ds_PDSampleDetail.Tables("PDSample")
            If Not objSave.SaveInDb("Insert_PDSampleDetail", Tbl_PDSampleDetail, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of PDSampleDetail In Database"
                Exit Function
            End If
            '******************************************

            If Ds_PDSampleDetail.Tables.Contains("CRFHdr") AndAlso _
                Ds_PDSampleDetail.Tables.Contains("CRFDtl") AndAlso _
                Ds_PDSampleDetail.Tables.Contains("CRFSubDtl") Then

                Dim Tbl_CRFDtl As Data.DataTable = Nothing
                Dim Tbl_CRFSubDtl As Data.DataTable = Nothing
                Dim Tbl_CRFHdr As Data.DataTable = Nothing
                Dim RetuVal As ParameterReturnValue = Nothing
                Dim DataReturnList_CRF As New ArrayList

                Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add

                Tbl_CRFHdr = Ds_PDSampleDetail.Tables("CRFHdr")
                Tbl_CRFDtl = Ds_PDSampleDetail.Tables("CRFDtl")
                Tbl_CRFSubDtl = Ds_PDSampleDetail.Tables("CRFSubDtl")

                ' Save in CRFHdr
                If Not objSave.SaveInDb("Insert_CRFHdr", Tbl_CRFHdr, Choice, DataReturnList_CRF, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of CRFHdr In Database"
                    Exit Function
                End If
                'Assiging New HdrNo 
                DataReturnList_CRF = DataReturnList_CRF.Item(0)
                RetuVal = DataReturnList_CRF.Item(0)
                For Each dr In Tbl_CRFDtl.Rows
                    dr("nCRFHdrNo") = RetuVal.ParameterValue
                    dr("iRepeatNo") = 1
                    dr.AcceptChanges()
                Next
                Tbl_CRFDtl.AcceptChanges()
                '********************************************

                ' Save in CRFDtl
                DataReturnList_CRF = Nothing
                DataReturnList_CRF = New ArrayList
                If Not objSave.SaveInDb("Insert_CRFDtl", Tbl_CRFDtl, Choice, DataReturnList_CRF, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of CRFDtl In Database"
                    Exit Function
                End If
                '*************************************

                'Assiging New DtlNo 
                DataReturnList_CRF = DataReturnList_CRF.Item(0)
                RetuVal = DataReturnList_CRF.Item(0)

                '*************************************

                For Each dr In Tbl_CRFSubDtl.Rows
                    dr("nCRFDtlNo") = RetuVal.ParameterValue
                    dr.AcceptChanges()
                Next
                Tbl_CRFSubDtl.AcceptChanges()

                ' Save in CRFSubDtl
                DataReturnList_CRF = Nothing
                DataReturnList_CRF = New ArrayList

                If Not objSave.SaveInDb("Insert_CRFSubDtl", Tbl_CRFSubDtl, Choice, DataReturnList_CRF, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of CRFDtl In Database"
                    Exit Function
                End If
                '*************************************

            End If

            '******************************************

            Save_PDSampleDetail = True

            'Logic of Save End

            If Save_PDSampleDetail Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving PDSampleDetail"
            Save_PDSampleDetail = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function

#End Region '==Added on 06-Mar-2010===

#Region "Save_LabRptLockUnlockDtl"

    Public Function Save_LabRptLockUnlockDtl(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_LabRptLockUnlockDtl As DataSet, _
                                 ByVal UserCode_1 As String, _
                                 ByRef eStr_Retu As String) As Boolean
        Dim objDtLogic As New ClsDataLogic_New()

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_LabRptLockUnlockDtl As Data.DataTable = Nothing

        Dim Instr_nLabRptLockUnlockDtlNo As String = ""

        Dim PkColArr(0) As String

        Dim DataReturnList As New ArrayList

        Dim RetuVal As ParameterReturnValue = Nothing


        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            'Logic Of save Start
            eStr_Retu = ""


            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_LabRptLockUnlockDtl Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Or Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Delete Then
                For Each tr As Data.DataRow In Ds_LabRptLockUnlockDtl.Tables("LabRptLockUnlockDtl").Rows

                    Instr_nLabRptLockUnlockDtlNo += IIf(Instr_nLabRptLockUnlockDtlNo = "", "", ",").ToString + _
                                    tr("nLabRptLockUnlockDtlNo").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of User Login Details
            If Not objHelpDbTbl.GetLabRptLockUnlockDtl("nLabRptLockUnlockDtlNo In (" + Instr_nLabRptLockUnlockDtlNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_LabRptLockUnlockDtl, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving LabRptLockUnlockDtl"
                Exit Function
            End If



            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nLabRptLockUnlockDtlNo"

            If Not objSave.AssignValues(Ds_LabRptLockUnlockDtl.Tables(0).TableName, PkColArr, Choice, _
                                        Ds_LabRptLockUnlockDtl.Tables(0), _
                                        Tbl_LabRptLockUnlockDtl, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in UserLoginDetails
            If Not objSave.SaveInDb("Insert_LabRptLockUnlockDtl", Tbl_LabRptLockUnlockDtl, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Saving LabRptLockUnlockDtl In Database"
                Exit Function
            End If

            'DataReturnList = DataReturnList.Item(0)
            'RetuVal = DataReturnList.Item(0)
            'Retu_TranNo = RetuVal.ParameterValue

            Save_LabRptLockUnlockDtl = True

            If Save_LabRptLockUnlockDtl Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while Saving LabRptLockUnlockDtl"
            Save_LabRptLockUnlockDtl = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function

#End Region '==Added on 09-June-2010===

#Region "Save_ScreeeningLockDtl"

    Public Function Save_ScreeeningLockDtl(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_ScreeningLockDtl As DataSet, _
                                 ByVal UserCode_1 As String, _
                                 ByRef eStr_Retu As String) As Boolean
        Dim objDtLogic As New ClsDataLogic_New()

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_ScreeningLockDtl As Data.DataTable = Nothing

        Dim Instr_nScreeningLockDtlNo As String = ""

        Dim PkColArr(0) As String

        Dim DataReturnList As New ArrayList

        Dim RetuVal As ParameterReturnValue = Nothing


        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            'Logic Of save Start
            eStr_Retu = ""


            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_ScreeningLockDtl Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Or Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Delete Then
                For Each tr As Data.DataRow In Ds_ScreeningLockDtl.Tables("ScreeningLockDtl").Rows

                    Instr_nScreeningLockDtlNo += IIf(Instr_nScreeningLockDtlNo = "", "", ",").ToString + _
                                    tr("nScreeningLockDtlNo").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of User Login Details
            If Not objHelpDbTbl.GetScreeningLockDtl("nScreeningLockDtlNo In (" + Instr_nScreeningLockDtlNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_ScreeningLockDtl, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving ScreeningLockDtl"
                Exit Function
            End If



            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nScreeningLockDtlNo"

            If Not objSave.AssignValues(Ds_ScreeningLockDtl.Tables(0).TableName, PkColArr, Choice, _
                                        Ds_ScreeningLockDtl.Tables(0), _
                                        Tbl_ScreeningLockDtl, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in UserLoginDetails
            If Not objSave.SaveInDb("Insert_ScreeningLockDtl", Tbl_ScreeningLockDtl, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Saving ScreeningLockDtl In Database"
                Exit Function
            End If

            'DataReturnList = DataReturnList.Item(0)
            'RetuVal = DataReturnList.Item(0)
            'Retu_TranNo = RetuVal.ParameterValue

            Save_ScreeeningLockDtl = True

            If Save_ScreeeningLockDtl Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while Saving ScreeningLockDtl"
            Save_ScreeeningLockDtl = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function

#End Region '==Added on 05-July-2010===

#Region "Save_ReportTypeMst"

    Public Function Save_ReportTypeMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_ReportTypeMst As DataSet, _
                                 ByVal UserCode_1 As String, _
                                 ByRef eStr_Retu As String) As Boolean
        Dim objDtLogic As New ClsDataLogic_New()

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_ReportTypeMst As Data.DataTable = Nothing

        Dim Instr_nReportTypeMstNo As String = ""

        Dim PkColArr(0) As String

        Dim DataReturnList As New ArrayList

        Dim RetuVal As ParameterReturnValue = Nothing


        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            'Logic Of save Start
            eStr_Retu = ""


            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_ReportTypeMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Or Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Delete Then
                For Each tr As Data.DataRow In Ds_ReportTypeMst.Tables("ReportTypeMst").Rows

                    Instr_nReportTypeMstNo += IIf(Instr_nReportTypeMstNo = "", "", ",").ToString + _
                                    tr("nReportTypeMstNo").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of User Login Details
            If Not objHelpDbTbl.ReportTypeMst("nReportTypeMstNo In (" + Instr_nReportTypeMstNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_ReportTypeMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving ReportTypeMst"
                Exit Function
            End If



            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nReportTypeMstNo"

            If Not objSave.AssignValues(Ds_ReportTypeMst.Tables(0).TableName, PkColArr, Choice, _
                                        Ds_ReportTypeMst.Tables(0), _
                                        Tbl_ReportTypeMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in UserLoginDetails
            If Not objSave.SaveInDb("Insert_ReportTypeMst", Tbl_ReportTypeMst, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Saving ReportTypeMst In Database"
                Exit Function
            End If

            'DataReturnList = DataReturnList.Item(0)
            'RetuVal = DataReturnList.Item(0)
            'Retu_TranNo = RetuVal.ParameterValue

            Save_ReportTypeMst = True

            If Save_ReportTypeMst Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while Saving ReportTypeMst"
            Save_ReportTypeMst = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function

#End Region

#Region "WorkspaceProtocoldetail"
    Public Function Save_WorkspaceProtocoldetail(ByVal Choice As DataObjOpenSaveModeEnum, _
                                ByVal Ds_WorkSpaceProtocoldetail As Data.DataSet, _
                                ByVal UserCode_1 As String, _
                                ByRef RequestId As String, _
                                ByRef eStr_Retu As String) As Boolean


        Dim objDtLogic As New ClsDataLogic_New
        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime
        Dim Tbl_workspaceprotocoldetail As Data.DataTable = Nothing
        Dim Instr_WorkSpaceId As String = ""
        Dim vWorkspaceId As String = ""
        Dim WorkspaceId_Edit As String = ""
        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_WorkSpaceProtocoldetail Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If



            Tbl_workspaceprotocoldetail = Ds_WorkSpaceProtocoldetail.Tables(0)

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_WorkSpaceProtocoldetail.Tables("Workspaceprotocoldetail").Rows

                    Instr_WorkSpaceId += IIf(Instr_WorkSpaceId = "", "", ",").ToString + _
                                    tr("vWorkSpaceId").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of workspaceprotocoldetail
            If Not objHelpDbTbl.getWorkspaceProtocolDetail("vWorkSpaceId In (" + Instr_WorkSpaceId + ")", dataRet_1, _
                                            objDtLogic, Tbl_workspaceprotocoldetail, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving workspaceProtocoldetail"
                Exit Function
            End If

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vWorkSpaceId"

            If Not objSave.AssignValues(Tbl_workspaceprotocoldetail.TableName, PkColArr, Choice, _
                                        Ds_WorkSpaceProtocoldetail.Tables(Tbl_workspaceprotocoldetail.TableName), _
                                        Tbl_workspaceprotocoldetail, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If



            If Not objSave.SaveInDb("Insert_ProtocolDetails", Tbl_workspaceprotocoldetail, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of workspaceprotocoldetail In Database"
                Exit Function
            End If

            'If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
            '    DataReturnList = DataReturnList.Item(0)
            '    RetuVal = DataReturnList.Item(0)
            '    If Not CType(DataReturnList.Item(1), ParameterReturnValue) Is Nothing Then
            '        If CType(DataReturnList.Item(1), ParameterReturnValue).ParameterName.ToUpper = "@VREQUESTID" Then
            '            RequestId = CType(DataReturnList.Item(1), ParameterReturnValue).ParameterValue
            '        Else
            '            Throw New Exception("Parameter: RequestId not Found")
            '        End If
            '    End If

            '    If RetuVal.ParameterName.ToUpper <> "@NEWWORKSPACEID" Then
            '        Throw New Exception("Parameter: NewWorkspaceId not Found")
            '    End If

            '    If Not IsNothing(Ds_WorkSpaceMst.Tables("workspaceprotocoldetail")) Then
            '        For Each dr As Data.DataRow In Tbl_workspaceprotocoldetail.Rows
            '            dr("vWorkspaceId") = RetuVal.ParameterValue
            '        Next
            '    End If

            '    If Not IsNothing(Ds_WorkSpaceMst.Tables("workspacesubjectmst")) Then
            '        For Each dr As Data.DataRow In Tbl_workspacesubjectmst.Rows
            '            dr("vWorkspaceId") = RetuVal.ParameterValue
            '        Next
            '    End If

            '    If Not IsNothing(Ds_WorkSpaceMst.Tables("workspaceProtocolDetailMatrix")) Then
            '        For Each dr As Data.DataRow In Tbl_workspaceProtocolDetailMatrix.Rows
            '            dr("vWorkspaceId") = RetuVal.ParameterValue
            '        Next
            '    End If

            'Else

            '    WorkspaceId_Edit = Tbl_WorkSpaceMst.Rows(0).Item("vWorkspaceId")

            '    If Not IsNothing(Ds_WorkSpaceMst.Tables("workspaceprotocoldetail")) Then
            '        For Each dr As Data.DataRow In Tbl_workspaceprotocoldetail.Rows
            '            dr("vWorkspaceId") = WorkspaceId_Edit.Trim()
            '        Next
            '    End If


            '    If Not IsNothing(Ds_WorkSpaceMst.Tables("workspacesubjectmst")) Then
            '        For Each dr As Data.DataRow In Tbl_workspacesubjectmst.Rows
            '            dr("vWorkspaceId") = WorkspaceId_Edit.Trim()
            '        Next
            '    End If

            '    If Not IsNothing(Ds_WorkSpaceMst.Tables("workspaceProtocolDetailMatrix")) Then
            '        For Each dr As Data.DataRow In Tbl_workspaceProtocolDetailMatrix.Rows
            '            dr("vWorkspaceId") = WorkspaceId_Edit.Trim()
            '        Next
            '    End If

            '    If Not IsNothing(Ds_WorkSpaceMst.Tables("WorkSpaceStatusDtl")) Then
            '        For Each dr As Data.DataRow In Tbl_WorkSpaceStatusDtl.Rows
            '            dr("vWorkspaceId") = WorkspaceId_Edit.Trim()
            '        Next
            '    End If

            'End If


            Save_WorkspaceProtocoldetail = True

            If Save_WorkspaceProtocoldetail Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

            objDtLogic.Close_Connection()

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving workspacemst"
            Save_WorkspaceProtocoldetail = False
            objDtLogic.RollBack_Transaction()
            objDtLogic.Close_Connection()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region  '==Added on 03-Mar-2011===

    '====================================
    'For e-CTD
    'Created By : Bharat Patel
    'Created Date : 18-Oct-2011
    'Reason : to Insert the data into the WorkspaceNodeDetail,WorkspaceNodeHistory,WorkspaceNodeAttrDetail,WorkspaceNodeAttrHistory
    '====================================
    '====================================
    'For e-CTD
    'Created By : Bharat Patel
    'Created Date : 18-Oct-2011
    'Reason : to Insert the data into the WorkspaceNodeDetail,WorkspaceNodeHistory,WorkspaceNodeAttrDetail,WorkspaceNodeAttrHistory
    '====================================

#Region "Save_WorkspaceNodeDtlwithDoc"
    Public Function Save_WorkspaceNodeDtlwithDoc(ByVal Choice As DataObjOpenSaveModeEnum, _
                                ByVal Ds_WorkspaceMst As DataSet, _
                                ByVal UserCode_1 As String, _
                                ByRef eStr_Retu As String, ByRef NodeId As Integer, _
                                ByRef iTranNo As Integer, _
                                ByRef FilePath As String, _
                                ByRef FolderPath As String, _
                                ByVal Mode As String, _
                                ByVal Mode_WorkspaceNodeDetail As String, _
                                ByVal FormModified As String) As Boolean
        Dim objDtLogic As New ClsDataLogic_New

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing
        Dim wstr As String = String.Empty
        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime
        Dim ds_Workspace As Data.DataSet = Nothing
        Dim ds_Count As Data.DataSet = Nothing
        Dim ds_ReleaseDocIdTrack As Data.DataSet = Nothing
        Dim dr_ReleaseDocIdTrack As Data.DataRow = Nothing
        Dim Tbl_WorkspaceNodeDetail As Data.DataTable = Nothing
        Dim Tbl_WorkspaceNodeHistory As Data.DataTable = Nothing
        Dim Tbl_WorkspaceNodeAttrDtl As Data.DataTable = Nothing
        Dim Tbl_WorkspaceNodeAttrHistory As Data.DataTable = Nothing
        Dim Tbl_WorkspaceNodeAddAttrHistory As Data.DataTable = Nothing
        Dim Tbl_stfstudyidentifiermst As Data.DataTable = Nothing
        Dim Tbl_ReleaseDocIdTrack As Data.DataTable = Nothing
        Dim Tbl_WorkspaceNodeDetail_MaxTranData As Data.DataTable = Nothing
        Dim Instr_WorkspaceId As String = ""
        Dim wsId As String = String.Empty
        Dim PkColArr(1) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing
        Dim dt_WorkspaceNodeDetail As Data.DataTable = Nothing
        'Dim FilePath As String = String.Empty
        'Dim FolderPath As String = String.Empty

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            wsId = Ds_WorkspaceMst.Tables(0).Rows(0)("vWorkspaceId").ToString.Trim
            'Logic Of save Start

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_WorkspaceMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit AndAlso Not Ds_WorkspaceMst.Tables("WorkSpaceNodeDetail") Is Nothing Then
                For Each tr As Data.DataRow In Ds_WorkspaceMst.Tables("WorkSpaceNodeDetail").Rows

                    Instr_WorkspaceId += IIf(Instr_WorkspaceId = "", "'", ",'").ToString + _
                                    tr("vWorkSpaceId").ToString + tr("iNodeId").ToString + "'"

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            If Not Ds_WorkspaceMst.Tables("WorkSpaceNodeDetail") Is Nothing Then
                Tbl_WorkspaceNodeDetail = Ds_WorkspaceMst.Tables("WorkSpaceNodeDetail")
            End If

            If Not Ds_WorkspaceMst.Tables("WorkspaceNodeHistory") Is Nothing Then
                Tbl_WorkspaceNodeHistory = Ds_WorkspaceMst.Tables("WorkspaceNodeHistory")
            End If

            If Not Ds_WorkspaceMst.Tables("WorkSpaceNodeAttrDetail") Is Nothing Then
                Tbl_WorkspaceNodeAttrDtl = Ds_WorkspaceMst.Tables("WorkSpaceNodeAttrDetail")
            End If

            If Not Ds_WorkspaceMst.Tables("WorkSpaceNodeAttrHistory") Is Nothing Then
                Tbl_WorkspaceNodeAttrHistory = Ds_WorkspaceMst.Tables("WorkSpaceNodeAttrHistory")
            End If

            If Not Ds_WorkspaceMst.Tables("WorkSpaceNodeDetail") Is Nothing Then
                Tbl_stfstudyidentifiermst = Ds_WorkspaceMst.Tables("stfstudyidentifiermst")
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of WorkspaceNodeDetail
            If Not Tbl_WorkspaceNodeDetail Is Nothing AndAlso Not objHelpDbTbl.getWorkSpaceNodeDetail("vWorkspaceId + cast(iNodeId as varchar(10)) In (" + Instr_WorkspaceId + ") AND iTranNo IN(SELECT MAX(iTranNo) FROM workspacenodedetail  WHERE vWorkspaceId + cast(iNodeId as varchar(10)) IN (" + Instr_WorkspaceId + "))", dataRet_1, _
                                            objDtLogic, Tbl_WorkspaceNodeDetail, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving WorkspaceNodeDetail"
                Exit Function
            End If

            If Mode.ToUpper = "US" Then
                Tbl_WorkspaceNodeDetail.Columns.Add("NoOfRepetition", GetType(Integer))
                Tbl_WorkspaceNodeDetail.Columns.Add("Suffix", GetType(Integer))
                Tbl_WorkspaceNodeDetail.Columns.Add("vNodeContent", GetType(String))
            End If

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vWorkspaceId"
            PkColArr(1) = "iNodeId"
            PkColArr(1) = "iTranNo"
            If Not Ds_WorkspaceMst.Tables("WorkSpaceNodeDetail") Is Nothing AndAlso Ds_WorkspaceMst.Tables("WorkSpaceNodeDetail").Rows.Count > 0 Then

                If Not objSave.AssignValues(Tbl_WorkspaceNodeDetail.TableName, PkColArr, Choice, _
                                            Ds_WorkspaceMst.Tables(Tbl_WorkspaceNodeDetail.TableName), _
                                            Tbl_WorkspaceNodeDetail, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while assigning values"
                    Exit Function
                End If

                ' Save in WorkspaceNodeDetail
                If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Or Mode_WorkspaceNodeDetail.ToString.ToUpper = "EDIT" Or Mode_WorkspaceNodeDetail.ToString.ToUpper = "ADD" Then
                    If Mode.ToUpper = "EU" Then
                        ' For Add And Edit Mode of WorkspaceNodeDetail
                        If Mode_WorkspaceNodeDetail.ToString.ToUpper.Trim() = "ADD" Then
                            If FormModified.ToString.ToUpper <> "Y" Then
                                If Not objSave.SaveInDb("Insert_addWorkspaceNodeAfter_ForECTD", Tbl_WorkspaceNodeDetail, Choice, DataReturnList, eStr_Retu, True) Then
                                    eStr_Retu += vbCrLf + "Error occured while Save Information of WorkspaceNodeDetail In Database"
                                    Exit Function
                                End If
                            End If
                        ElseIf Mode_WorkspaceNodeDetail.ToString.ToUpper.Trim() = "EDIT" Then
                            If Not objSave.SaveInDb("Insert_addWorkspaceNodeAfter_ForECTD", Tbl_WorkspaceNodeDetail, DataObjOpenSaveModeEnum.DataObjOpenMode_Edit, DataReturnList, eStr_Retu, True) Then
                                eStr_Retu += vbCrLf + "Error occured while Save Information of WorkspaceNodeDetail In Database"
                                Exit Function
                            End If
                        End If


                    ElseIf Mode.ToUpper = "US" Then
                        If Not objSave.SaveInDb("Insert_WorkspaceNodeDetail_STF", Tbl_WorkspaceNodeDetail, Choice, DataReturnList, eStr_Retu, True) Then
                            eStr_Retu += vbCrLf + "Error occured while Save Information of WorkspaceNodeDetail In Database"
                            Exit Function
                        End If
                    End If
                Else

                    Tbl_WorkspaceNodeDetail.DefaultView.Sort = "iTranNo DESC"
                    Tbl_WorkspaceNodeDetail_MaxTranData = Tbl_WorkspaceNodeDetail.DefaultView.ToTable.Clone()
                    Tbl_WorkspaceNodeDetail_MaxTranData.ImportRow(Tbl_WorkspaceNodeDetail.DefaultView.ToTable.Rows(0))

                    If Not objSave.SaveInDb("Insert_WorkSpaceNodeDetail", Tbl_WorkspaceNodeDetail_MaxTranData, Choice, DataReturnList, eStr_Retu, True) Then
                        eStr_Retu += vbCrLf + "Error occured while Save Information of WorkspaceNodeDetail In Database"
                        Exit Function
                    End If
                    NodeId = CInt(Tbl_WorkspaceNodeDetail.Rows(0)("iNodeId").ToString)
                End If
                If DataReturnList.Count > 0 Then
                    DataReturnList = DataReturnList.Item(0)
                End If
                'DataReturnList = DataReturnList.Item(0)

                If DataReturnList.Count > 0 Then
                    RetuVal = DataReturnList.Item(0)
                    NodeId = RetuVal.ParameterValue

                    If Not Tbl_WorkspaceNodeHistory Is Nothing Then
                        For Each dr As DataRow In Tbl_WorkspaceNodeHistory.Rows
                            dr("iNodeId") = NodeId
                        Next
                    End If

                    If Not Tbl_WorkspaceNodeAttrHistory Is Nothing Then
                        For Each dr As DataRow In Tbl_WorkspaceNodeAttrHistory.Rows
                            dr("iNodeId") = NodeId
                        Next
                    End If

                    If Not Tbl_WorkspaceNodeAttrDtl Is Nothing Then
                        For Each dr As DataRow In Tbl_WorkspaceNodeAttrDtl.Rows
                            dr("iNodeIdNew") = NodeId
                        Next
                    End If

                    If Not Tbl_stfstudyidentifiermst Is Nothing Then
                        For Each dr As DataRow In Tbl_stfstudyidentifiermst.Rows
                            dr("iNodeId") = NodeId
                        Next
                    End If

                End If
            End If

            If Not Tbl_stfstudyidentifiermst Is Nothing AndAlso Tbl_stfstudyidentifiermst.Rows.Count > 0 Then
                If Not objSave.SaveInDb("Insert_StfStudyIdentifierMst", Tbl_stfstudyidentifiermst, Choice, DataReturnList, eStr_Retu, True) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of StfStudyIdentifierMst In Database"
                    Exit Function
                End If
            End If

            If Not Tbl_WorkspaceNodeHistory Is Nothing AndAlso Tbl_WorkspaceNodeHistory.Rows.Count > 0 Then
                wstr = "vWorkspaceId = '" + wsId + "' and iNodeId =" + NodeId.ToString.Trim
                If Not objHelpDbTbl.getWorkspaceNodeHistory(wstr, DataRetrievalModeEnum.DataTable_WithWhereCondition, ds_Count, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while getting WorekspaceMst"
                    Exit Function
                End If

                If Not objSave.SaveInDb("insert_workspacenodehistory_ForEctd", Tbl_WorkspaceNodeHistory, DataObjOpenSaveModeEnum.DataObjOpenMode_Add, DataReturnList, eStr_Retu, True) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of workspacenodehistory In Database"
                    Exit Function
                End If

                DataReturnList = DataReturnList.Item(0)
                RetuVal = DataReturnList.Item(0)
                iTranNo = RetuVal.ParameterValue

                FolderPath = Tbl_WorkspaceNodeHistory.Rows(0)("vFolderName").ToString.Replace("&&&", NodeId).Replace("$$$", iTranNo)
                FilePath = Tbl_WorkspaceNodeHistory.Rows(0)("vFilePath").ToString.Replace("&&&", NodeId).Replace("$$$", iTranNo)
                Tbl_WorkspaceNodeHistory.Rows(0)("vFolderName") = FolderPath
                Tbl_WorkspaceNodeHistory.Rows(0)("vFilePath") = FilePath

                If Not objSave.SaveInDb("insert_workspacenodehistory_ForEctd", Tbl_WorkspaceNodeHistory, DataObjOpenSaveModeEnum.DataObjOpenMode_Edit, Nothing, eStr_Retu, True) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of workspacenodehistory In Database"
                    Exit Function
                End If

                If Not objHelpDbTbl.GetReleaseDocIdTrack("", DataRetrievalModeEnum.DataTable_Empty, ds_ReleaseDocIdTrack, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while getting ReleaseDocIdTrack"
                    Exit Function
                End If

                wstr = "vWorkspaceId = '" + Tbl_WorkspaceNodeHistory.Rows(0)("vWorkspaceid").ToString.Trim + "'"
                If Not objHelpDbTbl.getworkspacemst(wstr, DataRetrievalModeEnum.DataTable_WithWhereCondition, ds_Workspace, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while getting WorekspaceMst"
                    Exit Function
                End If
                ds_Count.Tables(0).DefaultView.RowFilter = "cStatusIndi <> 'D'"
                dr_ReleaseDocIdTrack = ds_ReleaseDocIdTrack.Tables(0).NewRow
                dr_ReleaseDocIdTrack("vWorkspaceid") = Tbl_WorkspaceNodeHistory.Rows(0)("vWorkspaceid")
                dr_ReleaseDocIdTrack("iNodeId") = Tbl_WorkspaceNodeHistory.Rows(0)("iNodeId")
                dr_ReleaseDocIdTrack("vDocId") = "DMS-" + (ds_Count.Tables(0).DefaultView.ToTable.Rows.Count + 1).ToString.Trim + "-" + "00000001" 'ds_Workspace.Tables(0).Rows(0)("vRemark").ToString.Trim + "-" + (ds_Count.Tables(0).Rows.Count + 1).ToString.Trim + "-" + "00000001"
                ''================================================================================
                '' Uncomment following line to store category name in Document Id instead of number.
                'dr_ReleaseDocIdTrack("vDocId") = ds_Workspace.Tables(0).Rows(0)("vRemark").ToString.Trim + "-" + Tbl_WorkspaceNodeDetail.Rows(0)("vNodeDisplayName").ToString.Trim + "-" + "00000001"
                ''================================================================================
                dr_ReleaseDocIdTrack("iLastTranNo") = iTranNo
                ds_ReleaseDocIdTrack.Tables(0).Rows.Add(dr_ReleaseDocIdTrack)
                ds_ReleaseDocIdTrack.AcceptChanges()

                If ds_ReleaseDocIdTrack.Tables(0).Rows.Count > 0 Then
                    If Not objSave.SaveInDb("Insert_ReleaseDocIdTrack", ds_ReleaseDocIdTrack.Tables(0), DataObjOpenSaveModeEnum.DataObjOpenMode_Add, DataReturnList, eStr_Retu, True) Then
                        eStr_Retu += vbCrLf + "Error occured while Save Information of ReleaseDocIdTrack In Database"
                        Exit Function
                    End If
                End If
            End If

            If Not Tbl_WorkspaceNodeAttrDtl Is Nothing AndAlso Tbl_WorkspaceNodeAttrDtl.Rows.Count > 0 Then
                If Not objSave.SaveInDb("Insert_WorkspaceNodeAttrDetail_ForEctd", Tbl_WorkspaceNodeAttrDtl, Choice, Nothing, eStr_Retu, True) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of WorkspaceNodeAttrDetail In Database"
                    Exit Function
                End If
            End If

            If Not Tbl_WorkspaceNodeAttrHistory Is Nothing AndAlso Tbl_WorkspaceNodeAttrHistory.Rows.Count > 0 Then
                Tbl_WorkspaceNodeAddAttrHistory = Tbl_WorkspaceNodeAttrHistory.Clone()
                If Tbl_WorkspaceNodeAttrHistory.Rows.Count > 1 Then
                    Tbl_WorkspaceNodeAddAttrHistory.ImportRow(Tbl_WorkspaceNodeAttrHistory.Rows(0))
                Else
                    Tbl_WorkspaceNodeAddAttrHistory = Tbl_WorkspaceNodeAttrHistory.Copy
                End If

                If Not objSave.SaveInDb("Insert_Workspacenodeattrhistory__ForEctd", Tbl_WorkspaceNodeAddAttrHistory, DataObjOpenSaveModeEnum.DataObjOpenMode_Add, Nothing, eStr_Retu, True) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of Workspacenodeattrhistory In Database"
                    Exit Function
                End If
                If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                    If Not objSave.SaveInDb("Insert_Workspacenodeattrhistory__ForEctd", Tbl_WorkspaceNodeAttrHistory, DataObjOpenSaveModeEnum.DataObjOpenMode_Edit, Nothing, eStr_Retu, True) Then
                        eStr_Retu += vbCrLf + "Error occured while Save Information of Workspacenodeattrhistory In Database"
                        Exit Function
                    End If
                End If
            End If

            Save_WorkspaceNodeDtlwithDoc = True
            'Logic of Save End

            If Save_WorkspaceNodeDtlwithDoc Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving WorkspaceNodeDetail"
            Save_WorkspaceNodeDtlwithDoc = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region

#Region "Save_WorkspaceNodeHistory_ECTD"
    Public Function Save_WorkspaceNodeHistory_ECTD(ByVal Choice As DataObjOpenSaveModeEnum, _
                                ByVal Ds_WorkspaceNodeHist As DataSet, _
                                ByVal UserCode_1 As String, _
                                ByRef eStr_Retu As String, _
                                Optional ByRef iTranNo As Integer = 0) As Boolean
        Dim objDtLogic As New ClsDataLogic_New

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Instr_WorkspaceId As String = ""

        Dim PkColArr(2) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Dim dtWorkspaceNodeHistory As New DataTable

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()


            'Logic Of save Start

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_WorkspaceNodeHist Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
                dtWorkspaceNodeHistory = Ds_WorkspaceNodeHist.Tables(0).Clone
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
                dtWorkspaceNodeHistory = Ds_WorkspaceNodeHist.Tables(0).Copy
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vWorkspaceId"
            PkColArr(1) = "iNodeId"
            PkColArr(2) = "iTranNo"

            If Not objSave.AssignValues(Ds_WorkspaceNodeHist.Tables(0).TableName, PkColArr, Choice, _
                                        Ds_WorkspaceNodeHist.Tables(Ds_WorkspaceNodeHist.Tables(0).TableName), _
                                        dtWorkspaceNodeHistory, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in WorkspaceNodeDetail

            If Ds_WorkspaceNodeHist.Tables(0).Rows.Count > 0 Then
                If Not objSave.SaveInDb("insert_workspacenodehistory_ForEctd", dtWorkspaceNodeHistory, Choice, DataReturnList, eStr_Retu, True) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of workspacenodehistory In Database"
                    Exit Function
                End If

            End If


            Save_WorkspaceNodeHistory_ECTD = True
            'Logic of Save End

            If Save_WorkspaceNodeHistory_ECTD Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving WorkspaceNodeHistory"
            Save_WorkspaceNodeHistory_ECTD = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region

#Region "Save_WorkspaceCMSMst"

    Public Function Save_WorkspaceCMSMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_WorkspaceCMSMst As DataSet, _
                                 ByVal UserCode_1 As String, _
                                 ByRef eStr_Retu As String) As Boolean
        Dim objDtLogic As New ClsDataLogic_New()

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_WorkspaceCMSMst As Data.DataTable = Nothing

        Dim Instr_iWorkspaceCMSId As String = ""

        Dim PkColArr(0) As String

        Dim DataReturnList As New ArrayList

        Dim RetuVal As ParameterReturnValue = Nothing


        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            'Logic Of save Start
            eStr_Retu = ""


            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_WorkspaceCMSMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Or Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Delete Then
                For Each tr As Data.DataRow In Ds_WorkspaceCMSMst.Tables("WorkspaceCMSMst").Rows

                    Instr_iWorkspaceCMSId += IIf(Instr_iWorkspaceCMSId = "", "", ",").ToString + _
                                    tr("iWorkspaceCMSId").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of User Login Details
            If Not objHelpDbTbl.WorkspaceCMSMst("iWorkspaceCMSId In (" + Instr_iWorkspaceCMSId + ")", dataRet_1, _
                                            objDtLogic, Tbl_WorkspaceCMSMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving WorkspaceCMSMst"
                Exit Function
            End If



            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "iWorkspaceCMSId"

            If Not objSave.AssignValues(Ds_WorkspaceCMSMst.Tables(0).TableName, PkColArr, Choice, _
                                        Ds_WorkspaceCMSMst.Tables(0), _
                                        Tbl_WorkspaceCMSMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in UserLoginDetails
            If Not objSave.SaveInDb("Insert_WorkspaceCMSMst", Tbl_WorkspaceCMSMst, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Saving WorkspaceCMSMst In Database"
                Exit Function
            End If

            'DataReturnList = DataReturnList.Item(0)
            'RetuVal = DataReturnList.Item(0)
            'Retu_TranNo = RetuVal.ParameterValue

            Save_WorkspaceCMSMst = True

            If Save_WorkspaceCMSMst Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while Saving WorkspaceCMSMst"
            Save_WorkspaceCMSMst = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function

#End Region

#Region "Save_submissioninfoEU14MSt"
    Public Function Save_submissioninfoEU14MSt(ByVal Choice As DataObjOpenSaveModeEnum, _
                                       ByVal Ds_submissioninfoEU14MSt As Data.DataSet, _
                                       ByVal UserCode_1 As String, _
                                       ByRef eStr_Retu As String) As Boolean


        Dim objDtLogic As New ClsDataLogic_New
        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_submissioninfoEU14MSt As Data.DataTable = Nothing
        Dim Instr_SubmissionInfoEU14Id As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try

            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()


            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_submissioninfoEU14MSt Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_submissioninfoEU14MSt.Tables("vSubmissionInfoEU14Id").Rows

                    Instr_SubmissionInfoEU14Id += IIf(Instr_SubmissionInfoEU14Id = "", "", ",").ToString + _
                                    tr("vWorkspaceid").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of SubmissioninfoEU14Mst
            If Not objHelpDbTbl.GetSubmissioninfoEU14Mst("vSubmissionInfoEU14Id In (" + Instr_SubmissionInfoEU14Id + ")", dataRet_1, _
                                            objDtLogic, Tbl_submissioninfoEU14MSt, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving SubmissioninfoEU14Mst"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vSubmissionInfoEU14Id"

            If Not objSave.AssignValues(Tbl_submissioninfoEU14MSt.TableName, PkColArr, Choice, _
                                        Ds_submissioninfoEU14MSt.Tables(Tbl_submissioninfoEU14MSt.TableName), _
                                        Tbl_submissioninfoEU14MSt, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in submissioninfoEU14MSt
            If Not objSave.SaveInDb("insert_submissioninfoEU14MSt", Tbl_submissioninfoEU14MSt, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Submission detail for EU In Database"
                Exit Function
            End If
            Save_submissioninfoEU14MSt = True

            If Save_submissioninfoEU14MSt Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving submissioninfoEU14MSt"
            Save_submissioninfoEU14MSt = False
        End Try

    End Function
#End Region

#Region "Save_submissioninfoUSMSt"
    Public Function Save_submissioninfoUSMSt(ByVal Choice As DataObjOpenSaveModeEnum, _
                                       ByVal Ds_submissioninfoUSMSt As Data.DataSet, _
                                       ByVal UserCode_1 As String, _
                                       ByRef eStr_Retu As String) As Boolean


        Dim objDtLogic As New ClsDataLogic_New
        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_submissioninfoUSMSt As Data.DataTable = Nothing
        Dim Instr_SubmissionInfoUSId As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try

            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()


            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_submissioninfoUSMSt Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_submissioninfoUSMSt.Tables("vSubmissionInfoUSId").Rows

                    Instr_SubmissionInfoUSId += IIf(Instr_SubmissionInfoUSId = "", "", ",").ToString + _
                                    tr("vWorkspaceid").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of SubmissioninfoEU14Mst
            If Not objHelpDbTbl.GetSubmissioninfoUSMst("vSubmissionInfoUSId In (" + Instr_SubmissionInfoUSId + ")", dataRet_1, _
                                            objDtLogic, Tbl_submissioninfoUSMSt, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving SubmissioninfoEU14Mst"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vSubmissionInfoUSId"

            If Not objSave.AssignValues(Tbl_submissioninfoUSMSt.TableName, PkColArr, Choice, _
                                        Ds_submissioninfoUSMSt.Tables(Tbl_submissioninfoUSMSt.TableName), _
                                        Tbl_submissioninfoUSMSt, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in submissioninfoEU14MSt
            If Not objSave.SaveInDb("insert_submissioninfoUSMSt", Tbl_submissioninfoUSMSt, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Submission detail for US In Database"
                Exit Function
            End If
            Save_submissioninfoUSMSt = True

            If Save_submissioninfoUSMSt Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving submissioninfoUSMst"
            Save_submissioninfoUSMSt = False
        End Try

    End Function
#End Region

#Region "Save_submissioninfoCAMSt"
    Public Function Save_submissioninfoCAMSt(ByVal Choice As DataObjOpenSaveModeEnum, _
                                       ByVal Ds_submissioninfoCAMSt As Data.DataSet, _
                                       ByVal UserCode_1 As String, _
                                       ByRef eStr_Retu As String) As Boolean


        Dim objDtLogic As New ClsDataLogic_New
        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_submissioninfoCAMSt As Data.DataTable = Nothing
        Dim Instr_SubmissionInfoCAId As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try

            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_submissioninfoCAMSt Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_submissioninfoCAMSt.Tables("vSubmissionInfoCAId").Rows

                    Instr_SubmissionInfoCAId += IIf(Instr_SubmissionInfoCAId = "", "", ",").ToString + _
                                    tr("vWorkspaceid").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of SubmissioninfoCAMst
            If Not objHelpDbTbl.GetSubmissioninfoCAMst("vSubmissionInfoCAId In (" + Instr_SubmissionInfoCAId + ")", dataRet_1, _
                                            objDtLogic, Tbl_submissioninfoCAMSt, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving SubmissioninfoCAMst"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vSubmissionInfoCAId"

            If Not objSave.AssignValues(Tbl_submissioninfoCAMSt.TableName, PkColArr, Choice, _
                                        Ds_submissioninfoCAMSt.Tables(Tbl_submissioninfoCAMSt.TableName), _
                                        Tbl_submissioninfoCAMSt, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in submissioninfoCAMSt
            If Not objSave.SaveInDb("insert_submissioninfoCAMSt", Tbl_submissioninfoCAMSt, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Submission detail for CA In Database"
                Exit Function
            End If
            Save_submissioninfoCAMSt = True

            If Save_submissioninfoCAMSt Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If


        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving submissioninfoCAMSt"
            Save_submissioninfoCAMSt = False
        End Try

    End Function
#End Region

    ''
    '' Created By : Bharat Patel 
    '' Created Date : 1-Nov-2011
    '' Reason : For ECTD Attributewise Repetition 
    ''
#Region "Save_ProcCopyPasteWorkspace_ECTD"
    Public Function Save_ProcCopyPasteWorkspace_ECTD(ByVal Choice As DataObjOpenSaveModeEnum, _
                                     ByVal DsWorkspace As Data.DataSet, _
                                     ByVal objDtLogic As ClsDataLogic_New, _
                                     ByVal UserCode_1 As String, _
                                     ByRef eStr_Retu As String, _
                                     ByRef iMaxNodeId As Integer) As Boolean
        Try

            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            Dim objSave As SaveDataInDbObj = Nothing
            objSave = New SaveDataInDbObj(objDtLogic)
            Dim DataReturnList As New ArrayList
            Dim RetuVal As ParameterReturnValue = Nothing

            If Not objSave.SaveInDb("Proc_CopyPasteWorkspace", DsWorkspace.Tables(0), Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += " " + "Error occured while executing Save_ProcCopyPasteWorkspace_ECTD"
                Exit Function
            End If

            DataReturnList = DataReturnList.Item(0)
            If DataReturnList.Count > 0 Then
                RetuVal = DataReturnList.Item(0)
                iMaxNodeId = RetuVal.ParameterValue
            End If

            Save_ProcCopyPasteWorkspace_ECTD = True

            If Save_ProcCopyPasteWorkspace_ECTD Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while executing Save_ProcCopyPasteWorkspace_ECTD"
            Save_ProcCopyPasteWorkspace_ECTD = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "Insert_Workspacenodeattrhistory__ForEctd"      ' Created On 14-11-2011
    Public Function Insert_Workspacenodeattrhistory__ForEctd(ByVal Choice As DataObjOpenSaveModeEnum, _
                                ByVal Ds_WorkspaceNodeAttrHist As DataSet, _
                                ByVal UserCode_1 As String, _
                                ByRef eStr_Retu As String) As Boolean
        Dim objDtLogic As New ClsDataLogic_New

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Instr_WorkspaceId As String = ""

        Dim PkColArr(3) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Dim dtWorkspaceNodeAttrHistory As New DataTable

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()


            'Logic Of save Start

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_WorkspaceNodeAttrHist Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
                dtWorkspaceNodeAttrHistory = Ds_WorkspaceNodeAttrHist.Tables(0).Clone
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
                dtWorkspaceNodeAttrHistory = Ds_WorkspaceNodeAttrHist.Tables(0).Copy()
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vWorkspaceId"
            PkColArr(1) = "iNodeId"
            PkColArr(2) = "iTranNo"
            PkColArr(3) = "iAttrId"

            If Not objSave.AssignValues(Ds_WorkspaceNodeAttrHist.Tables(0).TableName, PkColArr, Choice, _
                                        Ds_WorkspaceNodeAttrHist.Tables(Ds_WorkspaceNodeAttrHist.Tables(0).TableName), _
                                        dtWorkspaceNodeAttrHistory, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in WorkspaceNodeDetail

            If Ds_WorkspaceNodeAttrHist.Tables(0).Rows.Count > 0 Then
                If Not objSave.SaveInDb("Insert_Workspacenodeattrhistory__ForEctd", dtWorkspaceNodeAttrHistory, Choice, DataReturnList, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of Workspacenodeattrhistory In Database"
                    Exit Function
                End If

            End If


            Insert_Workspacenodeattrhistory__ForEctd = True
            'Logic of Save End

            If Insert_Workspacenodeattrhistory__ForEctd Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Workspacenodeattrhistory"
            Insert_Workspacenodeattrhistory__ForEctd = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region

#Region "Insert_StfStudyIdentifierMst"      ' Created On 19-11-2011
    Public Function Insert_StfStudyIdentifierMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                ByVal DsStfStudyIdentifierMst As DataSet, _
                                ByVal UserCode_1 As String, _
                                ByRef eStr_Retu As String, _
                                ByRef iTagSequenceId As String) As Boolean
        Dim objDtLogic As New ClsDataLogic_New

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Instr_WorkspaceId As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Dim dtStfStudyIdentifierMst As New DataTable

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()


            'Logic Of save Start

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If DsStfStudyIdentifierMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
                dtStfStudyIdentifierMst = DsStfStudyIdentifierMst.Tables(0).Clone
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
                dtStfStudyIdentifierMst = DsStfStudyIdentifierMst.Tables(0).Copy()
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            'PkColArr(0) = "vSTFStudyIdentifierId"


            'If Not objSave.AssignValues(DsStfStudyIdentifierMst.Tables(0).TableName, PkColArr, Choice, _
            '                            DsStfStudyIdentifierMst.Tables(DsStfStudyIdentifierMst.Tables(0).TableName), _
            '                            dtStfStudyIdentifierMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
            '    eStr_Retu += vbCrLf + "Error occured while assigning values"
            '    Exit Function
            'End If


            ' Save in WorkspaceNodeDetail

            If DsStfStudyIdentifierMst.Tables(0).Rows.Count > 0 Then
                If Not objSave.SaveInDb("Insert_StfStudyIdentifierMst", DsStfStudyIdentifierMst.Tables(0), Choice, DataReturnList, eStr_Retu, True) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of StfStudyIdentifierMst In Database"
                    Exit Function
                End If

            End If

            DataReturnList = DataReturnList.Item(0)
            If DataReturnList.Count > 0 Then
                RetuVal = DataReturnList.Item(0)
                iTagSequenceId = RetuVal.ParameterValue
            End If

            Insert_StfStudyIdentifierMst = True
            'Logic of Save End

            If Insert_StfStudyIdentifierMst Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving StfStudyIdentifierMst"
            Insert_StfStudyIdentifierMst = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region

    '=====================================
    'Created By : Bharat Patel
    'Created Date : 28-Nov-2011
    'Reason : Insert the data into WorkspaceNodeDocHistory for the Source Doc
    '======================================

#Region "Save_WorkspaceNodeDocHistory"
    Public Function Save_WorkspaceNodeDocHistory(ByVal Choice As DataObjOpenSaveModeEnum, _
                                ByVal DsWorkspaceNodeDocHistory As DataSet, _
                                ByVal UserCode_1 As String, _
                                ByRef eStr_Retu As String, _
                                ByRef iDocHistId As String) As Boolean
        Dim objDtLogic As New ClsDataLogic_New

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Instr_WorkspaceId As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Dim dtWorkspaceNodeDocHistory As New DataTable

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()


            'Logic Of save Start

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If DsWorkspaceNodeDocHistory Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
                dtWorkspaceNodeDocHistory = DsWorkspaceNodeDocHistory.Tables(0).Clone
                'dtStfStudyIdentifierMst = DsStfStudyIdentifierMst.Tables(0).Clone
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
                dtWorkspaceNodeDocHistory = DsWorkspaceNodeDocHistory.Tables(0).Copy
                'dtStfStudyIdentifierMst = DsStfStudyIdentifierMst.Tables(0).Copy()
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "iDocHistoryId"


            If Not objSave.AssignValues(DsWorkspaceNodeDocHistory.Tables(0).TableName, PkColArr, Choice, _
                                        DsWorkspaceNodeDocHistory.Tables(DsWorkspaceNodeDocHistory.Tables(0).TableName), _
                                        dtWorkspaceNodeDocHistory, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in WorkspaceNodeDetail

            If DsWorkspaceNodeDocHistory.Tables(0).Rows.Count > 0 Then
                If Not objSave.SaveInDb("Insert_WorkspaceNodeDocHistory", DsWorkspaceNodeDocHistory.Tables(0), Choice, DataReturnList, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of WorkspaceNodeDocHistory In Database"
                    Exit Function
                End If
            End If

            DataReturnList = DataReturnList.Item(0)

            If DataReturnList.Count > 0 Then
                RetuVal = DataReturnList.Item(0)
                iDocHistId = RetuVal.ParameterValue.ToString
            End If

            Save_WorkspaceNodeDocHistory = True
            'Logic of Save End

            If Save_WorkspaceNodeDocHistory Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving WorkspaceNodeDocHistory"
            Save_WorkspaceNodeDocHistory = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region

#Region "Insert_WorkspaceNodeCommentHistory"
    Public Function Insert_WorkspaceNodeCommentHistory(ByVal Choice As DataObjOpenSaveModeEnum, _
                                ByVal DsWorkspaceNodeCommentHistory As DataSet, _
                                ByVal UserCode_1 As String, _
                                ByRef eStr_Retu As String, _
                                ByRef iTranNo As String) As Boolean
        Dim objDtLogic As New ClsDataLogic_New

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Instr_WorkspaceId As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Dim dtWorkspaceNodeCommentHistory As New DataTable

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()


            'Logic Of save Start

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If DsWorkspaceNodeCommentHistory Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
                dtWorkspaceNodeCommentHistory = DsWorkspaceNodeCommentHistory.Tables(0).Clone
                'dtStfStudyIdentifierMst = DsStfStudyIdentifierMst.Tables(0).Clone
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
                dtWorkspaceNodeCommentHistory = DsWorkspaceNodeCommentHistory.Tables(0).Copy
                'dtStfStudyIdentifierMst = DsStfStudyIdentifierMst.Tables(0).Copy()
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "iTranNo"

            If Not objSave.AssignValues(DsWorkspaceNodeCommentHistory.Tables(0).TableName, PkColArr, Choice, _
                                        DsWorkspaceNodeCommentHistory.Tables(DsWorkspaceNodeCommentHistory.Tables(0).TableName), _
                                        dtWorkspaceNodeCommentHistory, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in WorkspaceNodeDetail

            If DsWorkspaceNodeCommentHistory.Tables(0).Rows.Count > 0 Then
                If Not objSave.SaveInDb("Insert_WorkspaceNodeCommentHistory", DsWorkspaceNodeCommentHistory.Tables(0), Choice, DataReturnList, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of WorkspaceNodeCommentHistory In Database"
                    Exit Function
                End If
            End If

            DataReturnList = DataReturnList.Item(0)

            If DataReturnList.Count > 0 Then
                RetuVal = DataReturnList.Item(0)
                iTranNo = RetuVal.ParameterValue.ToString
            End If

            Insert_WorkspaceNodeCommentHistory = True
            'Logic of Save End

            If Insert_WorkspaceNodeCommentHistory Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving WorkspaceNodeCommentHistory"
            Insert_WorkspaceNodeCommentHistory = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region

#Region "Save_WorkSpaceMst_eCTD"
    Public Function Save_WorkSpaceMst_eCTD(ByVal Choice As DataObjOpenSaveModeEnum, _
                                ByVal Ds_WorkSpaceMst As Data.DataSet, _
                                ByVal UserCode_1 As String, _
                                ByRef RequestId As String, _
                                ByRef eStr_Retu As String) As Boolean


        Dim objDtLogic As New ClsDataLogic_New
        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_WorkSpaceMst As Data.DataTable = Nothing
        Dim Tbl_workspaceprotocoldetail As Data.DataTable = Nothing
        Dim Instr_WorkSpaceId As String = ""
        Dim vWorkspaceId As String = ""
        Dim WorkspaceId_Edit As String = ""
        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_WorkSpaceMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            If Not IsNothing(Ds_WorkSpaceMst.Tables("workspacemst")) Then
                Tbl_WorkSpaceMst = Ds_WorkSpaceMst.Tables("workspacemst")
            End If

            If Not IsNothing(Ds_WorkSpaceMst.Tables("workspaceprotocoldetail")) Then
                Tbl_workspaceprotocoldetail = Ds_WorkSpaceMst.Tables("workspaceprotocoldetail")
            End If

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_WorkSpaceMst.Tables("workspacemst").Rows

                    Instr_WorkSpaceId += IIf(Instr_WorkSpaceId = "", "", ",").ToString + _
                                    tr("vWorkSpaceId").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of workspacemst
            If Not objHelpDbTbl.getworkspacemst("vWorkSpaceId In (" + Instr_WorkSpaceId + ")", dataRet_1, _
                                            objDtLogic, Tbl_WorkSpaceMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving workspacemst"
                Exit Function
            End If

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vWorkSpaceId"

            If Not objSave.AssignValues(Tbl_WorkSpaceMst.TableName, PkColArr, Choice, _
                                        Ds_WorkSpaceMst.Tables(Tbl_WorkSpaceMst.TableName), _
                                        Tbl_WorkSpaceMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in Workspace Master
            If Not objSave.SaveInDb("Insert_Workspace_eCTD", Tbl_WorkSpaceMst, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of workspacemst In Database"
                Exit Function
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                DataReturnList = DataReturnList.Item(0)
                RetuVal = DataReturnList.Item(0)
                If Not CType(DataReturnList.Item(1), ParameterReturnValue) Is Nothing Then
                    If CType(DataReturnList.Item(1), ParameterReturnValue).ParameterName.ToUpper = "@VREQUESTID" Then
                        RequestId = CType(DataReturnList.Item(1), ParameterReturnValue).ParameterValue
                    Else
                        Throw New Exception("Parameter: RequestId not Found")
                    End If
                End If

                If RetuVal.ParameterName.ToUpper <> "@NEWWORKSPACEID" Then
                    Throw New Exception("Parameter: NewWorkspaceId not Found")
                End If

                If Not IsNothing(Ds_WorkSpaceMst.Tables("workspaceprotocoldetail")) Then
                    For Each dr As Data.DataRow In Tbl_workspaceprotocoldetail.Rows
                        dr("vWorkspaceId") = RetuVal.ParameterValue
                    Next
                End If

            Else

                WorkspaceId_Edit = Tbl_WorkSpaceMst.Rows(0).Item("vWorkspaceId")

                If Not IsNothing(Ds_WorkSpaceMst.Tables("workspaceprotocoldetail")) Then
                    For Each dr As Data.DataRow In Tbl_workspaceprotocoldetail.Rows
                        dr("vWorkspaceId") = WorkspaceId_Edit.Trim()
                    Next
                End If
            End If


            'For workspaceprotocoldetail
            If Not IsNothing(Ds_WorkSpaceMst.Tables("workspaceprotocoldetail")) Then
                If Not objSave.SaveInDb("Insert_ProtocolDetails", Tbl_workspaceprotocoldetail, Choice, Nothing, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of workspaceprotocoldetail In Database"
                    Exit Function
                End If

            End If

            Save_WorkSpaceMst_eCTD = True

            If Save_WorkSpaceMst_eCTD Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

            objDtLogic.Close_Connection()

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving workspacemst"
            Save_WorkSpaceMst_eCTD = False
            objDtLogic.RollBack_Transaction()
            objDtLogic.Close_Connection()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "Insert_DocReleaseTrack"

    Public Function Insert_DocReleaseTrack(ByVal Choice As DataObjOpenSaveModeEnum, _
                                ByVal ds_DocReleaseTrack As DataSet, _
                                ByVal UserCode_1 As String, _
                                ByRef eStr_Retu As String) As Boolean
        Dim objDtLogic As New ClsDataLogic_New

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Instr_WorkspaceId As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Dim dtDocReleaseTrack As New DataTable

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()


            'Logic Of save Start

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If ds_DocReleaseTrack Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
                dtDocReleaseTrack = ds_DocReleaseTrack.Tables(0).Clone
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
                dtDocReleaseTrack = ds_DocReleaseTrack.Tables(0).Copy()
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            'PkColArr(0) = "vSTFStudyIdentifierId"


            'If Not objSave.AssignValues(DsStfStudyIdentifierMst.Tables(0).TableName, PkColArr, Choice, _
            '                            DsStfStudyIdentifierMst.Tables(DsStfStudyIdentifierMst.Tables(0).TableName), _
            '                            dtStfStudyIdentifierMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
            '    eStr_Retu += vbCrLf + "Error occured while assigning values"
            '    Exit Function
            'End If


            ' Save in WorkspaceNodeDetail

            If ds_DocReleaseTrack.Tables(0).Rows.Count > 0 Then
                If Not objSave.SaveInDb("Insert_DocReleaseTrack", ds_DocReleaseTrack.Tables(0), Choice, DataReturnList, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of StfStudyIdentifierMst In Database"
                    Exit Function
                End If

            End If


            Insert_DocReleaseTrack = True
            'Logic of Save End

            If Insert_DocReleaseTrack Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Insert_DocReleaseTrack"
            Insert_DocReleaseTrack = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function

#End Region

#Region "Insert_ReleaseDocIdTrack"

    Public Function Insert_ReleaseDocIdTrack(ByVal Choice As DataObjOpenSaveModeEnum, _
                                ByVal ds_ReleaseDocIdTrack As DataSet, _
                                ByVal UserCode_1 As String, _
                                ByRef eStr_Retu As String) As Boolean
        Dim objDtLogic As New ClsDataLogic_New

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Instr_WorkspaceId As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Dim dtReleaseDocIdTrack As New DataTable

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()


            'Logic Of save Start

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If ds_ReleaseDocIdTrack Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
                dtReleaseDocIdTrack = ds_ReleaseDocIdTrack.Tables(0).Clone
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
                dtReleaseDocIdTrack = ds_ReleaseDocIdTrack.Tables(0).Copy()
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            'PkColArr(0) = "vSTFStudyIdentifierId"


            'If Not objSave.AssignValues(DsStfStudyIdentifierMst.Tables(0).TableName, PkColArr, Choice, _
            '                            DsStfStudyIdentifierMst.Tables(DsStfStudyIdentifierMst.Tables(0).TableName), _
            '                            dtStfStudyIdentifierMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
            '    eStr_Retu += vbCrLf + "Error occured while assigning values"
            '    Exit Function
            'End If



            If ds_ReleaseDocIdTrack.Tables(0).Rows.Count > 0 Then
                If Not objSave.SaveInDb("Insert_ReleaseDocIdTrack", ds_ReleaseDocIdTrack.Tables(0), Choice, DataReturnList, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of StfStudyIdentifierMst In Database"
                    Exit Function
                End If
            End If


            Insert_ReleaseDocIdTrack = True
            'Logic of Save End

            If Insert_ReleaseDocIdTrack Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving ReleaseDocIdTrack"
            Insert_ReleaseDocIdTrack = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function

#End Region

#Region "Insert_ReleaseDocMgmt"

    Public Function Insert_ReleaseDocMgmt(ByVal Choice As DataObjOpenSaveModeEnum, _
                                ByVal ds_ReleaseDocMgmt As DataSet, _
                                ByVal UserCode_1 As String, _
                                ByRef eStr_Retu As String) As Boolean
        Dim objDtLogic As New ClsDataLogic_New

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Instr_WorkspaceId As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Dim dtReleaseDocIdTrack As New DataTable

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()


            'Logic Of save Start

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If ds_ReleaseDocMgmt Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
                dtReleaseDocIdTrack = ds_ReleaseDocMgmt.Tables(0).Clone
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
                dtReleaseDocIdTrack = ds_ReleaseDocMgmt.Tables(0).Copy()
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            'PkColArr(0) = "vSTFStudyIdentifierId"


            'If Not objSave.AssignValues(DsStfStudyIdentifierMst.Tables(0).TableName, PkColArr, Choice, _
            '                            DsStfStudyIdentifierMst.Tables(DsStfStudyIdentifierMst.Tables(0).TableName), _
            '                            dtStfStudyIdentifierMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
            '    eStr_Retu += vbCrLf + "Error occured while assigning values"
            '    Exit Function
            'End If


            ' Save in WorkspaceNodeDetail

            If ds_ReleaseDocMgmt.Tables(0).Rows.Count > 0 Then
                If Not objSave.SaveInDb("Insert_ReleaseDocMgmt", ds_ReleaseDocMgmt.Tables(0), Choice, DataReturnList, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of ReleaseDocMgmt In Database"
                    Exit Function
                End If

            End If


            Insert_ReleaseDocMgmt = True
            'Logic of Save End

            If Insert_ReleaseDocMgmt Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving ReleaseDocMgmt"
            Insert_ReleaseDocMgmt = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function

#End Region

#Region "Insert_SOPMailMgmt"

    Public Function Insert_SOPMailMgmt(ByVal Choice As DataObjOpenSaveModeEnum, _
                                ByVal ds_SOPMailMgmt As DataSet, _
                                ByVal UserCode_1 As String, _
                                ByRef eStr_Retu As String) As Boolean
        Dim objDtLogic As New ClsDataLogic_New

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Instr_WorkspaceId As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Dim dtSOPMailMgmt As New DataTable

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()


            'Logic Of save Start

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If ds_SOPMailMgmt Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
                dtSOPMailMgmt = ds_SOPMailMgmt.Tables(0).Clone
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
                dtSOPMailMgmt = ds_SOPMailMgmt.Tables(0).Copy()
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            'PkColArr(0) = "vSTFStudyIdentifierId"


            'If Not objSave.AssignValues(DsStfStudyIdentifierMst.Tables(0).TableName, PkColArr, Choice, _
            '                            DsStfStudyIdentifierMst.Tables(DsStfStudyIdentifierMst.Tables(0).TableName), _
            '                            dtStfStudyIdentifierMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
            '    eStr_Retu += vbCrLf + "Error occured while assigning values"
            '    Exit Function
            'End If


            ' Save in WorkspaceNodeDetail

            If ds_SOPMailMgmt.Tables(0).Rows.Count > 0 Then
                If Not objSave.SaveInDb("Insert_SOPMailMgmt", ds_SOPMailMgmt.Tables(0), Choice, DataReturnList, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Saving In SOPMailMgmt"
                    Exit Function
                End If

            End If


            Insert_SOPMailMgmt = True
            'Logic of Save End

            If Insert_SOPMailMgmt Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Insert_SOPMailMgmt"
            Insert_SOPMailMgmt = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function

#End Region

#Region "Save_WorkspaceNodeDtlWithHist_DocCentric"
    Public Function Save_WorkspaceNodeDtlWithHist_DocCentric(ByVal Choice As DataObjOpenSaveModeEnum, _
                                ByVal Ds As DataSet, _
                                ByVal UserCode_1 As String, _
                                ByRef eStr_Retu As String, _
                                ByVal iDocId As Integer, _
                                ByVal Repetition As Integer, _
                                ByVal vDocId As String, _
                                ByVal BaseFolder As String, _
                                ByRef vFilePaths As String) As Boolean
        Dim objDtLogic As New ClsDataLogic_New

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_WorkspaceNodeDetail As Data.DataTable = Nothing
        Dim Tbl_WorkspaceNodeHistory As Data.DataTable = Nothing
        Dim Tbl_DocReleaseTrack As Data.DataTable = Nothing

        Dim Instr_WorkspaceId As String = ""

        Dim PkColArr(1) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing
        'Dim FilePath As String = String.Empty
        'Dim FolderPath As String = String.Empty
        Dim NodeId As String = String.Empty
        Dim TranNo As String = String.Empty

        Dim srcFilePath As String = String.Empty
        Dim destFilePath As String = String.Empty
        Dim FileName As String = String.Empty
        Dim FileType As String = String.Empty
        Dim FileSize As String = String.Empty
        Dim TempDocId As String = String.Empty
        Dim vId As String = String.Empty
        Dim WsId As String = String.Empty
        Dim Folder As String = String.Empty

        Dim objCommom As New clsCommon

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()


            'Logic Of save Start

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit AndAlso Not Ds.Tables("WorkSpaceNodeDetail") Is Nothing Then
                For Each tr As Data.DataRow In Ds.Tables("WorkSpaceNodeDetail").Rows

                    Instr_WorkspaceId += IIf(Instr_WorkspaceId = "", "'", ",'").ToString + _
                                    tr("vWorkSpaceId").ToString + tr("iNodeId").ToString + "'"

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            If Not Ds.Tables("WorkSpaceNodeDetail") Is Nothing Then
                Tbl_WorkspaceNodeDetail = Ds.Tables("WorkSpaceNodeDetail")
            End If

            If Not Ds.Tables("WorkspaceNodeHistory") Is Nothing Then
                Tbl_WorkspaceNodeHistory = Ds.Tables("WorkspaceNodeHistory")
            End If

            If Not Ds.Tables("DocReleaseTrack") Is Nothing Then
                Tbl_DocReleaseTrack = Ds.Tables("DocReleaseTrack")
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of WorkspaceNodeDetail
            If Not Tbl_WorkspaceNodeDetail Is Nothing AndAlso Not objHelpDbTbl.getWorkSpaceNodeDetail("vWorkspaceId + cast(iNodeId as varchar(4)) In (" + Instr_WorkspaceId + ")", dataRet_1, _
                                            objDtLogic, Tbl_WorkspaceNodeDetail, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving WorkspaceNodeDetail"
                Exit Function
            End If

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vWorkspaceId"
            PkColArr(1) = "iNodeId"

            If Not Ds.Tables("WorkSpaceNodeDetail") Is Nothing AndAlso Ds.Tables("WorkSpaceNodeDetail").Rows.Count > 0 Then
                WsId = Ds.Tables("WorkSpaceNodeDetail").Rows(0)("vWorkspaceId").ToString
                If Not objSave.AssignValues(Tbl_WorkspaceNodeDetail.TableName, PkColArr, Choice, _
                                            Ds.Tables(Tbl_WorkspaceNodeDetail.TableName), _
                                            Tbl_WorkspaceNodeDetail, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while assigning values"
                    Exit Function
                End If

                If Not Tbl_WorkspaceNodeHistory Is Nothing AndAlso Tbl_WorkspaceNodeHistory.Rows.Count > 0 Then
                    srcFilePath = Tbl_WorkspaceNodeHistory.Rows(0)("vFilePath").ToString
                    FileName = Tbl_WorkspaceNodeHistory.Rows(0)("vFileName").ToString
                    FileSize = Tbl_WorkspaceNodeHistory.Rows(0)("vFileSize").ToString
                    FileType = Tbl_WorkspaceNodeHistory.Rows(0)("vFileType").ToString
                    TranNo = Tbl_WorkspaceNodeHistory.Rows(0)("iTranNo").ToString

                    For Count As Integer = iDocId To Repetition
                        Tbl_WorkspaceNodeDetail.Clear()
                        TempDocId = vDocId.Remove(vDocId.Length - 8)
                        vId = "0000000" + Count.ToString
                        TempDocId = TempDocId + vId.Substring(vId.Length - 8)

                        ''''''' ADDING ROWS IN NEW DATASET FOR WORKSPACENODEDETAIL ''''''
                        Ds.Tables("WorkspaceNodeDetail").Rows(0)("vFolderName") = TempDocId
                        Ds.Tables("WorkspaceNodeDetail").Rows(0)("vNodeName") = TempDocId
                        Ds.Tables("WorkspaceNodeDetail").Rows(0)("vNodeDisplayName") = TempDocId
                        Ds.Tables("WorkspaceNodeDetail").Rows(0)("iNodeIndex") = "-1"
                        'ds_WsNodeDtl.Tables(0).Rows(0)("dModifyOn") = System.DateTime.Now.ToString
                        Tbl_WorkspaceNodeDetail.ImportRow(Ds.Tables(0).Rows(0))

                        If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                            If Not objSave.SaveInDb("Insert_addWorkspaceNodeAfter_ForECTD", Tbl_WorkspaceNodeDetail, Choice, DataReturnList, eStr_Retu, True) Then
                                eStr_Retu += vbCrLf + "Error occured while Save Information of WorkspaceNodeDetail In Database"
                                Exit Function
                            End If
                        Else
                            If Not objSave.SaveInDb("Insert_WorkSpaceNodeDetail", Tbl_WorkspaceNodeDetail, Choice, DataReturnList, eStr_Retu, True) Then
                                eStr_Retu += vbCrLf + "Error occured while Save Information of WorkspaceNodeDetail In Database"
                                Exit Function
                            End If
                            NodeId = CInt(Tbl_WorkspaceNodeDetail.Rows(0)("iNodeId").ToString)
                        End If

                        DataReturnList = DataReturnList.Item(0)
                        If DataReturnList.Count > 0 Then
                            RetuVal = DataReturnList.Item(0)
                            NodeId = RetuVal.ParameterValue

                            Folder = "/" + WsId + "/" + NodeId + "/" + TranNo
                            destFilePath = BaseFolder + Folder + "/" + FileName.Trim

                            Tbl_WorkspaceNodeHistory.Clear()
                            Tbl_WorkspaceNodeHistory.Rows.Add()
                            Tbl_WorkspaceNodeHistory.Rows(0)("vFileName") = FileName.Trim
                            Tbl_WorkspaceNodeHistory.Rows(0)("vFileType") = FileType.Trim
                            Tbl_WorkspaceNodeHistory.Rows(0)("vFolderName") = Folder
                            Tbl_WorkspaceNodeHistory.Rows(0)("vFilePath") = destFilePath
                            Tbl_WorkspaceNodeHistory.Rows(0)("vFileSize") = FileSize
                            Tbl_WorkspaceNodeHistory.Rows(0)("iModifyBy") = UserCode_1
                            Tbl_WorkspaceNodeHistory.Rows(0)("vWorkSpaceId") = WsId
                            Tbl_WorkspaceNodeHistory.Rows(0)("iNodeId") = NodeId
                            Tbl_WorkspaceNodeHistory.Rows(0)("cRequiredFlag") = "D"
                            Tbl_WorkspaceNodeHistory.Rows(0)("iStageId") = 100
                            Tbl_WorkspaceNodeHistory.Rows(0)("cStatusIndi") = "N"
                            Tbl_WorkspaceNodeHistory.Rows(0)("iTranNo") = TranNo

                            If Not objSave.SaveInDb("insert_workspacenodehistory_ForEctd", Tbl_WorkspaceNodeHistory, DataObjOpenSaveModeEnum.DataObjOpenMode_Add, DataReturnList, eStr_Retu, True) Then
                                eStr_Retu += vbCrLf + "Error occured while Save Information of workspacenodehistory In Database"
                                Exit Function
                            End If

                            Folder = BaseFolder + Folder + "/"
                            If Not IO.Directory.Exists(Folder) Then
                                IO.Directory.CreateDirectory(Folder.Trim)
                            End If

                            vFilePaths += destFilePath + ","
                            ' System.IO.File.Move(srcFilePath, destFilePath)
                            'objCommom.InserDocIdToPdf(TempDocId, srcFilePath, destFilePath, Position)
                        End If

                    Next

                    If Not Tbl_DocReleaseTrack Is Nothing AndAlso Tbl_DocReleaseTrack.Rows.Count > 0 Then
                        If Not objSave.SaveInDb("Insert_DocReleaseTrack", Tbl_DocReleaseTrack, Choice, DataReturnList, eStr_Retu, True) Then
                            eStr_Retu += vbCrLf + "Error occured while Save Information of StfStudyIdentifierMst In Database"
                            Exit Function
                        End If
                    End If

                End If

            End If

            Save_WorkspaceNodeDtlWithHist_DocCentric = True
            'Logic of Save End

            If Save_WorkspaceNodeDtlWithHist_DocCentric Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving WorkspaceNodeDetail"
            Save_WorkspaceNodeDtlWithHist_DocCentric = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function


#End Region
    ' ====================================
    ' ====================================


#Region "Insert_WorkspaceActivitySequenceDeviation"
    Public Function Insert_WorkspaceActivitySequenceDeviation(ByVal Choice As DataObjOpenSaveModeEnum, _
                                                                ByVal Ds_WorkspaceActivitySequenceDeviation As Data.DataSet, _
                                                                ByVal objDtLogic As ClsDataLogic_New, _
                                                                ByVal UserCode As String, _
                                                                ByRef eStr_Retu As String) As Boolean


        Dim dataRet As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime As DateTime

        Dim Tbl_WorkspaceActivitySequenceDeviation As Data.DataTable = Nothing
        Dim Instr_iSequenceDeviation As String = "0"

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_WorkspaceActivitySequenceDeviation Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            ''Function called only if edit is called
            'If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
            '    For Each tr As Data.DataRow In Ds_WorkspaceActivitySequenceDeviation.Tables("WorkspaceActivitySequenceDeviation").Rows
            '        Instr_iSequenceDeviation += IIf(Instr_iSequenceDeviation = "", "", ",").ToString + _
            '                        tr("iSequenceDeviation").ToString

            '    Next tr
            'End If

            'If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
            '    dataRet = DataRetrievalModeEnum.DataTable_Empty
            'Else
            '    dataRet = DataRetrievalModeEnum.DataTable_WithWhereCondition
            'End If


            'objHelpDbTbl = New clsHelpDbTable()

            'serverDateTime = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of DrugRegionMatrix
            'If Not objHelpDbTbl.View_WorkspaceActivitySequenceDeviation("iSequenceDeviation In (" + Instr_iSequenceDeviation + ")", dataRet, _
            '                                objDtLogic, Tbl_WorkspaceActivitySequenceDeviation, eStr_Retu) Then

            '    eStr_Retu += vbCrLf + "Error occured while retrieving WorkspaceActivitySequenceDeviation"
            '    Exit Function
            'End If

            ''Assignment of Values
            'PkColArr(0) = "vDrugRegionCode"

            'If Not objSave.AssignValues(Tbl_WorkspaceActivitySequenceDeviation.TableName, PkColArr, Choice, _
            '                            Ds_WorkspaceActivitySequenceDeviation.Tables(Tbl_WorkspaceActivitySequenceDeviation.TableName), _
            '                            Tbl_WorkspaceActivitySequenceDeviation, Tbl_Audit, False, UserCode, serverDateTime, eStr_Retu) Then
            '    eStr_Retu += vbCrLf + "Error occured while assigning values"
            '    Exit Function
            'End If


            ' Save in DrugRegionMatrix
            If Not objSave.SaveInDb("Insert_WorkspaceActivitySequenceDeviation", Ds_WorkspaceActivitySequenceDeviation.Tables(0), Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of DrugRegionMatrix In Database"
                Exit Function
            End If

            Insert_WorkspaceActivitySequenceDeviation = True

            If Insert_WorkspaceActivitySequenceDeviation Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving WorkspaceActivitySequenceDeviation"
            Insert_WorkspaceActivitySequenceDeviation = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region '==Added on 24-Feb-2012===

#Region "Save_InvoiceDetail"

    Public Function Save_InvoiceDetail(ByVal Choice As DataObjOpenSaveModeEnum, _
                                    ByVal Ds_InvoiceDetail As DataSet, _
                                    ByVal objDtLogic As ClsDataLogic_New, _
                                    ByVal UserCode_1 As String, _
                                    ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_InvoiceHdr As Data.DataTable = Nothing
        Dim Tbl_InvoiceDtl As Data.DataTable = Nothing
        Dim Tbl_InvoiceSubDtl As Data.DataTable = Nothing

        Dim Instr_InvoiceNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim DataReturnList_New As New ArrayList

        Dim RetuVal1 As ParameterReturnValue = Nothing
        Dim RetuVal2 As ParameterReturnValue = Nothing
        Dim InvoiceNo_Retu As Integer
        Dim InvoiceTranNo_Retu As Integer
        Dim ctr_1 As Integer

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            'Logic Of save Start
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_InvoiceDetail Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_InvoiceDetail.Tables("InvoiceHdr").Rows

                    Instr_InvoiceNo += IIf(Instr_InvoiceNo = "", "", ",").ToString + _
                                    tr("nInvoiceNo").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of SampleDetail
            If Not objHelpDbTbl.getInvoiceHdr("nInvoiceNo In (" + Instr_InvoiceNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_InvoiceHdr, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving SampleDetail"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nInvoiceNo"
            If Not objSave.AssignValues(Tbl_InvoiceHdr.TableName, PkColArr, Choice, _
                                        Ds_InvoiceDetail.Tables(Tbl_InvoiceHdr.TableName), _
                                        Tbl_InvoiceHdr, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in SampleDetail
            If Not objSave.SaveInDb("Insert_InvoiceHdr", Tbl_InvoiceHdr, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of InvoiceHdr In Database"
                Exit Function
            End If

            If Not Ds_InvoiceDetail.Tables("InvoiceDtl") Is Nothing Then
                Tbl_InvoiceDtl = Ds_InvoiceDetail.Tables("InvoiceDtl")

                DataReturnList = DataReturnList.Item(0)
                RetuVal1 = DataReturnList.Item(0)

                InvoiceNo_Retu = RetuVal1.ParameterValue 'Returns Generated SampleId

                For Each dr As DataRow In Tbl_InvoiceDtl.Rows
                    dr("nInvoiceNo") = RetuVal1.ParameterValue
                Next dr
                Tbl_InvoiceDtl.AcceptChanges()

                ' Save in InvoiceDtl
                If Not objSave.SaveInDb("Insert_InvoiceDtl", Tbl_InvoiceDtl, Choice, DataReturnList, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of InvoiceDtl In Database"
                    Exit Function
                End If

                If Not Ds_InvoiceDetail.Tables("InvoiceSubDtl") Is Nothing Then

                    Tbl_InvoiceSubDtl = Ds_InvoiceDetail.Tables("InvoiceSubDtl")

                    For ctr_1 = 0 To DataReturnList.Count - 1
                        DataReturnList_New = DataReturnList.Item(ctr_1)
                        RetuVal2 = DataReturnList_New.Item(0)
                        InvoiceTranNo_Retu = RetuVal2.ParameterValue


                        For Each dr As DataRow In Tbl_InvoiceSubDtl.Rows
                            If dr("nInvoiceTranNo") = (ctr_1 + 1) Then
                                dr("nInvoiceNo") = RetuVal1.ParameterValue
                                dr("nInvoiceTranNo") = InvoiceTranNo_Retu
                            End If
                        Next dr
                    Next

                    Tbl_InvoiceSubDtl.AcceptChanges()

                    ' Save in InvoiceSubDtl
                    If Not objSave.SaveInDb("Insert_InvoiceSubDtl", Tbl_InvoiceSubDtl, Choice, Nothing, eStr_Retu) Then
                        eStr_Retu += vbCrLf + "Error occured while Save Information of InvoiceDtl In Database"
                        Exit Function
                    End If

                End If
            End If
            Save_InvoiceDetail = True

            'Logic of Save End

            If Save_InvoiceDetail Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Invoice Detail"
            Save_InvoiceDetail = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function

#End Region '== For LIMS

#Region "Save_SampleReportPrintingDetail"

    Public Function Save_SampleReportPrintingDetail(ByVal Choice As DataObjOpenSaveModeEnum, _
                                    ByVal Ds_SampleReportPrintingDetail As DataSet, _
                                    ByVal objDtLogic As ClsDataLogic_New, _
                                    ByVal UserCode_1 As String, _
                                    ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime
        Dim DataReturnList As New ArrayList
        Dim Tbl_SampleReportPrintingDetail As Data.DataTable = Nothing

        Dim Instr_SampleReportPrintingDetailNo As String = ""

        Dim PkColArr(0) As String

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            'Logic Of save Start
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_SampleReportPrintingDetail Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_SampleReportPrintingDetail.Tables("SampleReportPrintingDetail").Rows

                    Instr_SampleReportPrintingDetailNo += IIf(Instr_SampleReportPrintingDetailNo = "", "", ",").ToString + _
                                    tr("nSampleReportPrintingDetailNo").ToString
                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of SampleReportPrintingDetail
            If Not objHelpDbTbl.GetSampleReportPrintingDetail("nSampleReportPrintingDetailNo In (" + Instr_SampleReportPrintingDetailNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_SampleReportPrintingDetail, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving SampleDetail"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nSampleReportPrintingDetailNo"
            If Not objSave.AssignValues(Tbl_SampleReportPrintingDetail.TableName, PkColArr, Choice, _
                                        Ds_SampleReportPrintingDetail.Tables(Tbl_SampleReportPrintingDetail.TableName), _
                                        Tbl_SampleReportPrintingDetail, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in SampleReportPrintingDetail
            If Not objSave.SaveInDb("Insert_SampleReportPrintingDetail", Tbl_SampleReportPrintingDetail, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of Sample Report Printing Detail In Database"
                Exit Function
            End If

            Save_SampleReportPrintingDetail = True

            'Logic of Save End

            If Save_SampleReportPrintingDetail Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Sample Report Printing Detail"
            Save_SampleReportPrintingDetail = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function

#End Region '== For LIMS

#Region "Save_ReferralMaster"
    Public Function Save_ReferralMaster(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_ReferralMaster As DataSet, _
                                 ByVal objDtLogic As ClsDataLogic_New, _
                                 ByVal UserCode_1 As String, _
                                 ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_ReferralMaster As Data.DataTable = Nothing

        Dim Instr_ReferralNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_ReferralMaster Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                For Each tr As Data.DataRow In Ds_ReferralMaster.Tables("ReferralMaster").Rows

                    Instr_ReferralNo += IIf(Instr_ReferralNo = "", "", ",").ToString + _
                                    tr("nReferralNo").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of ScopeMst
            If Not objHelpDbTbl.GetReferralMaster("nReferralNo In (" + Instr_ReferralNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_ReferralMaster, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving UOMMst"
                Exit Function
            End If

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nReferralNo"
            If Not objSave.AssignValues(Tbl_ReferralMaster.TableName, PkColArr, Choice, _
                                        Ds_ReferralMaster.Tables(Tbl_ReferralMaster.TableName), _
                                        Tbl_ReferralMaster, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in ScopeMst
            If Not objSave.SaveInDb("Insert_ReferralMaster", Tbl_ReferralMaster, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of Referral Master In Database"
                Exit Function
            End If

            Save_ReferralMaster = True

            If Save_ReferralMaster Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Referral Master"
            Save_ReferralMaster = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region '== For LIMS

#Region "Save_PatientMaster"
    Public Function Save_PatientMaster(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_PatientMaster As DataSet, _
                                 ByVal objDtLogic As ClsDataLogic_New, _
                                 ByVal UserCode_1 As String, _
                                 ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_PatientMaster As Data.DataTable = Nothing

        Dim Instr_PatientNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_PatientMaster Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                For Each tr As Data.DataRow In Ds_PatientMaster.Tables("PatientMaster").Rows

                    Instr_PatientNo += IIf(Instr_PatientNo = "", "", ",").ToString + _
                                    tr("vPatientID").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of PatientMst
            If Not objHelpDbTbl.Get_PatientMaster("vPatientID In (" + "'" + Instr_PatientNo + "'" + ")", dataRet_1, _
                                            objDtLogic, Tbl_PatientMaster, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving Patient"
                Exit Function
            End If

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving  Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vPatientID"
            If Not objSave.AssignValues(Tbl_PatientMaster.TableName, PkColArr, Choice, _
                                        Ds_PatientMaster.Tables(Tbl_PatientMaster.TableName), _
                                        Tbl_PatientMaster, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in PatientMst
            If Not objSave.SaveInDb("Insert_PatientMaster", Tbl_PatientMaster, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of Patient Master In Database"
                Exit Function
            End If


            DataReturnList = DataReturnList.Item(0)
            RetuVal = DataReturnList.Item(0)
            eStr_Retu = RetuVal.ParameterValue

            Save_PatientMaster = True

            If Save_PatientMaster Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Patient Master"
            Save_PatientMaster = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region '== For LIMS

#Region "Save_DocumentUpload (LIMS)"
    Public Function Save_DocumentUpload(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_DocumentUpload As DataSet, _
                                 ByVal objDtLogic As ClsDataLogic_New, _
                                 ByVal UserCode_1 As String, _
                                 ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_DocumentUpload As Data.DataTable = Nothing

        Dim Instr_DocumentUpload As String = ""

        Dim PkColArr(1) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_DocumentUpload Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                For Each tr As Data.DataRow In Ds_DocumentUpload.Tables("DocumentUpload").Rows

                    Instr_DocumentUpload += IIf(Instr_DocumentUpload = "", "", ",").ToString + _
                                    tr("nUpoadTranNo").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of Document Data
            If Not objHelpDbTbl.Get_DocumentUpload("nUpoadTranNo In (" + Instr_DocumentUpload + ")", dataRet_1, _
                                            objDtLogic, Tbl_DocumentUpload, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving Document Upload Data"
                Exit Function
            End If

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving  Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nUpoadTranNo"
            PkColArr(1) = "nSrNo"
            If Not objSave.AssignValues(Tbl_DocumentUpload.TableName, PkColArr, Choice, _
                                        Ds_DocumentUpload.Tables(Tbl_DocumentUpload.TableName), _
                                        Tbl_DocumentUpload, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in PatientMst
            If Not objSave.SaveInDb("Insert_DocumentUpload", Tbl_DocumentUpload, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of Document Upload In Database"
                Exit Function
            End If

            Save_DocumentUpload = True

            If Save_DocumentUpload Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Document Upload"
            Save_DocumentUpload = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region '== For LIMS

#Region "Save_DiscountMedExTemplateMatrix"

    Public Function Save_DiscountMedExTemplateMatrix(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_DiscountMedExTemplateMatrix As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean
        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim Dt_View As Data.DataView = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_DiscountMedExTemplateMatrix As Data.DataTable = Nothing

        Dim Instr_nDiscountCode As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_DiscountMedExTemplateMatrix Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            Ds_DiscountMedExTemplateMatrix.Tables(0).TableName = "DiscountMedExTemplateMatrix"
            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_DiscountMedExTemplateMatrix.Tables("DiscountMedExTemplateMatrix").Rows

                    Instr_nDiscountCode += IIf(Instr_nDiscountCode = "", "'", ",'").ToString + _
                                    tr("nDiscountCode").ToString + "'"

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of Discount MedExTemplate Matrix
            If Not objHelpDbTbl.GetDiscountMedExTemplateMatrix("nDiscountCode in (" + Instr_nDiscountCode + ")", dataRet_1, _
                                            objDtLogic, Tbl_DiscountMedExTemplateMatrix, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving Discount MedExTemplate Matrix Details"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            Tbl_DiscountMedExTemplateMatrix.TableName = "DiscountMedExTemplateMatrix"

            'Assignment of Values

            PkColArr(0) = ""


            If Not objSave.AssignValues(Tbl_DiscountMedExTemplateMatrix.TableName, PkColArr, Choice, _
                                        Ds_DiscountMedExTemplateMatrix.Tables(Tbl_DiscountMedExTemplateMatrix.TableName), _
                                        Tbl_DiscountMedExTemplateMatrix, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "error occured while assigning values"
                Exit Function
            End If

            ' Save in DiscountMedExTemplateMatrix
            Tbl_DiscountMedExTemplateMatrix.TableName = "DiscountMedExTemplateMatrix"
            If Not objSave.SaveInDb("Insert_DiscountMedExTemplateMatrix", Tbl_DiscountMedExTemplateMatrix, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of Discount MedExTemplate Matrix In Database"
                Exit Function
            End If

            Save_DiscountMedExTemplateMatrix = True

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving DiscountMedExTemplateMatrix Details"
            Save_DiscountMedExTemplateMatrix = False
        End Try
    End Function

#End Region '== For LIMS

#Region "Save_SMSDetails"

    Public Function Save_SMSDetails(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_SMSDetails As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean
        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim Dt_View As Data.DataView = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_SMSDetail As Data.DataTable = Nothing

        Dim Instr_nSMSID As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_SMSDetails Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            Ds_SMSDetails.Tables(0).TableName = "SMSDetail"
            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_SMSDetails.Tables("SMSDetail").Rows

                    Instr_nSMSID += IIf(Instr_nSMSID = "", "'", ",'").ToString + _
                                    tr("nSMSId").ToString + "'"

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of Discount MedExTemplate Matrix
            If Not objHelpDbTbl.Get_SMSDetail("nSMSId in (" + Instr_nSMSID + ")", dataRet_1, _
                                            objDtLogic, Tbl_SMSDetail, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving SMS Details"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            Tbl_SMSDetail.TableName = "SMSDetail"

            'Assignment of Values

            PkColArr(0) = "nSMSId"

            If Not objSave.AssignValues(Tbl_SMSDetail.TableName, PkColArr, Choice, _
                                        Ds_SMSDetails.Tables(Tbl_SMSDetail.TableName), _
                                        Tbl_SMSDetail, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "error occured while assigning values"
                Exit Function
            End If

            ' Save in DiscountMedExTemplateMatrix
            Tbl_SMSDetail.TableName = "SMSDetail"
            If Not objSave.SaveInDb("Insert_SMSDetail", Tbl_SMSDetail, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of SMS Details In Database"
                Exit Function
            End If

            Save_SMSDetails = True

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving SMS Details"
            Save_SMSDetails = False
        End Try
    End Function

#End Region '== For LIMS

#Region "Save_TemplateCostMst"

    Public Function Save_TemplateCostMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_TemplateCost As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean
        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim Dt_View As Data.DataView = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_TemplateCostDtl As Data.DataTable = Nothing

        Dim Instr_nTemplateTestCodeID As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_TemplateCost Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            Ds_TemplateCost.Tables(0).TableName = "TemplateCostMSt"
            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_TemplateCost.Tables("TemplateCostMSt").Rows

                    Instr_nTemplateTestCodeID += IIf(Instr_nTemplateTestCodeID = "", "'", ",'").ToString + _
                                    tr("nTemplateCostCode").ToString + "'"

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of Discount MedExTemplate Matrix
            If Not objHelpDbTbl.Get_TemplateCostMSt("nTemplateCostCode in (" + Instr_nTemplateTestCodeID + ")", dataRet_1, _
                                            objDtLogic, Tbl_TemplateCostDtl, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving SMS Details"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            Tbl_TemplateCostDtl.TableName = "TemplateCostMst"

            'Assignment of Values

            PkColArr(0) = "nSMSId"

            If Not objSave.AssignValues(Tbl_TemplateCostDtl.TableName, PkColArr, Choice, _
                                        Ds_TemplateCost.Tables(Tbl_TemplateCostDtl.TableName), _
                                        Tbl_TemplateCostDtl, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "error occured while assigning values"
                Exit Function
            End If

            ' Save in DiscountMedExTemplateMatrix
            Tbl_TemplateCostDtl.TableName = "TemplateCostMst"
            If Not objSave.SaveInDb("Insert_TemplateCostMst", Tbl_TemplateCostDtl, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of Template Cost Details In Database"
                Exit Function
            End If

            Save_TemplateCostMst = True

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving SMS Details"
            Save_TemplateCostMst = False
        End Try
    End Function

#End Region '== For LIMS

#Region "Save_SpecialityMst"
    Public Function Save_SpecialityMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_SpecialityMst As DataSet, _
                                 ByVal objDtLogic As ClsDataLogic_New, _
                                 ByVal UserCode_1 As String, _
                                 ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_SpecialityMst As Data.DataTable = Nothing

        Dim Instr_SpecialityNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_SpecialityMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                For Each tr As Data.DataRow In Ds_SpecialityMst.Tables("SpecialityMst").Rows

                    Instr_SpecialityNo += IIf(Instr_SpecialityNo = "", "", ",").ToString + _
                                    tr("nSpecialityNo").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of ScopeMst
            If Not objHelpDbTbl.GetSpecialityMst("nSpecialityNo In (" + Instr_SpecialityNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_SpecialityMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving SpecialityMst"
                Exit Function
            End If

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nSpecialityNo"

            If Not objSave.AssignValues(Tbl_SpecialityMst.TableName, PkColArr, Choice, _
                                        Ds_SpecialityMst.Tables(Tbl_SpecialityMst.TableName), _
                                        Tbl_SpecialityMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in ScopeMst
            If Not objSave.SaveInDb("Insert_SpecialityMst", Tbl_SpecialityMst, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of SpecialityMst In Database"
                Exit Function
            End If

            Save_SpecialityMst = True

            If Save_SpecialityMst Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving SpecialityMst"
            Save_SpecialityMst = False
            objDtLogic.RollBack_Transaction()

        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try

    End Function
#End Region '== For LIMS

#Region "Save_CityMst"
    Public Function Save_CityMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_CityMst As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean
        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim Dt_View As Data.DataView = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_CityMst As Data.DataTable = Nothing

        Dim Instr_vCityCode As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_CityMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            Ds_CityMst.Tables(0).TableName = "CityMst"
            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_CityMst.Tables("CityMst").Rows

                    Instr_vCityCode += IIf(Instr_vCityCode = "", "'", ",'").ToString + _
                                    tr("vCityCode").ToString + "'"

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Add
            'Retrieval of CityMst
            If Not objHelpDbTbl.GetCityMst("vCityCode in (" + Instr_vCityCode + ")", dataRet_1, _
                                            objDtLogic, Tbl_CityMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving MedExGroup Mst Details"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            Tbl_CityMst.TableName = "CityMst"


            'End 
            PkColArr(0) = "vCityCode"

            If Not objSave.AssignValues(Tbl_CityMst.TableName, PkColArr, Choice, _
                                        Ds_CityMst.Tables(Tbl_CityMst.TableName), _
                                        Tbl_CityMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "error occured while assigning values"
                Exit Function
            End If

            ' Save in CityMst
            Tbl_CityMst.TableName = "CityMst"
            If Not objSave.SaveInDb("Insert_CityMst", Tbl_CityMst, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of City Master In Database"
                Exit Function
            End If

            Save_CityMst = True

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving City Master Details"
            Save_CityMst = False
        End Try
    End Function
#End Region '== For LIMS

#Region "Save_KnockOffDtl"
    Public Function Save_KnockOffDetail(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_KnockOffDtl As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean
        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim Dt_View As Data.DataView = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_KnockOffDtl As Data.DataTable = Nothing

        Dim Instr_nKnockoffDetail As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_KnockOffDtl Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            Ds_KnockOffDtl.Tables(0).TableName = "KnockOffDetail"
            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_KnockOffDtl.Tables("KnockOffDetail").Rows

                    Instr_nKnockoffDetail += IIf(Instr_nKnockoffDetail = "", "'", ",'").ToString + _
                                    tr("nKnockoffNo").ToString + "'"

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Add
            'Retrieval of CityMst
            If Not objHelpDbTbl.GetKnockOffDetail("nKnockoffNo in (" + Instr_nKnockoffDetail + ")", dataRet_1, _
                                            objDtLogic, Tbl_KnockOffDtl, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving MedExGroup Mst Details"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            Tbl_KnockOffDtl.TableName = "KnockOffDetail"


            'End 
            PkColArr(0) = "nKnockoffNo"

            If Not objSave.AssignValues(Tbl_KnockOffDtl.TableName, PkColArr, Choice, _
                                        Ds_KnockOffDtl.Tables(Tbl_KnockOffDtl.TableName), _
                                        Tbl_KnockOffDtl, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "error occured while assigning values"
                Exit Function
            End If

            ' Save in CityMst
            Tbl_KnockOffDtl.TableName = "KnockOffDetail"
            If Not objSave.SaveInDb("Insert_KnockOffDetail", Tbl_KnockOffDtl, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of Knockoff Detail In Database"
                Exit Function
            End If

            Save_KnockOffDetail = True

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while KnockOff Detail"
            Save_KnockOffDetail = False
        End Try
    End Function
#End Region '== For LIMS

#Region "Save_PatientMaster" ' Added By Ankit Shah
    Public Function Save_LabPatientMaster(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_LabPatientMaster As DataSet, _
                                 ByVal objDtLogic As ClsDataLogic_New, _
                                 ByVal UserCode_1 As String, _
                                 ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_LabPatientMaster As Data.DataTable = Nothing

        Dim Instr_LabPatientNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_LabPatientMaster Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                For Each tr As Data.DataRow In Ds_LabPatientMaster.Tables("LabPatientMaster").Rows

                    Instr_LabPatientNo += IIf(Instr_LabPatientNo = "", "", ",").ToString + _
                                    tr("vPatientID").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of PatientMst


            If Not objHelpDbTbl.Get_LabPatientMaster("vPatientID In (" + "'" + Instr_LabPatientNo + "'" + ")", dataRet_1, _
                                            objDtLogic, Tbl_LabPatientMaster, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving Patient"
                Exit Function
            End If

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving  Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vPatientID"

            If Not objSave.AssignValues(Tbl_LabPatientMaster.TableName, PkColArr, Choice, _
                                        Ds_LabPatientMaster.Tables(Tbl_LabPatientMaster.TableName), _
                                        Tbl_LabPatientMaster, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in PatientMst
            If Not objSave.SaveInDb("Insert_LabPatientMaster", Tbl_LabPatientMaster, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of Lab Patient Master In Database"
                Exit Function
            End If


            DataReturnList = DataReturnList.Item(0)
            RetuVal = DataReturnList.Item(0)
            eStr_Retu = RetuVal.ParameterValue

            Save_LabPatientMaster = True

            If Save_LabPatientMaster Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Patient Master"
            Save_LabPatientMaster = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region '== For LIMS

#Region "Save_SampleRemarkDtl" ' Added By Ankit Shah
    Public Function Save_SampleRemarkDtl(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_SampleRemarkDtl As DataSet, _
                                 ByVal objDtLogic As ClsDataLogic_New, _
                                 ByVal UserCode_1 As String, _
                                 ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing
        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing
        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime
        Dim Tbl_SampleRemarkDtl As Data.DataTable = Nothing
        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_SampleRemarkDtl Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called


            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of Sample Remark Dtl
            If Not objHelpDbTbl.GetSampleRemarkDtl("", dataRet_1, _
                                            objDtLogic, Tbl_SampleRemarkDtl, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving Sample Remark Dtl"
                Exit Function
            End If

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving  Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vSampleID"

            If Not objSave.AssignValues(Tbl_SampleRemarkDtl.TableName, PkColArr, Choice, _
                                        Ds_SampleRemarkDtl.Tables(Tbl_SampleRemarkDtl.TableName), _
                                        Tbl_SampleRemarkDtl, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in Sample Remark Dtl
            If Not objSave.SaveInDb("Insert_SampleRemarkDtl", Tbl_SampleRemarkDtl, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of Sample Remark Dtl In Database"
                Exit Function
            End If


            Save_SampleRemarkDtl = True

            If Save_SampleRemarkDtl Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Sample Remark Dtl "
            Save_SampleRemarkDtl = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region '== For LIMS

#Region "Save_EditSamplesDetail"

    Public Function Save_EditSampleDetail(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_SampleDetail As DataSet, _
                                 ByVal objDtLogic As ClsDataLogic_New, _
                                 ByVal UserCode_1 As String, _
                                 ByRef nSampleId_Retu As String, _
                                 ByRef eStr_Retu As String) As Boolean

        ' Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_SampleMedExDetail As Data.DataTable = Nothing
        Dim Tbl_SampleTemplateDetail As Data.DataTable = Nothing

        Dim Instr_SampleId As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal1 As ParameterReturnValue = Nothing
        Dim RetuVal2 As ParameterReturnValue = Nothing


        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            'Logic Of save Start
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_SampleDetail Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            'If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
            '    dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            'Else
            '    dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            'End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            DataReturnList = DataReturnList.Item(0)
            'RetuVal1 = DataReturnList.Item(0)
            ''RetuVal2 = DataReturnList.Item(1)


            'If Not Ds_SampleDetail.Tables("SampleMedExDetail") Is Nothing Then
            '    Tbl_SampleMedExDetail = Ds_SampleDetail.Tables("SampleMedExDetail")

            '    nSampleId_Retu = RetuVal1.ParameterValue 'Returns Generated SampleId
            '    'vSampleId_Retu = RetuVal2.ParameterValue

            '    For Each dr As DataRow In Tbl_SampleMedExDetail.Rows
            '        dr("nSampleId") = RetuVal1.ParameterValue
            '    Next dr
            '    Tbl_SampleMedExDetail.AcceptChanges()
            'End If

            If Not Ds_SampleDetail.Tables("SampleMedExDetail") Is Nothing Then
                Tbl_SampleMedExDetail = Ds_SampleDetail.Tables("SampleMedExDetail")

                ' Save in SampleMedExDetail
                If Not objSave.SaveInDb("Insert_SampleMedExDetail", Tbl_SampleMedExDetail, Choice, DataReturnList, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of SampleMedExDetail In Database"
                    Exit Function
                End If

            End If

            If Not (Ds_SampleDetail.Tables("SampleTemplateDetail")) Is Nothing Then

                Tbl_SampleTemplateDetail = Ds_SampleDetail.Tables("SampleTemplateDetail")

                'nSampleId_Retu = RetuVal1.ParameterValue 'Returns Generated SampleId
                'vSampleId_Retu = RetuVal2.ParameterValue

                'For Each dr As DataRow In Tbl_SampleTemplateDetail.Rows
                '    dr("nSampleId") = RetuVal1.ParameterValue
                '    dr("vSampleId") = RetuVal2.ParameterValue
                'Next dr
                'Tbl_SampleTemplateDetail.AcceptChanges()

                ' Save in SampleMedExDetail
                If Not objSave.SaveInDb("insert_SampleTemplateDetail", Tbl_SampleTemplateDetail, Choice, DataReturnList, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of SampleTemplateDetail In Database"
                    Exit Function
                End If

            End If

            Save_EditSampleDetail = True

            'Logic of Save End

            If Save_EditSampleDetail Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving SampleDetail"
            Save_EditSampleDetail = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region '== For LIMS

#Region "Save_SampleTemplateDetail"


    Public Function Save_SampleTemplateDetail(ByVal Choice As DataObjOpenSaveModeEnum, _
                             ByVal Ds_SampleTemplateDetail As DataSet, _
                             ByVal objDtLogic As ClsDataLogic_New, _
                             ByVal UserCode_1 As String, _
                             ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_SampleTemplateDetail As Data.DataTable = Nothing
        Dim Instr_SampleId As String = ""

        Dim PkColArr(1) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing


        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu += Environment.NewLine + "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu += Environment.NewLine + "Transaction object is not started"
                Exit Function
            End If

            If Ds_SampleTemplateDetail Is Nothing Then
                eStr_Retu += Environment.NewLine + "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            Tbl_SampleTemplateDetail = Ds_SampleTemplateDetail.Tables("SampleTemplateDetail").Copy

            'Assignment of Values
            PkColArr(0) = "nSampleId"
            PkColArr(1) = "vTemplateCode"

            ' Save in SampleTemplateDetail
            If Not objSave.SaveInDb("insert_sampleTemplateDetail", Tbl_SampleTemplateDetail, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of SampleTemplateDetail In Database"
                Exit Function
            End If

            Save_SampleTemplateDetail = True

            If Save_SampleTemplateDetail Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving SampleTemplateDetail"
            Save_SampleTemplateDetail = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region '== For LIMS

#Region "Save_TemplateRemarkDtl" ' Added By Ankit Shah
    Public Function Save_TemplateRemarkDtl(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_TemplateRemarkDtl As DataSet, _
                                 ByVal objDtLogic As ClsDataLogic_New, _
                                 ByVal UserCode_1 As String, _
                                 ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing
        Dim objSave As SaveDataInDbObj = Nothing
        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime
        Dim Tbl_TemplateRemarkDtl As Data.DataTable = Nothing
        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_TemplateRemarkDtl Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called


            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of TemplateRemarkDtl
            If Not objHelpDbTbl.Get_TemplateRemarkDtl("", dataRet_1, _
                                            objDtLogic, Tbl_TemplateRemarkDtl, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving Template Remark Dtl"
                Exit Function
            End If

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving  Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vTemplateCode"

            If Not objSave.AssignValues(Tbl_TemplateRemarkDtl.TableName, PkColArr, Choice, _
                                        Ds_TemplateRemarkDtl.Tables(Tbl_TemplateRemarkDtl.TableName), _
                                        Tbl_TemplateRemarkDtl, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in TemplateRemarkDtl
            If Not objSave.SaveInDb("Insert_TemplateRemarkDtl", Tbl_TemplateRemarkDtl, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of Template Remark Dtl In Database"
                Exit Function
            End If


            Save_TemplateRemarkDtl = True

            If Save_TemplateRemarkDtl Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Template Remark Dtl"
            Save_TemplateRemarkDtl = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region '== For LIMS

#Region "Save_SampleCollecterMaster"
    Public Function Save_SampleCollecterMaster(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_SampleCollecter As DataSet, _
                                 ByVal objDtLogic As ClsDataLogic_New, _
                                 ByVal UserCode_1 As String, _
                                 ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing
        Dim objSave As SaveDataInDbObj = Nothing
        Dim Sql_DtSet As Data.DataSet = Nothing

        Dim Instr_nSampleCollecterNo As String = ""

        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime
        Dim Tbl_SampleCollecterMaster As Data.DataTable = Nothing
        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_SampleCollecter Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_SampleCollecter.Tables("SampleCollecterMaster").Rows

                    Instr_nSampleCollecterNo += IIf(Instr_nSampleCollecterNo = "", "'", ",'").ToString + _
                                    tr("nSampleCollectedNo").ToString + "'"

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of SampleCollecterMaster
            If Not objHelpDbTbl.Get_SampleCollecterMaster("nSampleCollectedNo in (" + Instr_nSampleCollecterNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_SampleCollecterMaster, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving SampleCollecterMaster"
                Exit Function
            End If

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving  Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nSampleCollectedNo"

            If Not objSave.AssignValues(Tbl_SampleCollecterMaster.TableName, PkColArr, Choice, _
                                        Ds_SampleCollecter.Tables(Tbl_SampleCollecterMaster.TableName), _
                                        Tbl_SampleCollecterMaster, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in SampleCollecterMaster
            If Not objSave.SaveInDb("Insert_SampleCollecterMaster", Tbl_SampleCollecterMaster, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of SampleCollecterMaster"
                Exit Function
            End If


            Save_SampleCollecterMaster = True

            If Save_SampleCollecterMaster Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Template Remark Dtl"
            Save_SampleCollecterMaster = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region '== For LIMS

#Region "Save_HistoParameterDtl"
    Public Function Save_HistoParameterDtl(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_HistoParameter As DataSet, _
                                 ByVal objDtLogic As ClsDataLogic_New, _
                                 ByVal UserCode_1 As String, _
                                 ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing
        Dim objSave As SaveDataInDbObj = Nothing
        Dim Sql_DtSet As Data.DataSet = Nothing

        Dim Instr_nSampleID As String = ""
        Dim Instr_nHistoParamNo As String = ""


        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime
        Dim Tbl_HistoParameterDtl As Data.DataTable = Nothing
        Dim PkColArr(1) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_HistoParameter Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_HistoParameter.Tables("HistoParameterDtl").Rows

                    Instr_nSampleID += IIf(Instr_nSampleID = "", "'", ",'").ToString + _
                                    tr("nSampleId").ToString + "'"

                    Instr_nHistoParamNo += IIf(Instr_nHistoParamNo = "", "'", ",'").ToString + _
                                    tr("nHistoParamNo").ToString + "'"

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of SampleCollecterMaster
            If Not objHelpDbTbl.Get_HistoParameterDtl("nSampleId in (" + Instr_nSampleID + ") And " + _
                                                           "nHistoParamNo in (" + Instr_nHistoParamNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_HistoParameterDtl, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving SampleCollecterMaster"
                Exit Function
            End If

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving  Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nSampleId"
            PkColArr(1) = "nHistoParamNo"


            If Not objSave.AssignValues(Tbl_HistoParameterDtl.TableName, PkColArr, Choice, _
                                        Ds_HistoParameter.Tables(Tbl_HistoParameterDtl.TableName), _
                                        Tbl_HistoParameterDtl, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in SampleCollecterMaster
            If Not objSave.SaveInDb("Insert_HistoParameterDtl", Tbl_HistoParameterDtl, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of SampleCollecterMaster"
                Exit Function
            End If


            Save_HistoParameterDtl = True

            If Save_HistoParameterDtl Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Template Remark Dtl"
            Save_HistoParameterDtl = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region '== For LIMS

#Region "Save_ParameterHdr"
    Public Function Save_ParameterHdr(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_ParameterHdr As DataSet, _
                                 ByVal objDtLogic As ClsDataLogic_New, _
                                 ByVal UserCode_1 As String, _
                                 ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing
        Dim objSave As SaveDataInDbObj = Nothing
        Dim Sql_DtSet As Data.DataSet = Nothing

        Dim Instr_nParameterHdrNo As String = ""

        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime
        Dim Tbl_ParameterHdr As Data.DataTable = Nothing
        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_ParameterHdr Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_ParameterHdr.Tables("ParameterHdr").Rows

                    Instr_nParameterHdrNo += IIf(Instr_nParameterHdrNo = "", "'", ",'").ToString + _
                                    tr("nParameterHdrNo").ToString + "'"

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of ParameterHdr
            If Not objHelpDbTbl.Get_ParameterHdr("nParameterHdrNo in (" + Instr_nParameterHdrNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_ParameterHdr, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving ParameterHdr"
                Exit Function
            End If

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving  Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nParameterHdrNo"


            If Not objSave.AssignValues(Tbl_ParameterHdr.TableName, PkColArr, Choice, _
                                        Ds_ParameterHdr.Tables(Tbl_ParameterHdr.TableName), _
                                        Tbl_ParameterHdr, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in ParameterHdr
            If Not objSave.SaveInDb("Insert_ParameterHdr", Tbl_ParameterHdr, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of ParameterHdr"
                Exit Function
            End If

            Save_ParameterHdr = True

            If Save_ParameterHdr Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving ParameterHdr"
            Save_ParameterHdr = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region '== For LIMS

#Region "Save_ParameterDtl"
    Public Function Save_ParameterDtl(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_ParameterDtl As DataSet, _
                                 ByVal objDtLogic As ClsDataLogic_New, _
                                 ByVal UserCode_1 As String, _
                                 ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing
        Dim objSave As SaveDataInDbObj = Nothing
        Dim Sql_DtSet As Data.DataSet = Nothing

        Dim Instr_nParameterDtlNo As String = ""

        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime
        Dim Tbl_ParameterDtl As Data.DataTable = Nothing
        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_ParameterDtl Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_ParameterDtl.Tables("View_ParameterDtl").Rows

                    Instr_nParameterDtlNo += IIf(Instr_nParameterDtlNo = "", "'", ",'").ToString + _
                                    tr("nParameterDtlNo").ToString + "'"

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of ParameterDtl
            If Not objHelpDbTbl.Get_ParameterDtl("nParameterDtlNo in (" + Instr_nParameterDtlNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_ParameterDtl, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving ParameterDtl"
                Exit Function
            End If

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving  Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nParameterDtlNo"


            If Not objSave.AssignValues(Tbl_ParameterDtl.TableName, PkColArr, Choice, _
                                        Ds_ParameterDtl.Tables(Tbl_ParameterDtl.TableName), _
                                        Tbl_ParameterDtl, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in ParameterDtl
            If Not objSave.SaveInDb("Insert_ParameterDtl", Tbl_ParameterDtl, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of ParameterDtl"
                Exit Function
            End If

            Save_ParameterDtl = True

            If Save_ParameterDtl Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving ParameterDtl"
            Save_ParameterDtl = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region '== For LIMS

#Region "Save_SampleParameterDetail"
    Public Function Save_SampleParameterDetail(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_SampleParameterDetail As DataSet, _
                                 ByVal objDtLogic As ClsDataLogic_New, _
                                 ByVal UserCode_1 As String, _
                                 ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing
        Dim objSave As SaveDataInDbObj = Nothing
        Dim Sql_DtSet As Data.DataSet = Nothing

        Dim Instr_nSampleID As String = ""
        Dim Instr_nParameterHdrNo As String = ""
        Dim Instr_nParameterDtlNo As String = ""

        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime
        Dim Tbl_SampleParameterDetail As Data.DataTable = Nothing
        Dim PkColArr(2) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_SampleParameterDetail Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_SampleParameterDetail.Tables("SampleParameterDetail").Rows

                    Instr_nSampleID += IIf(Instr_nSampleID = "", "'", ",'").ToString + _
                                    tr("nSampleId").ToString + "'"

                    Instr_nParameterHdrNo += IIf(Instr_nParameterHdrNo = "", "'", ",'").ToString + _
                                    tr("nParameterHdrNo").ToString + "'"

                    Instr_nParameterDtlNo += IIf(Instr_nParameterDtlNo = "", "'", ",'").ToString + _
                                    tr("nParameterDtlNo").ToString + "'"

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of SampleParameterDetail
            If Not objHelpDbTbl.Get_ViewSampleParameterDetail("nSampleId in (" + Instr_nSampleID + ") And " + _
                                                           "nParameterHdrNo in (" + Instr_nParameterHdrNo + ") And " + _
                                                           "nParameterDtlNo in (" + Instr_nParameterDtlNo + ")", dataRet_1, _
                                                            objDtLogic, Tbl_SampleParameterDetail, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving SampleParameterDetail"
                Exit Function
            End If

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving  Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nSampleId"
            PkColArr(1) = "nParameterHdrNo"
            PkColArr(2) = "nParameterDtlNo"


            If Not objSave.AssignValues(Tbl_SampleParameterDetail.TableName, PkColArr, Choice, _
                                        Ds_SampleParameterDetail.Tables(Tbl_SampleParameterDetail.TableName), _
                                        Tbl_SampleParameterDetail, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in SampleParameterDetail
            If Not objSave.SaveInDb("Insert_SampleParameterDetail", Tbl_SampleParameterDetail, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of SampleParameterDetail"
                Exit Function
            End If


            Save_SampleParameterDetail = True

            If Save_SampleParameterDetail Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving SampleParameterDetail"
            Save_SampleParameterDetail = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region '== For LIMS

#Region "Save_RemarkGroupDtl"
    Public Function Save_RemarkGroupDtl(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_RemarkGroupDtl As DataSet, _
                                 ByVal objDtLogic As ClsDataLogic_New, _
                                 ByVal UserCode_1 As String, _
                                 ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing
        Dim objSave As SaveDataInDbObj = Nothing
        Dim Sql_DtSet As Data.DataSet = Nothing

        Dim Instr_nRemarkGroupHdrNo As String = ""
        Dim Instr_nRemarkGroupDtlNo As String = ""

        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime
        Dim Tbl_RemarkGroupDtl As Data.DataTable = Nothing
        Dim PkColArr(1) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_RemarkGroupDtl Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_RemarkGroupDtl.Tables("RemarkGroupDtl").Rows

                    Instr_nRemarkGroupHdrNo += IIf(Instr_nRemarkGroupHdrNo = "", "'", ",'").ToString + _
                                    tr("nRemarkGroupHdrNo").ToString + "'"

                    Instr_nRemarkGroupDtlNo += IIf(Instr_nRemarkGroupDtlNo = "", "'", ",'").ToString + _
                                    tr("nRemarkGroupDtlNo").ToString + "'"

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of RemarkGroupDtl
            If Not objHelpDbTbl.GetRemarkGroupDtl("nRemarkGroupHdrNo in (" + Instr_nRemarkGroupHdrNo + ") And " + _
                                                           "nRemarkGroupDtlNo in (" + Instr_nRemarkGroupDtlNo + ")", dataRet_1, _
                                                            objDtLogic, Tbl_RemarkGroupDtl, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving RemarkGroupDtl"
                Exit Function
            End If

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving  Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nRemarkGroupHdrNo"
            PkColArr(1) = "nRemarkGroupDtlNo"


            If Not objSave.AssignValues(Tbl_RemarkGroupDtl.TableName, PkColArr, Choice, _
                                        Ds_RemarkGroupDtl.Tables(Tbl_RemarkGroupDtl.TableName), _
                                        Tbl_RemarkGroupDtl, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in RemarkGroupDtl
            If Not objSave.SaveInDb("Insert_RemarkGroupDtl", Tbl_RemarkGroupDtl, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of RemarkGroupDtl"
                Exit Function
            End If


            Save_RemarkGroupDtl = True

            If Save_RemarkGroupDtl Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving RemarkGroupDtl"
            Save_RemarkGroupDtl = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region '== For LIMS

#Region "Save_MedexRemarkDtl"
    Public Function Save_MedexRemarkDtl(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal ds_MedexRemarkDtl As DataSet, _
                                 ByVal objDtLogic As ClsDataLogic_New, _
                                 ByVal UserCode_1 As String, _
                                 ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing
        Dim objSave As SaveDataInDbObj = Nothing
        Dim Sql_DtSet As Data.DataSet = Nothing

        Dim Instr_MedexCode As String = ""

        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime
        Dim Tbl_RemarkGroupDtl As Data.DataTable = Nothing
        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If ds_MedexRemarkDtl Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In ds_MedexRemarkDtl.Tables("MedexRemarkDtl").Rows

                    Instr_MedexCode += IIf(Instr_MedexCode = "", "'", ",'").ToString + _
                                    tr("vMedexCode").ToString + "'"

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of RemarkGroupDtl
            If Not objHelpDbTbl.Get_MedexRemarkDtl("vMedexCode in (" + Instr_MedexCode + ")", dataRet_1, _
                                                            objDtLogic, Tbl_RemarkGroupDtl, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving MedexRemarkDtl"
                Exit Function
            End If

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving  Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vMedexCode"


            If Not objSave.AssignValues(Tbl_RemarkGroupDtl.TableName, PkColArr, Choice, _
                                        ds_MedexRemarkDtl.Tables(Tbl_RemarkGroupDtl.TableName), _
                                        Tbl_RemarkGroupDtl, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in RemarkGroupDtl
            If Not objSave.SaveInDb("Insert_MedexRemarkDtl", Tbl_RemarkGroupDtl, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of MedexRemarkDtl"
                Exit Function
            End If


            Save_MedexRemarkDtl = True

            If Save_MedexRemarkDtl Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving RemarkGroupDtl"
            Save_MedexRemarkDtl = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region '== For LIMS

#Region "Save_HistoSampleUserApproval"
    Public Function Save_HistoSampleUserApproval(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal ds_MedexRemarkDtl As DataSet, _
                                 ByVal objDtLogic As ClsDataLogic_New, _
                                 ByVal UserCode_1 As String, _
                                 ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing
        Dim objSave As SaveDataInDbObj = Nothing
        Dim Sql_DtSet As Data.DataSet = Nothing

        Dim Instr_SampleId As String = ""

        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime
        Dim Tbl_RemarkGroupDtl As Data.DataTable = Nothing
        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If ds_MedexRemarkDtl Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In ds_MedexRemarkDtl.Tables("nSampleId").Rows

                    Instr_SampleId += IIf(Instr_SampleId = "", "'", ",'").ToString + _
                                    tr("nSampleId").ToString + "'"

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of RemarkGroupDtl
            If Not objHelpDbTbl.Get_HistoSampleUserApproval("nSampleId in (" + Instr_SampleId + ")", dataRet_1, _
                                                            objDtLogic, Tbl_RemarkGroupDtl, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving HistoSampleUserApproval"
                Exit Function
            End If

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving  Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nSampleId"


            If Not objSave.AssignValues(Tbl_RemarkGroupDtl.TableName, PkColArr, Choice, _
                                        ds_MedexRemarkDtl.Tables(Tbl_RemarkGroupDtl.TableName), _
                                        Tbl_RemarkGroupDtl, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in RemarkGroupDtl
            If Not objSave.SaveInDb("insert_HistoSampleUserApproval", Tbl_RemarkGroupDtl, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of Histo Sample User Approval"
                Exit Function
            End If


            Save_HistoSampleUserApproval = True

            If Save_HistoSampleUserApproval Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Histo Sample User Approval"
            Save_HistoSampleUserApproval = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region '== For LIMS

#Region "Save_FranchiseCostMst"
    Public Function Save_FranchiseCostMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_FranchiseCostMst As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean
        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim Dt_View As Data.DataView = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_FranchiseCostMst As Data.DataTable = Nothing

        Dim Instr_nLaboratoryCostMst As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_FranchiseCostMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            Ds_FranchiseCostMst.Tables(0).TableName = "FranchiseCostMst"
            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_FranchiseCostMst.Tables("FranchiseCostMst").Rows

                    Instr_nLaboratoryCostMst += IIf(Instr_nLaboratoryCostMst = "", "'", ",'").ToString + _
                                    tr("nFrnachiseCostNo").ToString + "'"

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Add
            'Retrieval of CityMst
            If Not objHelpDbTbl.GetFranchiseCostMaster("nFrnachiseCostNo in (" + Instr_nLaboratoryCostMst + ")", dataRet_1, _
                                            objDtLogic, Tbl_FranchiseCostMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving MedExGroup Mst Details"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            Tbl_FranchiseCostMst.TableName = "FranchiseCostMst"


            'End 
            PkColArr(0) = "nFrnachiseCostNo"

            If Not objSave.AssignValues(Tbl_FranchiseCostMst.TableName, PkColArr, Choice, _
                                        Ds_FranchiseCostMst.Tables(Tbl_FranchiseCostMst.TableName), _
                                        Tbl_FranchiseCostMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "error occured while assigning values"
                Exit Function
            End If

            ' Save in CityMst
            Tbl_FranchiseCostMst.TableName = "FranchiseCostMst"
            If Not objSave.SaveInDb("Insert_FranchiseCostMst", Tbl_FranchiseCostMst, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of City Master In Database"
                Exit Function
            End If

            Save_FranchiseCostMst = True

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Laboratory Cost Details"
            Save_FranchiseCostMst = False
        End Try
    End Function
#End Region '== For LIMS

#Region "Save_SampleDispatch"
    Public Function Save_SampleDispatch(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_SampleDispatch As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean
        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim Dt_View As Data.DataView = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_SampleDispatch As Data.DataTable = Nothing

        Dim Instr_SampleDispatch As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_SampleDispatch Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            Ds_SampleDispatch.Tables(0).TableName = "SampleDispatch"
            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_SampleDispatch.Tables("SampleDispatch").Rows

                    Instr_SampleDispatch += IIf(Instr_SampleDispatch = "", "'", ",'").ToString + _
                                    tr("nSampleId").ToString + "'"

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Add
            'Retrieval of Sample Dispatch
            If Not objHelpDbTbl.GetDispatchSample("nSampleId in (" + Instr_SampleDispatch + ")", dataRet_1, _
                                            objDtLogic, Tbl_SampleDispatch, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving Sample Dispatch"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            Tbl_SampleDispatch.TableName = "SampleDispatch"


            'End 
            PkColArr(0) = "nSampleID"

            If Not objSave.AssignValues(Tbl_SampleDispatch.TableName, PkColArr, Choice, _
                                        Ds_SampleDispatch.Tables(Tbl_SampleDispatch.TableName), _
                                        Tbl_SampleDispatch, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "error occured while assigning values"
                Exit Function
            End If

            'Save In Sample Dispatch
            Tbl_SampleDispatch.TableName = "SampleDispatch"
            If Not objSave.SaveInDb("Insert_SampleDispatch", Tbl_SampleDispatch, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of Sample Dispatch In Database"
                Exit Function
            End If

            Save_SampleDispatch = True

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Sample Dispatch Details"
            Save_SampleDispatch = False
        End Try
    End Function
#End Region '== For LIMS

#Region "Save_BoneParameterDtl"

    Public Function Save_BoneParameterDtl(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_BoneMarrowParam As DataSet, _
                                 ByVal objDtLogic As ClsDataLogic_New, _
                                 ByVal UserCode_1 As String, _
                                 ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing
        Dim objSave As SaveDataInDbObj = Nothing
        Dim Sql_DtSet As Data.DataSet = Nothing

        Dim Instr_nSampleID As String = ""
        Dim Instr_nBoneMarrowParamNo As String = ""
        Dim Instr_nBoneMarrowDiffcountNo As String = ""

        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime
        Dim Tbl_BoneMarrowParameterDtl As Data.DataTable = Nothing
        Dim Tbl_BoneMarrowDiffCountDtl As Data.DataTable = Nothing
        Dim PkColArr(1) As String
        Dim PkColArr_1(1) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_BoneMarrowParam Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_BoneMarrowParam.Tables("BoneMarrowparameterDtl").Rows

                    Instr_nSampleID += IIf(Instr_nSampleID = "", "'", ",'").ToString + _
                                    tr("nSampleId").ToString + "'"

                    Instr_nBoneMarrowParamNo += IIf(Instr_nBoneMarrowParamNo = "", "'", ",'").ToString + _
                                    tr("nBoneMarrowParamNo").ToString + "'"

                Next tr

                For Each tr As Data.DataRow In Ds_BoneMarrowParam.Tables("BONEMARROWDIFFCOUNTDTL").Rows

                    Instr_nBoneMarrowDiffcountNo += IIf(Instr_nBoneMarrowDiffcountNo = "", "'", ",'").ToString + _
                                    tr("nDiffCountParamNo").ToString + "'"

                Next tr

            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of SampleCollecterMaster
            If Not objHelpDbTbl.GetBoneMarrowParameter("nSampleId in (" + Instr_nSampleID + ") And " + _
                                                           "nBoneMarrowParamNo in (" + Instr_nBoneMarrowParamNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_BoneMarrowParameterDtl, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving BoneMarrowParameterDtl"
                Exit Function
            End If

            If Not objHelpDbTbl.GetBoneMarrowDiffCountDtl("nSampleId in (" + Instr_nSampleID + ") And " + _
                                               "nDiffCountParamNo in (" + Instr_nBoneMarrowDiffcountNo + ")", dataRet_1, _
                                objDtLogic, Tbl_BoneMarrowDiffCountDtl, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving BoneMarrowDiffCountDtl"
                Exit Function
            End If

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving  Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nSampleId"
            PkColArr(1) = "nBoneMarrowParamNo"

            If Not objSave.AssignValues(Tbl_BoneMarrowParameterDtl.TableName, PkColArr, Choice, _
                                        Ds_BoneMarrowParam.Tables(Tbl_BoneMarrowParameterDtl.TableName), _
                                        Tbl_BoneMarrowParameterDtl, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in SampleCollecterMaster
            If Not objSave.SaveInDb("Insert_BoneMarrowParameterDtl", Tbl_BoneMarrowParameterDtl, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of SampleCollecterMaster"
                Exit Function
            End If


            PkColArr_1(0) = "nSampleId"
            PkColArr_1(1) = "nDiffCountParamNo"

            If Not objSave.AssignValues(Tbl_BoneMarrowDiffCountDtl.TableName, PkColArr_1, Choice, _
                                        Ds_BoneMarrowParam.Tables(Tbl_BoneMarrowDiffCountDtl.TableName), _
                                        Tbl_BoneMarrowDiffCountDtl, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in SampleCollecterMaster
            If Not objSave.SaveInDb("Insert_BoneMarrowDiffCountDtl", Tbl_BoneMarrowDiffCountDtl, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of SampleCollecterMaster"
                Exit Function
            End If


            Save_BoneParameterDtl = True

            If Save_BoneParameterDtl Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Insert_BoneMarrowParameterDtl"
            Save_BoneParameterDtl = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region '== For LIMS

#Region "Save_SMSDetails"

    Public Function Save_EmailAlert(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_EmailAlert As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean
        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim Dt_View As Data.DataView = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_EmailAlert As Data.DataTable = Nothing

        Dim Instr_nEmailID As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_EmailAlert Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            Ds_EmailAlert.Tables(0).TableName = "EmailAlertmst"
            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_EmailAlert.Tables("EmailAlertmst").Rows

                    Instr_nEmailID += IIf(Instr_nEmailID = "", "'", ",'").ToString + _
                                    tr("nEmailAlertId").ToString + "'"

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of Discount MedExTemplate Matrix
            If Not objHelpDbTbl.GetEmailAlertMst("nEmailAlertId in (" + Instr_nEmailID + ")", dataRet_1, _
                                            objDtLogic, Tbl_EmailAlert, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving EmailAlertmst"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            Tbl_EmailAlert.TableName = "EmailAlertmst"

            'Assignment of Values

            PkColArr(0) = "nEmailAlertId"

            If Not objSave.AssignValues(Tbl_EmailAlert.TableName, PkColArr, Choice, _
                                        Ds_EmailAlert.Tables(Tbl_EmailAlert.TableName), _
                                        Tbl_EmailAlert, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "error occured while assigning values"
                Exit Function
            End If

            ' Save in DiscountMedExTemplateMatrix
            Tbl_EmailAlert.TableName = "EmailAlertmst"
            If Not objSave.SaveInDb("Insert_EmailAlertmst", Tbl_EmailAlert, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of Email Alert In Database"
                Exit Function
            End If

            Save_EmailAlert = True

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving SMS Details"
            Save_EmailAlert = False
        End Try
    End Function

#End Region '== For LIMS

#Region "Delete Collection"

    Public Function Delete_Collection(ByVal Choice As DataObjOpenSaveModeEnum, _
                                     ByVal Ds_CollDelete As Data.DataSet, _
                                     ByVal objDtLogic As ClsDataLogic_New, _
                                     ByVal UserCode_1 As String, _
                                     ByRef eStr_Retu As String) As Boolean
        Try

            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            Dim objSave As SaveDataInDbObj = Nothing
            objSave = New SaveDataInDbObj(objDtLogic)

            If Not objSave.SaveInDb("Proc_Delete_CollectionDetail", Ds_CollDelete.Tables(0), Choice, Nothing, eStr_Retu) Then
                eStr_Retu += " " + "Error occured while saving MTP In Database"
                Exit Function
            End If

            Delete_Collection = True

            If Delete_Collection Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while Saving MTP"
            Delete_Collection = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "Save_MedexResultCriticalRemarks"
    Public Function Save_MedexResultCriticalRemarks(ByVal Choice As DataObjOpenSaveModeEnum, _
                                              ByVal Ds_MedexResultCriticalRemarks As Data.DataSet, _
                                              ByVal objHdrogic As ClsDataLogic_New, _
                                              ByVal UserCode_1 As String, _
                                              ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing
        Dim objDtLogic As New ClsDataLogic_New
        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim Instr_MedexResultCriticalRemarks As String = ""

        Dim ObjHelpDbTable As New clsHelpDbTable

        Dim Tbl_Workspacenodedetail As New Data.DataTable
        Dim Tbl_MedexResultCriticalRemarks As New Data.DataTable
        Dim objCommon As New clsCommon

        Try


            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()


            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_MedexResultCriticalRemarks Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_MedexResultCriticalRemarks.Tables("MedexResultCriticalRemarks").Rows

                    Instr_MedexResultCriticalRemarks += IIf(Instr_MedexResultCriticalRemarks = "", "", ",").ToString + _
                                      tr("nMedexResultCriticalRemarksNo").ToString.Trim()

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of SampleTypeDetail
            If Not objHelpDbTbl.GetMedexResultCriticalRemarks("nMedexResultCriticalRemarksNo In (" + Instr_MedexResultCriticalRemarks + ")", dataRet_1, _
                                            objHdrogic, Tbl_MedexResultCriticalRemarks, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving SampleTypeDetail"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objHdrogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nMedexResultCriticalRemarksNo"

            If Not objSave.AssignValues(Tbl_MedexResultCriticalRemarks.TableName, PkColArr, Choice, _
                                        Ds_MedexResultCriticalRemarks.Tables(Tbl_MedexResultCriticalRemarks.TableName), _
                                        Tbl_MedexResultCriticalRemarks, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If



            If Not objSave.SaveInDb("Insert_MedexResultCriticalRemarks", Tbl_MedexResultCriticalRemarks, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of SampleTypeDetail In Database"
                Exit Function
            End If


            Save_MedexResultCriticalRemarks = True

            If Save_MedexResultCriticalRemarks Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            objDtLogic.RollBack_Transaction()
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Save_MedexResultCriticalRemarks!"
            Save_MedexResultCriticalRemarks = False
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region ' == For LIMS 01 March 2012

#Region "Save_SampleUnlockDtl"

    Public Function Save_SampleUnlockDtl(ByVal Choice As DataObjOpenSaveModeEnum, _
                                    ByVal Ds_SampleUnlockDtl As DataSet, _
                                    ByVal objDtLogic As ClsDataLogic_New, _
                                    ByVal UserCode_1 As String, _
                                    ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime
        Dim DataReturnList As New ArrayList
        Dim Tbl_SampleUnlockDtl As Data.DataTable = Nothing

        Dim Instr_SampleUnlockDtlNo As String = ""

        Dim PkColArr(0) As String

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            'Logic Of save Start
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_SampleUnlockDtl Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_SampleUnlockDtl.Tables("SampleUnlockDtl").Rows

                    Instr_SampleUnlockDtlNo += IIf(Instr_SampleUnlockDtlNo = "", "", ",").ToString + _
                                    tr("nSampleUnlockDtlNo").ToString
                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of SampleUnlockDtl
            If Not objHelpDbTbl.GetSampleUnlockDtl("nSampleUnlockDtlNo In (" + Instr_SampleUnlockDtlNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_SampleUnlockDtl, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving SampleDetail"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nSampleUnlockDtlNo"
            If Not objSave.AssignValues(Tbl_SampleUnlockDtl.TableName, PkColArr, Choice, _
                                        Ds_SampleUnlockDtl.Tables(Tbl_SampleUnlockDtl.TableName), _
                                        Tbl_SampleUnlockDtl, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in SampleUnlockDtl
            If Not objSave.SaveInDb("Insert_SampleUnlockDtl", Tbl_SampleUnlockDtl, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of Sample Unlocking In Database"
                Exit Function
            End If

            Save_SampleUnlockDtl = True

            'Logic of Save End

            If Save_SampleUnlockDtl Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Sample Unlocking  Detail"
            Save_SampleUnlockDtl = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function

#End Region ' == For LIMS 01 March 2012

#Region "Save_LabKitSendReceiveDtl"
    Public Function Save_LabKitSendReceiveDtl(ByVal Choice As DataObjOpenSaveModeEnum, _
                                              ByVal Ds_LabKitSendReceiveDetail As Data.DataSet, _
                                              ByVal objHdrogic As ClsDataLogic_New, _
                                              ByVal UserCode_1 As String, _
                                              ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing
        Dim objDtLogic As New ClsDataLogic_New
        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim Instr_LabKitSendReceiveDtlNo As String = ""

        Dim ObjHelpDbTable As New clsHelpDbTable

        Dim Tbl_Workspacenodedetail As New Data.DataTable
        Dim Tbl_LabKitSampleSendReciveDtl As New Data.DataTable
        Dim objCommon As New clsCommon

        Try


            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()


            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_LabKitSendReceiveDetail Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_LabKitSendReceiveDetail.Tables("LabKitSendReceiveDtl").Rows

                    Instr_LabKitSendReceiveDtlNo += IIf(Instr_LabKitSendReceiveDtlNo = "", "", ",").ToString + _
                                      tr("nLabKitSendReceiveDtlNo").ToString.Trim()

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of SampleTypeDetail
            If Not objHelpDbTbl.Get_LabKitSendReceiveDtl("nLabKitSendReceiveDtlNo In (" + Instr_LabKitSendReceiveDtlNo + ")", dataRet_1, _
                                            objHdrogic, Tbl_LabKitSampleSendReciveDtl, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving SampleTypeDetail"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objHdrogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nLabKitSendReceiveDtlNo"

            If Not objSave.AssignValues(Tbl_LabKitSampleSendReciveDtl.TableName, PkColArr, Choice, _
                                        Ds_LabKitSendReceiveDetail.Tables(Tbl_LabKitSampleSendReciveDtl.TableName), _
                                        Tbl_LabKitSampleSendReciveDtl, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If



            If Not objSave.SaveInDb("Insert_LabKitSendReceiveDtl", Tbl_LabKitSampleSendReciveDtl, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of SampleTypeDetail In Database"
                Exit Function
            End If


            Save_LabKitSendReceiveDtl = True

            If Save_LabKitSendReceiveDtl Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            objDtLogic.RollBack_Transaction()
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving LabKitSampleSendReceiveDetail"
            Save_LabKitSendReceiveDtl = False
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "Edit_SampleDetail"
    Public Function Edit_SampleDetail(ByVal Choice As DataObjOpenSaveModeEnum, _
                                              ByVal Ds_SampleDetail As Data.DataSet, _
                                              ByVal objHdrogic As ClsDataLogic_New, _
                                              ByVal UserCode_1 As String, _
                                              ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing
        Dim objDtLogic As New ClsDataLogic_New
        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim Instr_SampleDetailNo As String = ""

        Dim ObjHelpDbTable As New clsHelpDbTable

        Dim Tbl_Workspacenodedetail As New Data.DataTable
        Dim Tbl_SampleDetail As New Data.DataTable
        Dim Tbl_SampleDetailHistory As New DataTable
        Dim objCommon As New clsCommon

        Try


            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()


            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_SampleDetail Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_SampleDetail.Tables("SampleDetail").Rows
                    Instr_SampleDetailNo += IIf(Instr_SampleDetailNo = "", "", ",").ToString + _
                                      tr("nSampleId").ToString.Trim()
                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of SampleTypeDetail
            If Not objHelpDbTbl.GetSampleDetail("nSampleId In (" + Instr_SampleDetailNo + ")", dataRet_1, _
                                            objHdrogic, Tbl_SampleDetail, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving SampleTypeDetail"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objHdrogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nSampleId"
            If Not objSave.AssignValues(Tbl_SampleDetail.TableName, PkColArr, Choice, _
                                        Ds_SampleDetail.Tables(Tbl_SampleDetail.TableName), _
                                        Tbl_SampleDetail, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            If Not objSave.SaveInDb("Insert_SampleDetail", Tbl_SampleDetail, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of SampleTypeDetail In Database"
                Exit Function
            End If

            If Not (Ds_SampleDetail.Tables("SampleDetailHistory")) Is Nothing Then
                Tbl_SampleDetailHistory = Ds_SampleDetail.Tables("SampleDetailHistory")
                If Not objSave.SaveInDb("insert_SampledetailHistory", Tbl_SampleDetailHistory, DataObjOpenSaveModeEnum.DataObjOpenMode_Add, DataReturnList, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of SampleTemplateDetail In Database"
                    Exit Function
                End If
            End If

            Edit_SampleDetail = True

            If Edit_SampleDetail Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            objDtLogic.RollBack_Transaction()
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Edit_SampleDetail"
            Edit_SampleDetail = False
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "Receive_SampleDetail"
    Public Function Receive_SampleDetail(ByVal Choice As DataObjOpenSaveModeEnum, _
                                              ByVal Ds_SampleDetail As Data.DataSet, _
                                              ByVal objHdrogic As ClsDataLogic_New, _
                                              ByVal UserCode_1 As String, _
                                              ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing
        Dim objDtLogic As New ClsDataLogic_New
        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim Instr_SampleDetailNo As String = ""

        Dim ObjHelpDbTable As New clsHelpDbTable

        Dim Tbl_Workspacenodedetail As New Data.DataTable
        Dim Tbl_SampleDetail As New Data.DataTable
        Dim Tbl_SampleTypeDetail As New DataTable
        Dim Tbl_SampleTypeSendReceiveDetail As New DataTable
        Dim objCommon As New clsCommon

        Try


            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()


            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_SampleDetail Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_SampleDetail.Tables("SampleDetail").Rows
                    Instr_SampleDetailNo += IIf(Instr_SampleDetailNo = "", "", ",").ToString + _
                                      tr("nSampleId").ToString.Trim()
                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of SampleTypeDetail
            If Not objHelpDbTbl.GetSampleDetail("nSampleId In (" + Instr_SampleDetailNo + ")", dataRet_1, _
                                            objHdrogic, Tbl_SampleDetail, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving SampleTypeDetail"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objHdrogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nSampleId"
            If Not objSave.AssignValues(Tbl_SampleDetail.TableName, PkColArr, Choice, _
                                        Ds_SampleDetail.Tables(Tbl_SampleDetail.TableName), _
                                        Tbl_SampleDetail, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            If Not objSave.SaveInDb("Insert_SampleDetail", Tbl_SampleDetail, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of SampleTypeDetail In Database"
                Exit Function
            End If

            If Not (Ds_SampleDetail.Tables("SampleTypeDetail")) Is Nothing Then
                Tbl_SampleTypeDetail = Ds_SampleDetail.Tables("SampleTypeDetail")
                If Not objSave.SaveInDb("Insert_SampleTypeDetail", Tbl_SampleTypeDetail, DataObjOpenSaveModeEnum.DataObjOpenMode_Edit, DataReturnList, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of SampleTypeDetail In Database"
                    Exit Function
                End If
            End If


            If Not (Ds_SampleDetail.Tables("SampleTypeSendReceiveDetail")) Is Nothing Then
                Tbl_SampleTypeSendReceiveDetail = Ds_SampleDetail.Tables("SampleTypeSendReceiveDetail")
                If Not objSave.SaveInDb("insert_SampleTypeSendReceiveDetail", Tbl_SampleTypeSendReceiveDetail, DataObjOpenSaveModeEnum.DataObjOpenMode_Edit, DataReturnList, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of SampleTypeSendReceive In Database"
                    Exit Function
                End If
            End If


            Receive_SampleDetail = True

            If Receive_SampleDetail Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            objDtLogic.RollBack_Transaction()
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Receive_SampleDetail"
            Receive_SampleDetail = False
        Finally
            objDtLogic.Close_Connection()
        End Try
    End Function

#End Region

#Region "Save_LabKitDispatchmst"
    Public Function Save_LabKitDispatchmst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                          ByVal Ds_LabKitDispatchMst As Data.DataSet, _
                                          ByVal objHdrogic As ClsDataLogic_New, _
                                          ByVal UserCode_1 As String, _
                                          ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing
        Dim objDtLogic As New ClsDataLogic_New
        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim Instr_LabKitSendReceiveDtlNo As String = ""

        Dim ObjHelpDbTable As New clsHelpDbTable

        Dim Tbl_Workspacenodedetail As New Data.DataTable
        Dim Tbl_LabKitSampleSendReciveDtl As New Data.DataTable
        Dim objCommon As New clsCommon

        Try


            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()


            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_LabKitDispatchMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_LabKitDispatchMst.Tables("LabKitDispatchmst").Rows

                    Instr_LabKitSendReceiveDtlNo += IIf(Instr_LabKitSendReceiveDtlNo = "", "", ",").ToString + _
                                      tr("nLabKitDispatchNo").ToString.Trim()

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of SampleTypeDetail
            If Not objHelpDbTbl.get_LabKitDispatchmst("nLabKitDispatchNo In (" + Instr_LabKitSendReceiveDtlNo + ")", dataRet_1, _
                                            objHdrogic, Tbl_LabKitSampleSendReciveDtl, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving Lab Kit Dispatch Mst"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objHdrogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nLabKitDispatchNo"

            If Not objSave.AssignValues(Tbl_LabKitSampleSendReciveDtl.TableName, PkColArr, Choice, _
                                        Ds_LabKitDispatchMst.Tables(Tbl_LabKitSampleSendReciveDtl.TableName), _
                                        Tbl_LabKitSampleSendReciveDtl, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If



            If Not objSave.SaveInDb("Insert_labKitDispatchmst", Tbl_LabKitSampleSendReciveDtl, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of SampleTypeDetail In Database"
                Exit Function
            End If


            Save_LabKitDispatchmst = True

            If Save_LabKitDispatchmst Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            objDtLogic.RollBack_Transaction()
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving LabKitDispatchmst"
            Save_LabKitDispatchmst = False
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function


#End Region

#Region "Save_ScreenigTmpTable"
    Public Function Save_ScreenigTmpTable(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_ScreenigTmpTable As Data.DataSet, _
                                        ByVal objHdrogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime
        Dim Tbl_ScreenigTmpTable As Data.DataTable = Nothing

        Dim Instr_ScreenigTmpTable As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Dim DataReturnList_Mst As New ArrayList
        Dim RetuVal_Mst As ParameterReturnValue = Nothing

        Try
            eStr_Retu = ""
            objHdrogic.Open_Connection()
            objHdrogic.Begin_Transaction()

            If objHdrogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objHdrogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_ScreenigTmpTable Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If
            Tbl_ScreenigTmpTable = Ds_ScreenigTmpTable.Tables(0)

            'Tbl_ScreenigTmpTable.Rows.Clear()


            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objHdrogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objHdrogic)



            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getScreenigTmpTable("", DataRetrievalModeEnum.DataTable_Empty, objHdrogic, _
                                              Tbl_ScreenigTmpTable, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nMedExScreenNo"
            Tbl_ScreenigTmpTable.TableName = "ScreenigTmpTable"

            If Not objSave.AssignValues(Tbl_ScreenigTmpTable.TableName, PkColArr, Choice, _
                                        Ds_ScreenigTmpTable.Tables(Tbl_ScreenigTmpTable.TableName), _
                                        Tbl_ScreenigTmpTable, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in MedexScreeningHdrQC

            If Not objSave.SaveInDb("Insert_ScreenigTmpTable", Tbl_ScreenigTmpTable, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of MedexScreeningHdrQC In Database"
                Exit Function
            End If

            Save_ScreenigTmpTable = True

            If Save_ScreenigTmpTable Then
                objHdrogic.Commit_Transaction()
            Else
                objHdrogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving ScreenigTmpTable"
            Save_ScreenigTmpTable = False
            objHdrogic.RollBack_Transaction()
        Finally
            objHdrogic.Close_Connection()
        End Try

    End Function
#End Region

    '============================================================================================
    'Web Methods For BA Module
    '============================================================================================

#Region "Save_FreezerMst"
    Public Function Save_FreezerMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_FreezerMst As DataSet, _
                                 ByVal objDtLogic As ClsDataLogic_New, _
                                 ByVal UserCode_1 As String, _
                                 ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_FreezerMst As Data.DataTable = Nothing

        Dim Instr_FreezerNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_FreezerMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                For Each tr As Data.DataRow In Ds_FreezerMst.Tables("FreezerMst").Rows

                    Instr_FreezerNo += IIf(Instr_FreezerNo = "", "", ",").ToString + _
                                    tr("iFreezerNo").ToString

                Next tr
            End If

            dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of FreezerMst
            If Not objHelpDbTbl.GetFreezerMst("iFreezerNo In (" + Instr_FreezerNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_FreezerMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving FreezerMst"
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "iFreezerNo"
            If Not objSave.AssignValues(Tbl_FreezerMst.TableName, PkColArr, Choice, _
                                        Ds_FreezerMst.Tables(Tbl_FreezerMst.TableName), _
                                        Tbl_FreezerMst, Nothing, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in ScopeMst
            If Not objSave.SaveInDb("Insert_FreezerMst", Tbl_FreezerMst, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of FreezerMst In Database"
                Exit Function
            End If

            Save_FreezerMst = True

            If Save_FreezerMst Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving FreezerMst"
            Save_FreezerMst = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region '========================Added on 17-Jan-2012

#Region "Save_CentrifugationMachineMst"
    Public Function Save_CentrifugationMachineMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_CentrifugationMachineMst As DataSet, _
                                 ByVal objDtLogic As ClsDataLogic_New, _
                                 ByVal UserCode_1 As String, _
                                 ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_CentrifugationMachineMst As Data.DataTable = Nothing

        Dim Instr_iCentrifugationMachineNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_CentrifugationMachineMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                For Each tr As Data.DataRow In Ds_CentrifugationMachineMst.Tables("CentrifugationMachineMst").Rows

                    Instr_iCentrifugationMachineNo += IIf(Instr_iCentrifugationMachineNo = "", "", ",").ToString + _
                                    tr("iCentrifugationMachineNo").ToString

                Next tr
            End If

            dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of CentrifugationMachineMst
            If Not objHelpDbTbl.GetCentrifugationMachineMst("iCentrifugationMachineNo In (" + Instr_iCentrifugationMachineNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_CentrifugationMachineMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving CentrifugationMachineMst"
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "iCentrifugationMachineNo"
            If Not objSave.AssignValues(Tbl_CentrifugationMachineMst.TableName, PkColArr, Choice, _
                                        Ds_CentrifugationMachineMst.Tables(Tbl_CentrifugationMachineMst.TableName), _
                                        Tbl_CentrifugationMachineMst, Nothing, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in ScopeMst
            If Not objSave.SaveInDb("Insert_CentrifugationMachineMst", Tbl_CentrifugationMachineMst, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of CentrifugationMachineMst In Database"
                Exit Function
            End If

            Save_CentrifugationMachineMst = True

            If Save_CentrifugationMachineMst Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving CentrifugationMachineMst"
            Save_CentrifugationMachineMst = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region '========================Added on 17-Jan-2012

#Region "Save_SampleGroupMst"
    Public Function Save_SampleGroupMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_SampleGroupMst As DataSet, _
                                 ByVal objDtLogic As ClsDataLogic_New, _
                                 ByVal UserCode_1 As String, _
                                 ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_SampleGroupMst As Data.DataTable = Nothing

        Dim Instr_SampleGroupNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_SampleGroupMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                For Each tr As Data.DataRow In Ds_SampleGroupMst.Tables("SampleGroupMst").Rows

                    Instr_SampleGroupNo += IIf(Instr_SampleGroupNo = "", "", ",").ToString + _
                                    tr("iSampleGroupNo").ToString

                Next tr
            End If

            dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of SampleGroupMst
            If Not objHelpDbTbl.GetSampleGroupMst("iSampleGroupNo In (" + Instr_SampleGroupNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_SampleGroupMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving SampleGroupMst"
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "iSampleGroupNo"
            If Not objSave.AssignValues(Tbl_SampleGroupMst.TableName, PkColArr, Choice, _
                                        Ds_SampleGroupMst.Tables(Tbl_SampleGroupMst.TableName), _
                                        Tbl_SampleGroupMst, Nothing, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in SampleGroupMst
            If Not objSave.SaveInDb("Insert_SampleGroupMst", Tbl_SampleGroupMst, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of SampleGroupMst In Database"
                Exit Function
            End If

            Save_SampleGroupMst = True

            If Save_SampleGroupMst Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving SampleGroupMst"
            Save_SampleGroupMst = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region '========================Added on 17-Jan-2012

#Region "Save_SampleStandardMst"
    Public Function Save_SampleStandardMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_SampleStandardMst As DataSet, _
                                 ByVal objDtLogic As ClsDataLogic_New, _
                                 ByVal UserCode_1 As String, _
                                 ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_SampleStandardMst As Data.DataTable = Nothing

        Dim Instr_SampleStandardNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_SampleStandardMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                For Each tr As Data.DataRow In Ds_SampleStandardMst.Tables("SampleStandardMst").Rows

                    Instr_SampleStandardNo += IIf(Instr_SampleStandardNo = "", "", ",").ToString + _
                                    tr("iSampleStandardNo").ToString

                Next tr
            End If

            dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of SampleStandardMst
            If Not objHelpDbTbl.GetSampleStandardMst("iSampleStandardNo In (" + Instr_SampleStandardNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_SampleStandardMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving SampleStandardMst"
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "iSampleStandardNo"
            If Not objSave.AssignValues(Tbl_SampleStandardMst.TableName, PkColArr, Choice, _
                                        Ds_SampleStandardMst.Tables(Tbl_SampleStandardMst.TableName), _
                                        Tbl_SampleStandardMst, Nothing, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            If Not objSave.SaveInDb("Insert_SampleStandardMst", Tbl_SampleStandardMst, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of SampleStandardMst In Database"
                Exit Function
            End If

            Save_SampleStandardMst = True

            If Save_SampleStandardMst Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving SampleStandardMst"
            Save_SampleStandardMst = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region '========================Added on 17-Jan-2012

#Region "Save_BagBatchMst"
    Public Function Save_BagBatchMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_BagBatchMst As DataSet, _
                                 ByVal objDtLogic As ClsDataLogic_New, _
                                 ByVal UserCode_1 As String, _
                                 ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_BagBatchMst As Data.DataTable = Nothing

        Dim Instr_BagBatchNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim DataReturnList1 As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_BagBatchMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                For Each tr As Data.DataRow In Ds_BagBatchMst.Tables("BagBatchMst").Rows

                    Instr_BagBatchNo += IIf(Instr_BagBatchNo = "", "", ",").ToString + _
                                    tr("nBagBatchNo").ToString

                Next tr
            End If

            dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of FreezerMst
            If Not objHelpDbTbl.GetBagBatchMst("nBagBatchNo In (" + Instr_BagBatchNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_BagBatchMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving BagBatchMst"
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nBagBatchNo"
            If Not objSave.AssignValues(Tbl_BagBatchMst.TableName, PkColArr, Choice, _
                                        Ds_BagBatchMst.Tables(Tbl_BagBatchMst.TableName), _
                                        Tbl_BagBatchMst, Nothing, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            If Not objSave.SaveInDb("Insert_BagBatchMst", Tbl_BagBatchMst, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of BagBatchMst In Database"
                Exit Function
            End If

            ' added by prayag for dublicate barcode

            For itm As Integer = 0 To DataReturnList.Count - 1

                DataReturnList1 = DataReturnList.Item(itm)
                RetuVal = DataReturnList1.Item(0)

                If RetuVal.ParameterValue = "Regenarate" Then
                    eStr_Retu = "Please Regenerate Bag/Stand!"
                    Save_BagBatchMst = False
                    objDtLogic.RollBack_Transaction()
                    Exit Function
                End If

            Next
            Save_BagBatchMst = True

            If Save_BagBatchMst Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving BagBatchMst"
            Save_BagBatchMst = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region '========================Added on 17-Jan-2012

#Region "Save_SampleOperationMst"
    Public Function Save_SampleOperationMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_SampleOperationMst As DataSet, _
                                 ByVal objDtLogic As ClsDataLogic_New, _
                                 ByVal UserCode_1 As String, _
                                 ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_SampleOperationMst As Data.DataTable = Nothing

        Dim Instr_SampleOperationNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_SampleOperationMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                For Each tr As Data.DataRow In Ds_SampleOperationMst.Tables("SampleOperationMst").Rows

                    Instr_SampleOperationNo += IIf(Instr_SampleOperationNo = "", "", ",").ToString + _
                                    tr("iSampleOperationNo").ToString

                Next tr
            End If

            dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of SampleOperationMst
            If Not objHelpDbTbl.GetSampleOperationMst("iSampleOperationNo In (" + Instr_SampleOperationNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_SampleOperationMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving SampleOperationMst"
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "iSampleOperationNo"
            If Not objSave.AssignValues(Tbl_SampleOperationMst.TableName, PkColArr, Choice, _
                                        Ds_SampleOperationMst.Tables(Tbl_SampleOperationMst.TableName), _
                                        Tbl_SampleOperationMst, Nothing, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            If Not objSave.SaveInDb("Insert_SampleOperationMst", Tbl_SampleOperationMst, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of SampleOperationMst In Database"
                Exit Function
            End If

            Save_SampleOperationMst = True

            If Save_SampleOperationMst Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving SampleOperationMst"
            Save_SampleOperationMst = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region '========================Added on 17-Jan-2012

#Region "Save_SampleOperationReasonMst"
    Public Function Save_SampleOperationReasonMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_SampleOperationReasonMst As DataSet, _
                                 ByVal objDtLogic As ClsDataLogic_New, _
                                 ByVal UserCode_1 As String, _
                                 ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_SampleOperationReasonMst As Data.DataTable = Nothing

        Dim Instr_SampleOperationReasonNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_SampleOperationReasonMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                For Each tr As Data.DataRow In Ds_SampleOperationReasonMst.Tables("SampleOperationReasonMst").Rows

                    Instr_SampleOperationReasonNo += IIf(Instr_SampleOperationReasonNo = "", "", ",").ToString + _
                                    tr("iSampleOperationReasonNo").ToString

                Next tr
            End If

            dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of SampleOperationReasonMst
            If Not objHelpDbTbl.GetSampleOperationReasonMst("iSampleOperationReasonNo In (" + Instr_SampleOperationReasonNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_SampleOperationReasonMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving SampleOperationReasonMst"
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "iSampleOperationReasonNo"
            If Not objSave.AssignValues(Tbl_SampleOperationReasonMst.TableName, PkColArr, Choice, _
                                        Ds_SampleOperationReasonMst.Tables(Tbl_SampleOperationReasonMst.TableName), _
                                        Tbl_SampleOperationReasonMst, Nothing, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            If Not objSave.SaveInDb("Insert_SampleOperationReasonMst", Tbl_SampleOperationReasonMst, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of SampleOperationReasonMst In Database"
                Exit Function
            End If

            Save_SampleOperationReasonMst = True

            If Save_SampleOperationReasonMst Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving SampleOperationReasonMst"
            Save_SampleOperationReasonMst = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region '========================Added on 17-Jan-2012

#Region "Save_CalibrationMst"
    Public Function Save_CalibrationMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_CalibrationMst As DataSet, _
                                 ByVal objDtLogic As ClsDataLogic_New, _
                                 ByVal UserCode_1 As String, _
                                 ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_CalibrationMst As Data.DataTable = Nothing

        Dim Instr_CalibrationNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_CalibrationMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                For Each tr As Data.DataRow In Ds_CalibrationMst.Tables("CalibrationMst").Rows

                    Instr_CalibrationNo += IIf(Instr_CalibrationNo = "", "", ",").ToString + _
                                    tr("iCalibrationNo").ToString

                Next tr
            End If

            dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of CalibrationMst
            If Not objHelpDbTbl.GetCalibrationMst("iCalibrationNo In (" + Instr_CalibrationNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_CalibrationMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving CalibrationMst"
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "iCalibrationNo"
            If Not objSave.AssignValues(Tbl_CalibrationMst.TableName, PkColArr, Choice, _
                                        Ds_CalibrationMst.Tables(Tbl_CalibrationMst.TableName), _
                                        Tbl_CalibrationMst, Nothing, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            If Not objSave.SaveInDb("Insert_CalibrationMst", Tbl_CalibrationMst, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of CalibrationMst In Database"
                Exit Function
            End If

            Save_CalibrationMst = True

            If Save_CalibrationMst Then
                objDtLogic.Commit_Transaction()
            End If
            objDtLogic.RollBack_Transaction()

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving CalibrationMst"
            Save_CalibrationMst = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region '========================Added on 17-Jan-2012

#Region "Save_SampleCentrifugationDtl"
    Public Function Save_SampleCentrifugationDtl(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_SampleCentrifugationDtl As DataSet, _
                                 ByVal objDtLogic As ClsDataLogic_New, _
                                 ByVal UserCode_1 As String, _
                                 ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_SampleCentrifugationDtl As Data.DataTable = Nothing

        Dim Instr_SampleCentrifugationDtl As String = ""

        Dim PkColArr(1) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_SampleCentrifugationDtl Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                For Each tr As Data.DataRow In Ds_SampleCentrifugationDtl.Tables("SampleCentrifugationDtl").Rows

                    Instr_SampleCentrifugationDtl += IIf(Instr_SampleCentrifugationDtl = "", "", ",").ToString + _
                                    tr("nPKSampleId").ToString + tr("iTranNo").ToString()
                Next tr
            End If

            dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of SampleCentrifugationDtl
            If Not objHelpDbTbl.GetSampleCentrifugationDtl("Cast(nPKSampleId As Varchar(20)) + Cast(iTranNo As Varchar(20))  In (" + Instr_SampleCentrifugationDtl + ")", dataRet_1, _
                                            objDtLogic, Tbl_SampleCentrifugationDtl, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving SampleCentrifugationDtl"
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nPKSampleId"
            PkColArr(1) = "iTranNo"
            If Not objSave.AssignValues(Tbl_SampleCentrifugationDtl.TableName, PkColArr, Choice, _
                                        Ds_SampleCentrifugationDtl.Tables(Tbl_SampleCentrifugationDtl.TableName), _
                                        Tbl_SampleCentrifugationDtl, Nothing, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            If Not objSave.SaveInDb("Insert_SampleCentrifugationDtl", Tbl_SampleCentrifugationDtl, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of SampleCentrifugationDtl In Database"
                Exit Function
            End If

            Save_SampleCentrifugationDtl = True

            If Save_SampleCentrifugationDtl Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving SampleCentrifugationDtl"
            Save_SampleCentrifugationDtl = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region '========================Added on 17-Jan-2012

#Region "Save_SamplePickUpDetail"

    Public Function Save_SamplePickUpDetail(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_PKSampleDetail As DataSet, _
                                 ByVal objDtLogic As ClsDataLogic_New, _
                                 ByVal UserCode_1 As String, _
                                 ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_PKSampleDetail As Data.DataTable = Nothing
        Dim Instr_SampleId As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            'Logic Of save Start
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_PKSampleDetail Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit/delete is called
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                For Each tr As Data.DataRow In Ds_PKSampleDetail.Tables("PKSampleDetail").Rows
                    Instr_SampleId += IIf(Instr_SampleId = "", "", ",").ToString + _
                                    tr("nPKSampleId").ToString
                Next tr
            End If

            dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of PKSampleDetail
            If Not objHelpDbTbl.PKSampleDetail("nPKSampleId In (" + Instr_SampleId + ")", dataRet_1, _
                                            objDtLogic, Tbl_PKSampleDetail, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving PKSampleDetail"
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nPKSampleId"
            If Not objSave.AssignValues(Tbl_PKSampleDetail.TableName, PkColArr, Choice, _
                                        Ds_PKSampleDetail.Tables(Tbl_PKSampleDetail.TableName), _
                                        Tbl_PKSampleDetail, Nothing, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in SampleDetail
            If Not objSave.SaveInDb("Insert_PickUpSampleDetail", Tbl_PKSampleDetail, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of PKSampleDetail In Database"
                Exit Function
            End If

            Save_SamplePickUpDetail = True

            'Logic of Save End

            If Save_SamplePickUpDetail Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving SamplePickUpDetail"
            Save_SamplePickUpDetail = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function

#End Region '========================Added on 18-Jan-2012

#Region "Save_SampleSeparationDtl"

    Public Function Save_SampleSeparationDtl(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_SampleSeparationDtl As DataSet, _
                                 ByVal objDtLogic As ClsDataLogic_New, _
                                 ByVal UserCode_1 As String, _
                                 ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_SampleSeparationDtl As Data.DataTable = Nothing
        Dim Instr_SampleId As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            'Logic Of save Start
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_SampleSeparationDtl Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit/delete is called
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                For Each tr As Data.DataRow In Ds_SampleSeparationDtl.Tables("SampleSeparationDtl").Rows
                    Instr_SampleId += IIf(Instr_SampleId = "", "", ",").ToString + _
                                    tr("nSampleSeparationDtlNo").ToString
                Next tr
            End If

            dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of SampleSeparationDtl
            If Not objHelpDbTbl.GetSampleSeparationDtl("nSampleSeparationDtlNo In (" + Instr_SampleId + ")", dataRet_1, _
                                            objDtLogic, Tbl_SampleSeparationDtl, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving PKSampleDetail"
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nSampleSeparationDtlNo"
            If Not objSave.AssignValues(Tbl_SampleSeparationDtl.TableName, PkColArr, Choice, _
                                        Ds_SampleSeparationDtl.Tables(Tbl_SampleSeparationDtl.TableName), _
                                        Tbl_SampleSeparationDtl, Nothing, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in SampleSeparationDtl
            If Not objSave.SaveInDb("Insert_SampleSeparationDtl", Tbl_SampleSeparationDtl, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of SampleSeparationDtl In Database"
                Exit Function
            End If

            Save_SampleSeparationDtl = True

            'Logic of Save End

            If Save_SampleSeparationDtl Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving SampleSeparationDtl"
            Save_SampleSeparationDtl = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function

#End Region

#Region "Save_SampleOperationDtl"
    Public Function Save_SampleOperationDtl(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_SampleOperationDtl As DataSet, _
                                 ByVal objDtLogic As ClsDataLogic_New, _
                                 ByVal UserCode_1 As String, _
                                 ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_SampleOperationDtl As Data.DataTable = Nothing

        Dim Instr_SampleOperationDtl As String = ""

        Dim PkColArr(1) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_SampleOperationDtl Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                For Each tr As Data.DataRow In Ds_SampleOperationDtl.Tables("SampleOperationDtl").Rows

                    Instr_SampleOperationDtl += IIf(Instr_SampleOperationDtl = "", "", ",").ToString + _
                                    tr("nBagBatchNo").ToString + tr("iTranNo").ToString()
                Next tr
            End If

            dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of SampleOperationDtl
            If Not objHelpDbTbl.GetSampleOperationDtl("Cast(nBagBatchNo As Varchar(20)) + Cast(iTranNo As Varchar(20))  In (" + Instr_SampleOperationDtl + ")", dataRet_1, _
                                            objDtLogic, Tbl_SampleOperationDtl, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving SampleOperationDtl"
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nBagBatchNo"
            PkColArr(1) = "iTranNo"
            If Not objSave.AssignValues(Tbl_SampleOperationDtl.TableName, PkColArr, Choice, _
                                        Ds_SampleOperationDtl.Tables(Tbl_SampleOperationDtl.TableName), _
                                        Tbl_SampleOperationDtl, Nothing, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            If Not objSave.SaveInDb("Insert_SampleOperationDtl", Tbl_SampleOperationDtl, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of SampleOperationDtl In Database"
                Exit Function
            End If

            Save_SampleOperationDtl = True

            If Save_SampleOperationDtl Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving SampleOperationDtl"
            Save_SampleOperationDtl = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region '========================Added on 24-Jan-2012

#Region "Save_SampleSendReceiveDtl"
    Public Function Save_SampleSendReceiveDtl(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_SampleSendReceiveDtl As DataSet, _
                                 ByVal objDtLogic As ClsDataLogic_New, _
                                 ByVal UserCode_1 As String, _
                                 ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_SampleSendReceiveDtl As Data.DataTable = Nothing

        Dim Instr_SampleSendReceiveDtl As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_SampleSendReceiveDtl Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                For Each tr As Data.DataRow In Ds_SampleSendReceiveDtl.Tables("SampleSendReceiveDtl").Rows

                    Instr_SampleSendReceiveDtl += IIf(Instr_SampleSendReceiveDtl = "", "", ",").ToString + _
                                    tr("nSampleSendReceiveDtlNo").ToString
                Next tr
            End If

            dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of SampleSendReceiveDtl
            If Not objHelpDbTbl.GetSampleSendReceiveDtl("nSampleSendReceiveDtlNo In (" + Instr_SampleSendReceiveDtl + ")", dataRet_1, _
                                            objDtLogic, Tbl_SampleSendReceiveDtl, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving SampleSendReceiveDtl"
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nSampleSendReceiveDtlNo"

            If Not objSave.AssignValues(Tbl_SampleSendReceiveDtl.TableName, PkColArr, Choice, _
                                        Ds_SampleSendReceiveDtl.Tables(Tbl_SampleSendReceiveDtl.TableName), _
                                        Tbl_SampleSendReceiveDtl, Nothing, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            If Not objSave.SaveInDb("Insert_SampleSendReceiveDtl", Tbl_SampleSendReceiveDtl, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of SampleSendReceiveDtl In Database"
                Exit Function
            End If

            Save_SampleSendReceiveDtl = True

            If Save_SampleSendReceiveDtl Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving SampleSendReceiveDtl"
            Save_SampleSendReceiveDtl = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region '========================Added on 25-Jan-2012

#Region "Save_BagBatchDtl"
    Public Function Save_BagBatchDtl(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_BagBatchDtl As DataSet, _
                                 ByVal objDtLogic As ClsDataLogic_New, _
                                 ByVal UserCode_1 As String, _
                                 ByRef SampleOutput As String, _
                                 ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_BagBatchDtl As Data.DataTable = Nothing

        Dim Instr_BagBatchNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_BagBatchDtl Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                For Each tr As Data.DataRow In Ds_BagBatchDtl.Tables("BagBatchDtl").Rows

                    Instr_BagBatchNo += IIf(Instr_BagBatchNo = "", "", ",").ToString + _
                                    tr("nBagBatchDtlNo").ToString

                Next tr
            End If

            dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of BagBatchDtl
            If Not objHelpDbTbl.GetBagBatchDtl("nBagBatchDtlNo In (" + Instr_BagBatchNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_BagBatchDtl, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving BagBatchDtl"
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nBagBatchDtlNo"
            If Not objSave.AssignValues(Tbl_BagBatchDtl.TableName, PkColArr, Choice, _
                                        Ds_BagBatchDtl.Tables(Tbl_BagBatchDtl.TableName), _
                                        Tbl_BagBatchDtl, Nothing, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            If Not objSave.SaveInDb("Insert_BagBatchDtl", Tbl_BagBatchDtl, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of BagBatchDtl In Database"
                Exit Function
            End If
            'Add by Vineet Chourasia'
            DataReturnList = DataReturnList.Item(0)
            If DataReturnList.Count > 0 Then
                RetuVal = DataReturnList.Item(0)
                SampleOutput = RetuVal.ParameterValue
            End If

            Save_BagBatchDtl = True

            If Save_BagBatchDtl Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving BagBatchDtl"
            Save_BagBatchDtl = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region  '========================Added on 25-Jan-2012

#Region "Save_GeneralRemarksMst"
    Public Function Save_GeneralRemarksMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_GeneralRemarksMst As DataSet, _
                                 ByVal objDtLogic As ClsDataLogic_New, _
                                 ByVal UserCode_1 As String, _
                                 ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_GeneralRemarksMst As Data.DataTable = Nothing

        Dim Instr_GeneralRemarksNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_GeneralRemarksMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                For Each tr As Data.DataRow In Ds_GeneralRemarksMst.Tables("GeneralRemarksMst").Rows

                    Instr_GeneralRemarksNo += IIf(Instr_GeneralRemarksNo = "", "", ",").ToString + _
                                    tr("iGeneralRemarksNo").ToString

                Next tr
            End If

            dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of FreezerMst
            If Not objHelpDbTbl.GetGeneralRemarksmst("iGeneralRemarksNo In (" + Instr_GeneralRemarksNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_GeneralRemarksMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving GeneralRemarksMst"
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "iGeneralRemarksNo"
            If Not objSave.AssignValues(Tbl_GeneralRemarksMst.TableName, PkColArr, Choice, _
                                        Ds_GeneralRemarksMst.Tables(Tbl_GeneralRemarksMst.TableName), _
                                        Tbl_GeneralRemarksMst, Nothing, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in ScopeMst
            If Not objSave.SaveInDb("Insert_GeneralRemarksMst", Tbl_GeneralRemarksMst, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of GeneralRemarksMst In Database"
                Exit Function
            End If

            Save_GeneralRemarksMst = True

            If Save_GeneralRemarksMst Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving GeneralRemarksMst"
            Save_GeneralRemarksMst = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region '========================Added on 17-Jan-2012

#Region "Save_BA_DocumentAttachment"
    Public Function Save_BA_DocumentAttachment(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_BA_DocumentAttachment As DataSet, _
                                 ByVal objDtLogic As ClsDataLogic_New, _
                                 ByVal UserCode_1 As String, _
                                 ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_BA_DocumentAttachment As Data.DataTable = Nothing

        Dim Instr_BA_DocumentAttachment As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_BA_DocumentAttachment Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                For Each tr As Data.DataRow In Ds_BA_DocumentAttachment.Tables("BA_DocumentAttachmst").Rows

                    Instr_BA_DocumentAttachment += IIf(Instr_BA_DocumentAttachment = "", "", ",").ToString + _
                                    tr("nBADocMstNo").ToString

                Next tr
            End If

            dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of BA_DocumentAttachment
            If Not objHelpDbTbl.GetBA_DocumentAttachmst("nBADocMstNo In (" + Instr_BA_DocumentAttachment + ")", dataRet_1, _
                                            objDtLogic, Tbl_BA_DocumentAttachment, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving BA_DocumentAttachmst"
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nBADocMstNo"
            If Not objSave.AssignValues(Tbl_BA_DocumentAttachment.TableName, PkColArr, Choice, _
                                        Ds_BA_DocumentAttachment.Tables(Tbl_BA_DocumentAttachment.TableName), _
                                        Tbl_BA_DocumentAttachment, Nothing, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            If Not objSave.SaveInDb("Insert_BA_DocumentAttachmst", Tbl_BA_DocumentAttachment, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of BA_DocumentAttachmst In Database"
                Exit Function
            End If

            Save_BA_DocumentAttachment = True

            If Save_BA_DocumentAttachment Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving BA_DocumentAttachMst"
            Save_BA_DocumentAttachment = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region  '========================Added on 24-Mar-2012 By Mrunal

#Region "Save_CCSampleRetrievalMst"
    Public Function Save_CCSampleRetrievalMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_CCSampleRetrievalMst As Data.DataSet, _
                                        ByVal objHdrogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime
        Dim Tbl_CCSampleRetrievalMst As Data.DataTable = Nothing
        Dim Instr_nCCSampleRetrievalMstNo As String = ""

        Dim Tbl_BagBatchMst As Data.DataTable = Nothing
        Dim Instr_nBagBatchNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim DataReturnList1 As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing
        Dim ReturnValueList As New ParameterReturnValue


        Try
            eStr_Retu = ""
            objHdrogic.Open_Connection()
            objHdrogic.Begin_Transaction()

            If objHdrogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objHdrogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_CCSampleRetrievalMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            Tbl_CCSampleRetrievalMst = Ds_CCSampleRetrievalMst.Tables("CCSampleRetrievalMst")
            Tbl_BagBatchMst = Ds_CCSampleRetrievalMst.Tables("BagBatchMst")

            'Function called only if edit is called
            'If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                For Each tr As Data.DataRow In Ds_CCSampleRetrievalMst.Tables("CCSampleRetrievalMst").Rows

                    Instr_nCCSampleRetrievalMstNo += IIf(Instr_nCCSampleRetrievalMstNo = "", "", ",").ToString + _
                                      tr("nCCSampleRetrievalMstNo").ToString.Trim()

                Next tr
            End If
            'End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objHdrogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objHdrogic)

            'Retrieval of CCSampleRetrievalMst
            If Not objHelpDbTbl.GetCCSampleRetrievalMst("nCCSampleRetrievalMstNo In (" + Instr_nCCSampleRetrievalMstNo + ")", dataRet_1, _
                                            objHdrogic, Tbl_CCSampleRetrievalMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving CCSampleRetrievalMst"
                Exit Function
            End If


            'Assignment of Values
            PkColArr(0) = "nCCSampleRetrievalMstNo"

            If Not objSave.AssignValues(Tbl_CCSampleRetrievalMst.TableName, PkColArr, Choice, _
                                        Ds_CCSampleRetrievalMst.Tables(Tbl_CCSampleRetrievalMst.TableName), _
                                        Tbl_CCSampleRetrievalMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            If Not objSave.SaveInDb("Insert_CCSampleRetrievalMst", Tbl_CCSampleRetrievalMst, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of CCSampleRetrievalMst In Database"
                Exit Function
            End If

            '===Save in BagBatchMst
            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty

                objHelpDbTbl = New clsHelpDbTable()

                serverDateTime_1 = objHdrogic.GetServerDateTime
                objSave = New SaveDataInDbObj(objHdrogic)

                'Retrieval of BagBatchmst
                If Not objHelpDbTbl.GetBagBatchMst("", dataRet_1, _
                                                objHdrogic, Tbl_BagBatchMst, eStr_Retu) Then

                    eStr_Retu += vbCrLf + "Error occured while retrieving BagBatchMst"
                    Exit Function
                End If


                'Assignment of Values
                PkColArr(0) = "nBagBatchNo"

                If Not objSave.AssignValues(Tbl_BagBatchMst.TableName, PkColArr, Choice, _
                                            Ds_CCSampleRetrievalMst.Tables(Tbl_BagBatchMst.TableName), _
                                            Tbl_BagBatchMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while assigning values"
                    Exit Function
                End If

                If Not objSave.SaveInDb("Insert_BagBatchMst", Tbl_BagBatchMst, Choice, DataReturnList, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of BagBatchMst In Database"
                    Exit Function
                End If

                ' added by prayag for Duplicate Barcode-Id

                For itm As Integer = 0 To DataReturnList.Count - 1

                    DataReturnList1 = DataReturnList.Item(itm)
                    RetuVal = DataReturnList1.Item(0)


                    If RetuVal.ParameterValue = "Regenarate" Then
                        eStr_Retu = "Duplicate Barcode-Id Found.Please Generate Again!"
                        Save_CCSampleRetrievalMst = False
                        objHdrogic.RollBack_Transaction()
                        Exit Function
                    End If

                Next

            End If

            Save_CCSampleRetrievalMst = True

            If Save_CCSampleRetrievalMst Then
                objHdrogic.Commit_Transaction()
            Else
                objHdrogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving BagBatchMst"
            Save_CCSampleRetrievalMst = False
            objHdrogic.RollBack_Transaction()
        Finally
            objHdrogic.Close_Connection()
        End Try

    End Function
#End Region '================Added on 07-04-2012 By Mrunal===================

#Region "Save_WinNonlin_DocumentAttachMst"
    Public Function Save_WinNonlin_DocumentAttachMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_WinNonlin_DocumentAttachMst As DataSet, _
                                 ByVal objDtLogic As ClsDataLogic_New, _
                                 ByVal UserCode_1 As String, _
                                 ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_WinNonlin_DocumentAttachMst As Data.DataTable = Nothing

        Dim Instr_WinNonlin_DocumentAttachMst As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_WinNonlin_DocumentAttachMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                For Each tr As Data.DataRow In Ds_WinNonlin_DocumentAttachMst.Tables("WinNonlin_DocumentAttachMst").Rows

                    Instr_WinNonlin_DocumentAttachMst += IIf(Instr_WinNonlin_DocumentAttachMst = "", "", ",").ToString + _
                                    tr("nWinDocMstNo").ToString

                Next tr
            End If

            dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of WinNonlin_DocumentAttachMst
            If Not objHelpDbTbl.GetWinNonlin_DocumentAttachMst("nWinDocMstNo In (" + Instr_WinNonlin_DocumentAttachMst + ")", dataRet_1, _
                                            objDtLogic, Tbl_WinNonlin_DocumentAttachMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving WinNonlin_DocumentAttachMst"
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nWinDocMstNo"
            If Not objSave.AssignValues(Tbl_WinNonlin_DocumentAttachMst.TableName, PkColArr, Choice, _
                                        Ds_WinNonlin_DocumentAttachMst.Tables(Tbl_WinNonlin_DocumentAttachMst.TableName), _
                                        Tbl_WinNonlin_DocumentAttachMst, Nothing, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            If Not objSave.SaveInDb("Insert_WinNonlin_DocumentAttachMst", Tbl_WinNonlin_DocumentAttachMst, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of BA_DocumentAttachmst In Database"
                Exit Function
            End If

            Save_WinNonlin_DocumentAttachMst = True

            If Save_WinNonlin_DocumentAttachMst Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving WinNonlin_DocumentAttachMst"
            Save_WinNonlin_DocumentAttachMst = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region  '========================Added on 24-May-2012 By Mrunal

#Region "insert_CRFVersionMst"
    Public Function insert_CRFVersionMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_CRFVersionMst As Data.DataSet, _
                                         ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean

        'Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime
        Dim Tbl_CRFVersionMst As Data.DataTable = Nothing
        'Dim Instr_vWorkSpaceIDNo As String = ""

        'Dim PkColArr(1) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing
        Dim objHdrogic As New clsCommon

        Try
            eStr_Retu = ""
            objHdrogic.Open_Connection()
            objHdrogic.Begin_Transaction()

            If objHdrogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objHdrogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_CRFVersionMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            Tbl_CRFVersionMst = Ds_CRFVersionMst.Tables("CRFVersionMst")


            ''Function called only if edit is called
            ''If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
            'If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
            '    For Each tr As Data.DataRow In Ds_CRFVersionMst.Tables("CRFVersionMst").Rows

            '        Instr_vWorkSpaceIDNo += IIf(Instr_vWorkSpaceIDNo = "", "", ",").ToString + _
            '                          tr("vWorkSpaceId").ToString.Trim()

            '    Next tr
            'End If

            'If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
            '    dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            'Else
            '    dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            'End If

            'objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objHdrogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objHdrogic)

            ''Retrieval of CCSampleRetrievalMst
            ''If Not objHelpDbTbl.GetCCSampleRetrievalMst("nCCSampleRetrievalMstNo In (" + Instr_vWorkSpaceIDNo + ")", dataRet_1, _
            ''                                objHdrogic, Tbl_WorkspaceStatusDetail, eStr_Retu) Then

            ''    eStr_Retu += vbCrLf + "Error occured while retrieving CCSampleRetrievalMst"
            ''    Exit Function
            ''End If


            ''Assignment of Values
            'PkColArr(0) = "nVersionNo"
            'PkColArr(1) = "vWorkSpaceId"

            'If Not objSave.AssignValues(Tbl_CRFVersionMst.TableName, PkColArr, Choice, _
            '                            Ds_CRFVersionMst.Tables(Tbl_CRFVersionMst.TableName), _
            '                            Tbl_CRFVersionMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
            '    eStr_Retu += vbCrLf + "Error occured while assigning values"
            '    Exit Function
            'End If

            If Not objSave.SaveInDb("insert_CRFVersionMst", Ds_CRFVersionMst.Tables(0), Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of projectStatus In Database"
                Exit Function
            End If

            insert_CRFVersionMst = True

            If insert_CRFVersionMst Then
                objHdrogic.Commit_Transaction()
            Else
                objHdrogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving CRFVersionMst"
            insert_CRFVersionMst = False
            objHdrogic.RollBack_Transaction()
        Finally
            objHdrogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "Save_SubjectPatientMapping"
    Public Function Save_SubjectPatientMapping(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_SubjectPatientMapping As DataSet, _
                                 ByVal objDtLogic As ClsDataLogic_New, _
                                 ByVal UserCode_1 As String, _
                                 ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_SubjectPatientMapping As Data.DataTable = Nothing
        Tbl_SubjectPatientMapping = Ds_SubjectPatientMapping.Tables("SubjectPatientMapping")
        Dim Instr_SubjectPatientMapping As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_SubjectPatientMapping Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                For Each tr As Data.DataRow In Ds_SubjectPatientMapping.Tables("SubjectPatientMapping").Rows

                    Instr_SubjectPatientMapping += IIf(Instr_SubjectPatientMapping = "", "", ",").ToString + _
                                    tr("nSubjectPatientMapping").ToString

                Next tr
            End If

            dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of SubjectPatientMapping
            'If Not objHelpDbTbl.GetSubjectPatientMapping("nSubjectPatientMapping In (" + Instr_SubjectPatientMapping + ")", dataRet_1, _
            '                                objDtLogic, Tbl_SubjectPatientMapping, eStr_Retu) Then

            '    eStr_Retu += vbCrLf + "Error occured while retrieving SubjectPatientMapping"
            '    Exit Function
            'End If

            'Assignment of Values
            PkColArr(0) = "nSubjectPatientMapping"
            Tbl_SubjectPatientMapping.TableName = "SubjectPatientMapping"
            'If Not objSave.AssignValues(Tbl_SubjectPatientMapping.TableName, PkColArr, Choice, _
            '                            Ds_SubjectPatientMapping.Tables(Tbl_SubjectPatientMapping.TableName), _
            '                            Tbl_SubjectPatientMapping, Nothing, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
            '    eStr_Retu += vbCrLf + "Error occured while assigning values"
            '    Exit Function
            'End If


            If Not objSave.SaveInDb("Insert_SubjectPatientMapping", Tbl_SubjectPatientMapping, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information by Insert_SubjectPatientMapping In Database"
                Exit Function
            End If

            Save_SubjectPatientMapping = True

            If Save_SubjectPatientMapping Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving SubjectPatientMapping"
            Save_SubjectPatientMapping = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region 'Added by Akhilesh

#Region "Save_BASampleConcentrationFiles"
    Public Function Save_BASampleConcentrationFiles(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_BASampleConcentrationFiles As DataSet, _
                                 ByVal objDtLogic As ClsDataLogic_New, _
                                 ByVal UserCode_1 As String, _
                                 ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_BASampleConcentrationFiles As Data.DataTable = Nothing
        Tbl_BASampleConcentrationFiles = Ds_BASampleConcentrationFiles.Tables("BASampleConcentrationFiles")
        Dim Instr_BASampleConcentrationFiles As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_BASampleConcentrationFiles Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                For Each tr As Data.DataRow In Ds_BASampleConcentrationFiles.Tables("nSampleConcentrationFileDtlNo").Rows

                    Instr_BASampleConcentrationFiles += IIf(Instr_BASampleConcentrationFiles = "", "", ",").ToString + _
                                    tr("nSampleConcentrationFileDtlNo").ToString

                Next tr
            End If

            dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)


            PkColArr(0) = "nSampleConcentrationFileDtlNo"
            Tbl_BASampleConcentrationFiles.TableName = "BASampleConcentrationFiles"


            If Not objSave.SaveInDb("Insert_BASampleConcentrationFiles", Tbl_BASampleConcentrationFiles, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information by Insert_BASampleConcentrationFiles In Database"
                Exit Function
            End If

            Save_BASampleConcentrationFiles = True

            If Save_BASampleConcentrationFiles Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Insert_BASampleConcentrationFiles"
            Save_BASampleConcentrationFiles = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region

#Region "Save_MedExScreeningTempDtl"

    Public Function Save_MedExScreeningTempDtl(ByVal Choice As DataObjOpenSaveModeEnum, _
                                          ByVal Ds_MedExScreeningDtl As Data.DataSet, _
                                          ByVal objDtLogic As ClsDataLogic_New, _
                                          ByVal UserCode_1 As String, _
                                          ByRef TranNo_Retu As String, _
                                          ByRef Is_Transaction As Boolean, _
                                          ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing

        Dim serverDateTime_1 As DateTime
        Dim Tbl_MedExScreeningHdr As Data.DataTable = Nothing
        Dim Tbl_MedExScreeningDtl As Data.DataTable = Nothing
        Dim Tbl_SubjectScreeningTemplate As Data.DataTable = Nothing
        Dim Tbl_Top_MedExScreeningDtl As Data.DataTable = Nothing
        Dim Instr_ScreenId As String = ""

        Dim Tbl_MedExScreeningHdrHistory As Data.DataTable = Nothing

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Dim DataReturnList_Mst As New ArrayList
        Dim RetuVal_Mst As ParameterReturnValue = Nothing
        Dim RetuVal_Mst_ScreenDate As ParameterReturnValue = Nothing

        Dim DataReturnList_WSHdr As New ArrayList
        Dim RetuVal_WSHdr As ParameterReturnValue = Nothing

        Dim i As Integer

        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_MedExScreeningDtl Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_MedExScreeningDtl.Tables("MedExScreeningHdr").Rows

                    Instr_ScreenId += IIf(Instr_ScreenId = "", "", ",").ToString + _
                                      tr("nMedExScreeningHdrNo").ToString()

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of MedExScreeningDtl
            If Not objHelpDbTbl.GetMedExScreeningHdr("nMedExScreeningHdrNo In (" + Instr_ScreenId + ")", dataRet_1, _
                                            objDtLogic, Tbl_MedExScreeningHdr, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving MedExScreeningHDr"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nMedExScreeningHdrNo"

            If Not objSave.AssignValues(Tbl_MedExScreeningHdr.TableName, PkColArr, Choice, _
                                        Ds_MedExScreeningDtl.Tables(Tbl_MedExScreeningHdr.TableName), _
                                        Tbl_MedExScreeningHdr, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            If Not objSave.SaveInDb("Insert_MedExScreeningHdr", Tbl_MedExScreeningHdr, Choice, DataReturnList_Mst, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of MedExScreeningHdr In Database"
                Exit Function
            End If

            DataReturnList_Mst = DataReturnList_Mst.Item(0)
            RetuVal_Mst = DataReturnList_Mst.Item(0)
            RetuVal_Mst_ScreenDate = DataReturnList_Mst.Item(1)
            TranNo_Retu = RetuVal_Mst.ParameterValue
            If RetuVal_Mst.ParameterValue < 0 Then
                eStr_Retu = "Screening of selected subject for current date is already saved by other user."
                objDtLogic.RollBack_Transaction()
                Exit Function
            End If

            'Assiging New nMedExScreenId to MedExScreeningDtl table
            If Not IsNothing(Ds_MedExScreeningDtl.Tables("MedExScreeningDtl")) Then
                'DataReturnList_Mst = DataReturnList_Mst.Item(0)
                'RetuVal_Mst = DataReturnList_Mst.Item(0)
                Tbl_MedExScreeningDtl = New DataTable
                Tbl_MedExScreeningDtl = Ds_MedExScreeningDtl.Tables("MedExScreeningDtl")
                For Each dr As Data.DataRow In Tbl_MedExScreeningDtl.Rows
                    dr("nMedExScreeningHdrNo") = RetuVal_Mst.ParameterValue
                    dr.AcceptChanges()
                Next
                Tbl_MedExScreeningDtl.AcceptChanges()

                If Not objSave.SaveInDb("Insert_MedExScreeningDtl", Tbl_MedExScreeningDtl, Choice, DataReturnList, eStr_Retu, True) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of MedExScreeningDtl In Database"
                    Exit Function
                End If

            End If
            '==========================================================================================

            'Assiging New nMedExScreeningHdrNo to SubjectScreeningTemplate table
            If Not IsNothing(Ds_MedExScreeningDtl.Tables("SubjectScreeningTemplate")) Then
                'DataReturnList_Mst = DataReturnList_Mst.Item(0)
                'RetuVal_Mst = DataReturnList_Mst.Item(0)

                Tbl_SubjectScreeningTemplate = New DataTable
                Tbl_SubjectScreeningTemplate = Ds_MedExScreeningDtl.Tables("SubjectScreeningTemplate")
                For Each dr As Data.DataRow In Tbl_SubjectScreeningTemplate.Rows
                    dr("nMedExScreeningHdrNo") = RetuVal_Mst.ParameterValue
                    dr.AcceptChanges()
                Next
                Tbl_SubjectScreeningTemplate.AcceptChanges()
                'Now saveing Remaining Rows with same iTranno
                If Not objSave.SaveInDb("Insert_SubjectScreeningTemplate", Tbl_SubjectScreeningTemplate, Choice, Nothing, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of SubjectScreeningTemplate In Database"
                    Exit Function
                End If
            End If

            '==========================================================================================


            'Added by Chandresh Vanker on 16-Sep-2009 For saving Remarks in MedExScreeningHdrHistory table
            If Not IsNothing(Ds_MedExScreeningDtl.Tables("MedExScreeningHdrHistory")) Then
                Tbl_MedExScreeningHdrHistory = New DataTable
                Tbl_MedExScreeningHdrHistory = Ds_MedExScreeningDtl.Tables("MedExScreeningHdrHistory")
                For Each dr As Data.DataRow In Tbl_MedExScreeningHdrHistory.Rows
                    dr("nMedExScreeningHdrNo") = RetuVal_Mst.ParameterValue
                    'dr("iTranno") = RetuVal.ParameterValue
                    dr.AcceptChanges()
                Next
                Tbl_MedExScreeningHdrHistory.AcceptChanges()

                DataReturnList = Nothing
                DataReturnList = New ArrayList

                If Not objSave.SaveInDb("Insert_MedExScreeningHdrHistory", Tbl_MedExScreeningHdrHistory, Choice, DataReturnList, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of MedExScreeningHdrHistory In Database"
                    Exit Function
                End If

                DataReturnList = DataReturnList.Item(0)
                RetuVal = DataReturnList.Item(0)
                If Convert.ToInt32(RetuVal.ParameterValue) = 1 Then
                    Is_Transaction = True
                End If

            End If
            '**************************


            '-------------------PSS -------------------------------
            If Not Ds_MedExScreeningDtl.Tables("MedExWorkSpaceScreeningHdr") Is Nothing AndAlso _
                 Ds_MedExScreeningDtl.Tables("MedExWorkSpaceScreeningHdr").Rows.Count > 0 Then

                If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                    For Each dr As Data.DataRow In Ds_MedExScreeningDtl.Tables("MedExWorkSpaceScreeningHdr").Rows
                        dr("nMedExScreeningHdrNo") = RetuVal_Mst.ParameterValue
                        ' dr("dScreenDate") = RetuVal_Mst_ScreenDate.ParameterValue
                    Next
                    Ds_MedExScreeningDtl.Tables("MedExWorkSpaceScreeningHdr").AcceptChanges()
                End If

                'For Saving
                If Not objSave.SaveInDb("Insert_MedExWorkSpaceScreeningHdr", Ds_MedExScreeningDtl.Tables("MedExWorkSpaceScreeningHdr"), Choice, DataReturnList_WSHdr, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Saving MedExWorkSpaceScreeningHdr In Database"
                    Exit Function
                End If

                DataReturnList_WSHdr = DataReturnList_WSHdr.Item(0)
                RetuVal_WSHdr = DataReturnList_WSHdr.Item(0)

            End If


            If Not Ds_MedExScreeningDtl.Tables("MedExWorkSpaceScreeningDtl") Is Nothing AndAlso _
                Ds_MedExScreeningDtl.Tables("MedExWorkSpaceScreeningDtl").Rows.Count > 0 Then

                If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                    For Each dr As Data.DataRow In Ds_MedExScreeningDtl.Tables("MedExWorkSpaceScreeningDtl").Rows
                        dr("nMedExWorkSpaceScreeningHdrNo") = RetuVal_WSHdr.ParameterValue
                    Next
                    Ds_MedExScreeningDtl.Tables("MedExWorkSpaceScreeningDtl").AcceptChanges()
                End If

                'For Saving
                If Not objSave.SaveInDb("Insert_MedExWorkSpaceScreeningDtl", Ds_MedExScreeningDtl.Tables("MedExWorkSpaceScreeningDtl"), Choice, DataReturnList_WSHdr, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Saving MedExWorkSpaceScreeningDtl In Database"
                    Exit Function
                End If

            End If
            '--------------------------------------------------------------

            Save_MedExScreeningTempDtl = True

            If Save_MedExScreeningTempDtl Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving MedExScreeningDtl"
            Save_MedExScreeningTempDtl = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function

#End Region  '=============== Added on 25-09-2012 by Nidhi =============


#Region "Save_BAWorkflowStageMst"
    Public Function Save_BAWorkflowStageMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                            ByVal Ds_BAWorkflowStageMst As DataSet, _
                                            ByVal objDtLogic As ClsDataLogic_New, _
                                            ByVal UserCode_1 As String, _
                                            ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_BAWorkflowStageMst As Data.DataTable = Nothing
        Tbl_BAWorkflowStageMst = Ds_BAWorkflowStageMst.Tables("BAWorkflowStageMst")
        Dim Instr_BAWorkflowStageMst As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_BAWorkflowStageMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "iWorkFlowStageDtlNo"
            Tbl_BAWorkflowStageMst.TableName = "BAWorkflowStageMst"
            objSave = New SaveDataInDbObj(objDtLogic)
            If Not objSave.SaveInDb("Insert_BASampleConcentrationFiles", Tbl_BAWorkflowStageMst, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information by Insert_BAWorkflowStageMst In Database"
                Exit Function
            End If

            Save_BAWorkflowStageMst = True

            If Save_BAWorkflowStageMst Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving SubjectPatientMapping"
            Save_BAWorkflowStageMst = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region  '===============Added on 5-10-2012 by Pundarik=============

#Region "Save_BASampleCollectionWorkFlow"
    Public Function Save_BASampleCollectionWorkFlow(ByVal Choice As DataObjOpenSaveModeEnum, _
                                                    ByVal Ds_BASampleCollectionWorkFlow As DataSet, _
                                                    ByVal objDtLogic As ClsDataLogic_New, _
                                                    ByVal UserCode_1 As String, _
                                                    ByRef iBASampleFinalResultsNo As String, _
                                                    ByRef eStr_Retu As String) As Boolean

        'Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        'Dim serverDateTime_1 As DateTime

        Dim Tbl_BASampleCollectionWorkFlow As Data.DataTable = Nothing
        Tbl_BASampleCollectionWorkFlow = Ds_BASampleCollectionWorkFlow.Tables("BASampleCollectionWorkFlow")
        Dim Instr_BAWorkflowStageMst As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_BASampleCollectionWorkFlow Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "iSampleCollectionWorkFlowNo"
            Tbl_BASampleCollectionWorkFlow.TableName = "BASampleCollectionWorkFlow"
            objSave = New SaveDataInDbObj(objDtLogic)
            If Not objSave.SaveInDb("Insert_BASampleCollectionWorkFlow", Tbl_BASampleCollectionWorkFlow, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information by Insert_BASampleCollectionWorkFlow In Database"
                Exit Function
            End If
            iBASampleFinalResultsNo = DataReturnList.Item(0).Item(0).ParameterValue
            Save_BASampleCollectionWorkFlow = True

            If Save_BASampleCollectionWorkFlow Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving BASampleCollectionWorkFlow"
            Save_BASampleCollectionWorkFlow = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region  '===============Added on 5-10-2012 by Pundarik=============

#Region "Save_BASampleResults"
    Public Function Save_BASampleResults(ByVal Choice As DataObjOpenSaveModeEnum, _
                                         ByVal Ds_BASampleResults As DataSet, _
                                         ByVal objDtLogic As ClsDataLogic_New, _
                                         ByVal UserCode_1 As String, _
                                         ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_BASampleResults As Data.DataTable = Nothing
        Tbl_BASampleResults = Ds_BASampleResults.Tables("BASampleResults")
        Dim Instr_BASampleResults As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_BASampleResults Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "iPKSampleResultDtlNo"
            Tbl_BASampleResults.TableName = "BASampleResults"
            objSave = New SaveDataInDbObj(objDtLogic)
            If Not objSave.SaveInDb("Insert_BASampleResults", Tbl_BASampleResults, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information by Insert_BASampleResults In Database"
                Exit Function
            End If

            Save_BASampleResults = True

            If Save_BASampleResults Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving BASampleResults"
            Save_BASampleResults = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region  '===============Added on 5-10-2012 by Pundarik=============


#Region "Save_BAResultDCFDtl"
    Public Function Save_BAResultDCFDtl(ByVal Choice As DataObjOpenSaveModeEnum, _
                                         ByVal Ds_BAResultDCFDtl As DataSet, _
                                         ByVal objDtLogic As ClsDataLogic_New, _
                                         ByVal UserCode_1 As String, _
                                         ByRef eStr_Retu As String) As Boolean


        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing


        Dim Tbl_BAResultDCFDtl As Data.DataTable = Nothing
        Tbl_BAResultDCFDtl = Ds_BAResultDCFDtl.Tables("BAResultDCFDtl")
        Dim Instr_BAResultDCFDtl As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_BAResultDCFDtl Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "iPKSampleResultDtlNo"
            Tbl_BAResultDCFDtl.TableName = "BAResultDCFDtl"
            objSave = New SaveDataInDbObj(objDtLogic)
            If Not objSave.SaveInDb("Insert_BAResultDCFDtl", Tbl_BAResultDCFDtl, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information by Insert_BAResultDCFDtl In Database"
                Exit Function
            End If

            Save_BAResultDCFDtl = True

            If Save_BAResultDCFDtl Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving BAResultDCFDtl"
            Save_BAResultDCFDtl = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region 'By akhilesh 01-Jan-2013


#Region "Save_BASampleFinalResults"
    Public Function Save_BASampleFinalResults(ByVal Choice As DataObjOpenSaveModeEnum, _
                                              ByVal Ds_BASampleFinalResults As DataSet, _
                                              ByVal objDtLogic As ClsDataLogic_New, _
                                              ByVal UserCode_1 As String, _
                                              ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_BASampleFinalResults As Data.DataTable = Nothing
        Tbl_BASampleFinalResults = Ds_BASampleFinalResults.Tables("BASampleFinalResults")
        Dim Instr_BASampleFinalResults As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_BASampleFinalResults Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "iPKSampleFinalResultDtlNo"
            Tbl_BASampleFinalResults.TableName = "BASampleFinalResults"
            objSave = New SaveDataInDbObj(objDtLogic)
            If Not objSave.SaveInDb("Insert_BASampleFinalResults", Tbl_BASampleFinalResults, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information by Insert_BASampleFinalResults In Database"
                Exit Function
            End If

            Save_BASampleFinalResults = True

            If Save_BASampleFinalResults Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving BASampleFinalResults"
            Save_BASampleFinalResults = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region  '===============Added on 5-10-2012 by Pundarik=============

#Region "Save_BAWorkSpaceDataSetFiles"
    Public Function Save_BAWorkSpaceDataSetFiles(ByVal Choice As DataObjOpenSaveModeEnum, _
                                              ByVal Ds_BAWorkSpaceDataSetFiles As DataSet, _
                                              ByVal objDtLogic As ClsDataLogic_New, _
                                              ByVal UserCode_1 As String, _
                                              ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_BAWorkSpaceDataSetFiles As Data.DataTable = Nothing
        Tbl_BAWorkSpaceDataSetFiles = Ds_BAWorkSpaceDataSetFiles.Tables("BAWorkSpaceDataSetFiles")
        Dim Instr_BAWorkSpaceDataSetFiles As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_BAWorkSpaceDataSetFiles Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "iPKSampleFinalResultDtlNo"
            Tbl_BAWorkSpaceDataSetFiles.TableName = "BAWorkSpaceDataSetFiles"
            objSave = New SaveDataInDbObj(objDtLogic)
            If Not objSave.SaveInDb("Insert_BAWorkSpaceDataSetFiles", Tbl_BAWorkSpaceDataSetFiles, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information by Insert_BAWorkSpaceDataSetFiles In Database"
                Exit Function
            End If

            Save_BAWorkSpaceDataSetFiles = True

            If Save_BAWorkSpaceDataSetFiles Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving BAWorkSpaceDataSetFiles"
            Save_BAWorkSpaceDataSetFiles = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region ''BA akhilesh

#Region "Insert_WorkspaceSubjectMaster_Rejection"
    Public Function Insert_WorkspaceSubjectMaster_Rejection(ByVal Choice As DataObjOpenSaveModeEnum, _
                                              ByVal DS_workspaceSubjectMst As DataSet, _
                                              ByVal objDtLogic As ClsDataLogic_New, _
                                              ByVal UserCode_1 As String, _
                                              ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_BAWorkSpaceDataSetFiles As Data.DataTable = Nothing

        Dim Instr_BAWorkSpaceDataSetFiles As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If DS_workspaceSubjectMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Assignment of Values


            objSave = New SaveDataInDbObj(objDtLogic)
            If Not objSave.SaveInDb("Insert_WorkspaceSubjectMaster_Rejection", DS_workspaceSubjectMst.Tables(0), Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information by Insert_BAWorkSpaceDataSetFiles In Database"
                Exit Function
            End If

            Insert_WorkspaceSubjectMaster_Rejection = True

            If Insert_WorkspaceSubjectMaster_Rejection Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while Rejecting subject"
            Insert_WorkspaceSubjectMaster_Rejection = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region ''By Megha 

#Region "Insert_WorkSpaceScreeningHdrDtl"
    Public Function Insert_WorkSpaceScreeningHdrDtl(ByVal Choice As DataObjOpenSaveModeEnum, _
                                              ByVal ds_WorkspaceScreeningHdrDtl As DataSet, _
                                              ByVal objDtLogic As ClsDataLogic_New, _
                                             ByRef eStr_Retu As String) As Boolean


        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing
        Dim Table_WorkspaceScreeningHdr As DataTable = Nothing
        Dim Table_WorkspaceScreeingDtl As DataTable = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If ds_WorkspaceScreeningHdrDtl Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Assignment of Values
            objSave = New SaveDataInDbObj(objDtLogic)
            If Not IsNothing(ds_WorkspaceScreeningHdrDtl.Tables("WorkspaceScreeningHdr")) Then
                Table_WorkspaceScreeningHdr = ds_WorkspaceScreeningHdrDtl.Tables("WorkspaceScreeningHdr")
                If Not objSave.SaveInDb("Insert_WorkSpaceScreeningHdr", Table_WorkspaceScreeningHdr, Choice, DataReturnList, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information in WorkspaceScreeningHdr"
                    Exit Function
                End If
                DataReturnList = DataReturnList.Item(0)
                RetuVal = DataReturnList.Item(0)

                For Each dr As Data.DataRow In ds_WorkspaceScreeningHdrDtl.Tables(1).Rows
                    dr("nWorkSpaceScreeningHdrNo") = RetuVal.ParameterValue
                    dr.AcceptChanges()
                Next dr
                ds_WorkspaceScreeningHdrDtl.Tables(1).AcceptChanges()
            End If
            If Not IsNothing(ds_WorkspaceScreeningHdrDtl.Tables("WorkspaceScreeningDtl")) Then
                Table_WorkspaceScreeingDtl = ds_WorkspaceScreeningHdrDtl.Tables("WorkspaceScreeningDtl")
                If Not objSave.SaveInDb("Insert_WorkSpaceScreeningDtl", Table_WorkspaceScreeingDtl, Choice, Nothing, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information in WorkspaceScreeningDtl"
                    Exit Function
                End If
            End If
            Insert_WorkSpaceScreeningHdrDtl = True

            If Insert_WorkSpaceScreeningHdrDtl Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while Rejecting subject"
            Insert_WorkSpaceScreeningHdrDtl = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region ''By Megha 

#Region "Insert_ScreeningTemplateHdrDtl"
    Public Function Insert_ScreeningTemplateHdrDtl(ByVal Choice As DataObjOpenSaveModeEnum, _
                                              ByVal ds_ScreeningTemplateHdrDtl As DataSet, _
                                              ByVal objDtLogic As ClsDataLogic_New, _
                                             ByRef eStr_Retu As String) As Boolean


        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing
        Dim Table_ScreeningTemplateHdr As DataTable = Nothing
        Dim Table_ScreeningTemplateDtl As DataTable = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If ds_ScreeningTemplateHdrDtl Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Assignment of Values
            objSave = New SaveDataInDbObj(objDtLogic)
            If Not IsNothing(ds_ScreeningTemplateHdrDtl.Tables("ScreeningTemplateHdr")) Then
                Table_ScreeningTemplateHdr = ds_ScreeningTemplateHdrDtl.Tables("ScreeningTemplateHdr")
                If Not objSave.SaveInDb("Insert_ScreeningTemplateHdr", Table_ScreeningTemplateHdr, Choice, DataReturnList, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information in WorkspaceScreeningHdr"
                    Exit Function
                End If
                DataReturnList = DataReturnList.Item(0)
                RetuVal = DataReturnList.Item(0)

                For Each dr As Data.DataRow In ds_ScreeningTemplateHdrDtl.Tables(1).Rows
                    dr("nScreeningTemplateHdrNo") = RetuVal.ParameterValue
                    dr.AcceptChanges()
                Next dr
                ds_ScreeningTemplateHdrDtl.Tables("ScreeningTemplateDtl").AcceptChanges()
            End If
            If Not IsNothing(ds_ScreeningTemplateHdrDtl.Tables("ScreeningTemplateDtl")) Then
                Table_ScreeningTemplateDtl = ds_ScreeningTemplateHdrDtl.Tables("ScreeningTemplateDtl")
                If Not objSave.SaveInDb("Insert_ScreeningTemplateDtl", Table_ScreeningTemplateDtl, Choice, Nothing, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information in WorkspaceScreeningDtl"
                    Exit Function
                End If
            End If
            Insert_ScreeningTemplateHdrDtl = True

            If Insert_ScreeningTemplateHdrDtl Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while Rejecting subject"
            Insert_ScreeningTemplateHdrDtl = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region ''By Megha 

#Region "TableInsert"
    Public Function TableInsert(ByVal objDtLogic As ClsDataLogic_New, _
                                       ByVal dsSaveDTtoProc As DataSet, _
                                       ByVal UserCode_1 As String, _
                                       ByRef eStr_Retu As String) As Boolean


        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing


        Dim TblSave As Data.DataTable = Nothing
        'Tbl_BAResultDCFDtl = Ds_BAResultDCFDtl.Tables("BAResultDCFDtl")
        'Dim Instr_BAResultDCFDtl As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If dsSaveDTtoProc Is Nothing Then
                eStr_Retu = "Dataset Not Valid"
                Exit Function
            End If
            objSave = New SaveDataInDbObj(objDtLogic)
            For Each dt As DataTable In dsSaveDTtoProc.Tables
                TblSave = New DataTable
                TblSave.TableName = dt.TableName
                TblSave = dt
                If Not objSave.SaveInDb(dt.TableName.ToString.Trim, TblSave, 0, DataReturnList, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information by " & dt.TableName & " In Database"
                    Exit Function
                End If
            Next
            TableInsert = True

            If TableInsert Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving by TableInsert()"
            TableInsert = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region ''By Akhilesh
#Region "BulkCopyWithColumnMapping"
    Public Function BulkCopyWithColumnMapping(ByVal dsDataToSave As DataSet, _
                                              ByVal objDtLogic As ClsDataLogic_New, _
                                                        ByRef eStr_Retu As String) As Boolean


        Dim conStr As String = ""

        Try

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()
            For Each dtBulk As DataTable In dsDataToSave.Tables
                Dim myBulkCopy As SqlClient.SqlBulkCopy = New SqlClient.SqlBulkCopy(objDtLogic.Connection, SqlClient.SqlBulkCopyOptions.Default, objDtLogic.Transaction)
                MapBulkCopy(myBulkCopy, dtBulk)
                myBulkCopy.DestinationTableName = dtBulk.TableName
                myBulkCopy.WriteToServer(dtBulk)
            Next
            BulkCopyWithColumnMapping = True

            If BulkCopyWithColumnMapping Then
                objDtLogic.Commit_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message
            objDtLogic.RollBack_Transaction()
            BulkCopyWithColumnMapping = False
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try


    End Function
    Private Function MapBulkCopy(ByVal BC As SqlClient.SqlBulkCopy, ByVal dt As DataTable) As Boolean
        For Each dc As DataColumn In dt.Columns
            BC.ColumnMappings.Add(New SqlClient.SqlBulkCopyColumnMapping(dc.ColumnName.Trim, dc.ColumnName.Trim))
        Next
        Return True

    End Function
#End Region ''By Akhilesh

    '==========================================================================
    'Added by Vimal Ghoniya For CDMS
    '==========================================================================

#Region "Save_CDMSSubjectMst"

    Public Function Save_CDMSSubjectMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_CDMSSubjectMst As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef SubjectId As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim Tbl_CDMSubjectDtl As Data.DataTable = Nothing
        Dim Tbl_CDMDtlHistory As Data.DataTable = Nothing
        Dim Tbl_CDMDtlConsu As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_SubjectMst As Data.DataTable = Nothing
        Dim Instr_SubjectID As String = ""


        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_CDMSSubjectMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            Tbl_CDMSubjectDtl = New DataTable
            Tbl_CDMSubjectDtl = Ds_CDMSSubjectMst.Tables("SubjectDtlCDMS")
            Tbl_CDMDtlHistory = New DataTable
            Tbl_CDMDtlHistory = Ds_CDMSSubjectMst.Tables("SubjectDtlCDMSHistory")
            Tbl_CDMDtlConsu = New DataTable
            Tbl_CDMDtlConsu = Ds_CDMSSubjectMst.Tables("SubjectDtlCDMSConsumption")

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_CDMSSubjectMst.Tables("View_SubjectMaster").Rows

                    Instr_SubjectID += IIf(Instr_SubjectID = "", "", ",").ToString + _
                                    tr("vSubjectID").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of Subject Master
            If Not objHelpDbTbl.GetView_SubjectMaster("vSubjectID In ('" + Instr_SubjectID + "')", dataRet_1, _
                                            objDtLogic, Tbl_SubjectMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving Subject Master"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vSubjectID"

            If Not objSave.AssignValues(Tbl_SubjectMst.TableName, PkColArr, Choice, _
                                        Ds_CDMSSubjectMst.Tables(Tbl_SubjectMst.TableName), _
                                        Tbl_SubjectMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in Subject Master
            If Not objSave.SaveInDb("Insert_CDMSSubjectMaster", Tbl_SubjectMst, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of Subject Master In Database"
                Exit Function
            End If

            DataReturnList = DataReturnList.Item(0)
            RetuVal = DataReturnList.Item(0)
            SubjectId = RetuVal.ParameterValue

            If Not Tbl_CDMSubjectDtl Is Nothing Then
                For Each dr As Data.DataRow In Tbl_CDMSubjectDtl.Rows
                    dr("vSubjectID") = RetuVal.ParameterValue
                Next
                'Save in SubjectDtlCDMS
                If Not objSave.SaveInDb("Insert_SubjectDtlCDMS", Tbl_CDMSubjectDtl, Choice, Nothing, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of SubjectDtlCDMS Detail In Database"
                    Exit Function
                End If
            End If

            If Not Tbl_CDMDtlHistory Is Nothing Then
                For Each dr As Data.DataRow In Tbl_CDMDtlHistory.Rows
                    If dr("vColumnName") = "vSubjectID" Then
                        dr("vChangedValue") = RetuVal.ParameterValue
                    End If
                    dr("vSubjectID") = RetuVal.ParameterValue
                Next
                'Save in SubjectDtlCDMSHistory
                If Not objSave.SaveInDb("Insert_SubjectDtlCDMSHistory", Tbl_CDMDtlHistory, Choice, Nothing, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of SubjectDtlCDMSHistory Detail In Database"
                    Exit Function
                End If
            End If

            Tbl_CDMDtlConsu.Columns.Add("vRemarks", System.Type.GetType("System.String"))
            If Not Tbl_CDMDtlConsu Is Nothing Then
                For Each dr As Data.DataRow In Tbl_CDMDtlConsu.Rows
                    dr("vSubjectID") = RetuVal.ParameterValue
                Next
                'Save in SubjectDtlCDMSConsumption
                If Not objSave.SaveInDb("Insert_SubjectDtlCDMSConsumption", Tbl_CDMDtlConsu, Choice, Nothing, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of SubjectDtlCDMSConsumption Detail In Database"
                    Exit Function
                End If
            End If


            Save_CDMSSubjectMst = True

            If Save_CDMSSubjectMst Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Subject Master"
            Save_CDMSSubjectMst = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function

#End Region

#Region "Save_SubjectDtlCDMSMedicalCondition"

    Public Function Save_SubjectDtlCDMSMedicalCondition(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_MediCond As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim Tbl_MediCond As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Instr_SubjectDtlCSMSMedicalConditionNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_MediCond Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            Tbl_MediCond = New DataTable
            Tbl_MediCond = Ds_MediCond.Tables("SubjectDtlCDMSMedicalCondition")

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_MediCond.Tables("SubjectDtlCDMSMedicalCondition").Rows

                    Instr_SubjectDtlCSMSMedicalConditionNo += IIf(Instr_SubjectDtlCSMSMedicalConditionNo = "", "", ",").ToString + _
                                    tr("nSubjectDtlCSMSMedicalConditionNo").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of SubjectDtlCDMSMedicalCondition
            If Not objHelpDbTbl.getSubjectDtlCDMSMedicalCondition("nSubjectDtlCSMSMedicalConditionNo In (" + Instr_SubjectDtlCSMSMedicalConditionNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_MediCond, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving SubjectDtlCDMSMedicalCondition"
                Exit Function
            End If
            Tbl_MediCond.Columns.Add("vRemarks", System.Type.GetType("System.String"))

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If


            'Assignment of Values
            PkColArr(0) = "nSubjectDtlCSMSMedicalConditionNo"

            If Not objSave.AssignValues(Tbl_MediCond.TableName, PkColArr, Choice, _
                                        Ds_MediCond.Tables(Tbl_MediCond.TableName), _
                                        Tbl_MediCond, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in SubjectDtlCDMSMedicalCondition
            If Not objSave.SaveInDb("Insert_SubjectDtlCDMSMedicalCondition", Tbl_MediCond, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of SubjectDtlCDMSMedicalCondition In Database"
                Exit Function
            End If

            Save_SubjectDtlCDMSMedicalCondition = True

            If Save_SubjectDtlCDMSMedicalCondition Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving SubjectDtlCDMSMedicalCondition"
            Save_SubjectDtlCDMSMedicalCondition = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function

#End Region

#Region "Save_SubjectDtlCDMSConcoMedication"

    Public Function Save_SubjectDtlCDMSConcoMedication(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_Medication As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim Tbl_Medication As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Instr_SubjectDtlCDMSConcoMedicationNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_Medication Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            Tbl_Medication = New DataTable
            Tbl_Medication = Ds_Medication.Tables("SubjectDtlCDMSConcoMedication")

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_Medication.Tables("SubjectDtlCDMSConcoMedication").Rows

                    Instr_SubjectDtlCDMSConcoMedicationNo += IIf(Instr_SubjectDtlCDMSConcoMedicationNo = "", "", ",").ToString + _
                                    tr("nSubjectDtlCDMSConcoMedicationNo").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of SubjectDtlCDMSConcoMedication
            If Not objHelpDbTbl.getSubjectDtlCDMSConcoMedication("nSubjectDtlCDMSConcoMedicationNo In (" + Instr_SubjectDtlCDMSConcoMedicationNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_Medication, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving SubjectDtlCDMSConcoMedication"
                Exit Function
            End If
            Tbl_Medication.Columns.Add("vRemarks", System.Type.GetType("System.String"))

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If


            'Assignment of Values
            PkColArr(0) = "nSubjectDtlCDMSConcoMedicationNo"

            If Not objSave.AssignValues(Tbl_Medication.TableName, PkColArr, Choice, _
                                        Ds_Medication.Tables(Tbl_Medication.TableName), _
                                        Tbl_Medication, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in SubjectDtlCDMSConcoMedication
            If Not objSave.SaveInDb("Insert_SubjectDtlCDMSConcoMedication", Tbl_Medication, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of SubjectDtlCDMSConcoMedication In Database"
                Exit Function
            End If

            Save_SubjectDtlCDMSConcoMedication = True

            If Save_SubjectDtlCDMSConcoMedication Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving SubjectDtlCDMSConcoMedication"
            Save_SubjectDtlCDMSConcoMedication = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function

#End Region

#Region "Save_SubjectDtlCDMSConsumption"

    Public Function Save_SubjectDtlCDMSConsumption(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_Consumption As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim Tbl_Consumption As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Instr_SubjectDtlCDMSConsumptionNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_Consumption Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            Tbl_Consumption = New DataTable
            Tbl_Consumption = Ds_Consumption.Tables("SubjectDtlCDMSConsumption")

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_Consumption.Tables("SubjectDtlCDMSConsumption").Rows

                    Instr_SubjectDtlCDMSConsumptionNo += IIf(Instr_SubjectDtlCDMSConsumptionNo = "", "", ",").ToString + _
                                    tr("nSubjectDtlCDMSConsumptionNo").ToString

                Next tr
            End If



            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of SubjectDtlCDMSConsumption
            If Not objHelpDbTbl.getSubjectDtlCDMSConsumption("nSubjectDtlCDMSConsumptionNo In (" + Instr_SubjectDtlCDMSConsumptionNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_Consumption, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving SubjectDtlCDMSConsumption"
                Exit Function
            End If
            Tbl_Consumption.Columns.Add("vRemarks", System.Type.GetType("System.String"))

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If


            'Assignment of Values
            PkColArr(0) = "nSubjectDtlCDMSConsumptionNo"

            If Not objSave.AssignValues(Tbl_Consumption.TableName, PkColArr, Choice, _
                                        Ds_Consumption.Tables(Tbl_Consumption.TableName), _
                                        Tbl_Consumption, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in SubjectDtlCDMSConsumption
            If Not objSave.SaveInDb("Insert_SubjectDtlCDMSConsumption", Tbl_Consumption, DataObjOpenSaveModeEnum.DataObjOpenMode_Edit, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of SubjectDtlCDMSConsumption In Database"
                Exit Function
            End If

            Save_SubjectDtlCDMSConsumption = True

            If Save_SubjectDtlCDMSConsumption Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving SubjectDtlCDMSConsumption"
            Save_SubjectDtlCDMSConsumption = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function

#End Region

#Region "Insert_UpdateSubjectCDMSDtlField"

    Public Function Insert_UpdateSubjectCDMSDtlField(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Field As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing


        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            Tbl_Field = New DataTable
            Tbl_Field = Ds.Tables(0)

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            ' Save in Insert_UpdateSubjectCDMSDtlField
            If Not objSave.SaveInDb("Insert_UpdateSubjectCDMSDtlField", Tbl_Field, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of Insert_UpdateSubjectCDMSDtlField In Database"
                Exit Function
            End If

            Insert_UpdateSubjectCDMSDtlField = True

            If Insert_UpdateSubjectCDMSDtlField Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Insert_UpdateSubjectCDMSDtlField"
            Insert_UpdateSubjectCDMSDtlField = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function

#End Region

#Region "SaveWorkSpaceScreeningScheduleHdrDtl" '' CDMS DEBASHIS
    Public Function SaveWorkSpaceScreeningScheduleHdrDtl(ByVal Choice As DataObjOpenSaveModeEnum, _
                                      ByVal DsworkSpaceScreeningScheduleHdrDtl As Data.DataSet, _
                                      ByVal SaveDefaultValue As Boolean, _
                                      ByVal objDtLogic As ClsDataLogic_New, _
                                      ByVal UserCode_1 As String, _
                                      ByRef eStr_Retu As String) As Boolean


        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing


        Dim serverDateTime_1 As DateTime
        Dim Tbl_DsworkSpaceScreeningScheduleDtl As Data.DataTable = Nothing
        Dim Tbl_Top_DsworkSpaceScreeningScheduleDtl As Data.DataTable = Nothing
        Dim Tbl_DsworkSpaceScreeningScheduleHdr As Data.DataTable = Nothing
        Dim Tbl_DsExtraWorkSpaceScreeningScheduleDtl As Data.DataTable = Nothing
        Dim Tbl_Top_DsExtraWorkSpaceScreeningScheduleDtl As Data.DataTable = Nothing
        Dim Instr_workSpaceScreeningScheduleHdrNo As String = ""
        Dim Instr_workSpaceScreeningScheduleDtlNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing
        Dim RetuVal_RepeatNo As ParameterReturnValue = Nothing

        Dim DataReturnList_Mst As New ArrayList
        Dim RetuVal_Mst As ParameterReturnValue = Nothing
        Dim dr As DataRow


        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If DsworkSpaceScreeningScheduleHdrDtl Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If
            Tbl_DsExtraWorkSpaceScreeningScheduleDtl = DsworkSpaceScreeningScheduleHdrDtl.Tables("ExtraWorkSpaceScreeningScheduleDtl")
            Tbl_DsworkSpaceScreeningScheduleDtl = DsworkSpaceScreeningScheduleHdrDtl.Tables("workSpaceScreeningScheduleDtl")
            Tbl_DsworkSpaceScreeningScheduleHdr = DsworkSpaceScreeningScheduleHdrDtl.Tables("workSpaceScreeningScheduleHdr")



            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)


            If SaveDefaultValue = True Then

                ' Save in workSpaceScreeningScheduleHdr
                If Not objSave.SaveInDb("Insert_WorkSpaceScreeningScheduleHdr", Tbl_DsworkSpaceScreeningScheduleHdr, Choice, DataReturnList, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of workSpaceScreeningScheduleHdr In Database"
                    Exit Function
                End If
                'Assiging New HdrNo 
                DataReturnList = DataReturnList.Item(0)
                RetuVal = DataReturnList.Item(0)

                For Each dr In Tbl_DsworkSpaceScreeningScheduleDtl.Rows
                    dr("nWorkSpaceScreeningScheduleHdrId") = RetuVal.ParameterValue
                    dr.AcceptChanges()
                Next
                Tbl_DsworkSpaceScreeningScheduleDtl.AcceptChanges()
                '********************************************

                ' Save in workSpaceScreeningScheduleDtl
                DataReturnList = Nothing
                DataReturnList = New ArrayList

                If Not objSave.SaveInDb("Insert_WorkSpaceScreeningScheduleDtl", Tbl_DsworkSpaceScreeningScheduleDtl, Choice, DataReturnList, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of workSpaceScreeningScheduleDtl In Database"
                    SaveWorkSpaceScreeningScheduleHdrDtl = False
                    objDtLogic.RollBack_Transaction()
                    Exit Function
                End If
                objDtLogic.Commit_Transaction()
                '*************************************
            ElseIf SaveDefaultValue = False Then

                If Tbl_DsExtraWorkSpaceScreeningScheduleDtl Is Nothing Then

                    If Not objSave.SaveInDb("Insert_WorkSpaceScreeningScheduleHdr", Tbl_DsworkSpaceScreeningScheduleHdr, Choice, DataReturnList, eStr_Retu) Then
                        eStr_Retu += vbCrLf + "Error occured while Save Information of workSpaceScreeningScheduleHdr In Database"
                        Exit Function
                    End If

                    DataReturnList = DataReturnList.Item(0)
                    RetuVal = DataReturnList.Item(0)

                    DataReturnList = Nothing
                    DataReturnList = New ArrayList

                    If Not objSave.SaveInDb("Insert_WorkSpaceScreeningScheduleDtl", Tbl_DsworkSpaceScreeningScheduleDtl, Choice, DataReturnList, eStr_Retu) Then
                        eStr_Retu += vbCrLf + "Error occured while Save Information of workSpaceScreeningScheduleDtl In Database"
                        SaveWorkSpaceScreeningScheduleHdrDtl = False
                        objDtLogic.RollBack_Transaction()
                        Exit Function
                    End If
                    objDtLogic.Commit_Transaction()


                Else
                    Dim NewTbl_DsExtraWorkSpaceScreeningScheduleDtl As DataTable
                    Dim NewTbl_DsWorkSpaceScreeningScheduleDtl As DataTable


                    Tbl_DsExtraWorkSpaceScreeningScheduleDtl.DefaultView.RowFilter = "cStatus <> 'NR'"
                    NewTbl_DsExtraWorkSpaceScreeningScheduleDtl = Tbl_DsExtraWorkSpaceScreeningScheduleDtl.DefaultView.ToTable

                    If NewTbl_DsExtraWorkSpaceScreeningScheduleDtl.Rows.Count <> 0 Then

                        For i As Integer = 0 To NewTbl_DsExtraWorkSpaceScreeningScheduleDtl.Rows.Count - 1
                            NewTbl_DsExtraWorkSpaceScreeningScheduleDtl.Rows(i)("cStatus") = "U"
                        Next

                        If Not objSave.SaveInDb("Insert_WorkSpaceScreeningScheduleDtl", NewTbl_DsExtraWorkSpaceScreeningScheduleDtl, Choice, DataReturnList, eStr_Retu) Then
                            eStr_Retu += vbCrLf + "Error occured while Save Information of workSpaceScreeningScheduleDtl In Database"
                            SaveWorkSpaceScreeningScheduleHdrDtl = False
                            objDtLogic.RollBack_Transaction()
                            Exit Function
                        End If


                        If Not objSave.SaveInDb("Insert_WorkSpaceScreeningScheduleHdr", Tbl_DsworkSpaceScreeningScheduleHdr, Choice, DataReturnList, eStr_Retu) Then
                            eStr_Retu += vbCrLf + "Error occured while Save Information of workSpaceScreeningScheduleHdr In Database"
                            Exit Function
                        End If

                        DataReturnList = DataReturnList.Item(0)
                        RetuVal = DataReturnList.Item(0)

                        DataReturnList = Nothing
                        DataReturnList = New ArrayList

                        Tbl_DsworkSpaceScreeningScheduleDtl.DefaultView.RowFilter = "cStatusIndi = 'N'"
                        NewTbl_DsWorkSpaceScreeningScheduleDtl = Tbl_DsworkSpaceScreeningScheduleDtl.DefaultView.ToTable


                        If Not objSave.SaveInDb("Insert_WorkSpaceScreeningScheduleDtl", NewTbl_DsWorkSpaceScreeningScheduleDtl, Choice, DataReturnList, eStr_Retu) Then
                            eStr_Retu += vbCrLf + "Error occured while Save Information of workSpaceScreeningScheduleDtl In Database"
                            SaveWorkSpaceScreeningScheduleHdrDtl = False
                            objDtLogic.RollBack_Transaction()
                            Exit Function
                        End If

                    Else
                        If Not objSave.SaveInDb("Insert_WorkSpaceScreeningScheduleHdr", Tbl_DsworkSpaceScreeningScheduleHdr, Choice, DataReturnList, eStr_Retu) Then
                            eStr_Retu += vbCrLf + "Error occured while Save Information of workSpaceScreeningScheduleHdr In Database"
                            Exit Function
                        End If

                        DataReturnList = DataReturnList.Item(0)
                        RetuVal = DataReturnList.Item(0)

                        DataReturnList = Nothing
                        DataReturnList = New ArrayList

                        'Dim Temp1_Tbl_DsworkSpaceScreeningScheduleDtl As DataTable
                        'Dim Temp2_Tbl_DsworkSpaceScreeningScheduleDtl As DataTable
                        'Dim TempNewTbl_DsWorkSpaceScreeningScheduleDtl As DataTable

                        'Temp1_Tbl_DsworkSpaceScreeningScheduleDtl = Tbl_DsworkSpaceScreeningScheduleDtl.Copy
                        'Temp2_Tbl_DsworkSpaceScreeningScheduleDtl = Tbl_DsworkSpaceScreeningScheduleDtl.Copy

                        'Temp1_Tbl_DsworkSpaceScreeningScheduleDtl.DefaultView.RowFilter = "cStatus = 'U'" + "AND cStatusIndi = 'D'"
                        'TempNewTbl_DsWorkSpaceScreeningScheduleDtl = Temp1_Tbl_DsworkSpaceScreeningScheduleDtl.DefaultView.ToTable

                        'If Not objSave.SaveInDb("Insert_WorkSpaceScreeningScheduleDtl", TempNewTbl_DsWorkSpaceScreeningScheduleDtl, Choice, DataReturnList, eStr_Retu) Then
                        '    eStr_Retu += vbCrLf + "Error occured while Save Information of workSpaceScreeningScheduleDtl In Database"
                        '    SaveWorkSpaceScreeningScheduleHdrDtl = False
                        '    objDtLogic.RollBack_Transaction()
                        '    Exit Function
                        'End If


                        Tbl_DsworkSpaceScreeningScheduleDtl.DefaultView.RowFilter = "cStatusIndi = 'N'"
                        NewTbl_DsWorkSpaceScreeningScheduleDtl = Tbl_DsworkSpaceScreeningScheduleDtl.DefaultView.ToTable


                        If Not objSave.SaveInDb("Insert_WorkSpaceScreeningScheduleDtl", Tbl_DsworkSpaceScreeningScheduleDtl, Choice, DataReturnList, eStr_Retu) Then
                            eStr_Retu += vbCrLf + "Error occured while Save Information of workSpaceScreeningScheduleDtl In Database"
                            SaveWorkSpaceScreeningScheduleHdrDtl = False
                            objDtLogic.RollBack_Transaction()
                            Exit Function
                        End If


                    End If
                    objDtLogic.Commit_Transaction()
                End If

            End If



            'Else

            '    'Function called only if edit is called
            '    If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
            '        For Each tr As Data.DataRow In Ds_CRFHdrDtlSubDtl.Tables("CRFHdr").Rows

            '            Instr_CRFHdrNo += IIf(Instr_CRFHdrNo = "", "", ",").ToString + _
            '                              tr("nCRFHdrNo").ToString.Trim()

            '        Next tr
            '    End If

            '    If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
            '        dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            '    Else
            '        dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            '    End If

            '    'Retrieval of CRFHdr
            '    If Not objHelpDbTbl.GetCRFHdr("nCRFHdrNo In (" + Instr_CRFHdrNo + ")", dataRet_1, _
            '                                    objDtLogic, Tbl_CRFHdr, eStr_Retu) Then

            '        eStr_Retu += vbCrLf + "Error occured while retrieving CRFHdr"
            '        Exit Function
            '    End If


            '    'Retrieval of Online_AuditInfo
            '    If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
            '                                      Tbl_Audit, eStr_Retu) Then
            '        eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
            '        Exit Function
            '    End If

            '    'Assignment of Values
            '    PkColArr(0) = "nCRFHdrNo"
            '    Tbl_Audit = New DataTable()

            '    If Not objSave.AssignValues(Tbl_CRFHdr.TableName, PkColArr, Choice, _
            '                                Ds_CRFHdrDtlSubDtl.Tables(Tbl_CRFHdr.TableName), _
            '                                Tbl_CRFHdr, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
            '        eStr_Retu += vbCrLf + "Error occured while assigning values"
            '        Exit Function
            '    End If

            '    ' Save in CRFHdr

            '    If Not objSave.SaveInDb("Insert_CRFHdr", Tbl_CRFHdr, Choice, DataReturnList, eStr_Retu) Then
            '        eStr_Retu += vbCrLf + "Error occured while Save Information of CRFHdr In Database"
            '        Exit Function
            '    End If
            '    'Assiging New HdrNo 
            '    DataReturnList = DataReturnList.Item(0)
            '    RetuVal = DataReturnList.Item(0)

            '    For Each dr In Tbl_CRFDtl.Rows
            '        dr("nCRFHdrNo") = RetuVal.ParameterValue
            '        dr.AcceptChanges()
            '    Next
            '    Tbl_CRFDtl.AcceptChanges()
            '    '********************************************

            '    ' Save in CRFDtl
            '    If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
            '        'First we are saving only first Row and after that will save other rows 
            '        'for getting Return value (iscreenId) for Bulk Save with same iScreenId

            '        'To Add Only first row into the table and get itranNo as return value
            '        Tbl_Top_CRFDtl = Tbl_CRFDtl.Copy
            '        For i = Tbl_Top_CRFDtl.Rows.Count - 1 To 1 Step -1
            '            Tbl_Top_CRFDtl.Rows(i).Delete()
            '            Tbl_Top_CRFDtl.AcceptChanges()
            '        Next
            '        'Here first record go as tran No 0 because as per the condition in Procedure for getting new tran No.
            '        For Each dr In Tbl_Top_CRFDtl.Rows
            '            dr("iRepeatNo") = 0
            '            dr.AcceptChanges()
            '        Next
            '        Tbl_Top_CRFDtl.AcceptChanges()

            '        DataReturnList = Nothing
            '        DataReturnList = New ArrayList

            '        If Not objSave.SaveInDb("Insert_CRFDtl", Tbl_Top_CRFDtl, Choice, DataReturnList, eStr_Retu) Then
            '            eStr_Retu += vbCrLf + "Error occured while Save Information of CRFDtl In Database"
            '            Exit Function
            '        End If
            '        '*************************************

            '        Tbl_CRFDtl.Rows(0).Delete()
            '        Tbl_CRFDtl.AcceptChanges()

            '        'Assiging New iTranno for Other than first rows
            '        DataReturnList = DataReturnList.Item(0)
            '        RetuVal = DataReturnList.Item(0)
            '        RetuVal_RepeatNo = DataReturnList.Item(1)

            '        If RetuVal.ParameterValue = 0 AndAlso RetuVal_RepeatNo.ParameterValue = 0 Then
            '            eStr_Retu = "Entry already done in this page, Kindly open the page again to change the data."
            '            Save_WorkSpaceScreeningScheduleHdrDtl = False
            '            objDtLogic.RollBack_Transaction()
            '            Exit Function
            '        End If

            '        'For updating DAta status of CRF entry at the end of this method
            '        For Each dr In Tbl_CRFDtl.Rows
            '            dr("nCRFDtlNo") = RetuVal.ParameterValue
            '            dr("iRepeatNo") = RetuVal_RepeatNo.ParameterValue
            '            dr.AcceptChanges()
            '        Next
            '        Tbl_CRFDtl.AcceptChanges()

            '        'Assigning Repeat no for updating flag of CRF entry at the end of this method
            '        For Each dr In Tbl_Top_CRFDtl.Rows
            '            dr("nCRFDtlNo") = RetuVal.ParameterValue
            '            dr("iRepeatNo") = RetuVal_RepeatNo.ParameterValue
            '            dr.AcceptChanges()
            '        Next
            '        Tbl_Top_CRFDtl.AcceptChanges()
            '        '*********************

            '    End If

            '    'Now saving Remaining Rows with same iRepeatNo
            '    If Tbl_CRFDtl.Rows.Count > 0 Then
            '        DataReturnList = Nothing
            '        DataReturnList = New ArrayList
            '        If Not objSave.SaveInDb("Insert_CRFDtl", Tbl_CRFDtl, Choice, DataReturnList, eStr_Retu) Then
            '            eStr_Retu += vbCrLf + "Error occured while Save Information of CRFDtl In Database"
            '            Exit Function
            '        End If
            '        DataReturnList = DataReturnList.Item(0)
            '    End If
            '    '********************************************

            '    'Assiging New DtlNo 
            '    If DataReturnList.Count > 0 Then
            '        RetuVal = DataReturnList.Item(0)
            '        RetuVal_RepeatNo = DataReturnList.Item(1)

            '        'For updating DAta status of CRF entry at the end of this method
            '        For Each dr In Tbl_CRFDtl.Rows
            '            dr("nCRFDtlNo") = RetuVal.ParameterValue
            '            dr("iRepeatNo") = RetuVal_RepeatNo.ParameterValue
            '            dr.AcceptChanges()
            '        Next
            '        Tbl_CRFDtl.AcceptChanges()
            '        '*************************************

            '        For Each dr In Tbl_CRFSubDtl.Rows
            '            dr("nCRFDtlNo") = RetuVal.ParameterValue
            '            dr.AcceptChanges()
            '        Next
            '        Tbl_CRFSubDtl.AcceptChanges()

            '        '********************************************
            '        'Assiging New DtlNo in DCF
            '        If Not Tbl_DCFMst Is Nothing Then
            '            For Each dr In Tbl_DCFMst.Rows
            '                dr("nCRFDtlNo") = RetuVal.ParameterValue
            '                dr.AcceptChanges()
            '            Next
            '            Tbl_DCFMst.AcceptChanges()
            '            '**********************************
            '        End If
            '    End If

            ' Save in CRFDtl
            'If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
            '    'First we are saving only first Row and after that will save other rows 
            '    'for getting Return value (iscreenId) for Bulk Save with same iScreenId

            '    'To Add Only first row into the table and get itranNo as return value

            '    Tbl_Top_CRFSubDtl = Tbl_CRFSubDtl.Copy
            '    For i = Tbl_Top_CRFSubDtl.Rows.Count - 1 To 1 Step -1
            '        Tbl_Top_CRFSubDtl.Rows(i).Delete()
            '        Tbl_Top_CRFSubDtl.AcceptChanges()
            '    Next
            '    'Here first record go as tran No 0 because as per the condition in Procedure for getting new tran No.
            '    For Each dr In Tbl_Top_CRFSubDtl.Rows
            '        dr("iTranNo") = 0
            '        dr.AcceptChanges()
            '    Next
            '    Tbl_Top_CRFSubDtl.AcceptChanges()

            '    DataReturnList = Nothing
            '    DataReturnList = New ArrayList

            '    If Not objSave.SaveInDb("Insert_CRFSubDtl", Tbl_Top_CRFSubDtl, DataObjOpenSaveModeEnum.DataObjOpenMode_Add, DataReturnList, eStr_Retu) Then
            '        eStr_Retu += vbCrLf + "Error occured while Save Information of CRFSubDtl In Database"
            '        Exit Function
            '    End If
            '    '*************************************

            '    Tbl_CRFSubDtl.Rows(0).Delete()
            '    Tbl_CRFSubDtl.AcceptChanges()

            '    'Assiging New iTranno for Other than first rows
            '    DataReturnList = DataReturnList.Item(0)
            '    RetuVal = DataReturnList.Item(0)
            '    For Each dr In Tbl_CRFSubDtl.Rows
            '        dr("iTranNo") = RetuVal.ParameterValue
            '        dr.AcceptChanges()
            '    Next

            '    Tbl_CRFSubDtl.AcceptChanges()

            'End If

            ''Now saving Remaining Rows with same iTranNo
            'If Not objSave.SaveInDb("Insert_CRFSubDtl", Tbl_CRFSubDtl, DataObjOpenSaveModeEnum.DataObjOpenMode_Add, Nothing, eStr_Retu) Then
            '    eStr_Retu += vbCrLf + "Error occured while Save Information of CRFSubDtl In Database"
            '    Exit Function
            'End If
            ''********************************************



            'Updating DataStatus flag of CRFDtl on 01-Feb-2010
            '    If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
            '        If Not Tbl_Top_CRFDtl Is Nothing Then
            '            If Tbl_Top_CRFDtl.Rows.Count > 0 Then
            '                DataReturnList = Nothing
            '                DataReturnList = New ArrayList

            '                For Each dr In Tbl_Top_CRFDtl.Rows
            '                    If dr("cDataStatus") = "C" Then
            '                        dr("cDataStatus") = "D"
            '                    End If
            '                Next
            '                Tbl_Top_CRFDtl.AcceptChanges()

            '                If Not objSave.SaveInDb("Insert_CRFDtl", Tbl_Top_CRFDtl, Choice, DataReturnList, eStr_Retu) Then
            '                    eStr_Retu += vbCrLf + "Error occured while Save Information of CRFDtl In Database"
            '                    Exit Function
            '                End If
            '            End If
            '        End If
            '    End If
            '    If Tbl_CRFDtl.Rows.Count > 0 Then
            '        DataReturnList = Nothing
            '        DataReturnList = New ArrayList
            '        For Each dr In Tbl_CRFDtl.Rows
            '            If dr("cDataStatus") = "C" Then
            '                dr("cDataStatus") = "D"
            '            End If
            '        Next
            '        Tbl_CRFDtl.AcceptChanges()

            '        If Not objSave.SaveInDb("Insert_CRFDtl", Tbl_CRFDtl, Choice, DataReturnList, eStr_Retu) Then
            '            eStr_Retu += vbCrLf + "Error occured while Save Information of CRFDtl In Database"
            '            Exit Function
            '        End If
            '    End If
            '    '****************************

            'End If

            'SaveWorkSpaceScreeningScheduleHdrDtl = True

            'If SaveWorkSpaceScreeningScheduleHdrDtl Then
            '    objDtLogic.Commit_Transaction()
            'Else
            '    objDtLogic.RollBack_Transaction()
            'End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Save_WorkSpaceScreeningScheduleHdrDtl"
            SaveWorkSpaceScreeningScheduleHdrDtl = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "Save_WorkSpaceScreeningScheduleDtl"
    Public Function Save_WorkSpaceScreeningScheduleDtl(ByVal Choice As DataObjOpenSaveModeEnum, _
                                         ByVal Ds_WorkSpaceScreeningScheduleDtl As Data.DataSet, _
                                         ByVal objDtLogic As ClsDataLogic_New, _
                                         ByVal UserCode_1 As String, _
                                         ByRef eStr_Retu As String) As Boolean


        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing
        Dim serverDateTime_1 As DateTime
        Dim Tbl_WorkSpaceScreeningScheduleDtl As Data.DataTable = Nothing
        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing
        Dim ds_Consumption As New DataSet
        Dim ds_Field As New DataSet
        Dim dt_Field As New DataTable
        Dim dr_Field As DataRow


        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_WorkSpaceScreeningScheduleDtl Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If
            Tbl_WorkSpaceScreeningScheduleDtl = Ds_WorkSpaceScreeningScheduleDtl.Tables(0)

            'Function called only if edit is called

            'If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
            '    dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            'Else
            '    dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            'End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            PkColArr(0) = "nWorkSpaceScreeningScheduleDtlId"

            dt_Field.Columns.Add("vSubjectID", Type.GetType("System.String"))
            dt_Field.Columns.Add("vTableName", Type.GetType("System.String"))
            dt_Field.Columns.Add("vColumnName", Type.GetType("System.String"))
            dt_Field.Columns.Add("vChangedValue", Type.GetType("System.String"))
            dt_Field.Columns.Add("vRemarks", Type.GetType("System.String"))
            dt_Field.Columns.Add("iModifyBy", Type.GetType("System.Int32"))
            dt_Field.Columns.Add("dStartDate", Type.GetType("System.String"))
            dt_Field.Columns.Add("dEndDate", Type.GetType("System.String"))

            dr_Field = dt_Field.NewRow
            dr_Field("vSubjectID") = Tbl_WorkSpaceScreeningScheduleDtl.Rows(0)("vSubjectId")
            dr_Field("vTableName") = "SUBJECTDTLCDMS"
            dr_Field("vColumnName") = "cStatus"
            If Tbl_WorkSpaceScreeningScheduleDtl.Rows(0)("cStatus") = "B" Then
                dr_Field("vChangedValue") = "BO"
            Else
                dr_Field("vChangedValue") = "AC"
            End If
            dr_Field("vRemarks") = System.DBNull.Value
            dr_Field("dStartDate") = System.DBNull.Value
            dr_Field("dEndDate") = System.DBNull.Value
            dr_Field("iModifyBy") = Tbl_WorkSpaceScreeningScheduleDtl.Rows(0)("iModifyBy")
            dt_Field.Rows.Add(dr_Field)

            ds_Field.Tables.Add(dt_Field)

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Delete Then
                Tbl_WorkSpaceScreeningScheduleDtl.Rows(0)("vSubjectId") = System.DBNull.Value
            End If



            If Not objSave.SaveInDb("Insert_WorkSpaceScreeningScheduleDtl", Tbl_WorkSpaceScreeningScheduleDtl, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of workSpaceScreeningScheduleDtl In Database"
                Save_WorkSpaceScreeningScheduleDtl = False
                objDtLogic.RollBack_Transaction()
                Exit Function
            End If

            ' Change by Jeet Patel on 30-APR-2015 to retrive message from Stored Procedure
            DataReturnList = DataReturnList.Item(0)
            RetuVal = DataReturnList.Item(0)
            If RetuVal.ParameterValue = "" Then
                If Not objSave.SaveInDb("Insert_UpdateSubjectCDMSDtlField", ds_Field.Tables(0), DataObjOpenSaveModeEnum.DataObjOpenMode_Add, DataReturnList, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of Insert_UpdateSubjectCDMSDtlField In Database"
                    Exit Function
                End If
                Save_WorkSpaceScreeningScheduleDtl = True
            Else
                eStr_Retu = RetuVal.ParameterValue
                Save_WorkSpaceScreeningScheduleDtl = False
            End If
            '---------------------------------------------------------------------------------

            ''Save in Insert_UpdateSubjectCDMSDtlField
            'If Not objSave.SaveInDb("Insert_UpdateSubjectCDMSDtlField", ds_Field.Tables(0), DataObjOpenSaveModeEnum.DataObjOpenMode_Add, DataReturnList, eStr_Retu) Then
            '    eStr_Retu += vbCrLf + "Error occured while Save Information of Insert_UpdateSubjectCDMSDtlField In Database"
            '    Exit Function
            'End If
            'Save_WorkSpaceScreeningScheduleDtl = True

            If Save_WorkSpaceScreeningScheduleDtl Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving workSpaceScreeningScheduleDtl"
            Save_WorkSpaceScreeningScheduleDtl = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "Save_ProjectDtlCDMSConcoMedication"

    Public Function Save_ProjectDtlCDMSConcoMedication(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_Medication As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim Tbl_Medication As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Instr_ProjectDtlCDMSConcoMedicationNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_Medication Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            Tbl_Medication = New DataTable
            Tbl_Medication = Ds_Medication.Tables("ProjectDtlCDMSConcoMedication")

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_Medication.Tables("ProjectDtlCDMSConcoMedication").Rows

                    Instr_ProjectDtlCDMSConcoMedicationNo += IIf(Instr_ProjectDtlCDMSConcoMedicationNo = "", "", ",").ToString + _
                                    tr("nProjectDtlCDMSConcoMedicationNo").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of SubjectDtlCDMSConcoMedication
            If Not objHelpDbTbl.getProjectDtlCDMSConcoMedication("nProjectDtlCDMSConcoMedicationNo In (" + Instr_ProjectDtlCDMSConcoMedicationNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_Medication, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving ProjectDtlCDMSConcoMedication"
                Exit Function
            End If
            Tbl_Medication.Columns.Add("vRemarks", System.Type.GetType("System.String"))

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If


            'Assignment of Values
            PkColArr(0) = "nProjectDtlCDMSConcoMedicationNo"

            If Not objSave.AssignValues(Tbl_Medication.TableName, PkColArr, Choice, _
                                        Ds_Medication.Tables(Tbl_Medication.TableName), _
                                        Tbl_Medication, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in SubjectDtlCDMSConcoMedication
            If Not objSave.SaveInDb("Insert_ProjectDtlCDMSConcoMedication", Tbl_Medication, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of ProjectDtlCDMSConcoMedication In Database"
                Exit Function
            End If

            Save_ProjectDtlCDMSConcoMedication = True

            If Save_ProjectDtlCDMSConcoMedication Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving ProjectDtlCDMSConcoMedication"
            Save_ProjectDtlCDMSConcoMedication = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function

#End Region

#Region "Save_ProjectDtlCDMSMedicalCondition"

    Public Function Save_ProjectDtlCDMSMedicalCondition(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_MediCond As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim Tbl_MediCond As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Instr_ProjectDtlCSMSMedicalConditionNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_MediCond Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            Tbl_MediCond = New DataTable
            Tbl_MediCond = Ds_MediCond.Tables("ProjectDtlCDMSMedicalCondition")

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_MediCond.Tables("ProjectDtlCDMSMedicalCondition").Rows

                    Instr_ProjectDtlCSMSMedicalConditionNo += IIf(Instr_ProjectDtlCSMSMedicalConditionNo = "", "", ",").ToString + _
                                    tr("nProjectDtlCSMSMedicalConditionNo").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of ProjectDtlCDMSMedicalCondition
            If Not objHelpDbTbl.getProjectDtlCDMSMedicalCondition("nProjectDtlCSMSMedicalConditionNo In (" + Instr_ProjectDtlCSMSMedicalConditionNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_MediCond, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving ProjectDtlCDMSMedicalCondition"
                Exit Function
            End If
            Tbl_MediCond.Columns.Add("vRemarks", System.Type.GetType("System.String"))

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If


            'Assignment of Values
            PkColArr(0) = "nProjectDtlCSMSMedicalConditionNo"

            If Not objSave.AssignValues(Tbl_MediCond.TableName, PkColArr, Choice, _
                                        Ds_MediCond.Tables(Tbl_MediCond.TableName), _
                                        Tbl_MediCond, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in SubjectDtlCDMSMedicalCondition
            If Not objSave.SaveInDb("Insert_ProjectDtlCDMSMedicalCondition", Tbl_MediCond, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of ProjectDtlCDMSMedicalCondition In Database"
                Exit Function
            End If

            Save_ProjectDtlCDMSMedicalCondition = True

            If Save_ProjectDtlCDMSMedicalCondition Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving ProjectDtlCDMSMedicalCondition"
            Save_ProjectDtlCDMSMedicalCondition = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function

#End Region

#Region "Save_StudyDtlCDMS"

    Public Function Save_StudyDtlCDMS(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_StudyCDMS As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim Tbl_CDMStudyDtl As Data.DataTable = Nothing
        Dim Tbl_CDMDtlHistory As Data.DataTable = Nothing
        Dim Tbl_CDMDtlConsu As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_Study As Data.DataTable = Nothing
        Dim Instr_WorkspaceID As String = ""


        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_StudyCDMS Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            Tbl_CDMStudyDtl = New DataTable
            Tbl_CDMStudyDtl = Ds_StudyCDMS.Tables("StudyDtlCDMS")
            Tbl_CDMDtlHistory = New DataTable
            Tbl_CDMDtlHistory = Ds_StudyCDMS.Tables("StudyDtlCDMSHistory")
            Tbl_CDMDtlConsu = New DataTable
            Tbl_CDMDtlConsu = Ds_StudyCDMS.Tables("StudyDtlCDMSConsumption")

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_StudyCDMS.Tables("StudyDtlCDMS").Rows

                    Instr_WorkspaceID += IIf(Instr_WorkspaceID = "", "", ",").ToString + _
                                    tr("vWorkSpaceId").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of StudyDtl
            If Not objHelpDbTbl.getStudyDtlCDMS("vWorkSpaceId In ('" + Instr_WorkspaceID + "')", dataRet_1, _
                                            objDtLogic, Tbl_Study, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving Subject Master"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nStudyDtlCDMSNo"

            If Not objSave.AssignValues(Tbl_Study.TableName, PkColArr, Choice, _
                                        Ds_StudyCDMS.Tables(Tbl_Study.TableName), _
                                        Tbl_Study, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            Tbl_Study = Tbl_CDMStudyDtl

            ' Save in StudyDtl
            If Not objSave.SaveInDb("Insert_StudyDtlCDMS", Tbl_Study, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of StudyDtl In Database"
                Exit Function
            End If


            If Not Tbl_CDMDtlHistory Is Nothing Then
                'Save in StudyDtlCDMSHistory
                If Not objSave.SaveInDb("Insert_StudyDtlCDMSHistory", Tbl_CDMDtlHistory, Choice, Nothing, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of StudyDtlCDMSHistory Detail In Database"
                    Exit Function
                End If
            End If

            Tbl_CDMDtlConsu.Columns.Add("vRemarks", System.Type.GetType("System.String"))
            If Not Tbl_CDMDtlConsu Is Nothing Then
                'Save in StudyDtlCDMSConsumption
                If Not objSave.SaveInDb("Insert_StudyDtlCDMSConsumption", Tbl_CDMDtlConsu, Choice, Nothing, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of StudyDtlCDMSConsumption Detail In Database"
                    Exit Function
                End If
            End If


            Save_StudyDtlCDMS = True

            If Save_StudyDtlCDMS Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving StudyDtl"
            Save_StudyDtlCDMS = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function

#End Region

#Region "Save_StudyDtlCDMSConsumption"

    Public Function Save_StudyDtlCDMSConsumption(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_Consumption As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim Tbl_Consumption As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Instr_StudyDtlCDMSConsumptionNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_Consumption Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            Tbl_Consumption = New DataTable
            Tbl_Consumption = Ds_Consumption.Tables("StudyDtlCDMSConsumption")

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_Consumption.Tables("StudyDtlCDMSConsumption").Rows

                    Instr_StudyDtlCDMSConsumptionNo += IIf(Instr_StudyDtlCDMSConsumptionNo = "", "", ",").ToString + _
                                    tr("nStudyDtlCDMSConsumptionNo").ToString

                Next tr
            End If



            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of StudyDtlCDMSConsumption
            If Not objHelpDbTbl.getStudyDtlCDMSConsumption("nStudyDtlCDMSConsumptionNo In (" + Instr_StudyDtlCDMSConsumptionNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_Consumption, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving StudyDtlCDMSConsumption"
                Exit Function
            End If
            Tbl_Consumption.Columns.Add("vRemarks", System.Type.GetType("System.String"))

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If


            'Assignment of Values
            PkColArr(0) = "nStudyDtlCDMSConsumptionNo"

            If Not objSave.AssignValues(Tbl_Consumption.TableName, PkColArr, Choice, _
                                        Ds_Consumption.Tables(Tbl_Consumption.TableName), _
                                        Tbl_Consumption, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in StudyDtlCDMSConsumption
            If Not objSave.SaveInDb("Insert_StudyDtlCDMSConsumption", Tbl_Consumption, DataObjOpenSaveModeEnum.DataObjOpenMode_Edit, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of StudyDtlCDMSConsumption In Database"
                Exit Function
            End If

            Save_StudyDtlCDMSConsumption = True

            If Save_StudyDtlCDMSConsumption Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving StudyDtlCDMSConsumption"
            Save_StudyDtlCDMSConsumption = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function

#End Region

#Region "Insert_UpdateStudyCDMSDtlField"

    Public Function Insert_UpdateStudyCDMSDtlField(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Field As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing


        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            Tbl_Field = New DataTable
            Tbl_Field = Ds.Tables(0)

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            ' Save in Insert_UpdateStudyCDMSDtlField
            If Not objSave.SaveInDb("Insert_UpdateStudyCDMSDtlField", Tbl_Field, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of Insert_UpdateStudyCDMSDtlField In Database"
                Exit Function
            End If

            Insert_UpdateStudyCDMSDtlField = True

            If Insert_UpdateStudyCDMSDtlField Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Insert_UpdateStudyCDMSDtlField"
            Insert_UpdateStudyCDMSDtlField = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function

#End Region

#Region "Insert_DataEntryControlHistory"
    Public Function insert_DataEntryControlHistory(ByVal Choice As DataObjOpenSaveModeEnum, _
                                             ByVal ds_DataEntryControl As DataSet, _
                                             ByVal objDtLogic As ClsDataLogic_New, _
                                            ByRef eStr_Retu As String) As Boolean


        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing



        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If ds_DataEntryControl Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Assignment of Values
            objSave = New SaveDataInDbObj(objDtLogic)

            If Not objSave.SaveInDb("insert_DataEntryControlHistory", ds_DataEntryControl.Tables(0), Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information in DataEntryControlHistory"
                Exit Function
            End If

            insert_DataEntryControlHistory = True

            If insert_DataEntryControlHistory Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while Rejecting subject"
            insert_DataEntryControlHistory = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function '' By Dipen Shah
#End Region


#Region "insert_DataEntryControl"
    Public Function insert_DataEntryControl(ByVal Choice As DataObjOpenSaveModeEnum, _
                                              ByVal ds_DataEntryControl As DataSet, _
                                              ByVal objDtLogic As ClsDataLogic_New, _
                                             ByRef eStr_Retu As String, _
                                             ByRef Return_Val As Char) As Boolean


        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing



        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If ds_DataEntryControl Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Assignment of Values
            objSave = New SaveDataInDbObj(objDtLogic)

            If Not objSave.SaveInDb("insert_DataEntryControl", ds_DataEntryControl.Tables(0), Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information in WorkspaceScreeningDtl"
                Exit Function
            End If
            DataReturnList = DataReturnList.Item(0)
            RetuVal = DataReturnList.Item(0)
            Return_Val = RetuVal.ParameterValue

            insert_DataEntryControl = True

            If insert_DataEntryControl Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while Rejecting subject"
            insert_DataEntryControl = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region ''By Megha 

#Region "insert_WorkspaceEditChecksDtl"
    Public Function insert_WorkspaceEditChecksDtl(ByVal Choice As DataObjOpenSaveModeEnum, _
                                              ByVal ds_WorkspaceEditChecksDtl As DataSet, _
                                              ByVal objDtLogic As ClsDataLogic_New, _
                                             ByRef eStr_Retu As String) As Boolean


        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing



        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If ds_WorkspaceEditChecksDtl Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Assignment of Values
            objSave = New SaveDataInDbObj(objDtLogic)

            If Not objSave.SaveInDb("insert_WorkspaceEditChecksDtl", ds_WorkspaceEditChecksDtl.Tables(0), Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information in WorkspaceScreeningDtl"
                Exit Function
            End If

            insert_WorkspaceEditChecksDtl = True

            If insert_WorkspaceEditChecksDtl Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error While Saveing Resolved Remarks"
            insert_WorkspaceEditChecksDtl = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region ''By Megha 

#Region "Save_SubjectDtlCDMSStudyHistory"

    Public Function Save_SubjectDtlCDMSStudyHistory(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_StudyHistory As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim Tbl_StudyHistory As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Instr_SubjectDtlCDMSStudyHistory As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_StudyHistory Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            Tbl_StudyHistory = New DataTable
            Tbl_StudyHistory = Ds_StudyHistory.Tables(0)

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_StudyHistory.Tables(0).Rows

                    Instr_SubjectDtlCDMSStudyHistory += IIf(Instr_SubjectDtlCDMSStudyHistory = "", "", ",").ToString + _
                                    tr("nSubjectDtlCDMSStudyHistoryNo").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of SubjectDtlCDMSStudyHistory
            If Not objHelpDbTbl.getSubjectDtlCDMSStudyHistory("nSubjectDtlCDMSStudyHistoryNo In (" + Instr_SubjectDtlCDMSStudyHistory + ")", dataRet_1, _
                                            objDtLogic, Tbl_StudyHistory, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving SubjectDtlCDMSStudyHistory"
                Exit Function
            End If

            Tbl_StudyHistory.Columns.Add("vRemarks", System.Type.GetType("System.String"))

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If


            'Assignment of Values
            PkColArr(0) = "nSubjectDtlCDMSStudyHistoryNo"

            If Not objSave.AssignValues(Tbl_StudyHistory.TableName, PkColArr, Choice, _
                                        Ds_StudyHistory.Tables(Tbl_StudyHistory.TableName), _
                                        Tbl_StudyHistory, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in SubjectDtlCDMSMedicalCondition
            If Not objSave.SaveInDb("Insert_SubjectDtlCDMSStudyHistory", Tbl_StudyHistory, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of SubjectDtlCDMSStudyHistory In Database"
                Exit Function
            End If

            Save_SubjectDtlCDMSStudyHistory = True

            If Save_SubjectDtlCDMSStudyHistory Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving SubjectDtlCDMSStudyHistory"
            Save_SubjectDtlCDMSStudyHistory = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function

#End Region

#Region "TimeZoneMst"
    Public Function Save_TimeZoneMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_TimeZoneMst As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_TimeZoneMst As Data.DataTable = Nothing
        Dim Instr_LocationCode As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_TimeZoneMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            Tbl_TimeZoneMst = New DataTable
            Tbl_TimeZoneMst = Ds_TimeZoneMst.Tables(0)

            'Function called only if edit is called
            'If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
            '    For Each tr As Data.DataRow In Ds_TimeZoneMst.Tables("TimeZoneMst").Rows

            '        Instr_LocationCode += IIf(Instr_LocationCode = "", "", ",").ToString + _
            '                        tr("nTimeZoneMstNo").ToString

            '    Next tr
            'End If

            'If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
            '    dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            'Else
            '    dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            'End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)


            'If Not objHelpDbTbl.GetTimeZoneMaster("nTimeZoneMstNo In (" + Instr_LocationCode + ")", dataRet_1, _
            '                                objDtLogic, Tbl_TimeZoneMst, eStr_Retu) Then

            '    eStr_Retu += vbCrLf + "Error occured while retrieving TimeZoneMst"
            '    Exit Function
            'End If


            ''Retrieval of Online_AuditInfo
            'If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
            '                                  Tbl_Audit, eStr_Retu) Then
            '    eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
            '    Exit Function
            'End If

            ''Assignment of Values
            'PkColArr(0) = "nTimeZoneMstNo"

            'If Not objSave.AssignValues(Tbl_TimeZoneMst.TableName, PkColArr, Choice, _
            '                            Ds_TimeZoneMst.Tables(Tbl_TimeZoneMst.TableName), _
            '                            Tbl_TimeZoneMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
            '    eStr_Retu += vbCrLf + "Error occured while assigning values"
            '    Exit Function
            'End If



            If Not objSave.SaveInDb("Insert_TimeZoneMst", Tbl_TimeZoneMst, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of TimeZone Master In Database"
                Exit Function
            End If

            Save_TimeZoneMst = True

            If Save_TimeZoneMst Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving TimeZone Master "
            Save_TimeZoneMst = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region ''By Debashis

#Region "MedexDependency"
    Public Function Save_MedExDependency(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_MedexDependency As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_MedexDependency As Data.DataTable = Nothing
        Dim Instr_LocationCode As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_MedexDependency Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            Tbl_MedexDependency = New DataTable
            Tbl_MedexDependency = Ds_MedexDependency.Tables(0)

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_MedexDependency.Tables("MedexDependency").Rows

                    Instr_LocationCode += IIf(Instr_LocationCode = "", "", ",").ToString + _
                                    tr("nMedExDependcyNo").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)


            If Not objHelpDbTbl.GetMedexDependency("nMedExDependcyNo In (" + Instr_LocationCode + ")", dataRet_1, _
                                            objDtLogic, Tbl_MedexDependency, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving MedExDependcy"
                Exit Function
            End If



            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nMedExDependcyNo"

            If Not objSave.AssignValues(Tbl_MedexDependency.TableName, PkColArr, Choice, _
                                        Ds_MedexDependency.Tables(Tbl_MedexDependency.TableName), _
                                        Tbl_MedexDependency, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If



            If Not objSave.SaveInDb("Insert_MedexDependency", Tbl_MedexDependency, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of MedexDependency In Database"
                Exit Function
            End If

            Save_MedExDependency = True

            If Save_MedExDependency Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving MedexDependency"
            Save_MedExDependency = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region  ''By Debashis

#Region "Insert_ScreeningEntryControl"
    Public Function Insert_ScreeningEntryControl(ByVal Choice As DataObjOpenSaveModeEnum, _
                                              ByVal ds_ScreeningEntryControl As DataSet, _
                                              ByVal objDtLogic As ClsDataLogic_New, _
                                             ByRef eStr_Retu As String) As Boolean


        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If ds_ScreeningEntryControl Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Assignment of Values
            objSave = New SaveDataInDbObj(objDtLogic)

            If Not objSave.SaveInDb("Insert_ScreeningEntryControl", ds_ScreeningEntryControl.Tables(0), Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information in ScreeningEntryControl"
                Exit Function
            End If

            Insert_ScreeningEntryControl = True

            If Insert_ScreeningEntryControl Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error While Inserting in Entry Control"
            Insert_ScreeningEntryControl = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region ''By Debashis


#Region "Insert_HL7Data"
    Public Function Insert_HL7Data(ByVal Choice As DataObjOpenSaveModeEnum, _
                                              ByVal ds As DataSet, _
                                              ByVal objDtLogic As ClsDataLogic_New, _
                                             ByRef eStr_Retu As String) As Boolean


        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If ds Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Assignment of Values
            objSave = New SaveDataInDbObj(objDtLogic)

            If Not objSave.SaveInDb("Insert_HL7Data", ds.Tables(0), Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information in HL7Data"
                Exit Function
            End If

            Insert_HL7Data = True

            If Insert_HL7Data Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error While Inserting in HL7Data"
            Insert_HL7Data = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region ''By Megha

#Region "Save_MedExScreeningDtlOnly"
    Public Function Save_MedExScreeningDtlOnly(ByVal Choice As DataObjOpenSaveModeEnum, _
                                              ByVal ds_MedexScreeningDtl As DataSet, _
                                              ByVal objDtLogic As ClsDataLogic_New, _
                                             ByRef eStr_Retu As String) As Boolean


        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If ds_MedexScreeningDtl Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Assignment of Values
            objSave = New SaveDataInDbObj(objDtLogic)

            If Not objSave.SaveInDb("insert_MedexScreeningdtl", ds_MedexScreeningDtl.Tables(0), Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information in MedexScreeningDtl"
                Exit Function
            End If

            Save_MedExScreeningDtlOnly = True

            If Save_MedExScreeningDtlOnly Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error While Inserting in MedexScreeningDtl"
            Save_MedExScreeningDtlOnly = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region ''By Debashis

#Region "Save_MedexWorkspaceScreeningDtlOnly"

    Public Function Save_MedexWorkspaceScreeningDtlOnly(ByVal Choice As DataObjOpenSaveModeEnum, _
                                              ByVal ds_MedexWorkspaceScreeningDtl As DataSet, _
                                              ByVal objDtLogic As ClsDataLogic_New, _
                                             ByRef eStr_Retu As String) As Boolean


        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If ds_MedexWorkspaceScreeningDtl Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Assignment of Values
            objSave = New SaveDataInDbObj(objDtLogic)

            If Not objSave.SaveInDb("Insert_MedexWorkspaceScreeningDtl", ds_MedexWorkspaceScreeningDtl.Tables(0), Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information in MedexWorkspaceScreeningDtl"
                Exit Function
            End If

            Save_MedexWorkspaceScreeningDtlOnly = True

            If Save_MedexWorkspaceScreeningDtlOnly Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error While Inserting in MedexWorkspaceScreeningDtl"
            Save_MedexWorkspaceScreeningDtlOnly = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function

#End Region ''By Debashis

#Region "Save_MedExScreeningHdrOnly"
    Public Function Save_MedExScreeningHdrOnly(ByVal Choice As DataObjOpenSaveModeEnum, _
                                              ByVal ds_MedexScreeningHdr As DataSet, _
                                              ByVal objDtLogic As ClsDataLogic_New, _
                                             ByRef eStr_Retu As String) As Boolean


        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If ds_MedexScreeningHdr Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Assignment of Values
            objSave = New SaveDataInDbObj(objDtLogic)

            If Not objSave.SaveInDb("insert_MedexScreeningHdr", ds_MedexScreeningHdr.Tables(0), Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information in MedexScreeningHdr"
                Exit Function
            End If

            Save_MedExScreeningHdrOnly = True

            If Save_MedExScreeningHdrOnly Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error While Inserting in MedexScreeningHdr"
            Save_MedExScreeningHdrOnly = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region ''By Debashis

#Region "Save_ScreeningWorkflow"
    Public Function Save_ScreeningWorkflow(ByVal Choice As DataObjOpenSaveModeEnum, _
                                              ByVal ds_Workflow As DataSet, _
                                              ByVal objDtLogic As ClsDataLogic_New, _
                                             ByRef eStr_Retu As String) As Boolean


        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If ds_Workflow Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Assignment of Values
            objSave = New SaveDataInDbObj(objDtLogic)

            If Not objSave.SaveInDb("Insert_ScreeningWorkFlowDtl", ds_Workflow.Tables(0), Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information in ScreeningWorkflowdtl"
                Exit Function
            End If

            Save_ScreeningWorkflow = True

            If Save_ScreeningWorkflow Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error While Inserting in ScreeningWorkflowdtl"
            Save_ScreeningWorkflow = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region ''By Debashis

#Region "Save_SubjectDtlCDMSStatus"
    Public Function Save_SubjectDtlCDMSStatus(ByVal Choice As DataObjOpenSaveModeEnum, _
                                              ByVal ds_Status As DataSet, _
                                              ByVal objDtLogic As ClsDataLogic_New, _
                                             ByRef eStr_Retu As String) As Boolean


        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If ds_Status Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Assignment of Values
            objSave = New SaveDataInDbObj(objDtLogic)

            If Not objSave.SaveInDb("Insert_SubjectDtlCDMSStatus", ds_Status.Tables(0), Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information in SubjectDtlCDMSStatus"
                Exit Function
            End If

            Save_SubjectDtlCDMSStatus = True

            If Save_SubjectDtlCDMSStatus Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error While Inserting in SubjectDtlCDMSStatus"
            Save_SubjectDtlCDMSStatus = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region ''By Debashis

#Region "Save_WorkspaceSpecificSubject"

    Public Function Save_WorkspaceSpecificSubject(ByVal Choice As DataObjOpenSaveModeEnum, _
                                                  ByVal ds_ProjectSpecific As Data.DataSet, _
                                                  ByVal objDtLogic As ClsDataLogic_New, _
                                                  ByVal UserCode_1 As String, _
                                                  ByRef estr_Retu As String) As Boolean
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing



        Try

            estr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                estr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                estr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If ds_ProjectSpecific Is Nothing Then
                estr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            objSave = New SaveDataInDbObj(objDtLogic)
            If Not objSave.SaveInDb("Insert_WorkspaceSpecificSubject", ds_ProjectSpecific.Tables(0), Choice, Nothing, estr_Retu) Then
                estr_Retu += vbCrLf + "Error occured while Save Information in Save_BAFileDetail"
                Exit Function
            End If

            Save_WorkspaceSpecificSubject = True

            If Save_WorkspaceSpecificSubject Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            estr_Retu = ex.Message + vbCrLf + "Error While Inserting in Save_BAFileDetail"
            Save_WorkspaceSpecificSubject = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try




    End Function

#End Region
    '===============================================
    'Added By Vimal Ghoniya For Sequence Generation
    '===============================================


#Region "Save_BAChildProjects"

    Public Function Save_BAChildProjects(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_BAChildProject As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim Tbl_ProjectDtl As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_BAProjectDtl As Data.DataTable = Nothing
        Dim Instr_BAchildProjectsNo As String = ""


        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_BAChildProject Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            Tbl_ProjectDtl = New DataTable
            Tbl_ProjectDtl = Ds_BAChildProject.Tables("BAChildProjects")

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_BAChildProject.Tables("BAChildProjects").Rows

                    Instr_BAchildProjectsNo += IIf(Instr_BAchildProjectsNo = "", "", ",").ToString + _
                                    tr("nBAchildProjectsNo").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of BA Child Projects
            If Not objHelpDbTbl.getBAChildProjects("nBAchildProjectsNo In ('" + Instr_BAchildProjectsNo + "')", dataRet_1, _
                                            objDtLogic, Tbl_BAProjectDtl, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving BA Child Project"
                Exit Function
            End If

            If Not Tbl_BAProjectDtl Is Nothing Then
                Tbl_BAProjectDtl.Columns.Add("vRemarks")
            End If

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nBAchildProjectsNo"

            If Not objSave.AssignValues(Tbl_BAProjectDtl.TableName, PkColArr, Choice, _
                                        Ds_BAChildProject.Tables(Tbl_BAProjectDtl.TableName), _
                                        Tbl_BAProjectDtl, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in BA Child Projects
            If Not objSave.SaveInDb("Insert_BAChildProjects", Tbl_BAProjectDtl, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of BA Child Project In Database"
                Exit Function
            End If



            Save_BAChildProjects = True

            If Save_BAChildProjects Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving BA Child Project"
            Save_BAChildProjects = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function

#End Region

#Region "Save_BAProjectAnalyteDtl"

    Public Function Save_BAProjectAnalyteDtl(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_BAProjectAnalyte As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim Tbl_ProjectAnaylteDtl As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_BAProjectAnaylteDtl As Data.DataTable = Nothing
        Dim Instr_BAProjectAnalyteDtlNo As String = ""


        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_BAProjectAnalyte Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            Tbl_ProjectAnaylteDtl = New DataTable
            Tbl_ProjectAnaylteDtl = Ds_BAProjectAnalyte.Tables("BAProjectAnalyteDtl")

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_BAProjectAnalyte.Tables("BAProjectAnalyteDtl").Rows

                    Instr_BAProjectAnalyteDtlNo += IIf(Instr_BAProjectAnalyteDtlNo = "", "", ",").ToString + _
                                    tr("nBAProjectAnalyteDtlNo").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of BA Project Analyte
            If Not objHelpDbTbl.getBAProjectAnalyteDtl("nBAProjectAnalyteDtlNo In ('" + Instr_BAProjectAnalyteDtlNo + "')", dataRet_1, _
                                            objDtLogic, Tbl_BAProjectAnaylteDtl, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving BA Project Analyte"
                Exit Function
            End If

            If Not Tbl_BAProjectAnaylteDtl Is Nothing Then
                Tbl_BAProjectAnaylteDtl.Columns.Add("vRemarks")
            End If

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nBAProjectAnalyteDtlNo"

            If Not objSave.AssignValues(Tbl_BAProjectAnaylteDtl.TableName, PkColArr, Choice, _
                                        Ds_BAProjectAnalyte.Tables(Tbl_BAProjectAnaylteDtl.TableName), _
                                        Tbl_BAProjectAnaylteDtl, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in BA Child Projects
            If Not objSave.SaveInDb("Insert_BAProjectAnalyteDtl", Tbl_BAProjectAnaylteDtl, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of BA Project Analyte In Database"
                Exit Function
            End If


            Save_BAProjectAnalyteDtl = True

            If Save_BAProjectAnalyteDtl Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving BA Child Project"
            Save_BAProjectAnalyteDtl = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function

#End Region

#Region "SaveBaSampleReqHdrDtl"
    Public Function SaveBaSampleReqHdrDtl(ByVal Choice As DataObjOpenSaveModeEnum, _
                                      ByVal DsBaSampleReqHdrDtl As Data.DataSet, _
                                      ByVal objDtLogic As ClsDataLogic_New, _
                                      ByVal UserCode_1 As String, _
                                      ByRef eStr_Retu As String) As Boolean


        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing


        Dim serverDateTime_1 As DateTime
        Dim Tbl_DsBaSampleReqDtl As Data.DataTable = Nothing
        Dim Tbl_Top_DsBaSampleReqDtl As Data.DataTable = Nothing
        Dim Tbl_DsBaSampleReqHdr As Data.DataTable = Nothing
        Dim Instr_BaSampleReqHdrNo As String = ""
        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing
        Dim RetuVal_RepeatNo As ParameterReturnValue = Nothing

        Dim DataReturnList_Mst As New ArrayList
        Dim RetuVal_Mst As ParameterReturnValue = Nothing
        Dim dr As DataRow


        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If DsBaSampleReqHdrDtl Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If
            Tbl_DsBaSampleReqDtl = DsBaSampleReqHdrDtl.Tables("BaSampleReqDtl")
            Tbl_DsBaSampleReqHdr = DsBaSampleReqHdrDtl.Tables("BaSampleReqHdr")



            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)




            ' Save in BaSampleReqHdr
            If Not objSave.SaveInDb("Insert_BaSampleReqHdr", Tbl_DsBaSampleReqHdr, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of BaSampleReqHdr In Database"
                Exit Function
            End If
            'Assiging New HdrNo 
            DataReturnList = DataReturnList.Item(0)
            RetuVal = DataReturnList.Item(0)

            For Each dr In Tbl_DsBaSampleReqDtl.Rows
                dr("nBaSampleReqHdrNo") = RetuVal.ParameterValue
                dr.AcceptChanges()
            Next
            Tbl_DsBaSampleReqDtl.AcceptChanges()
            '********************************************

            ' Save in BaSampleReqDtl
            DataReturnList = Nothing
            DataReturnList = New ArrayList

            If Not objSave.SaveInDb("Insert_BaSampleReqDtl", Tbl_DsBaSampleReqDtl, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of BaSampleReqDtl In Database"
                SaveBaSampleReqHdrDtl = False
                objDtLogic.RollBack_Transaction()
                Exit Function
            End If



            SaveBaSampleReqHdrDtl = True

            If SaveBaSampleReqHdrDtl Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving SaveBaSampleReqHdrDtl"
            SaveBaSampleReqHdrDtl = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "Save_BAAnalyteSampleHdr"

    Public Function Save_BAAnalyteSampleHdr(ByVal Choice As DataObjOpenSaveModeEnum, _
                                       ByVal Ds_BAAnalyteSample As Data.DataSet, _
                                       ByVal objDtLogic As ClsDataLogic_New, _
                                       ByVal UserCode_1 As String, _
                                       ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim Tbl_AnalyteSampleHdr As Data.DataTable = Nothing
        Dim Tbl_AnalyteSampleDtl As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_AnalyteSample As Data.DataTable = Nothing
        Dim Instr_AnalyteSampleHdrNo As String = ""


        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_BAAnalyteSample Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            Tbl_AnalyteSampleDtl = New DataTable
            Tbl_AnalyteSampleDtl = Ds_BAAnalyteSample.Tables("BAAnalyteSampleDtl")

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit OrElse _
                Ds_BAAnalyteSample.Tables("BAAnalyteSampleHdr").Rows(0)("cStatusIndi") = "E" Then
                For Each tr As Data.DataRow In Ds_BAAnalyteSample.Tables("BAAnalyteSampleHdr").Rows

                    Instr_AnalyteSampleHdrNo += IIf(Instr_AnalyteSampleHdrNo = "", "", ",").ToString + _
                                    tr("nBAAnalyteSampleHdrNo").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            If Instr_AnalyteSampleHdrNo <> "" Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of BA Analyte Sample Hdr
            If Not objHelpDbTbl.getBAAnalyteSampleHdr("nBAAnalyteSampleHdrNo In ('" + Instr_AnalyteSampleHdrNo + "')", dataRet_1, _
                                            objDtLogic, Tbl_AnalyteSample, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving BA Analyte Sample Hdr"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nBAAnalyteSampleHdrNo"


            If Ds_BAAnalyteSample.Tables(Tbl_AnalyteSample.TableName).Rows(0)("cStatusIndi") = "E" Then
                If Not objSave.AssignValues(Tbl_AnalyteSample.TableName, PkColArr, DataObjOpenSaveModeEnum.DataObjOpenMode_Edit, _
                                       Ds_BAAnalyteSample.Tables(Tbl_AnalyteSample.TableName), _
                                       Tbl_AnalyteSample, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while assigning values"
                    Exit Function
                End If
            Else
                If Not objSave.AssignValues(Tbl_AnalyteSample.TableName, PkColArr, Choice, _
                                       Ds_BAAnalyteSample.Tables(Tbl_AnalyteSample.TableName), _
                                       Tbl_AnalyteSample, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while assigning values"
                    Exit Function
                End If
            End If


            ' Save in BA Analyte Sample Hdr
            If Not objSave.SaveInDb("Insert_BAAnalyteSampleHdr", Tbl_AnalyteSample, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of BAAnalyteSampleHdr In Database"
                Exit Function
            End If

            DataReturnList = DataReturnList.Item(0)
            RetuVal = DataReturnList.Item(0)

            If Not Tbl_AnalyteSampleDtl Is Nothing Then
                If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                    For Each dr As Data.DataRow In Tbl_AnalyteSampleDtl.Rows
                        dr("nBAAnalyteSampleHdrNo") = RetuVal.ParameterValue
                    Next
                End If
                'Save in SubjectDtlCDMS
                If Not objSave.SaveInDb("Insert_BAAnalyteSampleDtl", Tbl_AnalyteSampleDtl, Choice, Nothing, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of BAAnalyteSampleDtl Detail In Database"
                    Exit Function
                End If
            End If



            Save_BAAnalyteSampleHdr = True

            If Save_BAAnalyteSampleHdr Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving BA Analyte Sample"
            Save_BAAnalyteSampleHdr = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function


#End Region

#Region "Insert_UpdateSubjectPIFFields"

    Public Function Insert_UpdateSubjectPIFFields(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Field As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing


        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            Tbl_Field = New DataTable
            Tbl_Field = Ds.Tables(0)

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            ' Save in Insert_UpdateSubjectCDMSDtlField
            If Not objSave.SaveInDb("Insert_UpdateSubjectPIFFields", Tbl_Field, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of Insert_UpdateSubjectPIFFields In Database"
                Exit Function
            End If

            Insert_UpdateSubjectPIFFields = True

            If Insert_UpdateSubjectPIFFields Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Insert_UpdateSubjectPIFFields"
            Insert_UpdateSubjectPIFFields = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function

#End Region

#Region "Insert_SubjectHabitDetails"

    Public Function Insert_SubjectHabitDetails(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Field As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing


        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            Tbl_Field = New DataTable
            Tbl_Field = Ds.Tables(0)

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            ' Save in Insert_SubjectHabitDetails
            If Not objSave.SaveInDb("Insert_SubjectHabitDetails", Tbl_Field, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of Insert_SubjectHabitDetails In Database"
                Exit Function
            End If

            Insert_SubjectHabitDetails = True

            If Insert_SubjectHabitDetails Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Insert_SubjectHabitDetails"
            Insert_SubjectHabitDetails = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function

#End Region

#Region "Save_BaSampleReqHdr"
    Public Function Save_BaSampleReqHdr(ByVal Choice As DataObjOpenSaveModeEnum, _
                                         ByVal Ds_ReqHdr As Data.DataSet, _
                                         ByVal objDtLogic As ClsDataLogic_New, _
                                         ByVal UserCode_1 As String, _
                                         ByRef eStr_Retu As String) As Boolean


        Dim objHelpDbTbl As clsHelpDbTable = Nothing
        Dim objSave As SaveDataInDbObj = Nothing
        Dim serverDateTime_1 As DateTime
        Dim Tbl_ReqDtl As Data.DataTable = Nothing
        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_ReqHdr Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If
            Tbl_ReqDtl = Ds_ReqHdr.Tables(0)

            If Not objSave.SaveInDb("Insert_BaSampleReqHdr", Tbl_ReqDtl, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of BaSampleReqHdr In Database"
                Save_BaSampleReqHdr = False
                objDtLogic.RollBack_Transaction()
                Exit Function
            End If


            Save_BaSampleReqHdr = True

            If Save_BaSampleReqHdr Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving BaSampleReqHdr"
            Save_BaSampleReqHdr = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "Save_BaSampleReqDtl"
    Public Function Save_BaSampleReqDtl(ByVal Choice As DataObjOpenSaveModeEnum, _
                                         ByVal Ds_ReqDtl As Data.DataSet, _
                                         ByVal objDtLogic As ClsDataLogic_New, _
                                         ByVal UserCode_1 As String, _
                                         ByRef eStr_Retu As String) As Boolean


        Dim objHelpDbTbl As clsHelpDbTable = Nothing
        Dim objSave As SaveDataInDbObj = Nothing
        Dim serverDateTime_1 As DateTime
        Dim Tbl_ReqDtl As Data.DataTable = Nothing
        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_ReqDtl Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If
            Tbl_ReqDtl = Ds_ReqDtl.Tables(0)

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)


            If Not objSave.SaveInDb("Insert_BaSampleReqDtl", Tbl_ReqDtl, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of BaSampleReqDtl In Database"
                Save_BaSampleReqDtl = False
                objDtLogic.RollBack_Transaction()
                Exit Function
            End If


            Save_BaSampleReqDtl = True

            If Save_BaSampleReqDtl Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving BaSampleReqDtl"
            Save_BaSampleReqDtl = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "SaveBaSequenceScheduleHdrDtl"
    Public Function SaveBaSequenceScheduleHdrDtl(ByVal Choice As DataObjOpenSaveModeEnum, _
                                      ByVal DsBaSequenceScheduleHdrDtl As Data.DataSet, _
                                      ByVal objDtLogic As ClsDataLogic_New, _
                                      ByVal UserCode_1 As String, _
                                      ByRef eStr_Retu As String) As Boolean


        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing


        Dim serverDateTime_1 As DateTime
        Dim Tbl_DsBaSequenceScheduleDtl As Data.DataTable = Nothing
        Dim Tbl_Top_DsBaSequenceScheduleDtl As Data.DataTable = Nothing
        Dim Tbl_DsBaSequenceScheduleHdr As Data.DataTable = Nothing
        Dim Tbl_DSBASequenceConcentrationMatrix As Data.DataTable = Nothing
        Dim Instr_BaSequenceScheduleHdrNo As String = ""
        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing
        Dim RetuVal_RepeatNo As ParameterReturnValue = Nothing

        Dim DataReturnList_Mst As New ArrayList
        Dim RetuVal_Mst As ParameterReturnValue = Nothing
        Dim dr As DataRow


        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If DsBaSequenceScheduleHdrDtl Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If
            Tbl_DsBaSequenceScheduleDtl = DsBaSequenceScheduleHdrDtl.Tables("BaSequenceScheduleDtl")
            Tbl_DsBaSequenceScheduleHdr = DsBaSequenceScheduleHdrDtl.Tables("BaSequenceScheduleHdr")

            If DsBaSequenceScheduleHdrDtl.Tables.Contains("BASequenceConcentrationMatrix") Then
                Tbl_DSBASequenceConcentrationMatrix = DsBaSequenceScheduleHdrDtl.Tables("BASequenceConcentrationMatrix")
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)


            ' Save in BaSequenceScheduleHdr
            If Not objSave.SaveInDb("Insert_BaSequenceScheduleHdr", Tbl_DsBaSequenceScheduleHdr, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of BaSequenceScheduleHdr In Database"
                Exit Function
            End If
            'Assiging New HdrNo 
            DataReturnList = DataReturnList.Item(0)
            RetuVal = DataReturnList.Item(0)

            For Each dr In Tbl_DsBaSequenceScheduleDtl.Rows
                dr("nBaSequenceScheduleHdrNo") = RetuVal.ParameterValue
                dr.AcceptChanges()
            Next
            Tbl_DsBaSequenceScheduleDtl.AcceptChanges()
            '********************************************

            ' Save in BaSequenceScheduleDtl
            DataReturnList = Nothing
            DataReturnList = New ArrayList

            If Not objSave.SaveInDb("Insert_BaSequenceScheduleDtl", Tbl_DsBaSequenceScheduleDtl, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of BaSequenceScheduleDtl In Database"
                SaveBaSequenceScheduleHdrDtl = False
                objDtLogic.RollBack_Transaction()
                Exit Function
            End If

            If Not Tbl_DSBASequenceConcentrationMatrix Is Nothing Then
                'Save in BASequenceConcentrationMatrix
                For Each dr In Tbl_DSBASequenceConcentrationMatrix.Rows
                    dr("nBaSequenceScheduleHdrNo") = RetuVal.ParameterValue
                    dr.AcceptChanges()
                Next
                Tbl_DSBASequenceConcentrationMatrix.AcceptChanges()

                DataReturnList = Nothing
                DataReturnList = New ArrayList

                If Not objSave.SaveInDb("Insert_BASequenceConcentrationMatrix", Tbl_DSBASequenceConcentrationMatrix, Choice, DataReturnList, eStr_Retu) Then
                    eStr_Retu += vbCrLf + "Error occured while Save Information of BASequenceConcentrationMatrix In Database"
                    SaveBaSequenceScheduleHdrDtl = False
                    objDtLogic.RollBack_Transaction()
                    Exit Function
                End If
            End If

            SaveBaSequenceScheduleHdrDtl = True

            If SaveBaSequenceScheduleHdrDtl Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving SaveBaSequenceScheduleHdrDtl"
            SaveBaSequenceScheduleHdrDtl = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "SaveBaTemplateHdrDtl"
    Public Function SaveBaTemplateHdrDtl(ByVal Choice As DataObjOpenSaveModeEnum, _
                                      ByVal DsBaTemplateHdrDtl As Data.DataSet, _
                                      ByVal objDtLogic As ClsDataLogic_New, _
                                      ByVal UserCode_1 As String, _
                                      ByRef eStr_Retu As String) As Boolean


        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing


        Dim serverDateTime_1 As DateTime
        Dim Tbl_DsBaSequenceScheduleDtl As Data.DataTable = Nothing
        Dim Tbl_Top_DsBaSequenceScheduleDtl As Data.DataTable = Nothing
        Dim Tbl_DsBaSequenceScheduleHdr As Data.DataTable = Nothing
        Dim Instr_BaSequenceScheduleHdrNo As String = ""
        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing
        Dim RetuVal_RepeatNo As ParameterReturnValue = Nothing

        Dim DataReturnList_Mst As New ArrayList
        Dim RetuVal_Mst As ParameterReturnValue = Nothing
        Dim dr As DataRow


        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If DsBaTemplateHdrDtl Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If
            Tbl_DsBaSequenceScheduleDtl = DsBaTemplateHdrDtl.Tables("BaTemplateDtl")
            Tbl_DsBaSequenceScheduleHdr = DsBaTemplateHdrDtl.Tables("BaTemplateHdr")

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)


            ' Save in BaTemplateHdr
            If Not objSave.SaveInDb("Insert_BaTemplateHdr", Tbl_DsBaSequenceScheduleHdr, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of BaTemplateHdr In Database"
                Exit Function
            End If

            'Assiging New HdrNo 
            DataReturnList = DataReturnList.Item(0)
            RetuVal = DataReturnList.Item(0)

            If Not Tbl_DsBaSequenceScheduleDtl Is Nothing Then
                If Tbl_DsBaSequenceScheduleDtl.Rows.Count > 0 Then
                    For Each dr In Tbl_DsBaSequenceScheduleDtl.Rows
                        dr("nBaTemplateHdrNo") = RetuVal.ParameterValue
                        dr.AcceptChanges()
                    Next
                    Tbl_DsBaSequenceScheduleDtl.AcceptChanges()
                    '********************************************

                    ' Save in BaTemplateDtl
                    DataReturnList = Nothing
                    DataReturnList = New ArrayList

                    If Not objSave.SaveInDb("Insert_BaTemplateDtl", Tbl_DsBaSequenceScheduleDtl, Choice, DataReturnList, eStr_Retu) Then
                        eStr_Retu += vbCrLf + "Error occured while Save Information of BaTemplateDtl In Database"
                        SaveBaTemplateHdrDtl = False
                        objDtLogic.RollBack_Transaction()
                        Exit Function
                    End If
                End If
            End If

            SaveBaTemplateHdrDtl = True

            If SaveBaTemplateHdrDtl Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving SaveBaTemplateHdrDtl"
            SaveBaTemplateHdrDtl = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "Save_BASequenceExportDtl"

    Public Function Save_BASequenceExportDtl(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_BAExport As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim Tbl_ExportDtl As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_BASequenceExport As Data.DataTable = Nothing
        Dim Instr_BASequenceExportDtlNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_BAExport Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            Tbl_ExportDtl = New DataTable
            Tbl_ExportDtl = Ds_BAExport.Tables("nBASequenceExportDtlNo")

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_BAExport.Tables("nBASequenceExportDtlNo").Rows

                    Instr_BASequenceExportDtlNo += IIf(Instr_BASequenceExportDtlNo = "", "", ",").ToString + _
                                    tr("nBASequenceExportDtlNo").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of GetBASequenceExportDtl
            If Not objHelpDbTbl.GetBASequenceExportDtl("nBASequenceExportDtlNo In ('" + Instr_BASequenceExportDtlNo + "')", dataRet_1, _
                                            objDtLogic, Tbl_BASequenceExport, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving BASequenceExportDtl"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nBASequenceExportDtlNo"

            If Not objSave.AssignValues(Tbl_BASequenceExport.TableName, PkColArr, Choice, _
                                        Ds_BAExport.Tables(Tbl_BASequenceExport.TableName), _
                                        Tbl_BASequenceExport, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in BASequenceExportDtl
            If Not objSave.SaveInDb("Insert_BASequenceExportDtl", Tbl_BASequenceExport, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of BASequenceExportDtl In Database"
                Exit Function
            End If

            Save_BASequenceExportDtl = True

            If Save_BASequenceExportDtl Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving BASequenceExportDtl"
            Save_BASequenceExportDtl = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function

#End Region

#Region "Insert_BaSampleSeqError"

    Public Function Insert_BaSampleSeqError(ByVal Choice As DataObjOpenSaveModeEnum, _
                                    ByVal Ds As Data.DataSet, _
                                    ByVal objDtLogic As ClsDataLogic_New, _
                                    ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Field As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing


        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            Tbl_Field = New DataTable
            Tbl_Field = Ds.Tables(0)

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            ' Save in Insert_BaSampleSeqError
            If Not objSave.SaveInDb("Insert_BaSampleSeqError", Tbl_Field, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of Insert_BaSampleSeqError In Database"
                Exit Function
            End If

            Insert_BaSampleSeqError = True

            If Insert_BaSampleSeqError Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Insert_BaSampleSeqError"
            Insert_BaSampleSeqError = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try


    End Function

#End Region

#Region "Save_BASetProjectMatrix"

    Public Function Save_BASetProjectMatrix(ByVal Choice As DataObjOpenSaveModeEnum, _
                                         ByVal Ds_ReqHdr As Data.DataSet, _
                                         ByVal objDtLogic As ClsDataLogic_New, _
                                         ByVal UserCode_1 As String, _
                                         ByRef eStr_Retu As String) As Boolean


        Dim objHelpDbTbl As clsHelpDbTable = Nothing
        Dim objSave As SaveDataInDbObj = Nothing
        Dim serverDateTime_1 As DateTime
        Dim Tbl_ReqDtl As Data.DataTable = Nothing
        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_ReqHdr Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If
            Tbl_ReqDtl = Ds_ReqHdr.Tables(0)
            objSave = New SaveDataInDbObj(objDtLogic)
            If Not objSave.SaveInDb("Insert_BASetProjectMatrix", Tbl_ReqDtl, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of BASetProjectMatrix In Database"
                Save_BASetProjectMatrix = False
                objDtLogic.RollBack_Transaction()
                Exit Function
            End If


            Save_BASetProjectMatrix = True

            If Save_BASetProjectMatrix Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving BASetProjectMatrix"
            Save_BASetProjectMatrix = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function

#End Region

#Region "Insert_UpdateFieldValues"

    Public Function Save_UpdateFieldValues(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Field As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing


        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            Tbl_Field = New DataTable
            Tbl_Field = Ds.Tables(0)

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            ' Save in Insert_UpdateSubjectCDMSDtlField
            If Not objSave.SaveInDb("Insert_UpdateFieldValues", Tbl_Field, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of Save_UpdateFieldValues In Database"
                Exit Function
            End If

            Save_UpdateFieldValues = True

            If Save_UpdateFieldValues Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Save_UpdateFieldValues"
            Save_UpdateFieldValues = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function

#End Region

#Region "Save_PkSampleReviewDtl"

    Public Function Save_PkSampleReviewDtl(ByVal Choice As DataObjOpenSaveModeEnum, _
                                         ByVal Ds_ReqHdr As Data.DataSet, _
                                         ByVal objDtLogic As ClsDataLogic_New, _
                                         ByRef eStr_Retu As String) As Boolean


        Dim objHelpDbTbl As clsHelpDbTable = Nothing
        Dim objSave As SaveDataInDbObj = Nothing
        Dim Tbl_ReqDtl As Data.DataTable = Nothing
        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_ReqHdr Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            Tbl_ReqDtl = Ds_ReqHdr.Tables(0)
            objSave = New SaveDataInDbObj(objDtLogic)
            If Not objSave.SaveInDb("Insert_PkSampleReviewDtl", Tbl_ReqDtl, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of BASetProjectMatrix In Database"
                Save_PkSampleReviewDtl = False
                objDtLogic.RollBack_Transaction()
                Exit Function
            End If


            Save_PkSampleReviewDtl = True

            If Save_PkSampleReviewDtl Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving BASetProjectMatrix"
            Save_PkSampleReviewDtl = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function

#End Region

#Region "Save_BaSequenceScheduleHdr"

    Public Function Save_BaSequenceScheduleHdr(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_SequenceHdr As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_SequenceHdr As Data.DataTable = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_SampleSequenceHdr As Data.DataTable = Nothing
        Dim Instr_nBaSequenceScheduleHdrNo As String = ""


        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_SequenceHdr Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            Tbl_SequenceHdr = New DataTable
            Tbl_SequenceHdr = Ds_SequenceHdr.Tables("BaSequenceScheduleHdr")

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_SequenceHdr.Tables("BaSequenceScheduleHdr").Rows

                    Instr_nBaSequenceScheduleHdrNo += IIf(Instr_nBaSequenceScheduleHdrNo = "", "", ",").ToString + _
                                    tr("nBaSequenceScheduleHdrNo").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of BA Child Projects
            If Not objHelpDbTbl.GetBaSequenceScheduleHdr("nBaSequenceScheduleHdrNo In ('" + Instr_nBaSequenceScheduleHdrNo + "')", dataRet_1, _
                                            objDtLogic, Tbl_SampleSequenceHdr, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving BaSequenceScheduleHdr"
                Exit Function
            End If

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If


            'Assignment of Values
            PkColArr(0) = "nBaSequenceScheduleHdrNo"

            If Not objSave.AssignValues(Tbl_SampleSequenceHdr.TableName, PkColArr, Choice, _
                                        Ds_SequenceHdr.Tables(Tbl_SampleSequenceHdr.TableName), _
                                        Tbl_SampleSequenceHdr, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in BA Child Projects
            If Not objSave.SaveInDb("Insert_BaSequenceScheduleHdr", Tbl_SampleSequenceHdr, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of BaSequenceScheduleHdr In Database"
                Exit Function
            End If


            Save_BaSequenceScheduleHdr = True

            If Save_BaSequenceScheduleHdr Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving BaSequenceScheduleHdr"
            Save_BaSequenceScheduleHdr = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function

#End Region

#Region "Save_BaSequenceScheduleDtl"

    Public Function Save_BaSequenceScheduleDtl(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_SequenceDtl As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_SequenceDtl As Data.DataTable = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_SampleSequenceDtl As Data.DataTable = Nothing
        Dim Instr_nBaSequenceScheduleDtlNo As String = ""


        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_SequenceDtl Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            Tbl_SequenceDtl = New DataTable
            Tbl_SequenceDtl = Ds_SequenceDtl.Tables("BaSequenceScheduleDtl")

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_SequenceDtl.Tables("BaSequenceScheduleDtl").Rows

                    Instr_nBaSequenceScheduleDtlNo += IIf(Instr_nBaSequenceScheduleDtlNo = "", "", ",").ToString + _
                                    tr("nBaSequenceScheduleDtlNo").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of BaSequenceScheduleDtl
            If Not objHelpDbTbl.GetBaSequenceScheduleDtl("nBaSequenceScheduleDtlNo In (" + Instr_nBaSequenceScheduleDtlNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_SampleSequenceDtl, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving BaSequenceScheduleDtl"
                Exit Function
            End If

            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If


            'Assignment of Values
            PkColArr(0) = "nBaSequenceScheduleDtlNo"

            If Not objSave.AssignValues(Tbl_SampleSequenceDtl.TableName, PkColArr, Choice, _
                                        Ds_SequenceDtl.Tables(Tbl_SampleSequenceDtl.TableName), _
                                        Tbl_SampleSequenceDtl, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in BaSequenceScheduleDtl
            If Not objSave.SaveInDb("Insert_BaSequenceScheduleDtl", Tbl_SampleSequenceDtl, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of BaSequenceScheduleDtl In Database"
                Exit Function
            End If


            Save_BaSequenceScheduleDtl = True

            If Save_BaSequenceScheduleDtl Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving BaSequenceScheduleDtl"
            Save_BaSequenceScheduleDtl = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function

#End Region

#Region "Save_BASequenceConcentrationMatrix"
    Public Function Save_BASequenceConcentrationMatrix(ByVal Choice As DataObjOpenSaveModeEnum, _
                                      ByVal DsConcentrationSet As Data.DataSet, _
                                      ByVal objDtLogic As ClsDataLogic_New, _
                                      ByVal UserCode_1 As String, _
                                      ByRef eStr_Retu As String) As Boolean


        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing


        Dim serverDateTime_1 As DateTime
        Dim Tbl_DSBASequenceConcentrationMatrix As Data.DataTable = Nothing
        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing
        Dim RetuVal_RepeatNo As ParameterReturnValue = Nothing

        Dim DataReturnList_Mst As New ArrayList
        Dim RetuVal_Mst As ParameterReturnValue = Nothing
        Dim dr As DataRow


        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If DsConcentrationSet Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            Tbl_DSBASequenceConcentrationMatrix = DsConcentrationSet.Tables("BASequenceConcentrationMatrix")


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)


            ' Save in BASequenceConcentrationMatrix
            If Not objSave.SaveInDb("Insert_BASequenceConcentrationMatrix", Tbl_DSBASequenceConcentrationMatrix, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of BaSequenceScheduleHdr In Database"
                Exit Function
            End If


            Save_BASequenceConcentrationMatrix = True

            If Save_BASequenceConcentrationMatrix Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Save_BASequenceConcentrationMatrix"
            Save_BASequenceConcentrationMatrix = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "Insert_BAFileDetail"

    'Public Function Save_BAFileDetail(ByVal Choice As DataObjOpenSaveModeEnum, _
    '                                    ByVal Ds_BAFileDetail As Data.DataSet, _
    '                                    ByVal objDtLogic As ClsDataLogic_New, _
    '                                    ByVal UserCode_1 As String, _
    '                                    ByRef eStr_Retu As String) As Boolean


    '    Dim dataRet_1 As DataRetrievalModeEnum
    '    Dim objHelpDbTbl As clsHelpDbTable = Nothing

    '    'Object of friend class
    '    Dim objSave As SaveDataInDbObj = Nothing

    '    Dim Sql_DtSet As Data.DataSet = Nothing
    '    Dim Tbl_Audit As Data.DataTable = Nothing
    '    Dim Tbl_FileDetail As Data.DataTable = Nothing
    '    Dim serverDateTime_1 As DateTime

    '    Dim Tbl_BAFileDetail As Data.DataTable = Nothing
    '    Dim Instr_BAFileDetailNo As String = ""


    '    Dim PkColArr(0) As String
    '    Dim DataReturnList As New ArrayList
    '    Dim RetuVal As ParameterReturnValue = Nothing

    '    Try
    '        eStr_Retu = ""
    '        objDtLogic.Open_Connection()
    '        objDtLogic.Begin_Transaction()

    '        If objDtLogic Is Nothing Then
    '            eStr_Retu = "Data Object Is Invalid or Nothing"
    '            Exit Function
    '        End If

    '        If objDtLogic.Transaction Is Nothing Then
    '            eStr_Retu = "Transaction object is not started"
    '            Exit Function
    '        End If

    '        If Ds_BAFileDetail Is Nothing Then
    '            eStr_Retu = "Dataset Is Invalid or Nothing"
    '            Exit Function
    '        End If

    '        Tbl_FileDetail = New DataTable
    '        Tbl_FileDetail = Ds_BAFileDetail.Tables("BAFileDetail")

    '        If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
    '            For Each tr As Data.DataRow In Ds_BAFileDetail.Tables("BAFileDetail").Rows

    '                Instr_BAFileDetailNo += IIf(Instr_BAFileDetailNo = "", "", ",").ToString + _
    '                                tr("nBAFileDetailNo").ToString

    '            Next tr
    '        End If

    '        If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
    '            dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
    '        Else
    '            dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
    '        End If


    '        objHelpDbTbl = New clsHelpDbTable()

    '        serverDateTime_1 = objDtLogic.GetServerDateTime
    '        objSave = New SaveDataInDbObj(objDtLogic)

    '        'Retrieval of BA Project Analyte
    '        If Not objHelpDbTbl.getBAFileDetail("nBAFileDetail In ('" + Instr_BAFileDetailNo + "')", dataRet_1, _
    '                                        objDtLogic, Tbl_BAFileDetail, eStr_Retu) Then

    '            eStr_Retu += vbCrLf + "Error occured while retrieving BA File Detail"
    '            Exit Function
    '        End If

    '        If Not Tbl_BAFileDetail Is Nothing Then
    '            Tbl_BAFileDetail.Columns.Add("vRemarks")
    '        End If

    '        'Retrieval of Online_AuditInfo
    '        If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
    '                                          Tbl_Audit, eStr_Retu) Then
    '            eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
    '            Exit Function
    '        End If

    '        'Assignment of Values
    '        PkColArr(0) = "nBAFileDetailNo"

    '        If Not objSave.AssignValues(Tbl_BAFileDetail.TableName, PkColArr, Choice, _
    '                                    Ds_BAFileDetail.Tables(Tbl_BAFileDetail.TableName), _
    '                                    Tbl_BAFileDetail, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
    '            eStr_Retu += vbCrLf + "Error occured while assigning values"
    '            Exit Function
    '        End If

    '        ' Save in BA Child Projects
    '        If Not objSave.SaveInDb("Insert_BAFileDetail", Tbl_BAFileDetail, Choice, DataReturnList, eStr_Retu) Then
    '            eStr_Retu += vbCrLf + "Error occured while Save Information of BA Project Analyte In Database"
    '            Exit Function
    '        End If


    '        Save_BAFileDetail = True

    '        If Save_BAFileDetail Then
    '            objDtLogic.Commit_Transaction()
    '        Else
    '            objDtLogic.RollBack_Transaction()
    '        End If

    '    Catch ex As Exception
    '        eStr_Retu = ex.Message + vbCrLf + "Error occured while saving BA File Detail"
    '        Save_BAFileDetail = False
    '        objDtLogic.RollBack_Transaction()
    '    Finally
    '        objDtLogic.Close_Connection()
    '    End Try

    'End Function
    Public Function Save_BAFileDetail(ByVal Choice As DataObjOpenSaveModeEnum, _
                                                  ByVal ds_Status As DataSet, _
                                                  ByVal objDtLogic As ClsDataLogic_New, _
                                                 ByRef eStr_Retu As String) As Boolean


        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If ds_Status Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Assignment of Values
            objSave = New SaveDataInDbObj(objDtLogic)

            If Not objSave.SaveInDb("Insert_BAFileDetail", ds_Status.Tables(0), Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information in Save_BAFileDetail"
                Exit Function
            End If

            Save_BAFileDetail = True

            If Save_BAFileDetail Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error While Inserting in Save_BAFileDetail"
            Save_BAFileDetail = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region

#Region "Save_PkSampleReviewDtl"

    Public Function Save_CentrifugateParameterMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                         ByVal Ds_ReqHdr As Data.DataSet, _
                                         ByVal objDtLogic As ClsDataLogic_New, _
                                          ByVal UserCode_1 As String, _
                                         ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing
        Dim objSave As SaveDataInDbObj = Nothing
        Dim Tbl_ReqDtl As Data.DataTable = Nothing
        Dim PkColArr(0) As String
        Dim serverDateTime_1 As DateTime
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing
        Dim Instr_SampleId As String = ""

        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_ReqHdr Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit/delete is called
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                For Each tr As Data.DataRow In Ds_ReqHdr.Tables("ProjectParameterMst").Rows
                    Instr_SampleId += IIf(Instr_SampleId = "", "", ",").ToString + _
                                    tr("nProjectparameterNo").ToString
                Next tr
            End If

            dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of PKSampleDetail
            If Not objHelpDbTbl.GetCentrifugationParameter("nProjectparameterNo In (" + Instr_SampleId + ")", dataRet_1, _
                                            objDtLogic, Tbl_ReqDtl, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving ProjectParameterMst"
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nProjectparameterNo"
            If Not objSave.AssignValues(Tbl_ReqDtl.TableName, PkColArr, Choice, _
                                        Ds_ReqHdr.Tables(Tbl_ReqDtl.TableName), _
                                        Tbl_ReqDtl, Nothing, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            Tbl_ReqDtl = Ds_ReqHdr.Tables(0)
            objSave = New SaveDataInDbObj(objDtLogic)
            If Not objSave.SaveInDb("Insert_CentrifugateParametermst", Tbl_ReqDtl, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of BASetProjectMatrix In Database"
                Save_CentrifugateParameterMst = False
                objDtLogic.RollBack_Transaction()
                Exit Function
            End If

            Save_CentrifugateParameterMst = True

            If Save_CentrifugateParameterMst Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving ProjectParameterMst"
            Save_CentrifugateParameterMst = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function

#End Region

#Region "Save_IndividualSampleOperationDtl"
    'insert individual sample detail (freezer,compartment,operation) in sampleoperationdtl
    Public Function Save_IndividualSampleOperationDtl(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_SampleOperationDtl As DataSet, _
                                 ByVal objDtLogic As ClsDataLogic_New, _
                                 ByVal UserCode_1 As String, _
                                 ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_SampleOperationDtl As Data.DataTable = Nothing

        Dim Instr_IndividualSampleOperationDtl As String = ""

        Dim PkColArr(1) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_SampleOperationDtl Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            If Ds_SampleOperationDtl.Tables.Count = 0 Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            If Not Ds_SampleOperationDtl.Tables(0).Columns.Contains("cIsBagorBatch") Then
                eStr_Retu = "Column cIsBagorBatch is not available"
                Exit Function
            End If

            If Not Ds_SampleOperationDtl.Tables(0).Columns.Contains("OperationMode") Then
                eStr_Retu = "Column OperationMode is not available"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                For Each tr As Data.DataRow In Ds_SampleOperationDtl.Tables("SampleOperationDtl").Rows

                    Instr_IndividualSampleOperationDtl += IIf(Instr_IndividualSampleOperationDtl = "", "", ",").ToString + _
                                     tr("nSampleOperationDtlNo").ToString()
                Next tr
            End If

            dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of SampleOperationDtl
            If Not objHelpDbTbl.GetSampleOperationDtl("nSampleOperationDtlNo In (" + Instr_IndividualSampleOperationDtl + ")", dataRet_1, _
                                            objDtLogic, Tbl_SampleOperationDtl, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving SampleOperationDtl"
                Exit Function
            End If

            Tbl_SampleOperationDtl.Columns.Add("OperationMode")
            Tbl_SampleOperationDtl.Columns.Add("cIsBagOrBatch")
            Tbl_SampleOperationDtl.AcceptChanges()
            'Assignment of Values
            PkColArr(0) = "nSampleId"
            PkColArr(1) = "iTranNo"
            If Not objSave.AssignValues(Tbl_SampleOperationDtl.TableName, PkColArr, Choice, _
                                        Ds_SampleOperationDtl.Tables(Tbl_SampleOperationDtl.TableName), _
                                        Tbl_SampleOperationDtl, Nothing, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            If Not objSave.SaveInDb("Insert_IndividualSampleOperationDtl", Tbl_SampleOperationDtl, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of SampleOperationDtl In Database"
                Exit Function
            End If

            Save_IndividualSampleOperationDtl = True

            If Save_IndividualSampleOperationDtl Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving SampleOperationDtl"
            Save_IndividualSampleOperationDtl = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region

#Region "Save_ScreeningTimeMst"
    Public Function Save_ScreeningTimeMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                      ByVal DsScreeningTimeMst As Data.DataSet, _
                                      ByVal objDtLogic As ClsDataLogic_New, _
                                      ByVal UserCode_1 As String, _
                                      ByRef eStr_Retu As String) As Boolean


        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing


        Dim serverDateTime_1 As DateTime
        Dim Tbl_DSScreeningTimeMst As Data.DataTable = Nothing
        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing
        Dim RetuVal_RepeatNo As ParameterReturnValue = Nothing

        Dim DataReturnList_Mst As New ArrayList
        Dim RetuVal_Mst As ParameterReturnValue = Nothing
        Dim dr As DataRow


        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If DsScreeningTimeMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            Tbl_DSScreeningTimeMst = DsScreeningTimeMst.Tables("ScreeningTimeMst")


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)


            ' Save in BASequenceConcentrationMatrix
            If Not objSave.SaveInDb("Insert_ScreeningTimeMst", Tbl_DSScreeningTimeMst, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of BaSequenceScheduleHdr In Database"
                Exit Function
            End If


            Save_ScreeningTimeMst = True

            If Save_ScreeningTimeMst Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Save_BASequenceConcentrationMatrix"
            Save_ScreeningTimeMst = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "ExecuteQuery_Boolean"
    Public Function ExecuteQuery_Boolean(ByVal strQuery As String, ByRef eStr_Retu As String) As Boolean
        Dim objDtLogic As New ClsDataLogic_New
        Try

            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            ExecuteQuery_Boolean = objDtLogic.ExecuteQuery_Boolean(strQuery, eStr_Retu)

            If ExecuteQuery_Boolean Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region

#Region "Proc_ReleaseLabReport"
    Public Function Proc_ReleaseLabReport(ByVal Choice As DataObjOpenSaveModeEnum, _
                                     ByVal Ds_ReleaseLabReport As DataSet, _
                                     ByVal UserCode_1 As String, _
                                     ByRef ErrorMsg As String, _
                                     ByRef eStr_Retu As String) As Boolean

        Dim objDtLogic As New ClsDataLogic_New()

        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_ReleaseLabReport As Data.DataTable = Nothing

        'Dim Instr_WorkspaceId As String = ""

        'Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            'Logic Of save Start
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_ReleaseLabReport Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            Tbl_ReleaseLabReport = New DataTable()

            Tbl_ReleaseLabReport = Ds_ReleaseLabReport.Tables("ReleaseLabReport")

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Select * from WorkSpaceMst--Insert_Workspace
            'Select * from WorkSpaceProtocolDetail--Insert_WorkSpaceProtocolDetail
            'Select * from WorkSpaceNodeDetail--Insert_Workspace
            'Select * from WorkSpaceNodeAttrDetail--Insert_Workspace
            'Select * from WorkspaceNodeAttrHistory--Insert_Workspace--For StartDate and End Date of First Activity like create first time create project

            'Select * from WorkSpaceWorkflowUserDtl--If User='Y'--Insert_WorkSpaceWorkflowUserDtl
            'Select * from WorkspaceDefaultWorkflowUserDtl--If User='Y'--Insert_WorkspaceDefaultWorkflowUserDtl

            'Select * from WorkSpaceNodeHistory--If Doc='Y'--Insert_WorkSpaceNodeHistory

            'Select * from MedExWorkSpaceDtl--If Attribute='Y'--Insert_MedExWorkSpaceDtl
            'Select * from MedExWorkSpaceHdr--If Attribute='Y'--Insert_MedExWorkSpaceHdr

            ' Save As WorkSpaceMst
            If Not objSave.SaveInDb("Proc_ReleaseLabReport", Tbl_ReleaseLabReport, Choice, DataReturnList, eStr_Retu, True) Then
                eStr_Retu += vbCrLf + "Error occured while Release Lab Report."
                Exit Function
            End If

            DataReturnList = DataReturnList.Item(0)
            If DataReturnList.Count > 0 Then
                RetuVal = DataReturnList.Item(0)
                ErrorMsg = RetuVal.ParameterValue
            End If

            RetuVal = DataReturnList.Item(0)

            Proc_ReleaseLabReport = True

            If Proc_ReleaseLabReport Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

            objDtLogic.Close_Connection()
        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while Release Lab Report"
            Proc_ReleaseLabReport = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region

#Region "Save_CollectionTimeMst"
    Public Function Save_CollectionTimeMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                      ByVal DsCollectionTimeMst As Data.DataSet, _
                                      ByVal objDtLogic As ClsDataLogic_New, _
                                      ByVal UserCode_1 As String, _
                                      ByRef eStr_Retu As String) As Boolean


        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing


        Dim serverDateTime_1 As DateTime
        Dim Tbl_DSCollectionTimeMst As Data.DataTable = Nothing
        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing
        Dim RetuVal_RepeatNo As ParameterReturnValue = Nothing

        Dim DataReturnList_Mst As New ArrayList
        Dim RetuVal_Mst As ParameterReturnValue = Nothing
        Dim dr As DataRow


        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If DsCollectionTimeMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            Tbl_DSCollectionTimeMst = DsCollectionTimeMst.Tables("CollectionTimeMst")


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)


            ' Save in BASequenceConcentrationMatrix
            If Not objSave.SaveInDb("Insert_CollectionTimeMst", Tbl_DSCollectionTimeMst, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of CollectionTime In Database"
                Exit Function
            End If


            Save_CollectionTimeMst = True

            If Save_CollectionTimeMst Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Save_CollectionTimeMst"
            Save_CollectionTimeMst = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "Save_MachineMedExMst"
    Public Function Insert_MachineMedExMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                      ByVal DsMachineMedExMst As Data.DataSet, _
                                      ByVal objDtLogic As ClsDataLogic_New, _
                                      ByVal UserCode_1 As String, _
                                      ByRef eStr_Retu As String) As Boolean


        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing


        Dim serverDateTime_1 As DateTime
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim Tbl_DtMachineMedExMst As Data.DataTable = Nothing
        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing
        Dim RetuVal_RepeatNo As ParameterReturnValue = Nothing

        Dim DataReturnList_Mst As New ArrayList
        Dim RetuVal_Mst As ParameterReturnValue = Nothing
        Dim dr As DataRow


        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If DsMachineMedExMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            Tbl_DtMachineMedExMst = DsMachineMedExMst.Tables(0)


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)


            ' Save in MachineMedExMst
            If Not objSave.SaveInDb("Insert_MachineMedExMst", Tbl_DtMachineMedExMst, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of MachineMedExMst In Database"
                Exit Function
            End If


            Insert_MachineMedExMst = True

            If Insert_MachineMedExMst Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Save_MachineMedExMst"
            Insert_MachineMedExMst = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "Proc_CopyProject"
    Public Function Proc_CopyProject(ByVal Choice As DataObjOpenSaveModeEnum, _
                                     ByVal Ds_copyproject As DataSet, _
                                  ByRef ErrorMsg As String, _
                                     ByRef eStr_Retu As String) As Boolean
        Dim objDtLogic As New ClsDataLogic_New()

        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_copyproject As Data.DataTable = Nothing

        'Dim Instr_WorkspaceId As String = ""

        'Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            'Logic Of save Start
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_copyproject Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            Tbl_copyproject = New DataTable()

            Tbl_copyproject = Ds_copyproject.Tables("Proc_CopyProject")

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)


            If Not objSave.SaveInDb("Proc_CopyProject", Tbl_copyproject, Choice, DataReturnList, eStr_Retu, True) Then
                eStr_Retu += vbCrLf + "Error occured while Copy project structure."
                Exit Function
            End If

            DataReturnList = DataReturnList.Item(0)
            If DataReturnList.Count > 0 Then
                RetuVal = DataReturnList.Item(0)
                ErrorMsg = RetuVal.ParameterValue
            End If

            RetuVal = DataReturnList.Item(0)

            Proc_CopyProject = True

            If Proc_CopyProject Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

            objDtLogic.Close_Connection()
        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while Copy project structure"
            Proc_CopyProject = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try

    End Function

#End Region

#Region "Save_CRFUPLOADGUIDELINEDTL"
    Public Function Save_CRFUPLOADGUIDELINEDTL(ByVal Choice_1 As DataObjOpenSaveModeEnum, _
                                  ByVal DS_CRFUpload As DataSet, _
                                  ByVal objDtLogic As ClsDataLogic_New, _
                                  ByVal UserCode_1 As String, _
                                  ByRef eStr_Retu As String) As Boolean

        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing


        Dim serverDateTime_1 As DateTime
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim Tbl_CRFUpload As Data.DataTable = Nothing
        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing
        Dim RetuVal_RepeatNo As ParameterReturnValue = Nothing

        Dim DataReturnList_Mst As New ArrayList
        Dim RetuVal_Mst As ParameterReturnValue = Nothing
        Dim dr As DataRow

        Try

            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If DS_CRFUpload Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            Tbl_CRFUpload = DS_CRFUpload.Tables(0)

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            ' Save in CRFUploadGuideLineDtl
            If Not objSave.SaveInDb("Insert_CRFUPLOADGUIDELINEDTL", Tbl_CRFUpload, Choice_1, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of CRFUploadGuideLineDtl In Database"
                Exit Function
            End If

            Save_CRFUPLOADGUIDELINEDTL = True

            If Save_CRFUPLOADGUIDELINEDTL Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Save_CRFUPLOADGUIDELINEDTL"
            Save_CRFUPLOADGUIDELINEDTL = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try
    End Function
#End Region

#Region "Save_ReprintDeleteSampleAudit"
    Public Function Save_ReprintDeleteSampleAudit(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_ReprintDeleteSampleAudit As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_ReprintDeleteSampleAudit As Data.DataTable = Nothing
        Dim Instr_nReprintDeleteSampleNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim ReturnValueList As New ParameterReturnValue

        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()
            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_ReprintDeleteSampleAudit Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_ReprintDeleteSampleAudit.Tables("ReprintDeleteSampleAudit").Rows

                    Instr_nReprintDeleteSampleNo += IIf(Instr_nReprintDeleteSampleNo = "", "", ",").ToString + _
                                    tr("nReprintDeleteSampleNo").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of ClientMst
            If Not objHelpDbTbl.ReprintDeleteSampleAudit("nReprintDeleteSampleNo In (" + Instr_nReprintDeleteSampleNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_ReprintDeleteSampleAudit, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving ReprintDeleteSampleAudit"
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nReprintDeleteSampleNo"

            If Not objSave.AssignValues(Tbl_ReprintDeleteSampleAudit.TableName, PkColArr, Choice, _
                                        Ds_ReprintDeleteSampleAudit.Tables(Tbl_ReprintDeleteSampleAudit.TableName), _
                                        Tbl_ReprintDeleteSampleAudit, Nothing, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in Client Master
            If Not objSave.SaveInDb("insert_ReprintDeleteSampleAudit", Tbl_ReprintDeleteSampleAudit, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of ReprintDeleteSampleAudit In Database"
                Exit Function
            End If

            Save_ReprintDeleteSampleAudit = True
            If Save_ReprintDeleteSampleAudit Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If
        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving ReprintDeleteSampleAudit"
            Save_ReprintDeleteSampleAudit = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "Save_WorkSpaceDeviationReport"
    Public Function Save_WorkSpaceDeviationReport(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_WorkSpaceDeviationReport As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_WorkSpaceDeviationReport As Data.DataTable = Nothing
        Dim Instr_nWorkSpaceDeviationId As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim ReturnValueList As New ParameterReturnValue

        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()
            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_WorkSpaceDeviationReport Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_WorkSpaceDeviationReport.Tables("WorkSpaceDeviationReport").Rows

                    Instr_nWorkSpaceDeviationId += IIf(Instr_nWorkSpaceDeviationId = "", "", ",").ToString + _
                                    tr("nWorkSpaceDeviationId").ToString()

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)


            'Retrieval of WorkSpaceDeviationReport
            If Not objHelpDbTbl.WorkSpaceDeviationReport("nWorkSpaceDeviationId In (" + Instr_nWorkSpaceDeviationId + ")", dataRet_1, _
                                            objDtLogic, Tbl_WorkSpaceDeviationReport, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving ReprintDeleteSampleAudit"
                Exit Function
            End If


            'Assignment of Values
            PkColArr(0) = "nWorkSpaceDeviationId"

            If Not objSave.AssignValuesForCRFHDRDTLSUBDTL(Tbl_WorkSpaceDeviationReport.TableName, PkColArr, Choice, _
                                        Ds_WorkSpaceDeviationReport.Tables(Tbl_WorkSpaceDeviationReport.TableName), _
                                        Tbl_WorkSpaceDeviationReport, Nothing, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in WorkSpaceDeviationReport
            If Not objSave.SaveInDb("Insert_WorkSpaceDeviationReport", Tbl_WorkSpaceDeviationReport, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of ReprintDeleteSampleAudit In Database"
                Exit Function
            End If

            Save_WorkSpaceDeviationReport = True
            If Save_WorkSpaceDeviationReport Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If
        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving ReprintDeleteSampleAudit"
            Save_WorkSpaceDeviationReport = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "Save_IndividualSampleOperationDtlForRemarks"
    'insert individual sample detail (freezer,compartment,operation) in sampleoperationdtl
    Public Function Save_IndividualSampleOperationDtlForRemarks(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_SampleOperationDtl As DataSet, _
                                 ByVal objDtLogic As ClsDataLogic_New, _
                                 ByVal UserCode_1 As String, _
                                 ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_SampleOperationDtl As Data.DataTable = Nothing

        Dim Instr_IndividualSampleOperationDtl As String = ""

        Dim PkColArr(1) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal As ParameterReturnValue = Nothing

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_SampleOperationDtl Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            If Ds_SampleOperationDtl.Tables.Count = 0 Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'If Not Ds_SampleOperationDtl.Tables(0).Columns.Contains("cIsBagorBatch") Then
            '    eStr_Retu = "Column cIsBagorBatch is not available"
            '    Exit Function
            'End If

            'If Not Ds_SampleOperationDtl.Tables(0).Columns.Contains("OperationMode") Then
            '    eStr_Retu = "Column OperationMode is not available"
            '    Exit Function
            'End If

            'Function called only if edit is called
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                For Each tr As Data.DataRow In Ds_SampleOperationDtl.Tables("SampleOperationDtl").Rows

                    Instr_IndividualSampleOperationDtl += IIf(Instr_IndividualSampleOperationDtl = "", "", ",").ToString + _
                                     tr("nSampleOperationDtlNo").ToString()
                Next tr
            End If

            dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            If Choice <> DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of SampleOperationDtl
            If Not objHelpDbTbl.GetSampleOperationDtl("nSampleOperationDtlNo In (" + Instr_IndividualSampleOperationDtl + ")", dataRet_1, _
                                            objDtLogic, Tbl_SampleOperationDtl, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving SampleOperationDtl"
                Exit Function
            End If

            'Tbl_SampleOperationDtl.Columns.Add("OperationMode")
            'Tbl_SampleOperationDtl.Columns.Add("cIsBagOrBatch")
            'Tbl_SampleOperationDtl.AcceptChanges()
            'Assignment of Values
            PkColArr(0) = "nSampleId"
            PkColArr(1) = "iTranNo"
            If Not objSave.AssignValues(Tbl_SampleOperationDtl.TableName, PkColArr, Choice, _
                                        Ds_SampleOperationDtl.Tables(Tbl_SampleOperationDtl.TableName), _
                                        Tbl_SampleOperationDtl, Nothing, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            If Not objSave.SaveInDb("Insert_IndividualSampleOperationDtlForRemarks", Tbl_SampleOperationDtl, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of SampleOperationDtl In Database"
                Exit Function
            End If

            Save_IndividualSampleOperationDtlForRemarks = True

            If Save_IndividualSampleOperationDtlForRemarks Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving SampleOperationDtl"
            Save_IndividualSampleOperationDtlForRemarks = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region

#Region "Save_ProjectReviewerMst"
    Public Function Save_ProjectReviewerMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_ProjectReviewerMst As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_ProjectReviewerMst As Data.DataTable = Nothing
        Dim Instr_nProjectReviewerMstNo As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim ReturnValueList As New ParameterReturnValue

        Try
            eStr_Retu = ""
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()
            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_ProjectReviewerMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_ProjectReviewerMst.Tables("ProjectReviewerMst").Rows

                    Instr_nProjectReviewerMstNo += IIf(Instr_nProjectReviewerMstNo = "", "", ",").ToString + _
                                    tr("nProjectReviewerMstno").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of ClientMst
            If Not objHelpDbTbl.GetProjectReviewerMst("nProjectReviewerMstno In (" + Instr_nProjectReviewerMstNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_ProjectReviewerMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving ProjectReviewerMst"
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nProjectReviewerMstno"

            If Not objSave.AssignValues(Tbl_ProjectReviewerMst.TableName, PkColArr, Choice, _
                                        Ds_ProjectReviewerMst.Tables(Tbl_ProjectReviewerMst.TableName), _
                                        Tbl_ProjectReviewerMst, Nothing, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If

            ' Save in Client Master
            If Not objSave.SaveInDb("Insert_ProjectReviewerMst", Tbl_ProjectReviewerMst, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of ProjectReviewerMst In Database"
                Exit Function
            End If

            Save_ProjectReviewerMst = True
            If Save_ProjectReviewerMst Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If
        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving ProjectReviewerMst"
            Save_ProjectReviewerMst = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "Save_SubjectLabReportDetailForRevised"
    Public Function Save_SubjectLabReportDetailForRevised(ByVal Choice As DataObjOpenSaveModeEnum, _
                                   ByVal Ds_SubjectLabReportDetail As DataSet, _
                                   ByVal UserCode_1 As String, _
                                   ByRef eStr_Retu As String) As Boolean
        Dim objDtLogic As New ClsDataLogic_New()

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_SubjectLabReportDetail As Data.DataTable = Nothing

        Dim Instr_nSubjectLabReportNo As String = ""

        Dim PkColArr(0) As String

        Dim DataReturnList As New ArrayList

        Dim RetuVal As ParameterReturnValue = Nothing


        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            'Logic Of save Start
            eStr_Retu = ""


            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_SubjectLabReportDetail Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Or Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Delete Then
                For Each tr As Data.DataRow In Ds_SubjectLabReportDetail.Tables("SubjectLabReportDetail").Rows

                    Instr_nSubjectLabReportNo += IIf(Instr_nSubjectLabReportNo = "", "", ",").ToString + _
                                    tr("nSubjectLabReportNo").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of User Login Details
            If Not objHelpDbTbl.GetSubjectLabReportDetail("nSubjectLabReportNo In (" + Instr_nSubjectLabReportNo + ")", dataRet_1, _
                                            objDtLogic, Tbl_SubjectLabReportDetail, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving SubjectLabReportDetail"
                Exit Function
            End If



            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nSubjectLabReportNo"

            'If Not objSave.AssignValues(Ds_SubjectLabReportDetail.Tables(0).TableName, PkColArr, Choice, _
            '                            Ds_SubjectLabReportDetail.Tables(0), _
            '                            Tbl_SubjectLabReportDetail, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
            '    eStr_Retu += vbCrLf + "Error occured while assigning values"
            '    Exit Function
            'End If

            ' Save in UserLoginDetails
            If Not objSave.SaveInDb("Insert_SubjectLabReportDtlRevised", Ds_SubjectLabReportDetail.Tables(0), Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Saving SubjectLabReportDetail In Database"
                Exit Function
            End If

            'DataReturnList = DataReturnList.Item(0)
            'RetuVal = DataReturnList.Item(0)
            'Retu_TranNo = RetuVal.ParameterValue

            Save_SubjectLabReportDetailForRevised = True

            If Save_SubjectLabReportDetailForRevised Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while Saving SubjectLabReportDetail"
            Save_SubjectLabReportDetailForRevised = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region

#Region "ServiceMst"
    Public Function Save_ServiceMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_ServiceMst As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_ServiceMst As Data.DataTable = Nothing
        'Dim Tbl_ClientContactMatrix As Data.DataTable = Nothing

        Dim Instr_ServiceCode As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim ReturnValueList As New ParameterReturnValue

        Try
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_ServiceMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_ServiceMst.Tables("ServiceMst").Rows

                    Instr_ServiceCode += IIf(Instr_ServiceCode = "", "", ",").ToString + _
                                    tr("vServiceCode").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of ServiceMst
            If Not objHelpDbTbl.GetServiceDetail("vServiceCode In (" + Instr_ServiceCode + ")", dataRet_1, _
                                            objDtLogic, Tbl_ServiceMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving Service Master"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "vServiceCode"

            If Not objSave.AssignValues(Tbl_ServiceMst.TableName, PkColArr, Choice, _
                                        Ds_ServiceMst.Tables(Tbl_ServiceMst.TableName), _
                                        Tbl_ServiceMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in Service Master
            If Not objSave.SaveInDb("Insert_ServiceMst", Tbl_ServiceMst, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of Service Master In Database"
                Exit Function
            End If

            Save_ServiceMst = True

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Service Master"
            Save_ServiceMst = False
        End Try

    End Function
#End Region

#Region "Save_InstrumentInterface"
    Public Function Save_InstrumentInterface(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_InstruMentHdr As DataSet, _
                                 ByVal objDtLogic As ClsDataLogic_New, _
                                 ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing
        Dim objLambda As ClsMaster = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_InstruMentHdr As Data.DataTable = Nothing

        Dim Instr_SampleId As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal1 As ParameterReturnValue = Nothing
        Dim RetuVal2 As ParameterReturnValue = Nothing


        Try

            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            'Logic Of save Start
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_InstruMentHdr Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            objHelpDbTbl = New clsHelpDbTable()

            objSave = New SaveDataInDbObj(objDtLogic)



            If Not objSave.SaveInDb("Insert_InstrumentInterface", Ds_InstruMentHdr.Tables(0).DefaultView.ToTable(), Choice, Nothing, eStr_Retu, True) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of InstrumentInterface In Database"
                Exit Function
            End If

            Save_InstrumentInterface = True

            If Save_InstrumentInterface Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving InstrumentInterface"
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region


#Region "Save_VisitTracker"
    Public Function Save_VisitTracker(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_AddVisit As DataSet, _
                                 ByVal objDtLogic As ClsDataLogic_New, _
                                 ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing
        Dim objLambda As ClsMaster = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_AddVisit As Data.DataTable = Nothing

        Dim Instr_SampleId As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal1 As ParameterReturnValue = Nothing
        Dim RetuVal2 As ParameterReturnValue = Nothing


        Try

            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            'Logic Of save Start
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_AddVisit Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            objHelpDbTbl = New clsHelpDbTable()

            objSave = New SaveDataInDbObj(objDtLogic)



            If Not objSave.SaveInDb("Insert_VisitTracker", Ds_AddVisit.Tables(0).DefaultView.ToTable(), Choice, Nothing, eStr_Retu, True) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of VisitTracker In Database"
                Exit Function
            End If

            Save_VisitTracker = True

            If Save_VisitTracker Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Data In VisitTracker"
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region

#Region "Save_VisitScheduler"
    Public Function Save_VisitScheduler(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_VisitScheduler As DataSet, _
                                 ByVal objDtLogic As ClsDataLogic_New, _
                                 ByVal UserCode_1 As String, _
                                 ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing
        Dim objLambda As ClsMaster = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_AddVisit As Data.DataTable = Nothing

        Dim Instr_SampleId As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal1 As ParameterReturnValue = Nothing
        Dim RetuVal2 As ParameterReturnValue = Nothing


        Try

            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            'Logic Of save Start
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_VisitScheduler Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            objHelpDbTbl = New clsHelpDbTable()

            objSave = New SaveDataInDbObj(objDtLogic)

            If Not objSave.SaveInDb("Insert_VisitScheduler", Ds_VisitScheduler.Tables(0).DefaultView.ToTable(), Choice, Nothing, eStr_Retu, True) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of VisitTracker In Database"
                Exit Function
            End If

            Save_VisitScheduler = True

            If Save_VisitScheduler Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Data In VisitTracker"
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region

#Region "Save_VisitScheduler"
    Public Function Save_WorkSpaceSubjectMaster(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_WorkSpaceSubejctMaster As DataSet, _
                                 ByVal objDtLogic As ClsDataLogic_New, _
                                 ByVal UserCode_1 As String, _
                                 ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing
        Dim objLambda As ClsMaster = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_AddVisit As Data.DataTable = Nothing

        Dim Instr_SampleId As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim RetuVal1 As ParameterReturnValue = Nothing
        Dim RetuVal2 As ParameterReturnValue = Nothing


        Try

            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            'Logic Of save Start
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_WorkSpaceSubejctMaster Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            objHelpDbTbl = New clsHelpDbTable()

            objSave = New SaveDataInDbObj(objDtLogic)

            If Not objSave.SaveInDb("Insert_WorkspaceSubjectMaster", Ds_WorkSpaceSubejctMaster.Tables(0).DefaultView.ToTable(), Choice, Nothing, eStr_Retu, True) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of VisitTracker In Database"
                Exit Function
            End If

            Save_WorkSpaceSubjectMaster = True

            If Save_WorkSpaceSubjectMaster Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Data In VisitTracker"
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region

#Region "Save_MachineSampleMedexDtl"
    Public Function Save_MachineSampleMedexDtl(ByVal Choice As DataObjOpenSaveModeEnum, _
                                               ByVal ds_MachineWorkListSampleMedexDtl As Data.DataSet, _
                                               ByVal objHdrogic As ClsDataLogic_New, _
                                               ByVal UserCode_1 As String, _
                                               ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing
        Dim objDtLogic As New ClsDataLogic_New
        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing


        Dim serverDateTime_1 As DateTime


        Dim DataReturnList As New ArrayList


        Dim ObjHelpDbTable As New clsHelpDbTable


        Dim objCommon As New clsCommon

        Try


            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()


            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If ds_MachineWorkListSampleMedexDtl Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'If Not objSave.AssignValues(Tbl_MachineWorkListSampleMedexDtl.TableName, PkColArr, Choice, _
            '                           ds_MachineWorkListSampleMedexDtl.Tables(Tbl_MachineWorkListSampleMedexDtl.TableName), _
            '                           Tbl_MachineWorkListSampleMedexDtl, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
            '    eStr_Retu += vbCrLf + "Error occured while assigning values"
            '    Exit Function
            'End If


            If Not objSave.SaveInDb("Insert_MachineSampleMedexDtl", ds_MachineWorkListSampleMedexDtl.Tables(0), Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of Machine Worklist Detail In Database"
                Exit Function
            End If


            Save_MachineSampleMedexDtl = True

            If Save_MachineSampleMedexDtl Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            objDtLogic.RollBack_Transaction()
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving MachineWorkListSampleMedexDtl"
            Save_MachineSampleMedexDtl = False
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "Save_MachineSampleWorkListDtl"
    Public Function Save_MachineSampleWorkListDtl(ByVal Choice As DataObjOpenSaveModeEnum, _
                             ByVal Ds_SampleMedExDetail As DataSet, _
                             ByVal objDtLogic As ClsDataLogic_New, _
                             ByVal UserCode_1 As String, _
                             ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing


        Dim serverDateTime_1 As DateTime




        Dim DataReturnList As New ArrayList



        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()


            eStr_Retu = ""


            If objDtLogic Is Nothing Then
                eStr_Retu += Environment.NewLine + "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu += Environment.NewLine + "Transaction object is not started"
                Exit Function
            End If

            If Ds_SampleMedExDetail Is Nothing Then
                eStr_Retu += Environment.NewLine + "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            If Not objSave.SaveInDb("Insert_MachineSampleWorkListDtl", Ds_SampleMedExDetail.Tables(0), Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of SampleMedExDetail In Database"
                Exit Function
            End If

            Save_MachineSampleWorkListDtl = True

            'Logic of Save End

            If Save_MachineSampleWorkListDtl Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Save_MachineSampleWorkListDtl"
            Save_MachineSampleWorkListDtl = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region

#Region "Save_CopyScreeningTemplate"
    Public Function Save_CopyScreeningTemplate(ByVal Choice As DataObjOpenSaveModeEnum, _
                             ByVal Ds_SampleMedExDetail As DataSet, _
                             ByVal objDtLogic As ClsDataLogic_New, _
                             ByVal UserCode_1 As String, _
                             ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim serverDateTime_1 As DateTime
        Dim DataReturnList As New ArrayList

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""


            If objDtLogic Is Nothing Then
                eStr_Retu += Environment.NewLine + "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu += Environment.NewLine + "Transaction object is not started"
                Exit Function
            End If

            If Ds_SampleMedExDetail Is Nothing Then
                eStr_Retu += Environment.NewLine + "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            If Not objSave.SaveInDb("Insert_CopyScreeningTemplate", Ds_SampleMedExDetail.Tables(0), Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of SampleMedExDetail In Database"
                Exit Function
            End If

            Save_CopyScreeningTemplate = True

            'Logic of Save End

            If Save_CopyScreeningTemplate Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Save_MachineSampleWorkListDtl"
            Save_CopyScreeningTemplate = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region

#Region "Save_ScreeningTemplateVersionMst"
    Public Function Save_ScreeningTemplateVersionMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                             ByVal Ds_SampleMedExDetail As DataSet, _
                             ByVal objDtLogic As ClsDataLogic_New, _
                             ByVal UserCode_1 As String, _
                             ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim serverDateTime_1 As DateTime
        Dim DataReturnList As New ArrayList

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            eStr_Retu = ""


            If objDtLogic Is Nothing Then
                eStr_Retu += Environment.NewLine + "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu += Environment.NewLine + "Transaction object is not started"
                Exit Function
            End If

            If Ds_SampleMedExDetail Is Nothing Then
                eStr_Retu += Environment.NewLine + "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            If Not objSave.SaveInDb("Insert_ScreeningTemplateVersionMst", Ds_SampleMedExDetail.Tables(0), Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of SampleMedExDetail In Database"
                Exit Function
            End If

            Save_ScreeningTemplateVersionMst = True

            'Logic of Save End

            If Save_ScreeningTemplateVersionMst Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Save_MachineSampleWorkListDtl"
            Save_ScreeningTemplateVersionMst = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function
#End Region

#Region "Save_SubjectIrisDtl"
    Public Function Save_SubjectIrisDtl(ByVal Choice As DataObjOpenSaveModeEnum, _
                                               ByVal ds_SaveSubjectIrisDtl As Data.DataSet, _
                                               ByVal objHdrogic As ClsDataLogic_New, _
                                               ByVal UserCode_1 As String, _
                                               ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing
        Dim objDtLogic As New ClsDataLogic_New
        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList


        Dim ObjHelpDbTable As New clsHelpDbTable

        Dim Tbl_SubjectIrisDtl As New Data.DataTable

        Dim objCommon As New clsCommon

        Try


            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu += Environment.NewLine + "Data Object Is Invalid or Nothing"
                Exit Function
            End If


            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If ds_SaveSubjectIrisDtl Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)


            If Not objSave.SaveInDb("Insert_SubjectIrisDetail", ds_SaveSubjectIrisDtl.Tables(0), Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of Subject Iris Detail In Database"
                Exit Function
            End If


            Save_SubjectIrisDtl = True

            If Save_SubjectIrisDtl Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            objDtLogic.RollBack_Transaction()
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving SubjectIrisDetail"
            Save_SubjectIrisDtl = False
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "Save_SubjectIrisVerificationDetail"
    Public Function Save_SubjectIrisVerificationDetail(ByVal Choice As DataObjOpenSaveModeEnum, _
                                               ByVal ds_SaveSubjectIrisVrfctnDtl As Data.DataSet, _
                                               ByVal objHdrogic As ClsDataLogic_New, _
                                               ByVal UserCode_1 As String, _
                                               ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing
        Dim objDtLogic As New ClsDataLogic_New
        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim serverDateTime_1 As DateTime

        Dim ObjHelpDbTable As New clsHelpDbTable
        Try

            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu += Environment.NewLine + "Data Object Is Invalid or Nothing"
                Exit Function
            End If


            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If ds_SaveSubjectIrisVrfctnDtl Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            If Not objSave.SaveInDb("Insert_SubjectIrisVerificationDetail", ds_SaveSubjectIrisVrfctnDtl.Tables(0), Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of Subject Iris Verification Detail In Database"
                Exit Function
            End If
            Save_SubjectIrisVerificationDetail = True

            If Save_SubjectIrisVerificationDetail Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            objDtLogic.RollBack_Transaction()
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving SubjectIrisVerificationDetail"
            Save_SubjectIrisVerificationDetail = False
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "Save_SubjectPopulationMst"
    Public Function Save_SubjectPopulationMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_SubjectPopulationMst As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_SubjectPopulationMst As Data.DataTable = Nothing
        Dim Instr_PopulationId As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_SubjectPopulationMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_SubjectPopulationMst.Tables("SubjectPopulationMst").Rows

                    Instr_PopulationId += IIf(Instr_PopulationId = "", "", ",").ToString + _
                                    tr("nPopulationId").ToString
                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            If Not objHelpDbTbl.getSubjectPopulationMst("nPopulationId In (" + Instr_PopulationId + ")", dataRet_1, _
                                            objDtLogic, Tbl_SubjectPopulationMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving SubjectPopulation Master"
                Exit Function
            End If

            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nPopulationId"

            If Not objSave.AssignValues(Tbl_SubjectPopulationMst.TableName, PkColArr, Choice, _
                                        Ds_SubjectPopulationMst.Tables(Tbl_SubjectPopulationMst.TableName), _
                                        Tbl_SubjectPopulationMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If
            ' Save in SubjectPopulation Master
            If Not objSave.SaveInDb("Insert_SubjectPopulationMst", Tbl_SubjectPopulationMst, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of SubjectPopulation Master In Database"
                Exit Function
            End If
            Save_SubjectPopulationMst = True
            objDtLogic.Commit_Transaction()

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving SubjectPopulation Master"
            Save_SubjectPopulationMst = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "Save_PanelDisplay"
    Public Function Save_PanelDisplay(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_PanelDisplay As DataSet, _
                                 ByVal objDtLogic As ClsDataLogic_New, _
                                 ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing
        Dim objLambda As ClsMaster = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing
        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime
        Try

            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            'Logic Of save Start
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_PanelDisplay Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            objHelpDbTbl = New clsHelpDbTable()

            objSave = New SaveDataInDbObj(objDtLogic)

            If Not objSave.SaveInDb("Insert_PanelDisplay", Ds_PanelDisplay.Tables(0).DefaultView.ToTable(), Choice, Nothing, eStr_Retu, True) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of Panel Display In Database"
                Exit Function
            End If

            Save_PanelDisplay = True

            If Save_PanelDisplay = True Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Panel Display"
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function


#End Region

#Region "Save_ScreeningDCFMST"
    Public Function Save_ScreeningDCFMST(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_ScreeningDCFMST As DataSet, _
                                 ByVal objDtLogic As ClsDataLogic_New, _
                                 ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing
        Dim objLambda As ClsMaster = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing
        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime
        Try

            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            'Logic Of save Start
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_ScreeningDCFMST Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            objHelpDbTbl = New clsHelpDbTable()

            objSave = New SaveDataInDbObj(objDtLogic)

            If Not objSave.SaveInDb("Insert_ScreeningDCFMST", Ds_ScreeningDCFMST.Tables(0).DefaultView.ToTable(), Choice, Nothing, eStr_Retu, True) Then
                eStr_Retu += vbCrLf + "Error occured while Save ScreeningDCFMST In Database"
                Exit Function
            End If

            Save_ScreeningDCFMST = True

            If Save_ScreeningDCFMST = True Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Screening DCF Records."
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function


#End Region

#Region "Document Printer Detail"
    Public Function Save_PrinterDtl(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_PrinterDtl As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_PrinterDtl As Data.DataTable = Nothing
        
        Dim Instr_PrinterId As String = String.Empty

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim ReturnValueList As New ParameterReturnValue

        Try
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_PrinterDtl Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Then
                For Each tr As Data.DataRow In Ds_PrinterDtl.Tables("DocumentPrinterDtl").Rows

                    Instr_PrinterId += IIf(Instr_PrinterId = "", "", ",").ToString + _
                                    tr("nPrinterId").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of DocumentPrinterDtl
            If Not objHelpDbTbl.GetDocumentPrinterDtl("nPrinterId In (" + Instr_PrinterId + ")", dataRet_1, _
                                            objDtLogic, Tbl_PrinterDtl, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving DocumentPrinterDtl"
                Exit Function
            End If


            'Retrieval of Online_AuditInfo
            If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic, _
                                              Tbl_Audit, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nPrinterId"

            If Not objSave.AssignValues(Tbl_PrinterDtl.TableName, PkColArr, Choice, _
                                        Ds_PrinterDtl.Tables(Tbl_PrinterDtl.TableName), _
                                        Tbl_PrinterDtl, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in Service Master
            If Not objSave.SaveInDb("Insert_DocumentPrinterDtl", Tbl_PrinterDtl, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of Printer Detail In Database"
                Exit Function
            End If

            Save_PrinterDtl = True

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Printer Detail"
            Save_PrinterDtl = False
        End Try

    End Function
#End Region

#Region "NoticeMst"
    Public Function Save_NoticeMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                        ByVal Ds_NoticeMst As Data.DataSet, _
                                        ByVal objDtLogic As ClsDataLogic_New, _
                                        ByVal UserCode_1 As String, _
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_NoticeMst As Data.DataTable = Nothing

        Dim Instr_ClientCode As String = ""

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim ReturnValueList As New ParameterReturnValue

        Try
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_NoticeMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Or Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Delete Then
                For Each tr As Data.DataRow In Ds_NoticeMst.Tables("NoticeMst").Rows

                    Instr_ClientCode += IIf(Instr_ClientCode = "", "", ",").ToString + _
                                    tr("nNoticeNo").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of NoticeMst
            If Not objHelpDbTbl.GetNoticeMst("nNoticeNo In (" + Instr_ClientCode + ")", dataRet_1, _
                                            objDtLogic, Tbl_NoticeMst, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving Notice Master"
                Exit Function
            End If

            'Assignment of Values
            PkColArr(0) = "nNoticeNo"

            If Not objSave.AssignValues(Tbl_NoticeMst.TableName, PkColArr, Choice, _
                                        Ds_NoticeMst.Tables(Tbl_NoticeMst.TableName), _
                                        Tbl_NoticeMst, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while assigning values"
                Exit Function
            End If


            ' Save in Client Master
            If Not objSave.SaveInDb("Insert_NoticeMst", Tbl_NoticeMst, Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of Notice Master In Database"
                Exit Function
            End If

            Save_NoticeMst = True

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Client Master"
            Save_NoticeMst = False
        End Try

    End Function
#End Region

#Region "Save_ProjectActivityOperationMatrix"
    Public Function Save_ProjectActivityOperationMatrix(ByVal Choice As DataObjOpenSaveModeEnum, _
                                               ByVal ds_ProjectActivityOperationMatrix As Data.DataSet, _
                                               ByVal objHdrogic As ClsDataLogic_New, _
                                               ByVal UserCode_1 As String, _
                                               ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing
        Dim objDtLogic As New ClsDataLogic_New
        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Dim i As Integer


        Dim ObjHelpDbTable As New clsHelpDbTable

        Dim Tbl_SubjectIrisDtl As New Data.DataTable

        Dim objCommon As New clsCommon

        Try


            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu += Environment.NewLine + "Data Object Is Invalid or Nothing"
                Exit Function
            End If


            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If ds_ProjectActivityOperationMatrix Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)


            If Not objSave.SaveInDb("Insert_ProjectActivityOperationMatrix", ds_ProjectActivityOperationMatrix.Tables(0), Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of Project Activity Operation Matrix In Database"
                objDtLogic.RollBack_Transaction()
                Exit Function
            End If

            For i = 0 To DataReturnList.Count - 1
                If (DirectCast(DataReturnList(i)(0), ParameterReturnValue).ParameterValue = "3") Then
                    eStr_Retu = DirectCast(DataReturnList(i)(1), ParameterReturnValue).ParameterValue
                    objDtLogic.RollBack_Transaction()
                    Exit Function
                End If
            Next


            'If DataReturnList.Item(0) = 1 Then
            '    eStr_Retu += DataReturnList.Item(1)
            'ElseIf DataReturnList.Item(0) = 2 Then
            '    eStr_Retu += DataReturnList.Item(1)
            'ElseIf DataReturnList.Item(0) = 3 Then
            '    eStr_Retu += DataReturnList.Item(1)
            'End If

            Save_ProjectActivityOperationMatrix = True
            objDtLogic.Commit_Transaction()


        Catch ex As Exception
            objDtLogic.RollBack_Transaction()
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Project Activity Operation Matrix"
            Save_ProjectActivityOperationMatrix = False
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "Save_ScreeningDCFMST"
    Public Function Save_ScreeningBarcodeMst(ByVal Choice As DataObjOpenSaveModeEnum, _
                                 ByVal Ds_ScreeningBarcodeMst As DataSet, _
                                 ByVal objDtLogic As ClsDataLogic_New, _
                                 ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing
        Dim objLambda As ClsMaster = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing
        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime
        Try

            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            'Logic Of save Start
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_ScreeningBarcodeMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            objHelpDbTbl = New clsHelpDbTable()

            objSave = New SaveDataInDbObj(objDtLogic)

            If Not objSave.SaveInDb("Insert_ScreeningBarcodeMst", Ds_ScreeningBarcodeMst.Tables(0).DefaultView.ToTable(), Choice, Nothing, eStr_Retu, True) Then
                eStr_Retu += vbCrLf + "Error occured while Save ScreeningBarcodeMst In Database"
                Exit Function
            End If

            Save_ScreeningBarcodeMst = True

            If Save_ScreeningBarcodeMst = True Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Screening DCF Records."
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function


#End Region

#Region "Save_SubjectECGDetails"
    Public Function Save_SubjectECGDetails(ByVal Choice As DataObjOpenSaveModeEnum, _
                                               ByVal ds_SubjectECGDetails As Data.DataSet, _
                                               ByVal objHdrogic As ClsDataLogic_New, _
                                               ByVal UserCode_1 As String, _
                                               ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing
        Dim objDtLogic As New ClsDataLogic_New
        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Dim i As Integer


        Dim ObjHelpDbTable As New clsHelpDbTable

        Dim Tbl_SubjectIrisDtl As New Data.DataTable

        Dim objCommon As New clsCommon

        Try


            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu += Environment.NewLine + "Data Object Is Invalid or Nothing"
                Exit Function
            End If


            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If ds_SubjectECGDetails Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)


            If Not objSave.SaveInDb("Insert_SubjectECGDetails", ds_SubjectECGDetails.Tables(0), Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of Subject ECG Details"
                objDtLogic.RollBack_Transaction()
                Exit Function
            End If

            For i = 0 To DataReturnList.Count - 1
                If (DirectCast(DataReturnList(i)(0), ParameterReturnValue).ParameterValue = "3") Then
                    eStr_Retu = DirectCast(DataReturnList(i)(1), ParameterReturnValue).ParameterValue
                    objDtLogic.RollBack_Transaction()
                    Exit Function
                End If
            Next


            'If DataReturnList.Item(0) = 1 Then
            '    eStr_Retu += DataReturnList.Item(1)
            'ElseIf DataReturnList.Item(0) = 2 Then
            '    eStr_Retu += DataReturnList.Item(1)
            'ElseIf DataReturnList.Item(0) = 3 Then
            '    eStr_Retu += DataReturnList.Item(1)
            'End If

            Save_SubjectECGDetails = True
            objDtLogic.Commit_Transaction()


        Catch ex As Exception
            objDtLogic.RollBack_Transaction()
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Subject ECG Details"
            Save_SubjectECGDetails = False
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "Save_DISoftProjectActivityOperationMatrix"
    Public Function Save_DISoftProjectActivityOperationMatrix(ByVal Choice As DataObjOpenSaveModeEnum, _
                                               ByVal ds_ProjectActivityOperationMatrix As Data.DataSet, _
                                               ByVal objHdrogic As ClsDataLogic_New, _
                                               ByVal UserCode_1 As String, _
                                               ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing
        Dim objDtLogic As New ClsDataLogic_New
        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Dim i As Integer


        Dim ObjHelpDbTable As New clsHelpDbTable

        Dim Tbl_SubjectIrisDtl As New Data.DataTable

        Dim objCommon As New clsCommon

        Try


            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu += Environment.NewLine + "Data Object Is Invalid or Nothing"
                Exit Function
            End If


            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If ds_ProjectActivityOperationMatrix Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)


            If Not objSave.SaveInDb("Insert_DISoftProjectActivityOperationMatrix", ds_ProjectActivityOperationMatrix.Tables(0), Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of Project Activity Operation Matrix In Database"
                objDtLogic.RollBack_Transaction()
                Exit Function
            End If

            For i = 0 To DataReturnList.Count - 1
                If (DirectCast(DataReturnList(i)(0), ParameterReturnValue).ParameterValue = "3") Then
                    eStr_Retu = DirectCast(DataReturnList(i)(1), ParameterReturnValue).ParameterValue
                    objDtLogic.RollBack_Transaction()
                    Exit Function
                End If
            Next

            Save_DISoftProjectActivityOperationMatrix = True
            objDtLogic.Commit_Transaction()


        Catch ex As Exception
            objDtLogic.RollBack_Transaction()
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving Project Activity Operation Matrix"
            Save_DISoftProjectActivityOperationMatrix = False
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region

#Region "Save_ImgTransmittalHdr"
    Public Function Save_ImgTransmittalHdr(ByVal Choice As DataObjOpenSaveModeEnum,
                                               ByVal ds_ImgTransmittalHdr As Data.DataSet,
                                               ByVal objHdrogic As ClsDataLogic_New,
                                               ByVal UserCode_1 As String,
                                               ByRef eStr_Retu As String) As Boolean

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing
        Dim objDtLogic As New ClsDataLogic_New
        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Dim i As Integer


        Dim ObjHelpDbTable As New clsHelpDbTable

        Dim Tbl_SubjectIrisDtl As New Data.DataTable

        Dim objCommon As New clsCommon

        Try


            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu += Environment.NewLine + "Data Object Is Invalid or Nothing"
                Exit Function
            End If


            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If ds_ImgTransmittalHdr Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)


            If Not objSave.SaveInDb("Update_ImgTransmittalHdr", ds_ImgTransmittalHdr.Tables(0), Choice, DataReturnList, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of  ImgTransmittalHdr"
                objDtLogic.RollBack_Transaction()
                Exit Function
            End If

            For i = 0 To DataReturnList.Count - 1
                If (DirectCast(DataReturnList(i)(0), ParameterReturnValue).ParameterValue = "3") Then
                    eStr_Retu = DirectCast(DataReturnList(i)(1), ParameterReturnValue).ParameterValue
                    objDtLogic.RollBack_Transaction()
                    Exit Function
                End If
            Next

            Save_ImgTransmittalHdr = True
            objDtLogic.Commit_Transaction()


        Catch ex As Exception
            objDtLogic.RollBack_Transaction()
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving ImgTransmittalHdr"
            Save_ImgTransmittalHdr = False
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region '================ Added By Shyam Kamdar ===================

#Region "EmaillSetupMst"
    Public Function Save_EmailSetupMst(ByVal Choice As DataObjOpenSaveModeEnum,
                                        ByVal Ds_EmailSetupMst As Data.DataSet,
                                        ByVal objDtLogic As ClsDataLogic_New,
                                        ByVal UserCode_1 As String,
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_EmailSetupMst As Data.DataTable = Nothing


        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_EmailSetupMst Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            Tbl_EmailSetupMst = New DataTable
            Tbl_EmailSetupMst = Ds_EmailSetupMst.Tables(0)

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            If Not objSave.SaveInDb("Insert_EmailSetup", Tbl_EmailSetupMst, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of EmailSetup Master In Database"
                Exit Function
            End If

            Save_EmailSetupMst = True

            If Save_EmailSetupMst Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving EmailSetup Master "
            Save_EmailSetupMst = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region '================ Added By Shyam Kamdar on 28-04-2021 ===================

#Region "Save_OtpInfoDetails"

    Public Function Save_OtpInfoDetails(ByVal Choice As DataObjOpenSaveModeEnum,
                                 ByVal Ds_UserLoginDetails As DataSet,
                                 ByVal UserCode_1 As String,
                                 ByRef eStr_Retu As String) As Boolean
        Dim objDtLogic As New ClsDataLogic_New()

        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_UserOTPDetails As Data.DataTable = Nothing

        Dim Instr_iOtpId As String = ""

        Dim PkColArr(0) As String

        Dim DataReturnList As New ArrayList

        Dim RetuVal As ParameterReturnValue = Nothing


        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()

            'Logic Of save Start
            eStr_Retu = ""


            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_UserLoginDetails Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            'Function called only if edit is called
            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Edit Or Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Delete Then
                For Each tr As Data.DataRow In Ds_UserLoginDetails.Tables("OTPInfo").Rows

                    Instr_iOtpId += IIf(Instr_iOtpId = "", "", ",").ToString +
                                    tr("iOtpId").ToString

                Next tr
            End If

            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If


            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            'Retrieval of User Login Details
            If Not objHelpDbTbl.GetOTPInfoDetails("iOtpId In (" + Instr_iOtpId + ")", dataRet_1,
                                            objDtLogic, Tbl_UserOTPDetails, eStr_Retu) Then

                eStr_Retu += vbCrLf + "Error occured while retrieving User Login Details"
                Exit Function
            End If



            ''Retrieval of Online_AuditInfo
            'If Not objHelpDbTbl.getAuditorial("", DataRetrievalModeEnum.DataTable_Empty, objDtLogic,
            '                                  Tbl_Audit, eStr_Retu) Then
            '    eStr_Retu += vbCrLf + "Error occured while retrieving Audit Information "
            '    Exit Function
            'End If

            ''Assignment of Values
            'PkColArr(0) = "iUserID"

            'If Not objSave.AssignValues(Ds_UserLoginDetails.Tables(0).TableName, PkColArr, Choice,
            '                            Ds_UserLoginDetails.Tables(0),
            '                            Tbl_UserLoginDetails, Tbl_Audit, False, UserCode_1, serverDateTime_1, eStr_Retu) Then
            '    eStr_Retu += vbCrLf + "Error occured while assigning values"
            '    Exit Function
            'End If

            ' Save in Save_OtpInfoDetails
            If Not objSave.SaveInDb("Insert_OTPInfo", Ds_UserLoginDetails.Tables(0).Rows(0).Table, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Saving User Login Details In Database"
                Exit Function
            End If


            Save_OtpInfoDetails = True

            If Save_OtpInfoDetails Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while Saving User Login Details"
            Save_OtpInfoDetails = False
            objDtLogic.RollBack_Transaction()
        Finally
            If Not objDtLogic Is Nothing Then
                objDtLogic.Close_Connection()
                objDtLogic = Nothing
            End If
        End Try
    End Function

#End Region

#Region "SaveExMsgInfo"
    Public Function SaveExMsgInfo(ByVal Choice As DataObjOpenSaveModeEnum,
                                 ByVal Ds_ExMsgInfoDetails As DataSet,
                                 ByVal UserCode_1 As String,
                                 ByRef eStr_Retu As String) As Boolean
        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing
        Dim objDtLogic As New ClsDataLogic_New
        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime
        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList
        Dim ObjHelpDbTable As New clsHelpDbTable
        Dim Tbl_SubjectIrisDtl As New Data.DataTable
        Dim objCommon As New clsCommon

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu += Environment.NewLine + "Data Object Is Invalid or Nothing"
                Exit Function
            End If


            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_ExMsgInfoDetails Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If


            If Choice = DataObjOpenSaveModeEnum.DataObjOpenMode_Add Then
                dataRet_1 = DataRetrievalModeEnum.DataTable_Empty
            Else
                dataRet_1 = DataRetrievalModeEnum.DataTable_WithWhereCondition
            End If

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            If Not objSave.SaveInDb("Insert_ExMsgInfo", Ds_ExMsgInfoDetails.Tables(0).Rows(0).Table, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Saving EXE Msg Info In Database"
                Exit Function
            End If


            SaveExMsgInfo = True

            If SaveExMsgInfo Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception

        Finally

        End Try
    End Function
#End Region

#Region "QueryMaster"
    Public Function Save_QueryMaster(ByVal Choice As DataObjOpenSaveModeEnum,
                                        ByVal Ds_QueryMaster As Data.DataSet,
                                        ByVal objDtLogic As ClsDataLogic_New,
                                        ByVal UserCode_1 As String,
                                        ByRef eStr_Retu As String) As Boolean


        Dim dataRet_1 As DataRetrievalModeEnum
        Dim objHelpDbTbl As clsHelpDbTable = Nothing

        'Object of friend class
        Dim objSave As SaveDataInDbObj = Nothing

        Dim Sql_DtSet As Data.DataSet = Nothing
        Dim Tbl_Audit As Data.DataTable = Nothing
        Dim serverDateTime_1 As DateTime

        Dim Tbl_EmailSetupMst As Data.DataTable = Nothing


        Dim PkColArr(0) As String
        Dim DataReturnList As New ArrayList

        Try
            objDtLogic.Open_Connection()
            objDtLogic.Begin_Transaction()
            eStr_Retu = ""

            If objDtLogic Is Nothing Then
                eStr_Retu = "Data Object Is Invalid or Nothing"
                Exit Function
            End If

            If objDtLogic.Transaction Is Nothing Then
                eStr_Retu = "Transaction object is not started"
                Exit Function
            End If

            If Ds_QueryMaster Is Nothing Then
                eStr_Retu = "Dataset Is Invalid or Nothing"
                Exit Function
            End If

            Tbl_EmailSetupMst = New DataTable
            Tbl_EmailSetupMst = Ds_QueryMaster.Tables(0)

            objHelpDbTbl = New clsHelpDbTable()

            serverDateTime_1 = objDtLogic.GetServerDateTime
            objSave = New SaveDataInDbObj(objDtLogic)

            If Not objSave.SaveInDb("InsertUpdate_QueryMaster", Tbl_EmailSetupMst, Choice, Nothing, eStr_Retu) Then
                eStr_Retu += vbCrLf + "Error occured while Save Information of EmailSetup Master In Database"
                Exit Function
            End If

            Save_QueryMaster = True

            If Save_QueryMaster Then
                objDtLogic.Commit_Transaction()
            Else
                objDtLogic.RollBack_Transaction()
            End If

        Catch ex As Exception
            eStr_Retu = ex.Message + vbCrLf + "Error occured while saving EmailSetup Master "
            Save_QueryMaster = False
            objDtLogic.RollBack_Transaction()
        Finally
            objDtLogic.Close_Connection()
        End Try

    End Function
#End Region '================ Added By Ronak Nayak on 01-06-2022 ===================
End Class

